/**

   \file HOBasis.c

   define single-particle Harmonic oscillator basis


   (c) 2006 Thomas Neff

*/


#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <complex.h>

#include "numerics/cmath.h"
#include "numerics/clebsch.h"
#include "numerics/cmat.h"

#include "misc/physics.h"

#include "fmd/Gaussian.h"
#include "fmd/HOBasis.h"


#define ABS(x) ((x) < 0 ? -(x) : (x))


// array with HO basis states (isospin and spin)

HOSPState HOBasis[4*HODIMMAX];

// for the inverse mapping (xi,n,lj,m) -> idx

int invHOBasis[2][HONMAX+1][2*HONMAX+2][2*HONMAX+2];


// we also need (nx,ny,nz) and (n,l,m) oscillator bases

struct {
  int nx;
  int ny;
  int nz;
} HOnxnynz[HODIMMAX];

struct {
  int n;
  int l;
  int m;
} HOnlm[HODIMMAX];


int dim[HONMAX+1];
int n0[HONMAX+1];

// workspace for cartesian amplitudes

complex double ampcart[HONMAX+1][3];



void initHOBasis(int nmax)
{
  int N;
  int nx, ny, nz;
  int n, l, m;
  int xi, twoj, lj, twom;
  int i;

  i=0;
  for (N=0; N<=nmax; N++) {
    dim[N] = (N+1)*(N+2)/2;
    n0[N] = i;

    for (nx=N; nx>=0; nx--)
      for (ny=N-nx; ny>=0; ny--) {
        nz = N-nx-ny;

	// fprintf(stderr, "%d: (nx,ny,nz) = (%d,%d,%d)\n", i, nx, ny, nz);

        HOnxnynz[i].nx = nx;
        HOnxnynz[i].ny = ny;
        HOnxnynz[i].nz = nz;

        i++;
      }
  }

  i=0;
  for (N=0; N<=nmax; N++) {
    for (n=N/2; n>=0; n--) {
      l=N-2*n;
      for (m=-l; m<=l; m++) {

	// fprintf(stderr, "%d: (n, l, m) = (%d,%d,%d)\n", i, n, l, m);

        HOnlm[i].n = n;
        HOnlm[i].l = l;
        HOnlm[i].m = m;

        i++;
      }
    }
  }
  

  i=0;
  for (xi=0; xi<=1; xi++) {
    for (N=0; N<=nmax; N++) {
      for (n=N/2; n>=0; n--) {
	l=N-2*n;
	for (twoj=ABS(2*l-1); twoj<=2*l+1; twoj=twoj+2) {
	  lj = (2*l+twoj-1)/2;
	  for (twom=-twoj; twom<=twoj; twom=twom+2) {

	    HOBasis[i].xi = xi ? -1 : +1;
	    HOBasis[i].n = n;
	    HOBasis[i].lj = lj;
	    HOBasis[i].m = twom;

	    invHOBasis[xi][n][lj][(twoj+twom)/2] = i;
	    
	    i++;
	  }
	}
      }
    }
  }
}


// includes isospin and spin degeneracy
int dimHOBasis(int nmax)
{
  return 2*2*(nmax+1)*(nmax+2)*(nmax+3)/6;
}


HOSPState* getHOspstate(int idx)
{
  return &HOBasis[idx];
} 


int HOspstateidx(const HOSPState* sp)
{
  return invHOBasis[sp->xi][sp->n][sp->lj][(ljtotwoj(sp->lj)+sp->m)/2];
}


int HOxinljmidx(int xi, int n, int l, int twoj, int twom)
{
  return invHOBasis[xi == +1 ? 0 : 1][n][(2*l+twoj-1)/2][(twoj+twom)/2];
}


char* shelllabel[] = { "s", "p", "sd", "pf", "sdg", 
		       "pfh", "sdgi", "pfhj", "sdgik" };

char* labelHOshell(int N)
{
  return shelllabel[N];
}


char jlabel[] = {'s', 'p', 'd', 'f', 'g', 'h', 'i', 'j', 'k'};


char* labelHOorbit(int n, int l, int twoj)
{
  char* label = malloc(7*sizeof(char));
  sprintf(label, "%d%c%d/2",
	  n, jlabel[l], twoj);
  return label;
}


char* labelHOspstate(const HOSPState* sp)
{
  char* label = malloc(14*sizeof(char));
  sprintf(label, "%c%d%c%d/2,%+d/2", 
	  sp->xi == +1 ? 'p' : 'n', 
	  sp->n, 
	  jlabel[ljtotwol(sp->lj)/2],
	  ljtotwoj(sp->lj),
	  sp->m);
  return label;
}


// one-dimensional overlap between Gaussian and harmonic oscillator

static complex double ng0(double alpha,
			  complex double a, complex double b)
{
  return (sqrt(2)*pow(M_PI/alpha,0.25)/csqrt(1/a + 1/alpha)*
          cexp(-0.5*csqr(b)/(a + alpha)));
}

static complex double ng(int n, double alpha, 
			 complex double a, complex double b)
{
  double alpha2 = alpha*alpha;

  switch(n) {
  case 0:
    return 1;
  case 1:
    return sqrt(2*alpha)*b/(a+alpha);
  case 2:
    return (csqr(a)-alpha2+2*alpha*csqr(b))/(sqrt(2)*csqr(a+alpha));
  case 3:
    return sqrt(alpha)*b*(3*csqr(a)-3*alpha2+2*alpha*csqr(b))/(sqrt(3)*cpow(a+alpha, 3));
  case 4:
    return (3*cpow(a,4)-6*csqr(a)*alpha*(alpha-2*csqr(b))+alpha2*(3*alpha2-12*alpha*csqr(b)+4*cpow(b,4)))/(2*sqrt(6)*cpow(a+alpha,4));
  case 5:
    return (sqrt(alpha)*b*(15*cpow(a,4)+10*csqr(a)*alpha*(-3*alpha+2*csqr(b))+alpha2*(15*alpha2-20*alpha*csqr(b)+4*cpow(b,4))))/(2*sqrt(15)*cpow(a+alpha,5));
  case 6:
    return (15*cpow(a,6)-45*cpow(a,4)*alpha*(alpha-2*csqr(b))+15*csqr(a)*alpha2*(3*alpha2-12*alpha*csqr(b)+4*cpow(b,4))+pow(alpha,3)*(-15*pow(alpha,3)+90*alpha2*cpow(b,2)-60*alpha*cpow(b,4)+8*cpow(b,6)))/(12*sqrt(5)*cpow(a+alpha,6));
  case 7:
    return (sqrt(alpha)*b*(105*cpow(a,6)-105*cpow(a,4)*alpha*(3*alpha-2*csqr(b))+21*csqr(a)*alpha2*(15*alpha2-20*alpha*csqr(b)+4*cpow(b,4))+pow(alpha,3)*(-105*pow(alpha,3)+210*alpha2*csqr(b)-84*alpha*cpow(b,4)+8*cpow(b,6))))/(6*sqrt(70)*cpow(a+alpha,7));
  case 8:
    return (105*cpow(a,8)-420*cpow(a,6)*alpha*(alpha-2*csqr(b))+210*cpow(a,4)*alpha2*(3*alpha2-12*alpha*csqr(b)+4*cpow(b,4))-28*csqr(a)*pow(alpha,3)*(15*pow(alpha,3)-90*alpha2*csqr(b)+60*alpha*cpow(b,4)-8*cpow(b,6))+pow(alpha,4)*(105*pow(alpha,4)-840*pow(alpha,3)*csqr(b)+840*alpha2*cpow(b,4)-224*alpha*cpow(b,6)+16*cpow(b,8)))/(24*sqrt(70)*cpow(a+alpha,8));
  }
}

// Smirnov Coefficients have been calculated in Mathematica by analytically calculating the overlap
// between spherical and cartesian harmonic oscillator wave functions

complex double smirnovcoeff0[1][1] = {{1}};

complex double smirnovcoeff1[3][3] = {
  {0.7071067811865476, 0. + 0.7071067811865476*I, 0.}, 
  {0., 0., 1.}, 
  {-0.7071067811865476, 0. + 0.7071067811865476*I, 0.}};

complex double smirnovcoeff2[6][6] = {
  {-0.5773502691896257, 0., 0., -0.5773502691896257, 0., -0.5773502691896257}, 
  {0.5, 0. + 0.7071067811865476*I, 0., -0.5, 0., 0.}, 
  {0., 0., 0.7071067811865476, 0., 0. + 0.7071067811865476*I, 0.}, 
  {-0.408248290463863, 0., 0., -0.408248290463863, 0., 0.816496580927726}, 
  {0., 0., -0.7071067811865476, 0., 0. + 0.7071067811865476*I, 0.}, 
  {0.5, 0. - 0.7071067811865476*I, 0., -0.5, 0., 0.}};

complex double smirnovcoeff3[10][10] = {
  {-0.5477225575051661, 0. - 0.31622776601683794*I, 0., -0.31622776601683794, 0., 
   -0.31622776601683794, 0. - 0.5477225575051661*I, 0., 0. - 0.31622776601683794*I, 0.}, 
  {0., 0., -0.4472135954999579, 0., 0., 0., 0., -0.4472135954999579, 0., -0.7745966692414834}, 
  {0.5477225575051661, 0. - 0.31622776601683794*I, 0., 0.31622776601683794, 0., 
   0.31622776601683794, 0. - 0.5477225575051661*I, 0., 0. - 0.31622776601683794*I, 0.}, 
  {0.3535533905932738, 0. + 0.6123724356957945*I, 0., 
   -0.6123724356957945, 0., 0., 0. - 0.3535533905932738*I, 0., 0., 0.}, 
  {0., 0., 0.5, 0., 0. + 0.7071067811865476*I, 0., 0., -0.5, 0., 0.}, 
  {-0.27386127875258304, 0. - 0.15811388300841897*I, 0., -0.15811388300841897, 0., 
   0.6324555320336759, 0. - 0.27386127875258304*I, 0., 0. + 0.6324555320336759*I, 0.}, 
  {0., 0., -0.5477225575051661, 0., 0., 0., 0., -0.5477225575051661, 0., 0.6324555320336759}, 
  {0.27386127875258304, 0. - 0.15811388300841897*I, 0., 0.15811388300841897, 0., 
   -0.6324555320336759, 0. - 0.27386127875258304*I, 0., 0. + 0.6324555320336759*I, 0.}, 
  {0., 0., 0.5, 0., 0. - 0.7071067811865476*I, 0., 0., -0.5, 0., 0.}, 
  {-0.3535533905932738, 0. + 0.6123724356957945*I, 0., 0.6123724356957945, 0., 
   0., 0. - 0.3535533905932738*I, 0., 0., 0.}};

complex double smirnovcoeff4[15][15] = {
  {0.4472135954999579, 0., 0., 0.3651483716701107, 0., 0.3651483716701107, 0., 0., 0., 
   0., 0.4472135954999579, 0., 0.3651483716701107, 0., 0.4472135954999579}, 
  {-0.4629100498862757, 0. - 0.4629100498862757*I, 0., 0., 0., -0.18898223650461363, 
   0. - 0.4629100498862757*I, 0., 0. - 0.2672612419124244*I, 0., 0.4629100498862757, 0., 
   0.18898223650461363, 0., 0.}, 
  {0., 0., -0.4629100498862757, 0., 
   0. - 0.2672612419124244*I, 0., 0., -0.2672612419124244, 0., -0.4629100498862757, 0., 
   0. - 0.4629100498862757*I, 0., 0. - 0.4629100498862757*I, 0.}, 
  {0.37796447300922725, 0., 0., 0.3086066999241838, 0., -0.1543033499620919, 0., 0., 0., 
   0., 0.37796447300922725, 0., -0.1543033499620919, 0., -0.7559289460184545}, 
  {0., 0., 0.4629100498862757, 0., 0. - 0.2672612419124244*I, 0., 0., 
   0.2672612419124244, 0., 0.4629100498862757, 0., 0. - 0.4629100498862757*I, 0., 
   0. - 0.4629100498862757*I, 0.}, 
  {-0.4629100498862757, 0. + 0.4629100498862757*I, 0., 
   0., 0., -0.18898223650461363, 0. + 0.4629100498862757*I, 0., 
   0. + 0.2672612419124244*I, 0., 0.4629100498862757, 0., 0.18898223650461363, 0., 0.}, 
  {0.25, 0. + 0.5*I, 0., -0.6123724356957945, 0., 0., 0. - 0.5*I, 0., 0., 0., 0.25, 0., 
   0., 0., 0.}, 
  {0., 0., 0.3535533905932738, 0., 0. + 0.6123724356957945*I, 0., 0., 
   -0.6123724356957945, 0., 0., 0., 0. - 0.3535533905932738*I, 0., 0., 0.}, 
  {-0.18898223650461363, 0. - 0.18898223650461363*I, 0., 0., 0., 0.4629100498862757, 
   0. - 0.18898223650461363*I, 0., 0. + 0.6546536707079771*I, 0., 0.18898223650461363, 
   0., -0.4629100498862757, 0., 0.}, 
  {0., 0., -0.4008918628686366, 0., 0. - 0.23145502494313785*I, 0., 0., 
   -0.23145502494313785, 0., 0.5345224838248488, 0., 0. - 0.4008918628686366*I, 0., 
   0. + 0.5345224838248488*I, 0.}, 
  {0.17928429140015906, 0., 0., 0.14638501094227999, 0., -0.5855400437691199, 0., 0., 
   0., 0., 0.17928429140015906, 0., -0.5855400437691199, 0., 0.47809144373375745}, 
  {0., 0., 0.4008918628686366, 0., 0. - 0.23145502494313785*I, 0., 0., 
   0.23145502494313785, 0., -0.5345224838248488, 0., 0. - 0.4008918628686366*I, 0., 
   0. + 0.5345224838248488*I, 0.}, 
  {-0.18898223650461363, 0. + 0.18898223650461363*I, 
   0., 0., 0., 0.4629100498862757, 0. + 0.18898223650461363*I, 0., 
   0. - 0.6546536707079771*I, 0., 0.18898223650461363, 0., -0.4629100498862757, 0., 0.}, 
  {0., 0., -0.3535533905932738, 0., 0. + 0.6123724356957945*I, 0., 0., 
   0.6123724356957945, 0., 0., 0., 0. - 0.3535533905932738*I, 0., 0., 0.}, 
  {0.25, 0. - 0.5*I, 0., -0.6123724356957945, 0., 0., 0. + 0.5*I, 0., 0., 0., 0.25, 0., 
   0., 0., 0.}};

complex double smirnovcoeff5[21][21] = {
  {0.4629100498862757, 0. + 0.20701966780270625*I, 0., 0.29277002188455997, 0., 
   0.29277002188455997, 0. + 0.29277002188455997*I, 0., 0. + 0.1690308509457033*I, 0., 
   0.20701966780270625, 0., 0.1690308509457033, 0., 0.20701966780270625, 
   0. + 0.4629100498862757*I, 0., 0. + 0.29277002188455997*I, 0., 
   0. + 0.20701966780270625*I, 0.}, 
  {0., 0., 0.29277002188455997, 0., 0., 0., 0., 
   0.23904572186687872, 0., 0.4140393356054125, 0., 0., 0., 0., 0., 0., 
   0.29277002188455997, 0., 0.4140393356054125, 0., 0.6546536707079771}, 
  {-0.4629100498862757, 0. + 0.20701966780270625*I, 0., -0.29277002188455997, 0., 
   -0.29277002188455997, 0. + 0.29277002188455997*I, 0., 0. + 0.1690308509457033*I, 0., 
   -0.20701966780270625, 0., -0.1690308509457033, 0., -0.20701966780270625, 
   0. + 0.4629100498862757*I, 0., 0. + 0.29277002188455997*I, 0., 
   0. + 0.20701966780270625*I, 0.}, 
  {-0.37267799624996495, 0. - 0.5*I, 0., 
   0.23570226039551584, 0., -0.11785113019775792, 0. - 0.23570226039551584*I, 0., 
   0. - 0.2041241452319315*I, 0., 0.5, 0., 0.2041241452319315, 0., 0., 
   0. + 0.37267799624996495*I, 0., 0. + 0.11785113019775792*I, 0., 0., 0.}, 
  {0., 0., -0.408248290463863, 0., 0. - 0.408248290463863*I, 0., 0., 0., 0., 
   -0.28867513459481287, 0., 0. - 0.408248290463863*I, 0., 0. - 0.408248290463863*I, 0., 
   0., 0.408248290463863, 0., 0.28867513459481287, 0., 0.}, 
  {0.28867513459481287, 0. + 0.12909944487358058*I, 0., 0.18257418583505536, 0., 
   -0.27386127875258304, 0. + 0.18257418583505536*I, 0., 0. - 0.15811388300841897*I, 0., 
   0.12909944487358058, 0., -0.15811388300841897, 0., -0.5163977794943223, 
   0. + 0.28867513459481287*I, 0., 0. - 0.27386127875258304*I, 0., 
   0. - 0.5163977794943223*I, 0.}, 
  {0., 0., 0.4472135954999579, 0., 0., 0., 0., 
   0.3651483716701107, 0., 0.10540925533894598, 0., 0., 0., 0., 0., 0., 
   0.4472135954999579, 0., 0.10540925533894598, 0., -0.6666666666666666}, 
  {-0.28867513459481287, 0. + 0.12909944487358058*I, 0., -0.18257418583505536, 0., 
   0.27386127875258304, 0. + 0.18257418583505536*I, 0., 0. - 0.15811388300841897*I, 0., 
   -0.12909944487358058, 0., 0.15811388300841897, 0., 0.5163977794943223, 
   0. + 0.28867513459481287*I, 0., 0. - 0.27386127875258304*I, 0., 
   0. - 0.5163977794943223*I, 0.}, 
  {0., 0., -0.408248290463863, 0., 
   0. + 0.408248290463863*I, 0., 0., 0., 0., -0.28867513459481287, 0., 
   0. + 0.408248290463863*I, 0., 0. + 0.408248290463863*I, 0., 0., 0.408248290463863, 
   0., 0.28867513459481287, 0., 0.}, 
  {0.37267799624996495, 0. - 0.5*I, 0., 
   -0.23570226039551584, 0., 0.11785113019775792, 0. - 0.23570226039551584*I, 0., 
   0. - 0.2041241452319315*I, 0., -0.5, 0., -0.2041241452319315, 0., 0., 
   0. + 0.37267799624996495*I, 0., 0. + 0.11785113019775792*I, 0., 0., 0.}, 
  {0.1767766952966369, 0. + 0.39528470752104744*I, 0., -0.5590169943749475, 0., 0., 
   0. - 0.5590169943749475*I, 0., 0., 0., 0.39528470752104744, 0., 0., 0., 0., 
   0. + 0.1767766952966369*I, 0., 0., 0., 0., 0.}, 
  {0., 0., 0.25, 0., 0. + 0.5*I, 0., 
   0., -0.6123724356957945, 0., 0., 0., 0. - 0.5*I, 0., 0., 0., 0., 0.25, 0., 0., 0., 
   0.}, 
  {-0.13176156917368248, 0. - 0.1767766952966369*I, 0., 0.08333333333333333, 0., 
   0.3333333333333333, 0. - 0.08333333333333333*I, 0., 0. + 0.5773502691896257*I, 0., 
   0.1767766952966369, 0., -0.5773502691896257, 0., 0., 0. + 0.13176156917368248*I, 0., 
   0. - 0.3333333333333333*I, 0., 0., 0.}, 
  {0., 0., -0.28867513459481287, 0., 
   0. - 0.28867513459481287*I, 0., 0., 0., 0., 0.408248290463863, 0., 
   0. - 0.28867513459481287*I, 0., 0. + 0.5773502691896257*I, 0., 0., 
   0.28867513459481287, 0., -0.408248290463863, 0., 0.}, 
  {0.12198750911856665, 0. + 0.0545544725589981*I, 0., 0.07715167498104596, 0., 
   -0.4629100498862757, 0. + 0.07715167498104596*I, 0., 0. - 0.2672612419124244*I, 0., 
   0.0545544725589981, 0., -0.2672612419124244, 0., 0.4364357804719848, 
   0. + 0.12198750911856665*I, 0., 0. - 0.4629100498862757*I, 0., 
   0. + 0.4364357804719848*I, 0.}, 
  {0., 0., 0.2988071523335984, 0., 0., 0., 0., 
   0.2439750182371333, 0., -0.563436169819011, 0., 0., 0., 0., 0., 0., 
   0.2988071523335984, 0., -0.563436169819011, 0., 0.3563483225498992}, 
  {-0.12198750911856665, 0. + 0.0545544725589981*I, 0., -0.07715167498104596, 0., 
   0.4629100498862757, 0. + 0.07715167498104596*I, 0., 0. - 0.2672612419124244*I, 0., 
   -0.0545544725589981, 0., 0.2672612419124244, 0., -0.4364357804719848, 
   0. + 0.12198750911856665*I, 0., 0. - 0.4629100498862757*I, 0., 
   0. + 0.4364357804719848*I, 0.}, 
  {0., 0., -0.28867513459481287, 0., 
   0. + 0.28867513459481287*I, 0., 0., 0., 0., 0.408248290463863, 0., 
   0. + 0.28867513459481287*I, 0., 0. - 0.5773502691896257*I, 0., 0., 
   0.28867513459481287, 0., -0.408248290463863, 0., 0.}, 
  {0.13176156917368248, 0. - 0.1767766952966369*I, 0., -0.08333333333333333, 0., 
   -0.3333333333333333, 0. - 0.08333333333333333*I, 0., 0. + 0.5773502691896257*I, 0., 
   -0.1767766952966369, 0., 0.5773502691896257, 0., 0., 0. + 0.13176156917368248*I, 0., 
   0. - 0.3333333333333333*I, 0., 0., 0.}, 
  {0., 0., 0.25, 0., 0. - 0.5*I, 0., 0., 
   -0.6123724356957945, 0., 0., 0., 0. + 0.5*I, 0., 0., 0., 0., 0.25, 0., 0., 0., 0.}, 
  {-0.1767766952966369, 0. + 0.39528470752104744*I, 0., 0.5590169943749475, 0., 0., 
   0. - 0.5590169943749475*I, 0., 0., 0., -0.39528470752104744, 0., 0., 0., 0., 
   0. + 0.1767766952966369*I, 0., 0., 0., 0., 0.}};

complex double smirnovcoeff6[28][28] = {
  {-0.37796447300922725, 0., 0., -0.29277002188455997, 0., -0.29277002188455997, 0., 0., 
   0., 0., -0.29277002188455997, 0., -0.23904572186687872, 0., -0.29277002188455997, 0., 
   0., 0., 0., 0., 0., -0.37796447300922725, 0., -0.29277002188455997, 0., 
   -0.29277002188455997, 0., -0.37796447300922725}, 
  {0.4225771273642583, 0. + 0.3450327796711771*I, 0., 0.1091089451179962, 0., 
   0.2182178902359924, 0. + 0.37796447300922725*I, 0., 0. + 0.2182178902359924*I, 0., 
   -0.1091089451179962, 0., 0., 0., 0.1091089451179962, 0. + 0.3450327796711771*I, 0., 
   0. + 0.2182178902359924*I, 0., 0. + 0.1543033499620919*I, 0., -0.4225771273642583, 
   0., -0.2182178902359924, 0., -0.1091089451179962, 0., 0.}, 
  {0., 0., 0.3450327796711771, 0., 0. + 0.1543033499620919*I, 0., 0., 
   0.2182178902359924, 0., 0.37796447300922725, 0., 0. + 0.2182178902359924*I, 0., 
   0. + 0.2182178902359924*I, 0., 0., 0.1543033499620919, 0., 0.2182178902359924, 0., 
   0.3450327796711771, 0., 0. + 0.3450327796711771*I, 0., 0. + 0.37796447300922725*I, 
   0., 0. + 0.3450327796711771*I, 0.}, 
  {-0.3450327796711771, 0., 0., 
   -0.2672612419124244, 0., 0., 0., 0., 0., 0., -0.2672612419124244, 0., 0., 0., 
   0.2672612419124244, 0., 0., 0., 0., 0., 0., -0.3450327796711771, 0., 0., 0., 
   0.2672612419124244, 0., 0.6900655593423543}, 
  {0., 0., -0.3450327796711771, 0., 
   0. + 0.1543033499620919*I, 0., 0., -0.2182178902359924, 0., -0.37796447300922725, 0., 
   0. + 0.2182178902359924*I, 0., 0. + 0.2182178902359924*I, 0., 0., 
   -0.1543033499620919, 0., -0.2182178902359924, 0., -0.3450327796711771, 0., 
   0. + 0.3450327796711771*I, 0., 0. + 0.37796447300922725*I, 0., 
   0. + 0.3450327796711771*I, 0.}, 
  {0.4225771273642583, 0. - 0.3450327796711771*I, 0., 
   0.1091089451179962, 0., 0.2182178902359924, 0. - 0.37796447300922725*I, 0., 
   0. - 0.2182178902359924*I, 0., -0.1091089451179962, 0., 0., 0., 0.1091089451179962, 
   0. - 0.3450327796711771*I, 0., 0. - 0.2182178902359924*I, 0., 
   0. - 0.1543033499620919*I, 0., -0.4225771273642583, 0., -0.2182178902359924, 0., 
   -0.1091089451179962, 0., 0.}, 
  {-0.2919371040605711, 0. - 0.4767312946227962*I, 0., 
   0.37688918072220456, 0., -0.07537783614444091, 0., 0., 0. - 0.15075567228888181*I, 
   0., 0.37688918072220456, 0., 0.1846372364689991, 0., 0., 0. + 0.4767312946227962*I, 
   0., 0. + 0.15075567228888181*I, 0., 0., 0., -0.2919371040605711, 0., 
   -0.07537783614444091, 0., 0., 0., 0.}, 
  {0., 0., -0.337099931231621, 0., 
   0. - 0.45226701686664544*I, 0., 0., 0.21320071635561044, 0., -0.1846372364689991, 0., 
   0. - 0.21320071635561044*I, 0., 0. - 0.31980107453341566*I, 0., 0., 
   0.45226701686664544, 0., 0.31980107453341566, 0., 0., 0., 0. + 0.337099931231621*I, 
   0., 0. + 0.1846372364689991*I, 0., 0., 0.}, 
  {0.2206837073761874, 
   0. + 0.1801874925391118*I, 0., 0.05698028822981897, 0., -0.2849014411490949, 
   0. + 0.19738550848793068*I, 0., 0. - 0.2849014411490949*I, 0., -0.05698028822981897, 
   0., 0., 0., -0.3418817293789138, 0. + 0.1801874925391118*I, 0., 
   0. - 0.2849014411490949*I, 0., 0. - 0.48349377841522817*I, 0., -0.2206837073761874, 
   0., 0.2849014411490949, 0., 0.3418817293789138, 0., 0.}, 
  {0., 0., 0.3822353935782191, 0., 0. + 0.1709408646894569*I, 0., 0., 
   0.24174688920761409, 0., -0.06978631577988531, 0., 0. + 0.24174688920761409*I, 0., 
   0. - 0.040291148201269014*I, 0., 0., 0.1709408646894569, 0., -0.040291148201269014, 
   0., -0.5096471914376255, 0., 0. + 0.3822353935782191*I, 0., 
   0. - 0.06978631577988531*I, 0., 0. - 0.5096471914376255*I, 0.}, 
  {-0.20935894733965593, 0., 0., -0.16216874328520062, 0., 0.37839373433213475, 0., 0., 
   0., 0., -0.16216874328520062, 0., 0.30895719032666236, 0., 0.2882999880625789, 0., 
   0., 0., 0., 0., 0., -0.20935894733965593, 0., 0.37839373433213475, 0., 
   0.2882999880625789, 0., -0.5582905262390825}, 
  {0., 0., -0.3822353935782191, 0., 
   0. + 0.1709408646894569*I, 0., 0., -0.24174688920761409, 0., 0.06978631577988531, 0., 
   0. + 0.24174688920761409*I, 0., 0. - 0.040291148201269014*I, 0., 0., 
   -0.1709408646894569, 0., 0.040291148201269014, 0., 0.5096471914376255, 0., 
   0. + 0.3822353935782191*I, 0., 0. - 0.06978631577988531*I, 0., 
   0. - 0.5096471914376255*I, 0.}, 
  {0.2206837073761874, 0. - 0.1801874925391118*I, 0., 
   0.05698028822981897, 0., -0.2849014411490949, 0. - 0.19738550848793068*I, 0., 
   0. + 0.2849014411490949*I, 0., -0.05698028822981897, 0., 0., 0., -0.3418817293789138, 
   0. - 0.1801874925391118*I, 0., 0. + 0.2849014411490949*I, 0., 
   0. + 0.48349377841522817*I, 0., -0.2206837073761874, 0., 0.2849014411490949, 0., 
   0.3418817293789138, 0., 0.}, 
  {0., 0., 0.337099931231621, 0., 
   0. - 0.45226701686664544*I, 0., 0., -0.21320071635561044, 0., 0.1846372364689991, 0., 
   0. - 0.21320071635561044*I, 0., 0. - 0.31980107453341566*I, 0., 0., 
   -0.45226701686664544, 0., -0.31980107453341566, 0., 0., 0., 0. + 0.337099931231621*I, 
   0., 0. + 0.1846372364689991*I, 0., 0., 0.}, 
  {-0.2919371040605711, 
   0. + 0.4767312946227962*I, 0., 0.37688918072220456, 0., -0.07537783614444091, 0., 0., 
   0. + 0.15075567228888181*I, 0., 0.37688918072220456, 0., 0.1846372364689991, 0., 0., 
   0. - 0.4767312946227962*I, 0., 0. - 0.15075567228888181*I, 0., 0., 0., 
   -0.2919371040605711, 0., -0.07537783614444091, 0., 0., 0., 0.}, 
  {0.125, 0. + 0.30618621784789724*I, 0., -0.4841229182759271, 0., 0., 
   0. - 0.5590169943749475*I, 0., 0., 0., 0.4841229182759271, 0., 0., 0., 0., 
   0. + 0.30618621784789724*I, 0., 0., 0., 0., 0., -0.125, 0., 0., 0., 0., 0., 0.}, 
  {0., 0., 0.1767766952966369, 0., 0. + 0.39528470752104744*I, 0., 0., 
   -0.5590169943749475, 0., 0., 0., 0. - 0.5590169943749475*I, 0., 0., 0., 0., 
   0.39528470752104744, 0., 0., 0., 0., 0., 0. + 0.1767766952966369*I, 0., 0., 0., 0., 
   0.}, 
  {-0.09231861823449955, 0. - 0.15075567228888181*I, 0., 0.11918282365569904, 0., 
   0.2383656473113981, 0., 0., 0. + 0.4767312946227962*I, 0., 0.11918282365569904, 0., 
   -0.5838742081211422, 0., 0., 0. + 0.15075567228888181*I, 0., 
   0. - 0.4767312946227962*I, 0., 0., 0., -0.09231861823449955, 0., 0.2383656473113981, 
   0., 0., 0., 0.}, 
  {0., 0., -0.20643070596119262, 0., 0. - 0.27695585470349865*I, 0., 
   0., 0.13055824196677338, 0., 0.30151134457776363, 0., 0. - 0.13055824196677338*I, 0., 
   0. + 0.5222329678670935*I, 0., 0., 0.27695585470349865, 0., -0.5222329678670935, 0., 
   0., 0., 0. + 0.20643070596119262*I, 0., 0. - 0.30151134457776363*I, 0., 0., 0.}, 
  {0.08427498280790525, 0. + 0.06881023532039754*I, 0., 0.02175970699446223, 0., 
   -0.3481553119113957, 0. + 0.07537783614444091*I, 0., 0. - 0.3481553119113957*I, 0., 
   -0.02175970699446223, 0., 0., 0., 0.3481553119113957, 0. + 0.06881023532039754*I, 0., 
   0. - 0.3481553119113957*I, 0., 0. + 0.49236596391733095*I, 0., -0.08427498280790525, 
   0., 0.3481553119113957, 0., -0.3481553119113957, 0., 0.}, 
  {0., 0., 0.2175970699446223, 0., 0. + 0.09731236802019037*I, 0., 0., 
   0.13762047064079508, 0., -0.4767312946227962, 0., 0. + 0.13762047064079508*I, 0., 
   0. - 0.27524094128159016*I, 0., 0., 0.09731236802019037, 0., -0.27524094128159016, 
   0., 0.3481553119113957, 0., 0. + 0.2175970699446223*I, 0., 0. - 0.4767312946227962*I, 
   0., 0. + 0.3481553119113957*I, 0.}, 
  {-0.08224396186997113, 0., 0., 
   -0.06370589892970319, 0., 0.3822353935782191, 0., 0., 0., 0., -0.06370589892970319, 
   0., 0.31209389196617965, 0., -0.5096471914376255, 0., 0., 0., 0., 0., 0., 
   -0.08224396186997113, 0., 0.3822353935782191, 0., -0.5096471914376255, 0., 
   0.2631806779839076}, 
  {0., 0., -0.2175970699446223, 0., 0. + 0.09731236802019037*I, 
   0., 0., -0.13762047064079508, 0., 0.4767312946227962, 0., 0. + 0.13762047064079508*I, 
   0., 0. - 0.27524094128159016*I, 0., 0., -0.09731236802019037, 0., 
   0.27524094128159016, 0., -0.3481553119113957, 0., 0. + 0.2175970699446223*I, 0., 
   0. - 0.4767312946227962*I, 0., 0. + 0.3481553119113957*I, 0.}, 
  {0.08427498280790525, 0. - 0.06881023532039754*I, 0., 0.02175970699446223, 0., 
   -0.3481553119113957, 0. - 0.07537783614444091*I, 0., 0. + 0.3481553119113957*I, 0., 
   -0.02175970699446223, 0., 0., 0., 0.3481553119113957, 0. - 0.06881023532039754*I, 0., 
   0. + 0.3481553119113957*I, 0., 0. - 0.49236596391733095*I, 0., -0.08427498280790525, 
   0., 0.3481553119113957, 0., -0.3481553119113957, 0., 0.}, 
  {0., 0., 0.20643070596119262, 0., 0. - 0.27695585470349865*I, 0., 0., 
   -0.13055824196677338, 0., -0.30151134457776363, 0., 0. - 0.13055824196677338*I, 0., 
   0. + 0.5222329678670935*I, 0., 0., -0.27695585470349865, 0., 0.5222329678670935, 0., 
   0., 0., 0. + 0.20643070596119262*I, 0., 0. - 0.30151134457776363*I, 0., 0., 0.}, 
  {-0.09231861823449955, 0. + 0.15075567228888181*I, 0., 0.11918282365569904, 0., 
   0.2383656473113981, 0., 0., 0. - 0.4767312946227962*I, 0., 0.11918282365569904, 0., 
   -0.5838742081211422, 0., 0., 0. - 0.15075567228888181*I, 0., 
   0. + 0.4767312946227962*I, 0., 0., 0., -0.09231861823449955, 0., 0.2383656473113981, 
   0., 0., 0., 0.}, 
  {0., 0., -0.1767766952966369, 0., 0. + 0.39528470752104744*I, 0., 
   0., 0.5590169943749475, 0., 0., 0., 0. - 0.5590169943749475*I, 0., 0., 0., 0., 
   -0.39528470752104744, 0., 0., 0., 0., 0., 0. + 0.1767766952966369*I, 0., 0., 0., 0., 
   0.}, 
  {0.125, 0. - 0.30618621784789724*I, 0., -0.4841229182759271, 0., 0., 
   0. + 0.5590169943749475*I, 0., 0., 0., 0.4841229182759271, 0., 0., 0., 0., 
   0. - 0.30618621784789724*I, 0., 0., 0., 0., 0., -0.125, 0., 0., 0., 0., 0., 0.}};

complex double smirnovcoeff7[36][36] ={
  {-0.408248290463863, 0. - 0.1543033499620919*I, 0., -0.2672612419124244, 0., 
   -0.2672612419124244, 0. - 0.20701966780270625*I, 0., 0. - 0.11952286093343936*I, 0., 
   -0.20701966780270625, 0., -0.1690308509457033, 0., -0.20701966780270625, 
   0. - 0.2672612419124244*I, 0., 0. - 0.1690308509457033*I, 0., 
   0. - 0.11952286093343936*I, 0., -0.1543033499620919, 0., -0.11952286093343936, 0., 
   -0.11952286093343936, 0., -0.1543033499620919, 0. - 0.408248290463863*I, 0., 
   0. - 0.2672612419124244*I, 0., 0. - 0.20701966780270625*I, 0., 
   0. - 0.1543033499620919*I, 0.}, 
  {0., 0., -0.2182178902359924, 0., 0., 0., 0., 
   -0.1690308509457033, 0., -0.29277002188455997, 0., 0., 0., 0., 0., 0., 
   -0.1690308509457033, 0., -0.23904572186687872, 0., -0.37796447300922725, 0., 0., 0., 
   0., 0., 0., 0., 0., -0.2182178902359924, 0., -0.29277002188455997, 0., 
   -0.37796447300922725, 0., -0.5773502691896257}, 
  {0.408248290463863, 0. - 0.1543033499620919*I, 0., 0.2672612419124244, 0., 
   0.2672612419124244, 0. - 0.20701966780270625*I, 0., 0. - 0.11952286093343936*I, 0., 
   0.20701966780270625, 0., 0.1690308509457033, 0., 0.20701966780270625, 
   0. - 0.2672612419124244*I, 0., 0. - 0.1690308509457033*I, 0., 
   0. - 0.11952286093343936*I, 0., 0.1543033499620919, 0., 0.11952286093343936, 0., 
   0.11952286093343936, 0., 0.1543033499620919, 0. - 0.408248290463863*I, 0., 
   0. - 0.2672612419124244*I, 0., 0. - 0.20701966780270625*I, 0., 
   0. - 0.1543033499620919*I, 0.}, 
  {0.36410954062720957, 0. + 0.41286141192238524*I, 0., 
   -0.07945521577046602, 0., 0.15891043154093204, 0. + 0.30772872744833185*I, 0., 
   0. + 0.21320071635561044*I, 0., -0.30772872744833185, 0., -0.10050378152592121, 0., 
   0.06154574548966637, 0. + 0.07945521577046602*I, 0., 0. + 0.10050378152592121*I, 0., 
   0. + 0.10660035817780522*I, 0., -0.41286141192238524, 0., -0.21320071635561044, 0., 
   -0.10660035817780522, 0., 0., 0. - 0.36410954062720957*I, 0., 
   0. - 0.15891043154093204*I, 0., 0. - 0.06154574548966637*I, 0., 0., 0.}, 
  {0., 0., 0.337099931231621, 0., 0. + 0.27524094128159016*I, 0., 0., 
   0.08703882797784893, 0., 0.30151134457776363, 0., 0. + 0.30151134457776363*I, 0., 
   0. + 0.30151134457776363*I, 0., 0., -0.08703882797784893, 0., 0., 0., 
   0.19462473604038075, 0., 0. + 0.27524094128159016*I, 0., 0. + 0.30151134457776363*I, 
   0., 0. + 0.27524094128159016*I, 0., 0., -0.337099931231621, 0., -0.30151134457776363, 
   0., -0.19462473604038075, 0., 0.}, 
  {-0.2820380374088831, 0. - 0.10660035817780522*I, 
   0., -0.1846372364689991, 0., 0.12309149097933274, 0. - 0.14301938838683886*I, 0., 
   0. + 0.05504818825631803*I, 0., -0.14301938838683886, 0., 0.0778498944161523, 0., 
   0.3337119062359573, 0. - 0.1846372364689991*I, 0., 0. + 0.0778498944161523*I, 0., 
   0. + 0.1926686588971131*I, 0., -0.10660035817780522, 0., 0.05504818825631803, 0., 
   0.1926686588971131, 0., 0.4264014327112209, 0. - 0.2820380374088831*I, 0., 
   0. + 0.12309149097933274*I, 0., 0. + 0.3337119062359573*I, 0., 
   0. + 0.4264014327112209*I, 0.}, 
  {0., 0., -0.3692744729379982, 0., 0., 0., 0., 
   -0.2860387767736777, 0., -0.2201927530252721, 0., 0., 0., 0., 0., 0., 
   -0.2860387767736777, 0., -0.1797866299901979, 0., 0.07106690545187014, 0., 0., 0., 
   0., 0., 0., 0., 0., -0.3692744729379982, 0., -0.2201927530252721, 0., 
   0.07106690545187014, 0., 0.6513389472789296}, 
  {0.2820380374088831, 0. - 0.10660035817780522*I, 0., 0.1846372364689991, 0., 
   -0.12309149097933274, 0. - 0.14301938838683886*I, 0., 0. + 0.05504818825631803*I, 0., 
   0.14301938838683886, 0., -0.0778498944161523, 0., -0.3337119062359573, 
   0. - 0.1846372364689991*I, 0., 0. + 0.0778498944161523*I, 0., 
   0. + 0.1926686588971131*I, 0., 0.10660035817780522, 0., -0.05504818825631803, 0., 
   -0.1926686588971131, 0., -0.4264014327112209, 0. - 0.2820380374088831*I, 0., 
   0. + 0.12309149097933274*I, 0., 0. + 0.3337119062359573*I, 0., 
   0. + 0.4264014327112209*I, 0.}, 
  {0., 0., 0.337099931231621, 0., 
   0. - 0.27524094128159016*I, 0., 0., 0.08703882797784893, 0., 0.30151134457776363, 0., 
   0. - 0.30151134457776363*I, 0., 0. - 0.30151134457776363*I, 0., 0., 
   -0.08703882797784893, 0., 0., 0., 0.19462473604038075, 0., 
   0. - 0.27524094128159016*I, 0., 0. - 0.30151134457776363*I, 0., 
   0. - 0.27524094128159016*I, 0., 0., -0.337099931231621, 0., -0.30151134457776363, 0., 
   -0.19462473604038075, 0., 0.}, 
  {-0.36410954062720957, 0. + 0.41286141192238524*I, 0., 
   0.07945521577046602, 0., -0.15891043154093204, 0. + 0.30772872744833185*I, 0., 
   0. + 0.21320071635561044*I, 0., 0.30772872744833185, 0., 0.10050378152592121, 0., 
   -0.06154574548966637, 0. + 0.07945521577046602*I, 0., 0. + 0.10050378152592121*I, 0., 
   0. + 0.10660035817780522*I, 0., 0.41286141192238524, 0., 0.21320071635561044, 0., 
   0.10660035817780522, 0., 0., 0. - 0.36410954062720957*I, 0., 
   0. - 0.15891043154093204*I, 0., 0. - 0.06154574548966637*I, 0., 0., 0.}, 
  {-0.2246792585682293, 0. - 0.4246038878042234*I, 0., 0.44126130406091413, 0., 
   -0.04902903378454601, 0. + 0.18988863132818748*I, 0., 0. - 0.10963225241337865*I, 0., 
   0.18988863132818748, 0., 0.15504341823651058, 0., 0., 0. + 0.44126130406091413*I, 0., 
   0. + 0.15504341823651058*I, 0., 0., 0., -0.4246038878042234, 0., 
   -0.10963225241337865, 0., 0., 0., 0., 0. - 0.2246792585682293*I, 0., 
   0. - 0.04902903378454601*I, 0., 0., 0., 0., 0.}, 
  {0., 0., -0.2685430777647873, 0., 
   0. - 0.4385290096535146*I, 0., 0., 0.34668762264076824, 0., -0.12009611535381536, 0., 
   0., 0., 0. - 0.2401922307076307*I, 0., 0., 0.34668762264076824, 0., 
   0.29417420270727607, 0., 0., 0., 0. + 0.4385290096535146*I, 0., 
   0. + 0.2401922307076307*I, 0., 0., 0., 0., -0.2685430777647873, 0., 
   -0.12009611535381536, 0., 0., 0., 0.}, 
  {0.1674660317642709, 
   0. + 0.18988863132818748*I, 0., -0.03654408413779288, 0., -0.2558085889645502, 
   0. + 0.14153462926807447*I, 0., 0. - 0.34320323649182205*I, 0., -0.14153462926807447, 
   0., 0.16178755723235852, 0., -0.22645540682891915, 0. + 0.03654408413779288*I, 0., 
   0. - 0.16178755723235852*I, 0., 0. - 0.3922322702763681*I, 0., -0.18988863132818748, 
   0., 0.34320323649182205, 0., 0.3922322702763681, 0., 0., 0. - 0.1674660317642709*I, 
   0., 0. + 0.2558085889645502*I, 0., 0. + 0.22645540682891915*I, 0., 0., 0.}, 
  {0., 0., 0.31008683647302115, 0., 0. + 0.25318484177091666*I, 0., 0., 
   0.08006407690254357, 0., -0.1386750490563073, 0., 0. + 0.2773500981126146*I, 0., 
   0. - 0.1386750490563073*I, 0., 0., -0.08006407690254357, 0., 0., 0., 
   -0.35805743701971643, 0., 0. + 0.25318484177091666*I, 0., 0. - 0.1386750490563073*I, 
   0., 0. - 0.5063696835418333*I, 0., 0., -0.31008683647302115, 0., 0.1386750490563073, 
   0., 0.35805743701971643, 0., 0.}, 
  {-0.15504341823651058, 0. - 0.058600903867311926*I, 
   0., -0.10149974286764377, 0., 0.3721657238480272, 0. - 0.07862136275414387*I, 0., 
   0. + 0.16643757148392066*I, 0., -0.07862136275414387, 0., 0.2353782708810021, 0., 
   0.10482848367219183, 0. - 0.10149974286764377*I, 0., 0. + 0.2353782708810021*I, 0., 
   0. + 0.06052275326688024*I, 0., -0.058600903867311926, 0., 0.16643757148392066, 0., 
   0.06052275326688024, 0., -0.4688072309384954, 0. - 0.15504341823651058*I, 0., 
   0. + 0.3721657238480272*I, 0., 0. + 0.10482848367219183*I, 0., 
   0. - 0.4688072309384954*I, 0.}, 
  {0., 0., -0.3209703693831847, 0., 0., 0., 0., 
   -0.24862257904942348, 0., 0.23923718823467274, 0., 0., 0., 0., 0., 0., 
   -0.24862257904942348, 0., 0.1953363462243731, 0., 0.3953329688859206, 0., 0., 0., 0., 
   0., 0., 0., 0., -0.3209703693831847, 0., 0.23923718823467274, 0., 0.3953329688859206, 
   0., -0.4529108136578383}, 
  {0.15504341823651058, 0. - 0.058600903867311926*I, 0., 
   0.10149974286764377, 0., -0.3721657238480272, 0. - 0.07862136275414387*I, 0., 
   0. + 0.16643757148392066*I, 0., 0.07862136275414387, 0., -0.2353782708810021, 0., 
   -0.10482848367219183, 0. - 0.10149974286764377*I, 0., 0. + 0.2353782708810021*I, 0., 
   0. + 0.06052275326688024*I, 0., 0.058600903867311926, 0., -0.16643757148392066, 0., 
   -0.06052275326688024, 0., 0.4688072309384954, 0. - 0.15504341823651058*I, 0., 
   0. + 0.3721657238480272*I, 0., 0. + 0.10482848367219183*I, 0., 
   0. - 0.4688072309384954*I, 0.}, 
  {0., 0., 0.31008683647302115, 0., 
   0. - 0.25318484177091666*I, 0., 0., 0.08006407690254357, 0., -0.1386750490563073, 0., 
   0. - 0.2773500981126146*I, 0., 0. + 0.1386750490563073*I, 0., 0., 
   -0.08006407690254357, 0., 0., 0., -0.35805743701971643, 0., 
   0. - 0.25318484177091666*I, 0., 0. + 0.1386750490563073*I, 0., 
   0. + 0.5063696835418333*I, 0., 0., -0.31008683647302115, 0., 0.1386750490563073, 0., 
   0.35805743701971643, 0., 0.}, 
  {-0.1674660317642709, 0. + 0.18988863132818748*I, 0., 
   0.03654408413779288, 0., 0.2558085889645502, 0. + 0.14153462926807447*I, 0., 
   0. - 0.34320323649182205*I, 0., 0.14153462926807447, 0., -0.16178755723235852, 0., 
   0.22645540682891915, 0. + 0.03654408413779288*I, 0., 0. - 0.16178755723235852*I, 0., 
   0. - 0.3922322702763681*I, 0., 0.18988863132818748, 0., -0.34320323649182205, 0., 
   -0.3922322702763681, 0., 0., 0. - 0.1674660317642709*I, 0., 
   0. + 0.2558085889645502*I, 0., 0. + 0.22645540682891915*I, 0., 0., 0.}, 
  {0., 0., -0.2685430777647873, 0., 0. + 0.4385290096535146*I, 0., 0., 
   0.34668762264076824, 0., -0.12009611535381536, 0., 0., 0., 0. + 0.2401922307076307*I, 
   0., 0., 0.34668762264076824, 0., 0.29417420270727607, 0., 0., 0., 
   0. - 0.4385290096535146*I, 0., 0. - 0.2401922307076307*I, 0., 0., 0., 0., 
   -0.2685430777647873, 0., -0.12009611535381536, 0., 0., 0., 0.}, 
  {0.2246792585682293, 0. - 0.4246038878042234*I, 0., -0.44126130406091413, 0., 
   0.04902903378454601, 0. + 0.18988863132818748*I, 0., 0. - 0.10963225241337865*I, 0., 
   -0.18988863132818748, 0., -0.15504341823651058, 0., 0., 0. + 0.44126130406091413*I, 
   0., 0. + 0.15504341823651058*I, 0., 0., 0., 0.4246038878042234, 0., 
   0.10963225241337865, 0., 0., 0., 0., 0. - 0.2246792585682293*I, 0., 
   0. - 0.04902903378454601*I, 0., 0., 0., 0., 0.}, 
  {0.08838834764831845, 0. + 0.23385358667337133*I, 0., -0.4050462936504913, 0., 0., 
   0. - 0.5229125165837972*I, 0., 0., 0., 0.5229125165837972, 0., 0., 0., 0., 
   0. + 0.4050462936504913*I, 0., 0., 0., 0., 0., -0.23385358667337133, 0., 0., 0., 0., 
   0., 0., 0. - 0.08838834764831845*I, 0., 0., 0., 0., 0., 0., 0.}, 
  {0., 0., 0.125, 0., 0. + 0.30618621784789724*I, 0., 0., -0.4841229182759271, 0., 0., 
   0., 0. - 0.5590169943749475*I, 0., 0., 0., 0., 0.4841229182759271, 0., 0., 0., 0., 
   0., 0. + 0.30618621784789724*I, 0., 0., 0., 0., 0., 0., -0.125, 0., 0., 0., 0., 0., 
   0.}, 
  {-0.06485931520784635, 0. - 0.12257258446136503*I, 0., 0.127381166341267, 0., 
   0.16984155512168936, 0. + 0.054816126206689325*I, 0., 0. + 0.37977726265637496*I, 0., 
   0.054816126206689325, 0., -0.5370861555295746, 0., 0., 0. + 0.127381166341267*I, 0., 
   0. - 0.5370861555295746*I, 0., 0., 0., -0.12257258446136503, 0., 0.37977726265637496, 
   0., 0., 0., 0., 0. - 0.06485931520784635*I, 0., 0. + 0.16984155512168936*I, 0., 0., 
   0., 0., 0.}, 
  {0., 0., -0.14708710135363803, 0., 0. - 0.2401922307076307*I, 0., 0., 
   0.18988863132818748, 0., 0.2192645048267573, 0., 0., 0., 0. + 0.4385290096535146*I, 
   0., 0., 0.18988863132818748, 0., -0.5370861555295746, 0., 0., 0., 
   0. + 0.2401922307076307*I, 0., 0. - 0.4385290096535146*I, 0., 0., 0., 0., 
   -0.14708710135363803, 0., 0.2192645048267573, 0., 0., 0., 0.}, 
  {0.058667458010132234, 0. + 0.0665226445487718*I, 0., -0.01280228891247973, 0., 
   -0.25604577824959457, 0. + 0.04958305175136986*I, 0., 0. - 0.34352145931075834*I, 0., 
   -0.04958305175136986, 0., 0.16193756890782393, 0., 0.26444294267397256, 
   0. + 0.01280228891247973*I, 0., 0. - 0.16193756890782393*I, 0., 
   0. + 0.45802861241434445*I, 0., -0.0665226445487718, 0., 0.34352145931075834, 0., 
   -0.45802861241434445, 0., 0., 0. - 0.058667458010132234*I, 0., 
   0. + 0.25604577824959457*I, 0., 0. - 0.26444294267397256*I, 0., 0., 0.}, 
  {0., 0., 0.15679537687632952, 0., 0. + 0.12802288912479728*I, 0., 0., 
   0.04048439222695598, 0., -0.3739787960033829, 0., 0. + 0.1402420485012686*I, 0., 
   0. - 0.3739787960033829*I, 0., 0., -0.04048439222695598, 0., 0., 0., 
   0.28968272975116055, 0., 0. + 0.12802288912479728*I, 0., 0. - 0.3739787960033829*I, 
   0., 0. + 0.40967324519935133*I, 0., 0., -0.15679537687632952, 0., 0.3739787960033829, 
   0., -0.28968272975116055, 0., 0.}, 
  {-0.056452787791368184, 
   0. - 0.021337148187466213*I, 0., -0.03695702474931766, 0., 0.2956561979945413, 
   0. - 0.028626788275896528*I, 0., 0. + 0.13222147133698628*I, 0., 
   -0.028626788275896528, 0., 0.18698939800169145, 0., -0.45802861241434445, 
   0. - 0.03695702474931766*I, 0., 0. + 0.18698939800169145*I, 0., 
   0. - 0.26444294267397256*I, 0., -0.021337148187466213, 0., 0.13222147133698628, 0., 
   -0.26444294267397256, 0., 0.27311549679956754, 0. - 0.056452787791368184*I, 0., 
   0. + 0.2956561979945413*I, 0., 0. - 0.45802861241434445*I, 0., 
   0. + 0.27311549679956754*I, 0.}, 
  {0., 0., -0.15967259625664637, 0., 0., 0., 0., 
   -0.12368186122953842, 0., 0.42844653524848764, 0., 0., 0., 0., 0., 0., 
   -0.12368186122953842, 0., 0.3498251311407206, 0., -0.4424976788687098, 0., 0., 0., 
   0., 0., 0., 0., 0., -0.15967259625664637, 0., 0.42844653524848764, 0., 
   -0.4424976788687098, 0., 0.19312181983410703}, 
  {0.056452787791368184, 0. - 0.021337148187466213*I, 0., 0.03695702474931766, 0., 
   -0.2956561979945413, 0. - 0.028626788275896528*I, 0., 0. + 0.13222147133698628*I, 0., 
   0.028626788275896528, 0., -0.18698939800169145, 0., 0.45802861241434445, 
   0. - 0.03695702474931766*I, 0., 0. + 0.18698939800169145*I, 0., 
   0. - 0.26444294267397256*I, 0., 0.021337148187466213, 0., -0.13222147133698628, 0., 
   0.26444294267397256, 0., -0.27311549679956754, 0. - 0.056452787791368184*I, 0., 
   0. + 0.2956561979945413*I, 0., 0. - 0.45802861241434445*I, 0., 
   0. + 0.27311549679956754*I, 0.}, 
  {0., 0., 0.15679537687632952, 0., 
   0. - 0.12802288912479728*I, 0., 0., 0.04048439222695598, 0., -0.3739787960033829, 0., 
   0. - 0.1402420485012686*I, 0., 0. + 0.3739787960033829*I, 0., 0., 
   -0.04048439222695598, 0., 0., 0., 0.28968272975116055, 0., 
   0. - 0.12802288912479728*I, 0., 0. + 0.3739787960033829*I, 0., 
   0. - 0.40967324519935133*I, 0., 0., -0.15679537687632952, 0., 0.3739787960033829, 0., 
   -0.28968272975116055, 0., 0.}, 
  {-0.058667458010132234, 0. + 0.0665226445487718*I, 0., 
   0.01280228891247973, 0., 0.25604577824959457, 0. + 0.04958305175136986*I, 0., 
   0. - 0.34352145931075834*I, 0., 0.04958305175136986, 0., -0.16193756890782393, 0., 
   -0.26444294267397256, 0. + 0.01280228891247973*I, 0., 0. - 0.16193756890782393*I, 0., 
   0. + 0.45802861241434445*I, 0., 0.0665226445487718, 0., -0.34352145931075834, 0., 
   0.45802861241434445, 0., 0., 0. - 0.058667458010132234*I, 0., 
   0. + 0.25604577824959457*I, 0., 0. - 0.26444294267397256*I, 0., 0., 0.}, 
  {0., 0., -0.14708710135363803, 0., 0. + 0.2401922307076307*I, 0., 0., 
   0.18988863132818748, 0., 0.2192645048267573, 0., 0., 0., 0. - 0.4385290096535146*I, 
   0., 0., 0.18988863132818748, 0., -0.5370861555295746, 0., 0., 0., 
   0. - 0.2401922307076307*I, 0., 0. + 0.4385290096535146*I, 0., 0., 0., 0., 
   -0.14708710135363803, 0., 0.2192645048267573, 0., 0., 0., 0.}, 
  {0.06485931520784635, 0. - 0.12257258446136503*I, 0., -0.127381166341267, 0., 
   -0.16984155512168936, 0. + 0.054816126206689325*I, 0., 0. + 0.37977726265637496*I, 
   0., -0.054816126206689325, 0., 0.5370861555295746, 0., 0., 0. + 0.127381166341267*I, 
   0., 0. - 0.5370861555295746*I, 0., 0., 0., 0.12257258446136503, 0., 
   -0.37977726265637496, 0., 0., 0., 0., 0. - 0.06485931520784635*I, 0., 
   0. + 0.16984155512168936*I, 0., 0., 0., 0., 0.}, 
  {0., 0., 0.125, 0., 0. - 0.30618621784789724*I, 0., 0., -0.4841229182759271, 0., 0., 
   0., 0. + 0.5590169943749475*I, 0., 0., 0., 0., 0.4841229182759271, 0., 0., 0., 0., 
   0., 0. - 0.30618621784789724*I, 0., 0., 0., 0., 0., 0., -0.125, 0., 0., 0., 0., 0., 
   0.}, 
  {-0.08838834764831845, 0. + 0.23385358667337133*I, 0., 0.4050462936504913, 0., 
   0., 0. - 0.5229125165837972*I, 0., 0., 0., -0.5229125165837972, 0., 0., 0., 0., 
   0. + 0.4050462936504913*I, 0., 0., 0., 0., 0., 0.23385358667337133, 0., 0., 0., 0., 
   0., 0., 0. - 0.08838834764831845*I, 0., 0., 0., 0., 0., 0., 0.}};

complex double smirnovcoeff8[45][45] = {
  {0.3333333333333333, 0., 0., 0.25197631533948484, 0., 0.25197631533948484, 0., 0., 0., 
   0., 0.23904572186687872, 0., 0.19518001458970663, 0., 0.23904572186687872, 0., 0., 
   0., 0., 0., 0., 0.25197631533948484, 0., 0.19518001458970663, 0., 
   0.19518001458970663, 0., 0.25197631533948484, 0., 0., 0., 0., 0., 0., 0., 0., 
   0.3333333333333333, 0., 0.25197631533948484, 0., 0.23904572186687872, 0., 
   0.25197631533948484, 0., 0.3333333333333333}, 
  {-0.3892494720807615, 0. - 0.27524094128159016*I, 0., -0.14712247158412492, 0., 
   -0.2206837073761874, 0. - 0.31209389196617965*I, 0., 0. - 0.1801874925391118*I, 0., 
   0., 0., -0.05698028822981897, 0., -0.13957263155977062, 0. - 0.31209389196617965*I, 
   0., 0. - 0.19738550848793068*I, 0., 0. - 0.13957263155977062*I, 0., 
   0.14712247158412492, 0., 0.05698028822981897, 0., 0., 0., -0.07356123579206246, 
   0. - 0.27524094128159016*I, 0., 0. - 0.1801874925391118*I, 0., 
   0. - 0.13957263155977062*I, 0., 0. - 0.10403129732205987*I, 0., 0.3892494720807615, 
   0., 0.2206837073761874, 0., 0.13957263155977062, 0., 0.07356123579206246, 0., 0.}, 
  {0., 0., -0.27524094128159016, 0., 0. - 0.10403129732205987*I, 0., 0., 
   -0.1801874925391118, 0., -0.31209389196617965, 0., 0. - 0.13957263155977062*I, 0., 
   0. - 0.13957263155977062*I, 0., 0., -0.13957263155977062, 0., -0.19738550848793068, 
   0., -0.31209389196617965, 0., 0. - 0.1801874925391118*I, 0., 
   0. - 0.19738550848793068*I, 0., 0. - 0.1801874925391118*I, 0., 0., 
   -0.10403129732205987, 0., -0.13957263155977062, 0., -0.1801874925391118, 0., 
   -0.27524094128159016, 0., 0. - 0.27524094128159016*I, 0., 0. - 0.31209389196617965*I, 
   0., 0. - 0.31209389196617965*I, 0., 0. - 0.27524094128159016*I, 0.}, 
  {0.3178208630818641, 0., 0., 0.24024999005214903, 0., 0.06006249751303726, 0., 0., 0., 
   0., 0.2279211529192759, 0., 0.046524210519923545, 0., -0.11396057645963795, 0., 0., 
   0., 0., 0., 0., 0.24024999005214903, 0., 0.046524210519923545, 0., 
   -0.09304842103984709, 0., -0.3003124875651863, 0., 0., 0., 0., 0., 0., 0., 0., 
   0.3178208630818641, 0., 0.06006249751303726, 0., -0.11396057645963795, 0., 
   -0.3003124875651863, 0., -0.6356417261637282}, 
  {0., 0., 0.27524094128159016, 0., 
   0. - 0.10403129732205987*I, 0., 0., 0.1801874925391118, 0., 0.31209389196617965, 0., 
   0. - 0.13957263155977062*I, 0., 0. - 0.13957263155977062*I, 0., 0., 
   0.13957263155977062, 0., 0.19738550848793068, 0., 0.31209389196617965, 0., 
   0. - 0.1801874925391118*I, 0., 0. - 0.19738550848793068*I, 0., 
   0. - 0.1801874925391118*I, 0., 0., 0.10403129732205987, 0., 0.13957263155977062, 0., 
   0.1801874925391118, 0., 0.27524094128159016, 0., 0. - 0.27524094128159016*I, 0., 
   0. - 0.31209389196617965*I, 0., 0. - 0.31209389196617965*I, 0., 
   0. - 0.27524094128159016*I, 0.}, 
  {-0.3892494720807615, 0. + 0.27524094128159016*I, 
   0., -0.14712247158412492, 0., -0.2206837073761874, 0. + 0.31209389196617965*I, 0., 
   0. + 0.1801874925391118*I, 0., 0., 0., -0.05698028822981897, 0., 
   -0.13957263155977062, 0. + 0.31209389196617965*I, 0., 0. + 0.19738550848793068*I, 0., 
   0. + 0.13957263155977062*I, 0., 0.14712247158412492, 0., 0.05698028822981897, 0., 0., 
   0., -0.07356123579206246, 0. + 0.27524094128159016*I, 0., 0. + 0.1801874925391118*I, 
   0., 0. + 0.13957263155977062*I, 0., 0. + 0.10403129732205987*I, 0., 
   0.3892494720807615, 0., 0.2206837073761874, 0., 0.13957263155977062, 0., 
   0.07356123579206246, 0., 0.}, 
  {0.30295745045008676, 0. + 0.42844653524848764*I, 0., 
   -0.22901430620717222, 0., 0.11450715310358611, 0. + 0.16193756890782393*I, 0., 
   0. + 0.18698939800169145*I, 0., -0.3621034121889507, 0., -0.14782809899727065, 0., 
   0.03621034121889507, 0. - 0.16193756890782393*I, 0., 0., 0., 
   0. + 0.07242068243779014*I, 0., -0.22901430620717222, 0., -0.14782809899727065, 0., 
   -0.08869685939836239, 0., 0., 0. - 0.42844653524848764*I, 0., 
   0. - 0.18698939800169145*I, 0., 0. - 0.07242068243779014*I, 0., 0., 0., 
   0.30295745045008676, 0., 0.11450715310358611, 0., 0.03621034121889507, 0., 0., 0., 
   0.}, 
  {0., 0., 0.30295745045008676, 0., 0. + 0.34352145931075834*I, 0., 0., 
   -0.06611073566849314, 0., 0.22901430620717222, 0., 0. + 0.25604577824959457*I, 0., 
   0. + 0.3072549338995135*I, 0., 0., -0.25604577824959457, 0., -0.14484136487558028, 
   0., 0.11450715310358611, 0., 0. + 0.06611073566849314*I, 0., 
   0. + 0.14484136487558028*I, 0., 0. + 0.19833220700547943*I, 0., 0., 
   -0.34352145931075834, 0., -0.3072549338995135, 0., -0.19833220700547943, 0., 0., 0., 
   0. - 0.30295745045008676*I, 0., 0. - 0.22901430620717222*I, 0., 
   0. - 0.11450715310358611*I, 0., 0., 0.}, 
  {-0.22901430620717222, 
   0. - 0.16193756890782393*I, 0., -0.08655927155716765, 0., 0.1731185431143353, 
   0. - 0.18361994367792328*I, 0., 0. + 0.1413506985480439*I, 0., 0., 0., 
   0.04469901562676742, 0., 0.3010968957982474, 0. - 0.18361994367792328*I, 0., 
   0. + 0.15484193222775275*I, 0., 0. + 0.3010968957982474*I, 0., 0.08655927155716765, 
   0., -0.04469901562676742, 0., 0., 0., 0.25967781467150297, 
   0. - 0.16193756890782393*I, 0., 0. + 0.1413506985480439*I, 0., 
   0. + 0.3010968957982474*I, 0., 0. + 0.36723988735584656*I, 0., 0.22901430620717222, 
   0., -0.1731185431143353, 0., -0.3010968957982474, 0., -0.25967781467150297, 0., 0.}, 
  {0., 0., -0.34352145931075834, 0., 0. - 0.12983890733575149*I, 0., 0., 
   -0.22488758430474895, 0., -0.08655927155716765, 0., 0. - 0.17419717375622185*I, 0., 
   0. - 0.03871048305693819*I, 0., 0., -0.17419717375622185, 0., -0.054744890145135894, 
   0., 0.21639817889291912, 0., 0. - 0.22488758430474895*I, 0., 
   0. - 0.054744890145135894*I, 0., 0. + 0.12493754683597164*I, 0., 0., 
   -0.12983890733575149, 0., -0.03871048305693819, 0., 0.12493754683597164, 0., 
   0.45802861241434445, 0., 0. - 0.34352145931075834*I, 0., 0. - 0.08655927155716765*I, 
   0., 0. + 0.21639817889291912*I, 0., 0. + 0.45802861241434445*I, 0.}, 
  {0.2172620473133704, 0., 0., 0.16423467043540768, 0., -0.24635200565311152, 0., 0., 
   0., 0., 0.15580668880290177, 0., -0.19082344303985926, 0., -0.3202693047615203, 0., 
   0., 0., 0., 0., 0., 0.16423467043540768, 0., -0.19082344303985926, 0., 
   -0.26149879231388123, 0., -0.10948978029027179, 0., 0., 0., 0., 0., 0., 0., 0., 
   0.2172620473133704, 0., -0.24635200565311152, 0., -0.3202693047615203, 0., 
   -0.10948978029027179, 0., 0.5793654595023211}, 
  {0., 0., 0.34352145931075834, 0., 
   0. - 0.12983890733575149*I, 0., 0., 0.22488758430474895, 0., 0.08655927155716765, 0., 
   0. - 0.17419717375622185*I, 0., 0. - 0.03871048305693819*I, 0., 0., 
   0.17419717375622185, 0., 0.054744890145135894, 0., -0.21639817889291912, 0., 
   0. - 0.22488758430474895*I, 0., 0. - 0.054744890145135894*I, 0., 
   0. + 0.12493754683597164*I, 0., 0., 0.12983890733575149, 0., 0.03871048305693819, 0., 
   -0.12493754683597164, 0., -0.45802861241434445, 0., 0. - 0.34352145931075834*I, 0., 
   0. - 0.08655927155716765*I, 0., 0. + 0.21639817889291912*I, 0., 
   0. + 0.45802861241434445*I, 0.}, 
  {-0.22901430620717222, 0. + 0.16193756890782393*I, 
   0., -0.08655927155716765, 0., 0.1731185431143353, 0. + 0.18361994367792328*I, 0., 
   0. - 0.1413506985480439*I, 0., 0., 0., 0.04469901562676742, 0., 0.3010968957982474, 
   0. + 0.18361994367792328*I, 0., 0. - 0.15484193222775275*I, 0., 
   0. - 0.3010968957982474*I, 0., 0.08655927155716765, 0., -0.04469901562676742, 0., 0., 
   0., 0.25967781467150297, 0. + 0.16193756890782393*I, 0., 0. - 0.1413506985480439*I, 
   0., 0. - 0.3010968957982474*I, 0., 0. - 0.36723988735584656*I, 0., 
   0.22901430620717222, 0., -0.1731185431143353, 0., -0.3010968957982474, 0., 
   -0.25967781467150297, 0., 0.}, 
  {0., 0., -0.30295745045008676, 0., 
   0. + 0.34352145931075834*I, 0., 0., 0.06611073566849314, 0., -0.22901430620717222, 
   0., 0. + 0.25604577824959457*I, 0., 0. + 0.3072549338995135*I, 0., 0., 
   0.25604577824959457, 0., 0.14484136487558028, 0., -0.11450715310358611, 0., 
   0. + 0.06611073566849314*I, 0., 0. + 0.14484136487558028*I, 0., 
   0. + 0.19833220700547943*I, 0., 0., 0.34352145931075834, 0., 0.3072549338995135, 0., 
   0.19833220700547943, 0., 0., 0., 0. - 0.30295745045008676*I, 0., 
   0. - 0.22901430620717222*I, 0., 0. - 0.11450715310358611*I, 0., 0., 0.}, 
  {0.30295745045008676, 0. - 0.42844653524848764*I, 0., -0.22901430620717222, 0., 
   0.11450715310358611, 0. - 0.16193756890782393*I, 0., 0. - 0.18698939800169145*I, 0., 
   -0.3621034121889507, 0., -0.14782809899727065, 0., 0.03621034121889507, 
   0. + 0.16193756890782393*I, 0., 0., 0., 0. - 0.07242068243779014*I, 0., 
   -0.22901430620717222, 0., -0.14782809899727065, 0., -0.08869685939836239, 0., 0., 
   0. + 0.42844653524848764*I, 0., 0. + 0.18698939800169145*I, 0., 
   0. + 0.07242068243779014*I, 0., 0., 0., 0.30295745045008676, 0., 0.11450715310358611, 
   0., 0.03621034121889507, 0., 0., 0., 0.}, 
  {-0.1707825127659933, 
   0. - 0.362284418654736*I, 0., 0.451848057057532, 0., -0.032274861218395144, 
   0. + 0.3195048252113469*I, 0., 0. - 0.07905694150420949*I, 0., 0., 0., 0.125, 0., 0., 
   0. + 0.3195048252113469*I, 0., 0. + 0.14433756729740643*I, 0., 0., 0., 
   -0.451848057057532, 0., -0.125, 0., 0., 0., 0., 0. - 0.362284418654736*I, 0., 
   0. - 0.07905694150420949*I, 0., 0., 0., 0., 0., 0.1707825127659933, 0., 
   0.032274861218395144, 0., 0., 0., 0., 0., 0.}, 
  {0., 0., -0.2091650066335189, 0., 
   0. - 0.39528470752104744*I, 0., 0., 0.41079191812887456, 0., -0.07905694150420949, 
   0., 0. + 0.1767766952966369*I, 0., 0. - 0.1767766952966369*I, 0., 0., 
   0.1767766952966369, 0., 0.25, 0., 0., 0., 0. + 0.41079191812887456*I, 0., 
   0. + 0.25*I, 0., 0., 0., 0., -0.39528470752104744, 0., -0.1767766952966369, 0., 0., 
   0., 0., 0., 0. - 0.2091650066335189*I, 0., 0. - 0.07905694150420949*I, 0., 0., 0., 
   0., 0.}, 
  {0.12613124477737825, 0. + 0.17837651700316892*I, 0., -0.09534625892455924, 
   0., -0.2145290825802583, 0. + 0.06741998624632421*I, 0., 0. - 0.3503245248726853*I, 
   0., -0.15075567228888181, 0., 0.27695585470349865, 0., -0.15075567228888181, 
   0. - 0.06741998624632421*I, 0., 0., 0., 0. - 0.30151134457776363*I, 0., 
   -0.09534625892455924, 0., 0.27695585470349865, 0., 0.3692744729379982, 0., 0., 
   0. - 0.17837651700316892*I, 0., 0. + 0.3503245248726853*I, 0., 
   0. + 0.30151134457776363*I, 0., 0., 0., 0.12613124477737825, 0., -0.2145290825802583, 
   0., -0.15075567228888181, 0., 0., 0., 0.}, 
  {0., 0., 0.24425210522959862, 0., 
   0. + 0.27695585470349865*I, 0., 0., -0.05330017908890261, 0., -0.15386436372416593, 
   0., 0. + 0.20643070596119262*I, 0., 0. - 0.20643070596119262*I, 0., 0., 
   -0.20643070596119262, 0., 0.09731236802019037, 0., -0.24618298195866548, 0., 
   0. + 0.05330017908890261*I, 0., 0. - 0.09731236802019037*I, 0., 
   0. - 0.4264014327112209*I, 0., 0., -0.27695585470349865, 0., 0.20643070596119262, 0., 
   0.4264014327112209, 0., 0., 0., 0. - 0.24425210522959862*I, 0., 
   0. + 0.15386436372416593*I, 0., 0. + 0.24618298195866548*I, 0., 0., 0.}, 
  {-0.11514154661795957, 0. - 0.0814173684098662*I, 0., -0.04351941398892446, 0., 
   0.3263956049169334, 0. - 0.09231861823449955*I, 0., 0. + 0.26650089544451305*I, 0., 
   0., 0., 0.08427498280790525, 0., 0., 0. - 0.09231861823449955*I, 0., 
   0. + 0.2919371040605711*I, 0., 0., 0., 0.04351941398892446, 0., -0.08427498280790525, 
   0., 0., 0., -0.3481553119113957, 0. - 0.0814173684098662*I, 0., 
   0. + 0.26650089544451305*I, 0., 0., 0., 0. - 0.49236596391733095*I, 0., 
   0.11514154661795957, 0., -0.3263956049169334, 0., 0., 0., 0.3481553119113957, 0., 
   0.}, 
  {0., 0., -0.25746432527221863, 0., 0. - 0.09731236802019037*I, 0., 0., 
   -0.1685499656158105, 0., 0.2919371040605711, 0., 0. - 0.13055824196677338*I, 0., 
   0. + 0.13055824196677338*I, 0., 0., -0.13055824196677338, 0., 0.1846372364689991, 0., 
   0.23354968324845687, 0., 0. - 0.1685499656158105*I, 0., 0. + 0.1846372364689991*I, 
   0., 0. + 0.13483997249264842*I, 0., 0., -0.09731236802019037, 0., 
   0.13055824196677338, 0., 0.13483997249264842, 0., -0.4119429204355498, 0., 
   0. - 0.25746432527221863*I, 0., 0. + 0.2919371040605711*I, 0., 
   0. + 0.23354968324845687*I, 0., 0. - 0.4119429204355498*I, 0.}, 
  {0.11236664374387367, 0., 0., 0.08494119857293758, 0., -0.3610000939349847, 0., 0., 
   0., 0., 0.08058229640253803, 0., -0.2796294703579018, 0., 0.08058229640253803, 0., 
   0., 0., 0., 0., 0., 0.08494119857293758, 0., -0.2796294703579018, 0., 
   0.0657951694959769, 0., 0.4416942325792755, 0., 0., 0., 0., 0., 0., 0., 0., 
   0.11236664374387367, 0., -0.3610000939349847, 0., 0.08058229640253803, 0., 
   0.4416942325792755, 0., -0.3595732599803958}, 
  {0., 0., 0.25746432527221863, 0., 
   0. - 0.09731236802019037*I, 0., 0., 0.1685499656158105, 0., -0.2919371040605711, 0., 
   0. - 0.13055824196677338*I, 0., 0. + 0.13055824196677338*I, 0., 0., 
   0.13055824196677338, 0., -0.1846372364689991, 0., -0.23354968324845687, 0., 
   0. - 0.1685499656158105*I, 0., 0. + 0.1846372364689991*I, 0., 
   0. + 0.13483997249264842*I, 0., 0., 0.09731236802019037, 0., -0.13055824196677338, 
   0., -0.13483997249264842, 0., 0.4119429204355498, 0., 0. - 0.25746432527221863*I, 0., 
   0. + 0.2919371040605711*I, 0., 0. + 0.23354968324845687*I, 0., 
   0. - 0.4119429204355498*I, 0.}, 
  {-0.11514154661795957, 0. + 0.0814173684098662*I, 0., 
   -0.04351941398892446, 0., 0.3263956049169334, 0. + 0.09231861823449955*I, 0., 
   0. - 0.26650089544451305*I, 0., 0., 0., 0.08427498280790525, 0., 0., 
   0. + 0.09231861823449955*I, 0., 0. - 0.2919371040605711*I, 0., 0., 0., 
   0.04351941398892446, 0., -0.08427498280790525, 0., 0., 0., -0.3481553119113957, 
   0. + 0.0814173684098662*I, 0., 0. - 0.26650089544451305*I, 0., 0., 0., 
   0. + 0.49236596391733095*I, 0., 0.11514154661795957, 0., -0.3263956049169334, 0., 0., 
   0., 0.3481553119113957, 0., 0.}, 
  {0., 0., -0.24425210522959862, 0., 
   0. + 0.27695585470349865*I, 0., 0., 0.05330017908890261, 0., 0.15386436372416593, 0., 
   0. + 0.20643070596119262*I, 0., 0. - 0.20643070596119262*I, 0., 0., 
   0.20643070596119262, 0., -0.09731236802019037, 0., 0.24618298195866548, 0., 
   0. + 0.05330017908890261*I, 0., 0. - 0.09731236802019037*I, 0., 
   0. - 0.4264014327112209*I, 0., 0., 0.27695585470349865, 0., -0.20643070596119262, 0., 
   -0.4264014327112209, 0., 0., 0., 0. - 0.24425210522959862*I, 0., 
   0. + 0.15386436372416593*I, 0., 0. + 0.24618298195866548*I, 0., 0., 0.}, 
  {0.12613124477737825, 0. - 0.17837651700316892*I, 0., -0.09534625892455924, 0., 
   -0.2145290825802583, 0. - 0.06741998624632421*I, 0., 0. + 0.3503245248726853*I, 0., 
   -0.15075567228888181, 0., 0.27695585470349865, 0., -0.15075567228888181, 
   0. + 0.06741998624632421*I, 0., 0., 0., 0. + 0.30151134457776363*I, 0., 
   -0.09534625892455924, 0., 0.27695585470349865, 0., 0.3692744729379982, 0., 0., 
   0. + 0.17837651700316892*I, 0., 0. - 0.3503245248726853*I, 0., 
   0. - 0.30151134457776363*I, 0., 0., 0., 0.12613124477737825, 0., -0.2145290825802583, 
   0., -0.15075567228888181, 0., 0., 0., 0.}, 
  {0., 0., 0.2091650066335189, 0., 
   0. - 0.39528470752104744*I, 0., 0., -0.41079191812887456, 0., 0.07905694150420949, 
   0., 0. + 0.1767766952966369*I, 0., 0. - 0.1767766952966369*I, 0., 0., 
   -0.1767766952966369, 0., -0.25, 0., 0., 0., 0. + 0.41079191812887456*I, 0., 
   0. + 0.25*I, 0., 0., 0., 0., 0.39528470752104744, 0., 0.1767766952966369, 0., 0., 0., 
   0., 0., 0. - 0.2091650066335189*I, 0., 0. - 0.07905694150420949*I, 0., 0., 0., 0., 
   0.}, {-0.1707825127659933, 0. + 0.362284418654736*I, 0., 0.451848057057532, 0., 
	 -0.032274861218395144, 0. - 0.3195048252113469*I, 0., 0. + 0.07905694150420949*I, 0., 
	 0., 0., 0.125, 0., 0., 0. - 0.3195048252113469*I, 0., 0. - 0.14433756729740643*I, 0., 
	 0., 0., -0.451848057057532, 0., -0.125, 0., 0., 0., 0., 0. + 0.362284418654736*I, 0., 
	 0. + 0.07905694150420949*I, 0., 0., 0., 0., 0., 0.1707825127659933, 0., 
	 0.032274861218395144, 0., 0., 0., 0., 0., 0.}, 
  {0.0625, 0. + 0.1767766952966369*I, 
   0., -0.33071891388307384, 0., 0., 0. - 0.46770717334674267*I, 0., 0., 0., 
   0.5229125165837972, 0., 0., 0., 0., 0. + 0.46770717334674267*I, 0., 0., 0., 0., 0., 
   -0.33071891388307384, 0., 0., 0., 0., 0., 0., 0. - 0.1767766952966369*I, 0., 0., 0., 
   0., 0., 0., 0., 0.0625, 0., 0., 0., 0., 0., 0., 0., 0.}, 
  {0., 0., 0.08838834764831845, 0., 0. + 0.23385358667337133*I, 0., 0., 
   -0.4050462936504913, 0., 0., 0., 0. - 0.5229125165837972*I, 0., 0., 0., 0., 
   0.5229125165837972, 0., 0., 0., 0., 0., 0. + 0.4050462936504913*I, 0., 0., 0., 0., 
   0., 0., -0.23385358667337133, 0., 0., 0., 0., 0., 0., 0., 0. - 0.08838834764831845*I, 
   0., 0., 0., 0., 0., 0., 0.}, 
  {-0.04564354645876384, 0. - 0.09682458365518543*I, 0., 
   0.12076147288491199, 0., 0.12076147288491199, 0. + 0.08539125638299665*I, 0., 
   0. + 0.2958039891549808*I, 0., 0., 0., -0.46770717334674267, 0., 0., 
   0. + 0.08539125638299665*I, 0., 0. - 0.5400617248673217*I, 0., 0., 0., 
   -0.12076147288491199, 0., 0.46770717334674267, 0., 0., 0., 0., 
   0. - 0.09682458365518543*I, 0., 0. + 0.2958039891549808*I, 0., 0., 0., 0., 0., 
   0.04564354645876384, 0., -0.12076147288491199, 0., 0., 0., 0., 0., 0.}, 
  {0., 0., -0.10458250331675945, 0., 0. - 0.19764235376052372*I, 0., 0., 
   0.20539595906443728, 0., 0.15811388300841897, 0., 0. + 0.08838834764831845*I, 0., 
   0. + 0.3535533905932738*I, 0., 0., 0.08838834764831845, 0., -0.5, 0., 0., 0., 
   0. + 0.20539595906443728*I, 0., 0. - 0.5*I, 0., 0., 0., 0., -0.19764235376052372, 0., 
   0.3535533905932738, 0., 0., 0., 0., 0., 0. - 0.10458250331675945*I, 0., 
   0. + 0.15811388300841897*I, 0., 0., 0., 0., 0.}, 
  {0.04102063270711835, 0. + 0.05801193511153214*I, 0., -0.031008683647302113, 0., 
   -0.1860521018838127, 0. + 0.02192645048267573*I, 0., 0. - 0.3038218101251*I, 0., 
   -0.04902903378454601, 0., 0.2401922307076307, 0., 0.19611613513818404, 
   0. - 0.02192645048267573*I, 0., 0., 0., 0. + 0.3922322702763681*I, 0., 
   -0.031008683647302113, 0., 0.2401922307076307, 0., -0.4803844614152614, 0., 0., 
   0. - 0.05801193511153214*I, 0., 0. + 0.3038218101251*I, 0., 
   0. - 0.3922322702763681*I, 0., 0., 0., 0.04102063270711835, 0., -0.1860521018838127, 
   0., 0.19611613513818404, 0., 0., 0., 0.}, 
  {0., 0., 0.11233962928411464, 0., 
   0. + 0.127381166341267*I, 0., 0., -0.024514516892273006, 0., -0.28306925853614895, 
   0., 0. + 0.09494431566409374*I, 0., 0. - 0.37977726265637496*I, 0., 0., 
   -0.09494431566409374, 0., 0.17902871850985821, 0., 0.22645540682891915, 0., 
   0. + 0.024514516892273006*I, 0., 0. - 0.17902871850985821*I, 0., 
   0. + 0.3922322702763681*I, 0., 0., -0.127381166341267, 0., 0.37977726265637496, 0., 
   -0.3922322702763681, 0., 0., 0., 0. - 0.11233962928411464*I, 0., 
   0. + 0.28306925853614895*I, 0., 0. - 0.22645540682891915*I, 0., 0., 0.}, 
  {-0.03911163867342149, 0. - 0.02765610492929436*I, 0., -0.014782809899727065, 0., 
   0.22174214849590596, 0. - 0.0313590753752659*I, 0., 0. + 0.18105170609447535*I, 0., 
   0., 0., 0.057253576551793056, 0., -0.3739787960033829, 0. - 0.0313590753752659*I, 0., 
   0. + 0.19833220700547943*I, 0., 0. - 0.3739787960033829*I, 0., 0.014782809899727065, 
   0., -0.057253576551793056, 0., 0., 0., 0.23652495839563303, 
   0. - 0.02765610492929436*I, 0., 0. + 0.18105170609447535*I, 0., 
   0. - 0.3739787960033829*I, 0., 0. + 0.3344968040028363*I, 0., 0.03911163867342149, 
   0., -0.22174214849590596, 0., 0.3739787960033829, 0., -0.23652495839563303, 0., 0.}, 
  {0., 0., -0.115693787419863, 0., 0. - 0.04372814139259008*I, 0., 0., 
   -0.07573936261252169, 0., 0.3498251311407206, 0., 0. - 0.058667458010132234*I, 0., 
   0. + 0.15644655469368596*I, 0., 0., -0.058667458010132234, 0., 0.2212488394343549, 
   0., -0.41979015736886477, 0., 0. - 0.07573936261252169*I, 0., 
   0. + 0.2212488394343549*I, 0., 0. - 0.2423659603600694*I, 0., 0., 
   -0.04372814139259008, 0., 0.15644655469368596, 0., -0.2423659603600694, 0., 
   0.21155435413917803, 0., 0. - 0.115693787419863*I, 0., 0. + 0.3498251311407206*I, 0., 
   0. - 0.41979015736886477*I, 0., 0. + 0.21155435413917803*I, 0.}, 
  {0.038564595806621, 0., 0., 0.029152094261726717, 0., -0.23321675409381373, 0., 0., 
   0., 0., 0.02765610492929436, 0., -0.1806489209323782, 0., 0.4424976788687098, 0., 0., 
   0., 0., 0., 0., 0.029152094261726717, 0., -0.1806489209323782, 0., 
   0.3612978418647564, 0., -0.373146806550102, 0., 0., 0., 0., 0., 0., 0., 0., 
   0.038564595806621, 0., -0.23321675409381373, 0., 0.4424976788687098, 0., 
   -0.373146806550102, 0., 0.14103623609278534}, 
  {0., 0., 0.115693787419863, 0., 
   0. - 0.04372814139259008*I, 0., 0., 0.07573936261252169, 0., -0.3498251311407206, 0., 
   0. - 0.058667458010132234*I, 0., 0. + 0.15644655469368596*I, 0., 0., 
   0.058667458010132234, 0., -0.2212488394343549, 0., 0.41979015736886477, 0., 
   0. - 0.07573936261252169*I, 0., 0. + 0.2212488394343549*I, 0., 
   0. - 0.2423659603600694*I, 0., 0., 0.04372814139259008, 0., -0.15644655469368596, 0., 
   0.2423659603600694, 0., -0.21155435413917803, 0., 0. - 0.115693787419863*I, 0., 
   0. + 0.3498251311407206*I, 0., 0. - 0.41979015736886477*I, 0., 
   0. + 0.21155435413917803*I, 0.}, 
  {-0.03911163867342149, 0. + 0.02765610492929436*I, 
   0., -0.014782809899727065, 0., 0.22174214849590596, 0. + 0.0313590753752659*I, 0., 
   0. - 0.18105170609447535*I, 0., 0., 0., 0.057253576551793056, 0., 
   -0.3739787960033829, 0. + 0.0313590753752659*I, 0., 0. - 0.19833220700547943*I, 0., 
   0. + 0.3739787960033829*I, 0., 0.014782809899727065, 0., -0.057253576551793056, 0., 
   0., 0., 0.23652495839563303, 0. + 0.02765610492929436*I, 0., 
   0. - 0.18105170609447535*I, 0., 0. + 0.3739787960033829*I, 0., 
   0. - 0.3344968040028363*I, 0., 0.03911163867342149, 0., -0.22174214849590596, 0., 
   0.3739787960033829, 0., -0.23652495839563303, 0., 0.}, 
  {0., 0., -0.11233962928411464, 0., 0. + 0.127381166341267*I, 0., 0., 
   0.024514516892273006, 0., 0.28306925853614895, 0., 0. + 0.09494431566409374*I, 0., 
   0. - 0.37977726265637496*I, 0., 0., 0.09494431566409374, 0., -0.17902871850985821, 
   0., -0.22645540682891915, 0., 0. + 0.024514516892273006*I, 0., 
   0. - 0.17902871850985821*I, 0., 0. + 0.3922322702763681*I, 0., 0., 0.127381166341267, 
   0., -0.37977726265637496, 0., 0.3922322702763681, 0., 0., 0., 
   0. - 0.11233962928411464*I, 0., 0. + 0.28306925853614895*I, 0., 
   0. - 0.22645540682891915*I, 0., 0., 0.}, 
  {0.04102063270711835, 
   0. - 0.05801193511153214*I, 0., -0.031008683647302113, 0., -0.1860521018838127, 
   0. - 0.02192645048267573*I, 0., 0. + 0.3038218101251*I, 0., -0.04902903378454601, 0., 
   0.2401922307076307, 0., 0.19611613513818404, 0. + 0.02192645048267573*I, 0., 0., 0., 
   0. - 0.3922322702763681*I, 0., -0.031008683647302113, 0., 0.2401922307076307, 0., 
   -0.4803844614152614, 0., 0., 0. + 0.05801193511153214*I, 0., 0. - 0.3038218101251*I, 
   0., 0. + 0.3922322702763681*I, 0., 0., 0., 0.04102063270711835, 0., 
   -0.1860521018838127, 0., 0.19611613513818404, 0., 0., 0., 0.}, 
  {0., 0., 0.10458250331675945, 0., 0. - 0.19764235376052372*I, 0., 0., 
   -0.20539595906443728, 0., -0.15811388300841897, 0., 0. + 0.08838834764831845*I, 0., 
   0. + 0.3535533905932738*I, 0., 0., -0.08838834764831845, 0., 0.5, 0., 0., 0., 
   0. + 0.20539595906443728*I, 0., 0. - 0.5*I, 0., 0., 0., 0., 0.19764235376052372, 0., 
   -0.3535533905932738, 0., 0., 0., 0., 0., 0. - 0.10458250331675945*I, 0., 
   0. + 0.15811388300841897*I, 0., 0., 0., 0., 0.}, 
  {-0.04564354645876384, 0. + 0.09682458365518543*I, 0., 0.12076147288491199, 0., 
   0.12076147288491199, 0. - 0.08539125638299665*I, 0., 0. - 0.2958039891549808*I, 0., 
   0., 0., -0.46770717334674267, 0., 0., 0. - 0.08539125638299665*I, 0., 
   0. + 0.5400617248673217*I, 0., 0., 0., -0.12076147288491199, 0., 0.46770717334674267, 
   0., 0., 0., 0., 0. + 0.09682458365518543*I, 0., 0. - 0.2958039891549808*I, 0., 0., 
   0., 0., 0., 0.04564354645876384, 0., -0.12076147288491199, 0., 0., 0., 0., 0., 0.}, 
  {0., 0., -0.08838834764831845, 0., 0. + 0.23385358667337133*I, 0., 0., 
   0.4050462936504913, 0., 0., 0., 0. - 0.5229125165837972*I, 0., 0., 0., 0., 
   -0.5229125165837972, 0., 0., 0., 0., 0., 0. + 0.4050462936504913*I, 0., 0., 0., 0., 
   0., 0., 0.23385358667337133, 0., 0., 0., 0., 0., 0., 0., 0. - 0.08838834764831845*I, 
   0., 0., 0., 0., 0., 0., 0.}, 
  {0.0625, 0. - 0.1767766952966369*I, 0., 
   -0.33071891388307384, 0., 0., 0. + 0.46770717334674267*I, 0., 0., 0., 
   0.5229125165837972, 0., 0., 0., 0., 0. - 0.46770717334674267*I, 0., 0., 0., 0., 0., 
   -0.33071891388307384, 0., 0., 0., 0., 0., 0., 0. + 0.1767766952966369*I, 0., 0., 0., 
   0., 0., 0., 0., 0.0625, 0., 0., 0., 0., 0., 0., 0., 0.}};



complex double* smirnov[HONMAX+1] = {
  smirnovcoeff0,
  smirnovcoeff1,
  smirnovcoeff2,
  smirnovcoeff3,
  smirnovcoeff4,
  smirnovcoeff5,
  smirnovcoeff6,
  smirnovcoeff7,
  smirnovcoeff8
};
 

void amplitudesHOGaussian(const Gaussian* G, 
			 int nmax, double omega,
			 complex double* amp)
{
  double alpha = 1/(mnucleon*omega);
  int d = dimHOBasis(nmax);

  int i;
  for (i=0; i<d; i++)
    amp[i] = 0.0;

  // first calculate ovlaps with cartesian HO basis states

  for (i=0; i<3; i++)
    ampcart[0][i] = ng0(alpha, G->a, G->b[i]);

  int n;
  for (n=1; n<=nmax; n++)
    for (i=0; i<3; i++) 
      ampcart[n][i] = ampcart[0][i]* ng(n, alpha, G->a, G->b[i]);

  // transform into ovlaps in xinljm basis with Smirnov and 
  // Clebsch-Gordan coefficients

  int N, inxnynz, inlm, ixi, twol, twoml, twoms, twom, twoj, lj, ixinljm;
  complex double ampnlm, ampchi;
    
  for (N=0; N<=nmax; N++) {

    for (inlm=n0[N]; inlm<n0[N]+dim[N]; inlm++) {

      ampnlm = 0.0;
      for (inxnynz=n0[N]; inxnynz<n0[N]+dim[N]; inxnynz++) {
	ampnlm += smirnov[N][(inxnynz-n0[N])+(inlm-n0[N])*dim[N]]*
	  ampcart[HOnxnynz[inxnynz].nx][0]*
	  ampcart[HOnxnynz[inxnynz].ny][1]*
	  ampcart[HOnxnynz[inxnynz].nz][2];
      }

      ixi = (G->xi == +1 ? 0 : 1);
      n = HOnlm[inlm].n;
      twol = 2*HOnlm[inlm].l; twoml = 2*HOnlm[inlm].m;

      for (twoms=-1; twoms<=+1; twoms=twoms+2) {
	twom = twoml + twoms;
	
	ampchi = G->chi[twoms == +1 ? 0 : 1];

	for (twoj=ABS(twol-1); twoj<=twol+1; twoj = twoj+2) {

	  if (ABS(twom) <= twoj) {
	    lj = (twol+twoj-1)/2;
	    
	    ixinljm = invHOBasis[ixi][n][lj][(twoj+twom)/2];

	    amp[ixinljm] += clebsch(twol, 1, twoj, twoml, twoms, twom)* ampchi*ampnlm;
	  }
	}
      }
    }
  }
  
}

