<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/SlaterDet.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>fmd/SlaterDet.h File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;complex.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="Gaussian_8h_source.html">Gaussian.h</a>&quot;</code><br/>

<p><a href="SlaterDet_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSlaterDet.html">SlaterDet</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Slater Determinant.  <a href="structSlaterDet.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a0fe6e8eefc302957926038529e37e7c9">allocateSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, int A)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">allocate memory for <a class="el" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a>  <a href="#a0fe6e8eefc302957926038529e37e7c9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a16db6f53cfee239b7d506c86bc372686">initSlaterDet</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#adc279637790bc3303e9dca688966a7ab">freeSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">free memory used by Slater determinant Q  <a href="#adc279637790bc3303e9dca688966a7ab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a1046a070a040e038cac232d20a205093">writeSlaterDet</a> (FILE *fp, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">write parameters of Slater determinant Q in file  <a href="#a1046a070a040e038cac232d20a205093"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a45f5f0c4355fdf5dc10d5a5de969da62">readSlaterDet</a> (FILE *fp, <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a3ebf34d0b05c3dcde99a34ddb61c49e4">readSlaterDetfromFile</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const char *fname)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a95061fbc1f289e0ad28e565933af63e9">cloneSlaterDet</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#afdaa23393bbb93aad62823a8365f6810">joinSlaterDets</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *Qa, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *Qb, <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a6a41a03f939c76a6a27eb78fd46a1ebc">normalizeSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">normalize <a class="el" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a>  <a href="#a6a41a03f939c76a6a27eb78fd46a1ebc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a5463a8afc7565b2711169b605aad5ca3">moveSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, double d[3])</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">move Slater determinant by vector d  <a href="#a5463a8afc7565b2711169b605aad5ca3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#ad154093b24c00e82ac9129d87cd2e049">boostSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, double v[3])</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">boost Slater determinant with speed v  <a href="#ad154093b24c00e82ac9129d87cd2e049"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#acb9aa75178acc11ffabfb94f0247ee6c">rotateSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, double <a class="el" href="physics_8h.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>, double beta, double gamma)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">rotate Slater determinant by euler angles  <a href="#acb9aa75178acc11ffabfb94f0247ee6c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#ae3a4b38044ff7cac304d3258825f4ce8">moveboostSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">move and boost center of mass to origin  <a href="#ae3a4b38044ff7cac304d3258825f4ce8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a3d81dfe0c56874931a3f5ce934cd8786">moveboostorientSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">move and boost center of mass to origin, orient main axes  <a href="#a3d81dfe0c56874931a3f5ce934cd8786"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a4352c529278dcdf99e15254e4d1ce9c0">orientSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">orient main axes  <a href="#a4352c529278dcdf99e15254e4d1ce9c0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#ad0aa11be18d42c1cc26c2ad1380feb2a">invertSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">invert Slater determinant in origin  <a href="#ad0aa11be18d42c1cc26c2ad1380feb2a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#afd2f6a81babbbba6094dc63951676a17">invertcmSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">invert Slater determinant with respect to cm position and velocity  <a href="#afd2f6a81babbbba6094dc63951676a17"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#aea63bd7a51a1011e0e2024429f41c6e6">timerevertSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">time revert Slater determinant  <a href="#aea63bd7a51a1011e0e2024429f41c6e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#ad97350a50ef6bd07d50ed483af579542">scaleSlaterDet</a> (<a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, double kappa)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">scale Slater determinant  <a href="#ad97350a50ef6bd07d50ed483af579542"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a6489b81747a0bf6bab1e09d136f45065">allocateSlaterDetAux</a> (<a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, int A)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">allocate memory for <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a>  <a href="#a6489b81747a0bf6bab1e09d136f45065"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a9d28b849a027b454fd2eddb812a884c5">initSlaterDetAux</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">init <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> X  <a href="#a9d28b849a027b454fd2eddb812a884c5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a6d10ca2b062d871a6903292600c3125a">freeSlaterDetAux</a> (<a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">free memory used by <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> X  <a href="#a6d10ca2b062d871a6903292600c3125a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#ac1dfa773b90a1f5f6294d6081c412981">calcSlaterDetAux</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#ad3679a655d9b6019619456e5b7961638">calcSlaterDetAuxod</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a861e4c675c3918393d69a81090376053">calcSlaterDetAuxodsingular</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a6635ee67b67d4b93287d558fb8d22504">calcSlaterDetOBME</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structOneBodyOperator.html">OneBodyOperator</a> *op, double <a class="el" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a975c7ab0a35f0e9888d4d7410d019cf4">calcSlaterDetTBME</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *op, double <a class="el" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a3d1e03222b2c3d9b66ccbbe535963b7a">calcSlaterDetTBMErowcol</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *op, double <a class="el" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[], int <a class="el" href="MinimizerDONLP2proj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, int <a class="el" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a269a329a135cbb79c8defd0ec551eb45">calcSlaterDetOBMEod</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structOneBodyOperator.html">OneBodyOperator</a> *op, complex double <a class="el" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a302d3cb2ba683707773a9a01e6c0f594">calcSlaterDetTBMEod</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *op, complex double <a class="el" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a1566c80344b499c26afc08afd0015d3b">calcSlaterDetTBMEodrowcol</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *op, complex double <a class="el" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[], int <a class="el" href="MinimizerDONLP2proj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, int <a class="el" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a46a76d441c14b6581a2cbc080c100157">calcSlaterDetOBHFMEs</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structOneBodyOperator.html">OneBodyOperator</a> *op, void *<a class="el" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculate Hartree-Fock matrix elements for one-body operator  <a href="#a46a76d441c14b6581a2cbc080c100157"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SlaterDet_8h.html#a8f3c1824f12353267efc90cd6643d59a">calcSlaterDetTBHFMEs</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *op, void *<a class="el" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculate Hartree-Fock matrix elements for two-body operator  <a href="#a8f3c1824f12353267efc90cd6643d59a"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Slater determinant build of Gaussians</p>
<p>(c) 2003 Thomas Neff </p>

<p>Definition in file <a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a8fe56bf98987252342a9cb3a3efb61f5"></a><!-- doxytag: member="SlaterDet.h::MAXNG" ref="a8fe56bf98987252342a9cb3a3efb61f5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXNG&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SlaterDet_8h_source.html#l00024">24</a> of file <a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0fe6e8eefc302957926038529e37e7c9"></a><!-- doxytag: member="SlaterDet.h::allocateSlaterDet" ref="a0fe6e8eefc302957926038529e37e7c9" args="(SlaterDet *Q, int A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void allocateSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>A</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>allocate memory for <a class="el" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a> </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00032">32</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, and <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>, <a class="el" href="DiagonalDensityHOSlave_8c_source.html#l00026">DiagonalDensityHOSlave()</a>, <a class="el" href="DiClusterMulticonfig_8c_source.html#l00182">DiClusterMulticonfigGet()</a>, <a class="el" href="DiClusterMultiProjSlaterDet_8c_source.html#l00175">DiClusterMultiProjSlaterDetGet()</a>, <a class="el" href="DiClusterProjParSlaterDet_8c_source.html#l00116">DiClusterProjSlaterDetGet()</a>, <a class="el" href="FormfactorSlave_8c_source.html#l00026">FormfactorSlave()</a>, <a class="el" href="calcenergymultiprojmulti_8c_source.html#l00052">main()</a>, <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, <a class="el" href="MinimizerSlave_8c_source.html#l00026">MinimizerSlave()</a>, <a class="el" href="MinimizerSlave_8c_source.html#l00097">MinimizerSlaveod()</a>, <a class="el" href="OneNucleonOvlapsSlave_8c_source.html#l00033">OneNucleonOvlapsSlave()</a>, <a class="el" href="ProjectionSlave_8c_source.html#l00028">ProjectionSlave()</a>, and <a class="el" href="TwoNucleonOvlapsSlave_8c_source.html#l00034">TwoNucleonOvlapsSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> = A;
  Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a> = malloc(A*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a> = malloc(A*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a> = malloc(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*A*<span class="keyword">sizeof</span>(<a class="code" href="structGaussian.html">Gaussian</a>));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6489b81747a0bf6bab1e09d136f45065"></a><!-- doxytag: member="SlaterDet.h::allocateSlaterDetAux" ref="a6489b81747a0bf6bab1e09d136f45065" args="(SlaterDetAux *X, int A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void allocateSlaterDetAux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>A</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>allocate memory for <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00405">405</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="cmat_8c_source.html#l00023">initcmat()</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, <a class="el" href="SlaterDet_8h_source.html#l00045">SlaterDetAux::n</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>, <a class="el" href="DiagonalDensityHOSlave_8c_source.html#l00026">DiagonalDensityHOSlave()</a>, <a class="el" href="FormfactorSlave_8c_source.html#l00026">FormfactorSlave()</a>, <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, <a class="el" href="MinimizerSlave_8c_source.html#l00026">MinimizerSlave()</a>, <a class="el" href="MinimizerSlave_8c_source.html#l00097">MinimizerSlaveod()</a>, and <a class="el" href="ProjectionSlave_8c_source.html#l00028">ProjectionSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*A)*<span class="keyword">sizeof</span>(<a class="code" href="structGaussianAux.html">GaussianAux</a>));
  X-&gt;<a class="code" href="structSlaterDetAux.html#a50d38b691498b8b46c3ebd38a3945dd3" title="single particle ovlap matrix n(A,A)">n</a> = <a class="code" href="cmat_8c.html#a2c55a1976c165daaef0aeb57abd17f2b" title="initialize complex nxn matrix">initcmat</a>(A);
  X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a> = <a class="code" href="cmat_8c.html#a2c55a1976c165daaef0aeb57abd17f2b" title="initialize complex nxn matrix">initcmat</a>(A);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad154093b24c00e82ac9129d87cd2e049"></a><!-- doxytag: member="SlaterDet.h::boostSlaterDet" ref="ad154093b24c00e82ac9129d87cd2e049" args="(SlaterDet *Q, double v[3])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void boostSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>v</em>[3]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>boost Slater determinant with speed v </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00264">264</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="Gaussian_8c_source.html#l00033">boostGaussian()</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, and <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>.</p>

<p>Referenced by <a class="el" href="Formfactors_8c_source.html#l00101">calcFormfactorod()</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00215">calcOneNucleonOvlapsod()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00305">calcTwoNucleonOvlapsTod()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00444">calcTwoNucleonOvlapsYod()</a>, <a class="el" href="SlaterDet_8c_source.html#l00359">invertcmSlaterDet()</a>, <a class="el" href="joinsldets_8c_source.html#l00025">main()</a>, <a class="el" href="SlaterDet_8c_source.html#l00310">moveboostorientSlaterDet()</a>, and <a class="el" href="SlaterDet_8c_source.html#l00273">moveboostSlaterDet()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++)
    <a class="code" href="Gaussian_8c.html#ace1c71776a4249cf993a3caa6c93fd6f" title="boost Gaussian by v">boostGaussian</a>(&amp;Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i], v);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac1dfa773b90a1f5f6294d6081c412981"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetAux" ref="ac1dfa773b90a1f5f6294d6081c412981" args="(const SlaterDet *Q, SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetAux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> for <a class="el" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a> Q. hermiticity not exploited yet </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00432">432</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8c_source.html#l00096">calcGaussianAux()</a>, <a class="el" href="cmat_8c_source.html#l00036">copycmat()</a>, <a class="el" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="cmat_8c_source.html#l00045">mirrorcmat()</a>, <a class="el" href="SlaterDet_8h_source.html#l00045">SlaterDetAux::n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="lapack_8h.html#ae9da3f49c13b8f99c7017b05a7e40dcd">zpotrf()</a>, and <a class="el" href="lapack_8h.html#a0d0c3c5dbc1ba1328f61aef8a29ef11b">zpotri()</a>.</p>

<p>Referenced by <a class="el" href="cmprojection_8c_source.html#l00128">_estimateacm()</a>, <a class="el" href="Densities_8c_source.html#l00208">calcDensitiesCoordinate()</a>, <a class="el" href="Densities_8c_source.html#l00294">calcDensitiesMomentum()</a>, <a class="el" href="MinimizerDONLP2vappc_8c_source.html#l00861">calcgradprojectedHamiltonian()</a>, <a class="el" href="Observables_8c_source.html#l00033">calcObservables()</a>, <a class="el" href="Densities_8c_source.html#l00278">calcRadialDensitiesCoordinate()</a>, <a class="el" href="Densities_8c_source.html#l00310">calcRadialDensitiesMomentum()</a>, <a class="el" href="ProjectedShellOccupations_8c_source.html#l00163">calcShellOccupationsod()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00131">ef()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00150">egradf()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00224">egradh()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00205">eh()</a>, <a class="el" href="SlaterDet_8c_source.html#l00359">invertcmSlaterDet()</a>, <a class="el" href="calcconstraints_8c_source.html#l00033">main()</a>, <a class="el" href="MinimizerSlave_8c_source.html#l00026">MinimizerSlave()</a>, <a class="el" href="SlaterDet_8c_source.html#l00310">moveboostorientSlaterDet()</a>, <a class="el" href="SlaterDet_8c_source.html#l00273">moveboostSlaterDet()</a>, and <a class="el" href="SlaterDet_8c_source.html#l00339">orientSlaterDet()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,ki,li;

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
      <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
          <a class="code" href="Gaussian_8c.html#a4201ab71b543e745407c852ff52a6e13" title="calculate auxiliary quantities for two Gaussians">calcGaussianAux</a>(&amp;G[idx[k]+ki], &amp;G[idx[l]+li], 
                          &amp;Gaux[(idx[k]+ki)+(idx[l]+li)*ngauss]);


  <span class="keywordflow">for</span> (l=0; l&lt;A; l++) 
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++) {
      X-&gt;<a class="code" href="structSlaterDetAux.html#a50d38b691498b8b46c3ebd38a3945dd3" title="single particle ovlap matrix n(A,A)">n</a>[k+l*A] = 0.0;
      <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
          X-&gt;<a class="code" href="structSlaterDetAux.html#a50d38b691498b8b46c3ebd38a3945dd3" title="single particle ovlap matrix n(A,A)">n</a>[k+l*A] += Gaux[(idx[k]+ki)+(idx[l]+li)*ngauss].Q;
    }

  <span class="keywordtype">char</span> UPLO=<span class="charliteral">&#39;U&#39;</span>;
  <span class="keywordtype">int</span> info;

  <a class="code" href="cmat_8c.html#a25c4069e471b679af8dfdf807f30cd5a" title="copy matrix A into B">copycmat</a>(A, X-&gt;<a class="code" href="structSlaterDetAux.html#a50d38b691498b8b46c3ebd38a3945dd3" title="single particle ovlap matrix n(A,A)">n</a>, X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>);
  <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#ae9da3f49c13b8f99c7017b05a7e40dcd" title="cholesky factorization of complex Hermitian positive definite matrix A">zpotrf</a>)(&amp;UPLO, &amp;A, X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>, &amp;A, &amp;info);
  <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#a0d0c3c5dbc1ba1328f61aef8a29ef11b">zpotri</a>)(&amp;UPLO, &amp;A, X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>, &amp;A, &amp;info);
  <a class="code" href="cmat_8c.html#ae1c4783c61266d516df6ce359dc3c284" title="mirror upper triangle of hermitian matrix into lower triangle">mirrorcmat</a>(A, X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad3679a655d9b6019619456e5b7961638"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetAuxod" ref="ad3679a655d9b6019619456e5b7961638" args="(const SlaterDet *Q, const SlaterDet *Qp, SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetAuxod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> for SlaterDet's Q and Qp. inversion by LU decomposition does not work for singular overlap matrix </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00468">468</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8c_source.html#l00096">calcGaussianAux()</a>, <a class="el" href="cmat_8c_source.html#l00036">copycmat()</a>, <a class="el" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="SlaterDet_8h_source.html#l00045">SlaterDetAux::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>, <a class="el" href="lapack_8h.html#a45cd458d60d896788dc5024019d30828">zdet()</a>, <a class="el" href="lapack_8h.html#ae87f81c04c9dcd293299f610428d3cb3">zgetrf()</a>, and <a class="el" href="lapack_8h.html#a28dff83214199a090e2d62becf3a7bca">zgetri()</a>.</p>

<p>Referenced by <a class="el" href="angprojection_8c_source.html#l00092">_estimateangkappa()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00301">calcConstraintD3H()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00232">calcConstraintParCh()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00149">calcConstraintParN()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00101">calcConstraintParP()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00370">calcConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00439">calcConstraintSyz()</a>, <a class="el" href="Densities_8c_source.html#l00224">calcDensitiesCoordinateParity()</a>, <a class="el" href="DensityMatrixHO_8c_source.html#l00052">calcDensityMatrixHO()</a>, <a class="el" href="Formfactors_8c_source.html#l00101">calcFormfactorod()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00331">calcgradConstraintD3H()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00261">calcgradConstraintParCh()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00168">calcgradConstraintParN()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00120">calcgradConstraintParP()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00398">calcgradConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00467">calcgradConstraintSyz()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00958">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="Observables_8c_source.html#l00057">calcObservablesParity()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00390">calcorthprojectedHamiltonian()</a>, <a class="el" href="Parity_8c_source.html#l00039">calcParity()</a>, <a class="el" href="Parity_8c_source.html#l00060">calcParityod()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00777">calcprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00037">calcprojectedMBMEmpi()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00194">calcprojectedMBMEsmpi()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>, <a class="el" href="TimeReversal_8c_source.html#l00041">calcTimeReversal()</a>, <a class="el" href="TimeReversal_8c_source.html#l00062">calcTimeReversalod()</a>, <a class="el" href="DiagonalDensityHOSlave_8c_source.html#l00026">DiagonalDensityHOSlave()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00136">ef()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00169">egradf()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00284">egradh()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00230">eh()</a>, <a class="el" href="FormfactorSlave_8c_source.html#l00026">FormfactorSlave()</a>, <a class="el" href="calcnorm_8c_source.html#l00025">main()</a>, <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, <a class="el" href="MinimizerSlave_8c_source.html#l00097">MinimizerSlaveod()</a>, <a class="el" href="SlaterDet_8c_source.html#l00241">normalizeSlaterDet()</a>, and <a class="el" href="ProjectionSlave_8c_source.html#l00028">ProjectionSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  assert(Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> == Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> &amp;&amp; Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> == Qp-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> &amp;&amp; Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a> == Qp-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>);

  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* idxp=Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; 
  <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>; <span class="keywordtype">int</span>* ngp=Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>; <a class="code" href="structGaussian.html">Gaussian</a>* Gp=Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=X-&gt;<a class="code" href="structSlaterDetAux.html#a50d38b691498b8b46c3ebd38a3945dd3" title="single particle ovlap matrix n(A,A)">n</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,ki,li;

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (li=0; li&lt;ngp[l]; li++)
      <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
          <a class="code" href="Gaussian_8c.html#a4201ab71b543e745407c852ff52a6e13" title="calculate auxiliary quantities for two Gaussians">calcGaussianAux</a>(&amp;G[idx[k]+ki], &amp;Gp[idxp[l]+li], 
                          &amp;Gaux[(idx[k]+ki)+(idxp[l]+li)*ngauss]);


  <span class="keywordflow">for</span> (l=0; l&lt;A; l++) 
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++) {
      n[k+l*A] = 0.0;
      <span class="keywordflow">for</span> (li=0; li&lt;ngp[l]; li++)
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
          n[k+l*A] += Gaux[(idx[k]+ki)+(idxp[l]+li)*ngauss].Q;
    }


  <span class="keywordtype">int</span> ipiv[A];
  <span class="keywordtype">int</span> lwork=A*A;
  complex <span class="keywordtype">double</span> work[lwork];
  <span class="keywordtype">int</span> info;
  
  <a class="code" href="cmat_8c.html#a25c4069e471b679af8dfdf807f30cd5a" title="copy matrix A into B">copycmat</a>(A, X-&gt;<a class="code" href="structSlaterDetAux.html#a50d38b691498b8b46c3ebd38a3945dd3" title="single particle ovlap matrix n(A,A)">n</a>, X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>);
  <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#ae87f81c04c9dcd293299f610428d3cb3" title="compute an LU factorization of a general M-by-N matrix A">zgetrf</a>)(&amp;A, &amp;A, X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>, &amp;A, ipiv, &amp;info);
  <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#a45cd458d60d896788dc5024019d30828">zdet</a>)(X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>, &amp;A, &amp;A, ipiv, &amp;X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>);
  <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#a28dff83214199a090e2d62becf3a7bca">zgetri</a>)(&amp;A, X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>, &amp;A, ipiv, work, &amp;lwork, &amp;info);

  <span class="keywordflow">if</span> (info)
    fprintf(stderr, <span class="stringliteral">&quot;calcSlaterDetAuxod: overlap matrix singular !\n&quot;</span>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a861e4c675c3918393d69a81090376053"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetAuxodsingular" ref="a861e4c675c3918393d69a81090376053" args="(const SlaterDet *Q, const SlaterDet *Qp, SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetAuxodsingular </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> for SlaterDet's Q and Qp. inversion by SVD decomposition rank A-1 of overlap matrix assumed, ovlap set to 1.0 can only be used with One-Body Operators (GT) </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00520">520</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8c_source.html#l00096">calcGaussianAux()</a>, <a class="el" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="cmat_8c_source.html#l00070">multcmat()</a>, <a class="el" href="SlaterDet_8h_source.html#l00045">SlaterDetAux::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, <a class="el" href="lapack_8h.html#a45cd458d60d896788dc5024019d30828">zdet()</a>, <a class="el" href="lapack_8h.html#abeeaa93428c215c1d1052c3322b4a6a2">zgesvd()</a>, and <a class="el" href="lapack_8h.html#ae87f81c04c9dcd293299f610428d3cb3">zgetrf()</a>.</p>

<p>Referenced by <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, and <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* idxp=Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; 
  <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>; <span class="keywordtype">int</span>* ngp=Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>; <a class="code" href="structGaussian.html">Gaussian</a>* Gp=Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=X-&gt;<a class="code" href="structSlaterDetAux.html#a50d38b691498b8b46c3ebd38a3945dd3" title="single particle ovlap matrix n(A,A)">n</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,ki,li;

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (li=0; li&lt;ngp[l]; li++)
      <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
          <a class="code" href="Gaussian_8c.html#a4201ab71b543e745407c852ff52a6e13" title="calculate auxiliary quantities for two Gaussians">calcGaussianAux</a>(&amp;G[idx[k]+ki], &amp;Gp[idxp[l]+li], 
                          &amp;Gaux[(idx[k]+ki)+(idxp[l]+li)*ngauss]);


  <span class="keywordflow">for</span> (l=0; l&lt;A; l++) 
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++) {
      n[k+l*A] = 0.0;
      <span class="keywordflow">for</span> (li=0; li&lt;ngp[l]; li++)
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
          n[k+l*A] += Gaux[(idx[k]+ki)+(idxp[l]+li)*ngauss].Q;
    }

  <span class="comment">// calculate SVD of overlap matrix</span>
  complex <span class="keywordtype">double</span> U[A*A];
  complex <span class="keywordtype">double</span> Vh[A*A];
  <span class="keywordtype">double</span> S[A];
  {
    <span class="keyword">const</span> <span class="keywordtype">char</span> jobu=<span class="charliteral">&#39;A&#39;</span>, jobvt=<span class="charliteral">&#39;A&#39;</span>;
    <span class="keyword">const</span> <span class="keywordtype">int</span> lwork=5*A;
    complex <span class="keywordtype">double</span> work[lwork];
    <span class="keywordtype">double</span> rwork[lwork];
    <span class="keywordtype">int</span> info;

    <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#abeeaa93428c215c1d1052c3322b4a6a2" title="compute the singular value decomposition (SVD) of a complex matrix">zgesvd</a>)(&amp;jobu, &amp;jobvt, &amp;A, &amp;A, n, &amp;A, S,
                    U, &amp;A, Vh, &amp;A, work, &amp;lwork, rwork, &amp;info);
  }

  <span class="comment">// calculate phase detVhU using LU decomposition</span>
  complex <span class="keywordtype">double</span> detVhU;
  {
    complex <span class="keywordtype">double</span> VhU[A*A];
    <span class="keywordtype">int</span> ipiv[A];
    <span class="keywordtype">int</span> info;

    <a class="code" href="cmat_8c.html#a32a89cb47e192550e5d5373dad79bcde" title="multiply complex matrices C = A.B">multcmat</a>(Vh, U, VhU, A);
    <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#ae87f81c04c9dcd293299f610428d3cb3" title="compute an LU factorization of a general M-by-N matrix A">zgetrf</a>)(&amp;A, &amp;A, VhU, &amp;A, ipiv, &amp;info);
    <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#a45cd458d60d896788dc5024019d30828">zdet</a>)(VhU, &amp;A, &amp;A, ipiv, &amp;detVhU);
  }

  <span class="keywordtype">int</span> i,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;
  <span class="keywordtype">double</span> prodS;

  prodS = 1.0;
  <span class="keywordflow">for</span> (j=0; j&lt;A-1; j++)
    prodS *= S[j];
  
  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
      o[k+l*A] = conj(Vh[A-1+k*A])*prodS*conj(U[l+(A-1)*A])*detVhU;

  X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a> = 1.0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a46a76d441c14b6581a2cbc080c100157"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetOBHFMEs" ref="a46a76d441c14b6581a2cbc080c100157" args="(const SlaterDet *Q, const SlaterDetAux *X, const OneBodyOperator *op, void *val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetOBHFMEs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structOneBodyOperator.html">OneBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>val</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculate Hartree-Fock matrix elements for one-body operator </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00879">879</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00052">OneBodyOperator::dim</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="Gaussian_8h_source.html#l00055">OneBodyOperator::me</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="Gaussian_8h_source.html#l00053">OneBodyOperator::opt</a>, <a class="el" href="Gaussian_8h_source.html#l00054">OneBodyOperator::par</a>, and <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>.</p>

<p>Referenced by <a class="el" href="Densities_8c_source.html#l00326">calcDensitiesCoordinateHF()</a>, <a class="el" href="Densities_8c_source.html#l00337">calcDensitiesMomentumHF()</a>, <a class="el" href="NOscillator_8c_source.html#l00036">calcHOsciHF()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00182">calcj2HF()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00165">calcl2HF()</a>, <a class="el" href="Parity_8c_source.html#l00079">calcparHF()</a>, <a class="el" href="Isospin_8c_source.html#l00079">calct3HF()</a>, <a class="el" href="CenterofMass_8c_source.html#l00128">calcTCMHF()</a>, and <a class="el" href="KineticEnergy_8c_source.html#l00049">calcTHF()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex double (*mes)[op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>] = <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,ki,li;
  <span class="keywordtype">int</span> i;
  complex <span class="keywordtype">double</span> gval[op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>];

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
      <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++)
        mes[k+l*A][i] = 0.0;

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++) {
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++) 
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structOneBodyOperator.html#a99c3db87c16a8748935021b35ba6cdd5">opt</a> || Gaux[idx[k]+idx[l]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
      <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++) 
        gval[i] = 0.0;

      <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
          op-&gt;<a class="code" href="structOneBodyOperator.html#a888fa1c19bc6609362e8c560bf442db2">me</a>(op-&gt;<a class="code" href="structOneBodyOperator.html#a24c25f9ac34237bf8191f7b1de382e5f">par</a>, 
                 &amp;G[idx[k]+ki], &amp;G[idx[l]+li], 
                 &amp;Gaux[(idx[k]+ki)+(idx[l]+li)*ngauss], 
                 gval);

      <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++)
        mes[k+l*A][i] += gval[i];
    }   
  }     
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6635ee67b67d4b93287d558fb8d22504"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetOBME" ref="a6635ee67b67d4b93287d558fb8d22504" args="(const SlaterDet *Q, const SlaterDetAux *X, const OneBodyOperator *op, double val[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetOBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structOneBodyOperator.html">OneBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>val</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate matrix element with SaterDet Q for one-body operator op defined for Gaussians val will be overwritten </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00591">591</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00052">OneBodyOperator::dim</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="Gaussian_8h_source.html#l00055">OneBodyOperator::me</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="Gaussian_8h_source.html#l00053">OneBodyOperator::opt</a>, <a class="el" href="Gaussian_8h_source.html#l00054">OneBodyOperator::par</a>, and <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>.</p>

<p>Referenced by <a class="el" href="AngularMomenta_8c_source.html#l00129">calcAngularMomenta()</a>, <a class="el" href="CenterofMass_8c_source.html#l00071">calcCMPosition()</a>, <a class="el" href="CenterofMass_8c_source.html#l00085">calcCMVelocity()</a>, <a class="el" href="ConstraintCM_8c_source.html#l00097">calcConstraintCM()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00719">calcConstraintDetQ()</a>, <a class="el" href="ConstraintDipole_8c_source.html#l00098">calcConstraintED2()</a>, <a class="el" href="ConstraintOctupole_8c_source.html#l00492">calcConstraintEO2()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00469">calcConstraintEQ2()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00404">calcConstraintER2()</a>, <a class="el" href="ConstraintJ_8c_source.html#l00066">calcConstraintJ()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00396">calcConstraintJ2()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00216">calcConstraintJ2()</a>, <a class="el" href="Constraintl2_8c_source.html#l00187">calcConstraintl2()</a>, <a class="el" href="Constraintls_8c_source.html#l00125">calcConstraintls()</a>, <a class="el" href="ConstraintLS_8c_source.html#l00279">calcConstraintLS()</a>, <a class="el" href="ConstraintMainAxes_8c_source.html#l00218">calcConstraintMainAxes()</a>, <a class="el" href="ConstraintNOsci_8c_source.html#l00443">calcConstraintNNOsci()</a>, <a class="el" href="ConstraintOctupole_8c_source.html#l00512">calcConstraintNO2()</a>, <a class="el" href="ConstraintNOsci_8c_source.html#l00405">calcConstraintNOsci()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00501">calcConstraintNQ2()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00472">calcConstraintNR2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00293">calcConstraintNS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00295">calcConstraintNT2()</a>, <a class="el" href="ConstraintOctupole_8c_source.html#l00472">calcConstraintO2()</a>, <a class="el" href="ConstraintNOsci_8c_source.html#l00423">calcConstraintPNOsci()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00279">calcConstraintPS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00281">calcConstraintPT2()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00270">calcConstraintPX()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00278">calcConstraintPY()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00286">calcConstraintPZ()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00437">calcConstraintQ2()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00786">calcConstraintQ2offdiagonal()</a>, <a class="el" href="ConstraintMainAxes_8c_source.html#l00265">calcConstraintQbeta2()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00339">calcConstraintR2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00265">calcConstraintS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00267">calcConstraintT2()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00246">calcConstraintX()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00254">calcConstraintY()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00262">calcConstraintZ()</a>, <a class="el" href="Densities_8c_source.html#l00208">calcDensitiesCoordinate()</a>, <a class="el" href="Densities3d_8c_source.html#l00086">calcDensitiesCoordinate3d()</a>, <a class="el" href="Densities_8c_source.html#l00294">calcDensitiesMomentum()</a>, <a class="el" href="Densities3d_8c_source.html#l00096">calcDensitiesMomentum3d()</a>, <a class="el" href="gradCMSlaterDet_8c_source.html#l00061">calcgradCMSlaterDetOBME()</a>, <a class="el" href="ConstraintCM_8c_source.html#l00120">calcgradConstraintCM()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00747">calcgradConstraintDetQ()</a>, <a class="el" href="ConstraintDipole_8c_source.html#l00118">calcgradConstraintED2()</a>, <a class="el" href="ConstraintOctupole_8c_source.html#l00566">calcgradConstraintEO2()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00583">calcgradConstraintEQ2()</a>, <a class="el" href="ConstraintMainAxes_8c_source.html#l00237">calcgradConstraintMainAxes()</a>, <a class="el" href="ConstraintNOsci_8c_source.html#l00540">calcgradConstraintNNOsci()</a>, <a class="el" href="ConstraintOctupole_8c_source.html#l00600">calcgradConstraintNO2()</a>, <a class="el" href="ConstraintNOsci_8c_source.html#l00464">calcgradConstraintNOsci()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00638">calcgradConstraintNQ2()</a>, <a class="el" href="ConstraintOctupole_8c_source.html#l00532">calcgradConstraintO2()</a>, <a class="el" href="ConstraintNOsci_8c_source.html#l00501">calcgradConstraintPNOsci()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00533">calcgradConstraintQ2()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00806">calcgradConstraintQ2offdiagonal()</a>, <a class="el" href="ConstraintMainAxes_8c_source.html#l00284">calcgradConstraintQbeta2()</a>, <a class="el" href="SpatialOrientation_8c_source.html#l00049">calcInertiaTensor()</a>, <a class="el" href="Isospin_8c_source.html#l00049">calcIsospin()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00248">calcJ()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00199">calcJ2()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00232">calcL()</a>, <a class="el" href="SpatialOrientation_8c_source.html#l00086">calcOctupoleTensor()</a>, <a class="el" href="Oscillator_8c_source.html#l00040">calcOsci2()</a>, <a class="el" href="Oscillator_8c_source.html#l00051">calcOsci4()</a>, <a class="el" href="Quadrupole_8c_source.html#l00083">calcQuadrupole()</a>, <a class="el" href="Quadrupole_8c_source.html#l00110">calcQuadrupolePrime()</a>, <a class="el" href="Densities_8c_source.html#l00278">calcRadialDensitiesCoordinate()</a>, <a class="el" href="Densities_8c_source.html#l00310">calcRadialDensitiesMomentum()</a>, <a class="el" href="Radii_8c_source.html#l00055">calcRadii2()</a>, <a class="el" href="RadiiAll_8c_source.html#l00073">calcRadii2all()</a>, <a class="el" href="RadiiLS_8c_source.html#l00047">calcRadii2LS()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00240">calcS()</a>, <a class="el" href="SDRadii_8c_source.html#l00051">calcSDRadii2()</a>, <a class="el" href="SpinDensities_8c_source.html#l00110">calcSpinDensitiesCoordinate()</a>, <a class="el" href="SpinDensities_8c_source.html#l00120">calcSpinDensitiesMomentum()</a>, <a class="el" href="KineticEnergy_8c_source.html#l00032">calcT()</a>, and <a class="el" href="CenterofMass_8c_source.html#l00099">calcTCM()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,ki,li;
  <span class="keywordtype">int</span> i;
  complex <span class="keywordtype">double</span> *gval = malloc(op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++)
    <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] = 0.0;

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++) {
    <span class="keywordflow">for</span> (k=0; k&lt;l; k++) 
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structOneBodyOperator.html#a99c3db87c16a8748935021b35ba6cdd5">opt</a> || Gaux[idx[k]+idx[l]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
      <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++) 
        gval[i] = 0.0;

      <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
          op-&gt;<a class="code" href="structOneBodyOperator.html#a888fa1c19bc6609362e8c560bf442db2">me</a>(op-&gt;<a class="code" href="structOneBodyOperator.html#a24c25f9ac34237bf8191f7b1de382e5f">par</a>, 
                 &amp;G[idx[k]+ki], &amp;G[idx[l]+li], 
                 &amp;Gaux[(idx[k]+ki)+(idx[l]+li)*ngauss], 
                 gval);

      <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++)
        <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] += 2.0*gval[i]*o[l+k*A];
    }   
    
    <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++) 
      gval[i] = 0.0;
    <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
      <span class="keywordflow">for</span> (ki=0; ki&lt;ng[l]; ki++)
        op-&gt;<a class="code" href="structOneBodyOperator.html#a888fa1c19bc6609362e8c560bf442db2">me</a>(op-&gt;<a class="code" href="structOneBodyOperator.html#a24c25f9ac34237bf8191f7b1de382e5f">par</a>,
               &amp;G[idx[l]+ki], &amp;G[idx[l]+li], 
               &amp;Gaux[(idx[l]+ki)+(idx[l]+li)*ngauss], 
               gval);    

    <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++)
      <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] += creal(gval[i])*creal(o[k+l*A]);
  }     

  free(gval);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a269a329a135cbb79c8defd0ec551eb45"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetOBMEod" ref="a269a329a135cbb79c8defd0ec551eb45" args="(const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, const OneBodyOperator *op, complex double val[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetOBMEod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structOneBodyOperator.html">OneBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double&nbsp;</td>
          <td class="paramname"> <em>val</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate off-diagonal matrix element with SaterDets Q and Qp for one-body operator op defined for Gaussians val will be overwritten </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00736">736</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00052">OneBodyOperator::dim</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="Gaussian_8h_source.html#l00055">OneBodyOperator::me</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="Gaussian_8h_source.html#l00053">OneBodyOperator::opt</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, <a class="el" href="Gaussian_8h_source.html#l00054">OneBodyOperator::par</a>, and <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>.</p>

<p>Referenced by <a class="el" href="AngularMomenta_8c_source.html#l00146">calcAngularMomentaod()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00489">calcConstraintEQ2od()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00432">calcConstraintER2od()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00446">calcConstraintJ2od()</a>, <a class="el" href="ConstraintLS_8c_source.html#l00327">calcConstraintLSod()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00521">calcConstraintNQ2od()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00500">calcConstraintNR2od()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00457">calcConstraintQ2od()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00367">calcConstraintR2od()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00345">calcConstraintS2od()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00348">calcConstraintT2od()</a>, <a class="el" href="Densities_8c_source.html#l00224">calcDensitiesCoordinateParity()</a>, <a class="el" href="DensityMatrixHO_8c_source.html#l00052">calcDensityMatrixHO()</a>, <a class="el" href="ElectroMagneticMultipole_8c_source.html#l00211">calcEDipoleod()</a>, <a class="el" href="ElectroMagneticMultipole_8c_source.html#l00194">calcEMonopoleod()</a>, <a class="el" href="ElectroMagneticMultipole_8c_source.html#l00254">calcEQuadrupoleod()</a>, <a class="el" href="Formfactors_8c_source.html#l00101">calcFormfactorod()</a>, <a class="el" href="GamovTeller_8c_source.html#l00097">calcGTminusod()</a>, <a class="el" href="GamovTeller_8c_source.html#l00078">calcGTplusod()</a>, <a class="el" href="Isospin_8c_source.html#l00064">calcIsospinod()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00215">calcJ2od()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00275">calcJod()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00257">calcLod()</a>, <a class="el" href="ElectroMagneticMultipole_8c_source.html#l00230">calcMDipoleod()</a>, <a class="el" href="MeanOscillatorQuanta_8c_source.html#l00053">calcMeanOsciQuantaod()</a>, <a class="el" href="NOsci_8c_source.html#l00078">calcNOsciod()</a>, <a class="el" href="RadiiAll_8c_source.html#l00092">calcRadii2allod()</a>, <a class="el" href="RadiiLS_8c_source.html#l00060">calcRadii2LSod()</a>, <a class="el" href="Radii_8c_source.html#l00072">calcRadii2od()</a>, <a class="el" href="SDRadii_8c_source.html#l00066">calcSDRadii2od()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00266">calcSod()</a>, <a class="el" href="CenterofMass_8c_source.html#l00113">calcTCMod()</a>, and <a class="el" href="KineticEnergy_8c_source.html#l00040">calcTod()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* idxp=Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; 
  <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>; <span class="keywordtype">int</span>* ngp=Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>; <a class="code" href="structGaussian.html">Gaussian</a>* Gp=Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  complex <span class="keywordtype">double</span> ovl = X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, ki,li;
  <span class="keywordtype">int</span> i;
  complex <span class="keywordtype">double</span> *gval = malloc(op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++)
    <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] = 0.0;

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++) 
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structOneBodyOperator.html#a99c3db87c16a8748935021b35ba6cdd5">opt</a> || Gaux[idx[k]+idxp[l]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

        <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++) 
          gval[i] = 0.0;

        <span class="keywordflow">for</span> (li=0; li&lt;ngp[l]; li++)
          <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
            op-&gt;<a class="code" href="structOneBodyOperator.html#a888fa1c19bc6609362e8c560bf442db2">me</a>(op-&gt;<a class="code" href="structOneBodyOperator.html#a24c25f9ac34237bf8191f7b1de382e5f">par</a>, 
                   &amp;G[idx[k]+ki], &amp;Gp[idxp[l]+li], 
                   &amp;Gaux[(idx[k]+ki)+(idxp[l]+li)*ngauss], 
                   gval);

        <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structOneBodyOperator.html#a0d6192ba1c2267be5d9afe3fbe28b20d">dim</a>; i++)
          <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] += gval[i]*o[l+k*A]*ovl;
      }         
  
  free(gval);
}       
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8f3c1824f12353267efc90cd6643d59a"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetTBHFMEs" ref="a8f3c1824f12353267efc90cd6643d59a" args="(const SlaterDet *Q, const SlaterDetAux *X, const TwoBodyOperator *op, void *val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetTBHFMEs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>val</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculate Hartree-Fock matrix elements for two-body operator </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00917">917</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00067">TwoBodyOperator::dim</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Gaussian_8h_source.html#l00070">TwoBodyOperator::me</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="Gaussian_8h_source.html#l00068">TwoBodyOperator::opt</a>, <a class="el" href="Gaussian_8h_source.html#l00069">TwoBodyOperator::par</a>, and <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>.</p>

<p>Referenced by <a class="el" href="Potential_8c_source.html#l00455">calcPotentialsHF()</a>, and <a class="el" href="CenterofMass_8c_source.html#l00128">calcTCMHF()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  complex double (*mes)[op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>] = <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,<a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, ki,li,mi,ni;
  <span class="keywordtype">int</span> i;
  complex <span class="keywordtype">double</span> gval[op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>];

  <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
      <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++)
        mes[k+m*A][i] = 0.0;

  <span class="keywordflow">for</span> (n=0; n&lt;A; n++)
    <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[l]+idx[n]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
          <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
            <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[k]+idx[m]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++) 
                gval[i] = 0.0;

              <span class="keywordflow">for</span> (ni=0; ni&lt;ng[n]; ni++)
                <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
                  <span class="keywordflow">for</span> (mi=0; mi&lt;ng[m]; mi++)
                    <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
                      op-&gt;<a class="code" href="structTwoBodyOperator.html#ab0e427b9221cd201e201c1d4939a15b7">me</a>(op-&gt;<a class="code" href="structTwoBodyOperator.html#abe1d35d4264d137a39b4f4055056fa04">par</a>, 
                             &amp;G[idx[k]+ki], &amp;G[idx[l]+li], 
                             &amp;G[idx[m]+mi], &amp;G[idx[n]+ni], 
                             &amp;Gaux[(idx[k]+ki)+(idx[m]+mi)*ngauss],
                             &amp;Gaux[(idx[l]+li)+(idx[n]+ni)*ngauss],
                             gval);

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++) {
                mes[k+m*A][i] += gval[i]*o[n+l*A];
                mes[k+n*A][i] -= gval[i]*o[m+l*A];
              }
            }   
      } 
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a975c7ab0a35f0e9888d4d7410d019cf4"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetTBME" ref="a975c7ab0a35f0e9888d4d7410d019cf4" args="(const SlaterDet *Q, const SlaterDetAux *X, const TwoBodyOperator *op, double val[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetTBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>val</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate matrix element with SaterDet Q for two-body operator op defined for Gaussians val will be overwritten </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00641">641</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00067">TwoBodyOperator::dim</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Gaussian_8h_source.html#l00070">TwoBodyOperator::me</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="Gaussian_8h_source.html#l00068">TwoBodyOperator::opt</a>, <a class="el" href="Gaussian_8h_source.html#l00069">TwoBodyOperator::par</a>, and <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>.</p>

<p>Referenced by <a class="el" href="AngularMomenta_8c_source.html#l00129">calcAngularMomenta()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00404">calcConstraintER2()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00396">calcConstraintJ2()</a>, <a class="el" href="ConstraintLS_8c_source.html#l00279">calcConstraintLS()</a>, <a class="el" href="ConstraintMainAxes_8c_source.html#l00218">calcConstraintMainAxes()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00472">calcConstraintNR2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00293">calcConstraintNS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00295">calcConstraintNT2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00279">calcConstraintPS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00281">calcConstraintPT2()</a>, <a class="el" href="ConstraintMainAxes_8c_source.html#l00265">calcConstraintQbeta2()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00339">calcConstraintR2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00265">calcConstraintS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00267">calcConstraintT2()</a>, <a class="el" href="gradCMSlaterDet_8c_source.html#l00083">calcgradCMSlaterDetTBME()</a>, <a class="el" href="ConstraintMainAxes_8c_source.html#l00237">calcgradConstraintMainAxes()</a>, <a class="el" href="ConstraintMainAxes_8c_source.html#l00284">calcgradConstraintQbeta2()</a>, <a class="el" href="Isospin_8c_source.html#l00049">calcIsospin()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00199">calcJ2()</a>, <a class="el" href="TwoBodyDensity_8c_source.html#l00667">calcPairs()</a>, <a class="el" href="Potential_8c_source.html#l00394">calcPotential()</a>, <a class="el" href="Quadrupole_8c_source.html#l00083">calcQuadrupole()</a>, <a class="el" href="Quadrupole_8c_source.html#l00110">calcQuadrupolePrime()</a>, <a class="el" href="Radii_8c_source.html#l00055">calcRadii2()</a>, <a class="el" href="RadiiAll_8c_source.html#l00073">calcRadii2all()</a>, and <a class="el" href="CenterofMass_8c_source.html#l00099">calcTCM()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,<a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, ki,li,mi,ni;
  <span class="keywordtype">int</span> i;
  complex <span class="keywordtype">double</span> *gval = malloc(op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++)
    <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] = 0.0;

  <span class="keywordflow">for</span> (n=0; n&lt;A; n++)
    <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[l]+idx[n]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
          <span class="keywordflow">for</span> (k=0; k&lt;l; k++)
            <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[k]+idx[m]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++) 
                gval[i] = 0.0;

              <span class="keywordflow">for</span> (ni=0; ni&lt;ng[n]; ni++)
                <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
                  <span class="keywordflow">for</span> (mi=0; mi&lt;ng[m]; mi++)
                    <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
                      op-&gt;<a class="code" href="structTwoBodyOperator.html#ab0e427b9221cd201e201c1d4939a15b7">me</a>(op-&gt;<a class="code" href="structTwoBodyOperator.html#abe1d35d4264d137a39b4f4055056fa04">par</a>, 
                             &amp;G[idx[k]+ki], &amp;G[idx[l]+li], 
                             &amp;G[idx[m]+mi], &amp;G[idx[n]+ni], 
                             &amp;Gaux[(idx[k]+ki)+(idx[m]+mi)*ngauss],
                             &amp;Gaux[(idx[l]+li)+(idx[n]+ni)*ngauss],
                             gval);

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++)
                <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] += gval[i]*
                  (o[m+k*A]*o[n+l*A]-o[n+k*A]*o[m+l*A]);
            }   
      }
  
  free(gval);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a302d3cb2ba683707773a9a01e6c0f594"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetTBMEod" ref="a302d3cb2ba683707773a9a01e6c0f594" args="(const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, const TwoBodyOperator *op, complex double val[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetTBMEod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double&nbsp;</td>
          <td class="paramname"> <em>val</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate off-diagonal matrix element with SaterDets Q and Qp for two-body operator op defined for Gaussians val will be overwritten </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00777">777</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00067">TwoBodyOperator::dim</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Gaussian_8h_source.html#l00070">TwoBodyOperator::me</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="Gaussian_8h_source.html#l00068">TwoBodyOperator::opt</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, <a class="el" href="Gaussian_8h_source.html#l00069">TwoBodyOperator::par</a>, and <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>.</p>

<p>Referenced by <a class="el" href="AngularMomenta_8c_source.html#l00146">calcAngularMomentaod()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00432">calcConstraintER2od()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00446">calcConstraintJ2od()</a>, <a class="el" href="ConstraintLS_8c_source.html#l00327">calcConstraintLSod()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00500">calcConstraintNR2od()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00367">calcConstraintR2od()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00345">calcConstraintS2od()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00348">calcConstraintT2od()</a>, <a class="el" href="ElectroMagneticMultipole_8c_source.html#l00194">calcEMonopoleod()</a>, <a class="el" href="ElectroMagneticMultipole_8c_source.html#l00254">calcEQuadrupoleod()</a>, <a class="el" href="Isospin_8c_source.html#l00064">calcIsospinod()</a>, <a class="el" href="AngularMomenta_8c_source.html#l00215">calcJ2od()</a>, <a class="el" href="ElectroMagneticMultipole_8c_source.html#l00230">calcMDipoleod()</a>, <a class="el" href="TwoBodyDensity_8c_source.html#l00675">calcPairsod()</a>, <a class="el" href="Potential_8c_source.html#l00423">calcPotentialod()</a>, <a class="el" href="RadiiAll_8c_source.html#l00092">calcRadii2allod()</a>, <a class="el" href="Radii_8c_source.html#l00072">calcRadii2od()</a>, <a class="el" href="TwoBodyDensity_8c_source.html#l00874">calcTBDensQLod()</a>, <a class="el" href="TwoBodyDensity_8c_source.html#l00786">calcTBDensQod()</a>, <a class="el" href="TwoBodyDensity_8c_source.html#l00829">calcTBDensRLod()</a>, <a class="el" href="TwoBodyDensity_8c_source.html#l00743">calcTBDensRod()</a>, and <a class="el" href="CenterofMass_8c_source.html#l00113">calcTCMod()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* idxp=Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; 
  <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>; <span class="keywordtype">int</span>* ngp=Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>; <a class="code" href="structGaussian.html">Gaussian</a>* Gp=Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  complex <span class="keywordtype">double</span> ovl=X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,<a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, ki,li,mi,ni;
  <span class="keywordtype">int</span> i;
  complex <span class="keywordtype">double</span> *gval = malloc(op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++)
    <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] = 0.0;

  <span class="keywordflow">for</span> (n=0; n&lt;A; n++)
    <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[l]+idxp[n]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
          <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
            <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[k]+idxp[m]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++) 
                gval[i] = 0.0;

              <span class="keywordflow">for</span> (ni=0; ni&lt;ngp[n]; ni++)
                <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
                  <span class="keywordflow">for</span> (mi=0; mi&lt;ngp[m]; mi++)
                    <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
                      op-&gt;<a class="code" href="structTwoBodyOperator.html#ab0e427b9221cd201e201c1d4939a15b7">me</a>(op-&gt;<a class="code" href="structTwoBodyOperator.html#abe1d35d4264d137a39b4f4055056fa04">par</a>, 
                             &amp;G[idx[k]+ki], &amp;G[idx[l]+li], 
                             &amp;Gp[idxp[m]+mi], &amp;Gp[idxp[n]+ni], 
                             &amp;Gaux[(idx[k]+ki)+(idxp[m]+mi)*ngauss],
                             &amp;Gaux[(idx[l]+li)+(idxp[n]+ni)*ngauss],
                             gval);

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++)
                <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] += 0.5*gval[i]*
                  (o[m+k*A]*o[n+l*A]-o[n+k*A]*o[m+l*A])*ovl;
            }   
      }

  free(gval);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1566c80344b499c26afc08afd0015d3b"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetTBMEodrowcol" ref="a1566c80344b499c26afc08afd0015d3b" args="(const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, const TwoBodyOperator *op, complex double val[], int k, int l)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetTBMEodrowcol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double&nbsp;</td>
          <td class="paramname"> <em>val</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>l</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00827">827</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00067">TwoBodyOperator::dim</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Gaussian_8h_source.html#l00070">TwoBodyOperator::me</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="Gaussian_8h_source.html#l00068">TwoBodyOperator::opt</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, <a class="el" href="Gaussian_8h_source.html#l00069">TwoBodyOperator::par</a>, and <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>.</p>

<p>Referenced by <a class="el" href="Potential_8c_source.html#l00439">calcPotentialodrowcol()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* idxp=Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; 
  <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>; <span class="keywordtype">int</span>* ngp=Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>; <a class="code" href="structGaussian.html">Gaussian</a>* Gp=Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  complex <span class="keywordtype">double</span> ovl=X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>;

  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, ki,li,mi,ni;
  <span class="keywordtype">int</span> i;
  complex <span class="keywordtype">double</span> *gval = malloc(op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++)
    <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] = 0.0;

  <span class="keywordflow">for</span> (n=0; n&lt;A; n++)
    <span class="comment">// for (l=0; l&lt;A; l++)</span>
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+idxp[n]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
          <span class="comment">// for (k=0; k&lt;A; k++)</span>
            <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+idxp[m]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++) 
                gval[i] = 0.0;

              <span class="keywordflow">for</span> (ni=0; ni&lt;ngp[n]; ni++)
                <span class="keywordflow">for</span> (li=0; li&lt;ng[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]; li++)
                  <span class="keywordflow">for</span> (mi=0; mi&lt;ngp[m]; mi++)
                    <span class="keywordflow">for</span> (ki=0; ki&lt;ng[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]; ki++)
                      op-&gt;<a class="code" href="structTwoBodyOperator.html#ab0e427b9221cd201e201c1d4939a15b7">me</a>(op-&gt;<a class="code" href="structTwoBodyOperator.html#abe1d35d4264d137a39b4f4055056fa04">par</a>, 
                             &amp;G[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki], &amp;G[idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+li], 
                             &amp;Gp[idxp[m]+mi], &amp;Gp[idxp[n]+ni], 
                             &amp;Gaux[(idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki)+(idxp[m]+mi)*ngauss],
                             &amp;Gaux[(idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+li)+(idxp[n]+ni)*ngauss],
                             gval);

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++)
                <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] += gval[i]*
                  (o[m+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*A]*o[n+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A]-o[n+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*A]*o[m+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A])*ovl;
            }   
      }

  free(gval);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3d1e03222b2c3d9b66ccbbe535963b7a"></a><!-- doxytag: member="SlaterDet.h::calcSlaterDetTBMErowcol" ref="a3d1e03222b2c3d9b66ccbbe535963b7a" args="(const SlaterDet *Q, const SlaterDetAux *X, const TwoBodyOperator *op, double val[], int k, int l)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSlaterDetTBMErowcol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structTwoBodyOperator.html">TwoBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>val</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>l</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00688">688</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00067">TwoBodyOperator::dim</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Gaussian_8h_source.html#l00070">TwoBodyOperator::me</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="Gaussian_8h_source.html#l00068">TwoBodyOperator::opt</a>, <a class="el" href="Gaussian_8h_source.html#l00069">TwoBodyOperator::par</a>, and <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>.</p>

<p>Referenced by <a class="el" href="Potential_8c_source.html#l00408">calcPotentialrowcol()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;

  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, ki,li,mi,ni;
  <span class="keywordtype">int</span> i;
  complex <span class="keywordtype">double</span> *gval = malloc(op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++)
    <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] = 0.0;

  <span class="keywordflow">for</span> (n=0; n&lt;A; n++)
    <span class="comment">// for (l=0; l&lt;A; l++)</span>
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+idx[n]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
          <span class="comment">// for (k=0; k&lt;l; k++)</span>
            <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structTwoBodyOperator.html#a446a12989a0cfb4fd8032656574efdfd">opt</a> || Gaux[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+idx[m]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++) 
                gval[i] = 0.0;

              <span class="keywordflow">for</span> (ni=0; ni&lt;ng[n]; ni++)
                <span class="keywordflow">for</span> (li=0; li&lt;ng[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]; li++)
                  <span class="keywordflow">for</span> (mi=0; mi&lt;ng[m]; mi++)
                    <span class="keywordflow">for</span> (ki=0; ki&lt;ng[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]; ki++)
                      op-&gt;<a class="code" href="structTwoBodyOperator.html#ab0e427b9221cd201e201c1d4939a15b7">me</a>(op-&gt;<a class="code" href="structTwoBodyOperator.html#abe1d35d4264d137a39b4f4055056fa04">par</a>, 
                             &amp;G[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki], &amp;G[idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+li], 
                             &amp;G[idx[m]+mi], &amp;G[idx[n]+ni], 
                             &amp;Gaux[(idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki)+(idx[m]+mi)*ngauss],
                             &amp;Gaux[(idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+li)+(idx[n]+ni)*ngauss],
                             gval);

              <span class="keywordflow">for</span> (i=0; i&lt;op-&gt;<a class="code" href="structTwoBodyOperator.html#adffa325591daadf6d30d38f7f912c8e3">dim</a>; i++)
                <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[i] += gval[i]*
                  (o[m+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*A]*o[n+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A]-o[n+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*A]*o[m+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A]);
            }   
      } 

  free(gval);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a95061fbc1f289e0ad28e565933af63e9"></a><!-- doxytag: member="SlaterDet.h::cloneSlaterDet" ref="a95061fbc1f289e0ad28e565933af63e9" args="(const SlaterDet *Q, SlaterDet *Qp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cloneSlaterDet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>copy Slater determinant Q into Qp Qp will be initialized </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00198">198</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8c_source.html#l00180">copySlaterDet()</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, and <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>.</p>

<p>Referenced by <a class="el" href="Observables_8c_source.html#l00057">calcObservablesParity()</a>, <a class="el" href="ParameterizationCluster_8c_source.html#l00058">Clusterclone()</a>, <a class="el" href="ParameterizationClusterFMD_8c_source.html#l00064">ClusterFMDclone()</a>, <a class="el" href="ParameterizationClustersFMD_8c_source.html#l00064">ClustersFMDclone()</a>, <a class="el" href="ParameterizationCoreFMD_8c_source.html#l00061">CoreFMDclone()</a>, <a class="el" href="DiClusterMulticonfig_8c_source.html#l00362">DiClusterMulticonfigRead()</a>, <a class="el" href="DiClusterMultiProjSlaterDet_8c_source.html#l00253">DiClusterMultiProjSlaterDetRead()</a>, and <a class="el" href="DiClusterProjParSlaterDet_8c_source.html#l00155">DiClusterProjSlaterDetRead()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>;
  Qp-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a> = Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;

  Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a> = malloc(Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a> = malloc(Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a> = malloc(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<a class="code" href="structGaussian.html">Gaussian</a>));

  <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(Q, Qp);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="acd974ea424b0829a55ada79fc69abd90"></a><!-- doxytag: member="SlaterDet.h::copySlaterDet" ref="acd974ea424b0829a55ada79fc69abd90" args="(const SlaterDet *Q, SlaterDet *Qp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copySlaterDet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>copy Slater determinant Q into Qp Qp must have been initialized already </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00180">180</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="angprojection_8c_source.html#l00092">_estimateangkappa()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00301">calcConstraintD3H()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00232">calcConstraintParCh()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00149">calcConstraintParN()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00101">calcConstraintParP()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00370">calcConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00439">calcConstraintSyz()</a>, <a class="el" href="Densities_8c_source.html#l00224">calcDensitiesCoordinateParity()</a>, <a class="el" href="Formfactors_8c_source.html#l00101">calcFormfactorod()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00331">calcgradConstraintD3H()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00261">calcgradConstraintParCh()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00168">calcgradConstraintParN()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00120">calcgradConstraintParP()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00398">calcgradConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00467">calcgradConstraintSyz()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00958">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00215">calcOneNucleonOvlapsod()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00390">calcorthprojectedHamiltonian()</a>, <a class="el" href="Parity_8c_source.html#l00039">calcParity()</a>, <a class="el" href="Parity_8c_source.html#l00060">calcParityod()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00777">calcprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="TimeReversal_8c_source.html#l00041">calcTimeReversal()</a>, <a class="el" href="TimeReversal_8c_source.html#l00062">calcTimeReversalod()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00305">calcTwoNucleonOvlapsTod()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00444">calcTwoNucleonOvlapsYod()</a>, <a class="el" href="SlaterDet_8c_source.html#l00198">cloneSlaterDet()</a>, <a class="el" href="DiagonalDensityHOSlave_8c_source.html#l00026">DiagonalDensityHOSlave()</a>, <a class="el" href="DiClusterMulticonfig_8c_source.html#l00182">DiClusterMulticonfigGet()</a>, <a class="el" href="DiClusterMultiProjSlaterDet_8c_source.html#l00175">DiClusterMultiProjSlaterDetGet()</a>, <a class="el" href="DiClusterProjParSlaterDet_8c_source.html#l00116">DiClusterProjSlaterDetGet()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00136">ef()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00169">egradf()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00284">egradh()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00230">eh()</a>, <a class="el" href="FormfactorSlave_8c_source.html#l00026">FormfactorSlave()</a>, <a class="el" href="calcnormp_8c_source.html#l00025">main()</a>, <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, <a class="el" href="OneNucleonOvlapsSlave_8c_source.html#l00033">OneNucleonOvlapsSlave()</a>, <a class="el" href="ProjectionSlave_8c_source.html#l00028">ProjectionSlave()</a>, <a class="el" href="SimpleSlaterDet_8c_source.html#l00054">SimpleSlaterDetGet()</a>, <a class="el" href="SymmetricMultiSlaterDet_8c_source.html#l00064">SymmetricMultiSlaterDetGet()</a>, <a class="el" href="SymmetricSlaterDet_8c_source.html#l00061">SymmetricSlaterDetGet()</a>, and <a class="el" href="TwoNucleonOvlapsSlave_8c_source.html#l00034">TwoNucleonOvlapsSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;
  
  assert(Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> &gt;= Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>);

  Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>;
  Qp-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a>; Qp-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a> = Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>;
  Qp-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a> = Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; i++) {
    Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[i] = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[i];
    Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[i] = Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[i];
  }
  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++)
    Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i] = Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i];
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="adc279637790bc3303e9dca688966a7ab"></a><!-- doxytag: member="SlaterDet.h::freeSlaterDet" ref="adc279637790bc3303e9dca688966a7ab" args="(SlaterDet *Q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freeSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>free memory used by Slater determinant Q </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00053">53</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, and <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>.</p>

<p>Referenced by <a class="el" href="Densities_8c_source.html#l00224">calcDensitiesCoordinateParity()</a>, <a class="el" href="Observables_8c_source.html#l00057">calcObservablesParity()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, and <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  free(Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>);
  free(Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>);
  free(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6d10ca2b062d871a6903292600c3125a"></a><!-- doxytag: member="SlaterDet.h::freeSlaterDetAux" ref="a6d10ca2b062d871a6903292600c3125a" args="(SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freeSlaterDetAux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>free memory used by <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> X </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00423">423</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00045">SlaterDetAux::n</a>, and <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>.</p>

<p>Referenced by <a class="el" href="cmprojection_8c_source.html#l00128">_estimateacm()</a>, <a class="el" href="Densities_8c_source.html#l00208">calcDensitiesCoordinate()</a>, <a class="el" href="Densities_8c_source.html#l00224">calcDensitiesCoordinateParity()</a>, <a class="el" href="Densities_8c_source.html#l00294">calcDensitiesMomentum()</a>, <a class="el" href="Observables_8c_source.html#l00033">calcObservables()</a>, <a class="el" href="Observables_8c_source.html#l00057">calcObservablesParity()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="Densities_8c_source.html#l00278">calcRadialDensitiesCoordinate()</a>, <a class="el" href="Densities_8c_source.html#l00310">calcRadialDensitiesMomentum()</a>, and <a class="el" href="ProjectedShellOccupations_8c_source.html#l00163">calcShellOccupationsod()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  free(X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>);
  free(X-&gt;<a class="code" href="structSlaterDetAux.html#a50d38b691498b8b46c3ebd38a3945dd3" title="single particle ovlap matrix n(A,A)">n</a>);
  free(X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a16db6f53cfee239b7d506c86bc372686"></a><!-- doxytag: member="SlaterDet.h::initSlaterDet" ref="a16db6f53cfee239b7d506c86bc372686" args="(const SlaterDet *Q, SlaterDet *Qp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initSlaterDet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>initialize Slater determinant Qp with Q </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00041">41</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, and <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>.</p>

<p>Referenced by <a class="el" href="angprojection_8c_source.html#l00092">_estimateangkappa()</a>, <a class="el" href="Densities_8c_source.html#l00224">calcDensitiesCoordinateParity()</a>, <a class="el" href="Formfactors_8c_source.html#l00101">calcFormfactorod()</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00215">calcOneNucleonOvlapsod()</a>, <a class="el" href="Parity_8c_source.html#l00039">calcParity()</a>, <a class="el" href="Parity_8c_source.html#l00060">calcParityod()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="TimeReversal_8c_source.html#l00041">calcTimeReversal()</a>, <a class="el" href="TimeReversal_8c_source.html#l00062">calcTimeReversalod()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00305">calcTwoNucleonOvlapsTod()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00444">calcTwoNucleonOvlapsYod()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00687">initWork()</a>, and <a class="el" href="calcnormp_8c_source.html#l00025">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  assert(Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a> &lt;= <a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>);
  Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>;
  Qp-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a> = Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;

  Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a> = malloc(Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a> = malloc(Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a> = malloc(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<a class="code" href="structGaussian.html">Gaussian</a>));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9d28b849a027b454fd2eddb812a884c5"></a><!-- doxytag: member="SlaterDet.h::initSlaterDetAux" ref="a9d28b849a027b454fd2eddb812a884c5" args="(const SlaterDet *Q, SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initSlaterDetAux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>init <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> X </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00414">414</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="cmat_8c_source.html#l00023">initcmat()</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, <a class="el" href="SlaterDet_8h_source.html#l00045">SlaterDetAux::n</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="cmprojection_8c_source.html#l00128">_estimateacm()</a>, <a class="el" href="angprojection_8c_source.html#l00092">_estimateangkappa()</a>, <a class="el" href="Densities_8c_source.html#l00208">calcDensitiesCoordinate()</a>, <a class="el" href="Densities_8c_source.html#l00224">calcDensitiesCoordinateParity()</a>, <a class="el" href="Densities_8c_source.html#l00294">calcDensitiesMomentum()</a>, <a class="el" href="Formfactors_8c_source.html#l00101">calcFormfactorod()</a>, <a class="el" href="Observables_8c_source.html#l00033">calcObservables()</a>, <a class="el" href="Observables_8c_source.html#l00057">calcObservablesParity()</a>, <a class="el" href="Parity_8c_source.html#l00039">calcParity()</a>, <a class="el" href="Parity_8c_source.html#l00060">calcParityod()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00037">calcprojectedMBMEmpi()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00194">calcprojectedMBMEsmpi()</a>, <a class="el" href="Densities_8c_source.html#l00278">calcRadialDensitiesCoordinate()</a>, <a class="el" href="Densities_8c_source.html#l00310">calcRadialDensitiesMomentum()</a>, <a class="el" href="ProjectedShellOccupations_8c_source.html#l00163">calcShellOccupationsod()</a>, <a class="el" href="TimeReversal_8c_source.html#l00041">calcTimeReversal()</a>, <a class="el" href="TimeReversal_8c_source.html#l00062">calcTimeReversalod()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00687">initWork()</a>, <a class="el" href="calcconstraints_8c_source.html#l00033">main()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00092">MinimizeDONLP2()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l01148">MinimizeDONLP2orthproj()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00090">MinimizeDONLP2p()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00090">MinimizeDONLP2par()</a>, <a class="el" href="MinimizerDONLP2proj_8c_source.html#l00672">MinimizeDONLP2proj()</a>, and <a class="el" href="MinimizerDONLP2vap_8c_source.html#l00903">MinimizeDONLP2vap()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  assert(Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a> &lt;= <a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>);
  X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>)*<span class="keyword">sizeof</span>(<a class="code" href="structGaussianAux.html">GaussianAux</a>));
  X-&gt;<a class="code" href="structSlaterDetAux.html#a50d38b691498b8b46c3ebd38a3945dd3" title="single particle ovlap matrix n(A,A)">n</a> = <a class="code" href="cmat_8c.html#a2c55a1976c165daaef0aeb57abd17f2b" title="initialize complex nxn matrix">initcmat</a>(Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>);
  X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a> = <a class="code" href="cmat_8c.html#a2c55a1976c165daaef0aeb57abd17f2b" title="initialize complex nxn matrix">initcmat</a>(Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>);
}  
</pre></div></p>

</div>
</div>
<a class="anchor" id="afd2f6a81babbbba6094dc63951676a17"></a><!-- doxytag: member="SlaterDet.h::invertcmSlaterDet" ref="afd2f6a81babbbba6094dc63951676a17" args="(SlaterDet *Q, SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void invertcmSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>invert Slater determinant with respect to cm position and velocity </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00359">359</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8c_source.html#l00264">boostSlaterDet()</a>, <a class="el" href="CenterofMass_8c_source.html#l00071">calcCMPosition()</a>, <a class="el" href="CenterofMass_8c_source.html#l00085">calcCMVelocity()</a>, <a class="el" href="SlaterDet_8c_source.html#l00432">calcSlaterDetAux()</a>, <a class="el" href="SlaterDet_8c_source.html#l00350">invertSlaterDet()</a>, and <a class="el" href="SlaterDet_8c_source.html#l00255">moveSlaterDet()</a>.</p>

<p>Referenced by <a class="el" href="minenergyp_8c_source.html#l00055">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> Xcm[3], Vcm[3];
  <span class="keywordtype">int</span> i;

  <a class="code" href="SlaterDet_8c.html#ac1dfa773b90a1f5f6294d6081c412981">calcSlaterDetAux</a>(Q, X);
  <a class="code" href="CenterofMass_8c.html#a1e6d03a8864c008d5eccd7a0ca7704f0">calcCMPosition</a>(Q, X, Xcm);
  <a class="code" href="CenterofMass_8c.html#a70f46c8dd6549d99121002d39a5b1e1e">calcCMVelocity</a>(Q, X, Vcm);

  <span class="keywordflow">for</span> (i=0; i&lt;3; i++) {
    Xcm[i] *= -1;
    Vcm[i] *= -1;
  }
  <a class="code" href="SlaterDet_8c.html#ad154093b24c00e82ac9129d87cd2e049" title="boost Slater determinant with speed v">boostSlaterDet</a>(Q, Vcm);
  <a class="code" href="SlaterDet_8c.html#a5463a8afc7565b2711169b605aad5ca3" title="move Slater determinant by vector d">moveSlaterDet</a>(Q, Xcm);

  <a class="code" href="SlaterDet_8c.html#ad0aa11be18d42c1cc26c2ad1380feb2a" title="invert Slater determinant in origin">invertSlaterDet</a>(Q);

  <span class="keywordflow">for</span> (i=0; i&lt;3; i++) {
    Xcm[i] *= -1;
    Vcm[i] *= -1;
  }
  <a class="code" href="SlaterDet_8c.html#a5463a8afc7565b2711169b605aad5ca3" title="move Slater determinant by vector d">moveSlaterDet</a>(Q, Xcm);
  <a class="code" href="SlaterDet_8c.html#ad154093b24c00e82ac9129d87cd2e049" title="boost Slater determinant with speed v">boostSlaterDet</a>(Q, Vcm);

}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad0aa11be18d42c1cc26c2ad1380feb2a"></a><!-- doxytag: member="SlaterDet.h::invertSlaterDet" ref="ad0aa11be18d42c1cc26c2ad1380feb2a" args="(SlaterDet *Q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void invertSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>invert Slater determinant in origin </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00350">350</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="Gaussian_8c_source.html#l00054">invertGaussian()</a>, and <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>.</p>

<p>Referenced by <a class="el" href="ConstraintSymmetries_8c_source.html#l00232">calcConstraintParCh()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00149">calcConstraintParN()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00101">calcConstraintParP()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00370">calcConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00439">calcConstraintSyz()</a>, <a class="el" href="Densities_8c_source.html#l00224">calcDensitiesCoordinateParity()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00261">calcgradConstraintParCh()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00168">calcgradConstraintParN()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00120">calcgradConstraintParP()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00398">calcgradConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00467">calcgradConstraintSyz()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2proj_8c_source.html#l00410">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="Observables_8c_source.html#l00057">calcObservablesParity()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00390">calcorthprojectedHamiltonian()</a>, <a class="el" href="Parity_8c_source.html#l00039">calcParity()</a>, <a class="el" href="Parity_8c_source.html#l00060">calcParityod()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00179">calcprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="DiagonalDensityHOSlave_8c_source.html#l00026">DiagonalDensityHOSlave()</a>, <a class="el" href="DiClusterMulticonfig_8c_source.html#l00182">DiClusterMulticonfigGet()</a>, <a class="el" href="DiClusterMultiProjSlaterDet_8c_source.html#l00175">DiClusterMultiProjSlaterDetGet()</a>, <a class="el" href="DiClusterProjSlaterDet_8c_source.html#l00117">DiClusterProjSlaterDetGet()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00136">ef()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00169">egradf()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00284">egradh()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00230">eh()</a>, <a class="el" href="FormfactorSlave_8c_source.html#l00026">FormfactorSlave()</a>, <a class="el" href="SlaterDet_8c_source.html#l00359">invertcmSlaterDet()</a>, <a class="el" href="calcnormp_8c_source.html#l00025">main()</a>, <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, <a class="el" href="OneNucleonOvlapsSlave_8c_source.html#l00033">OneNucleonOvlapsSlave()</a>, <a class="el" href="ProjectionSlave_8c_source.html#l00028">ProjectionSlave()</a>, and <a class="el" href="TwoNucleonOvlapsSlave_8c_source.html#l00034">TwoNucleonOvlapsSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++)
    <a class="code" href="Gaussian_8c.html#a36bcf9e971ac21dc7203e1e000bebb98" title="parity operation with respect to origin">invertGaussian</a>(&amp;Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i]);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="afdaa23393bbb93aad62823a8365f6810"></a><!-- doxytag: member="SlaterDet.h::joinSlaterDets" ref="afdaa23393bbb93aad62823a8365f6810" args="(const SlaterDet *Qa, const SlaterDet *Qb, SlaterDet *Q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void joinSlaterDets </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>join Slater determinants Qa and Qb into Q Q will be initialized </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00211">211</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="joinsldets_8c_source.html#l00025">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> = Qa-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>+Qb-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>;
  Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> = Qa-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a>+Qb-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a>;
  Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a> = Qa-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>+Qb-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>;
  Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a> = Qa-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>+Qb-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;

  Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a> = malloc(Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a> = malloc(Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a> = malloc(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<a class="code" href="structGaussian.html">Gaussian</a>));

  <span class="keywordtype">int</span> i;
  <span class="comment">// copy Qa</span>
  <span class="keywordflow">for</span> (i=0; i&lt;Qa-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; i++) {
    Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[i] = Qa-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[i];
    Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[i] = Qa-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[i];
  }
  <span class="keywordflow">for</span> (i=0; i&lt;Qa-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++)
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i] = Qa-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i];

  <span class="comment">// copy Qb</span>
  for (i=0; i&lt;Qb-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; i++) {
    Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[i+Qa-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>] = Qb-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[i]+Qa-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
    Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[i+Qa-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>] = Qb-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[i];
  }
  <span class="keywordflow">for</span> (i=0; i&lt;Qb-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++) 
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i+Qa-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>] = Qb-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i];
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3d81dfe0c56874931a3f5ce934cd8786"></a><!-- doxytag: member="SlaterDet.h::moveboostorientSlaterDet" ref="a3d81dfe0c56874931a3f5ce934cd8786" args="(SlaterDet *Q, SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void moveboostorientSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>move and boost center of mass to origin, orient main axes </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00310">310</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00107">alpha</a>, <a class="el" href="SlaterDet_8c_source.html#l00264">boostSlaterDet()</a>, <a class="el" href="CenterofMass_8c_source.html#l00071">calcCMPosition()</a>, <a class="el" href="CenterofMass_8c_source.html#l00085">calcCMVelocity()</a>, <a class="el" href="SpatialOrientation_8c_source.html#l00198">calcOrientedOrientation()</a>, <a class="el" href="SlaterDet_8c_source.html#l00432">calcSlaterDetAux()</a>, <a class="el" href="SlaterDet_8c_source.html#l00255">moveSlaterDet()</a>, and <a class="el" href="SlaterDet_8c_source.html#l00294">rotateSlaterDet()</a>.</p>

<p>Referenced by <a class="el" href="minenergy_8c_source.html#l00071">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  <span class="comment">// move SlaterDet to origin in phase space</span>
  <span class="comment">// orient so that min moment of inertia around the z-axes</span>

  <span class="keywordtype">double</span> Xcm[3], Vcm[3];
  <a class="code" href="SlaterDet_8c.html#ac1dfa773b90a1f5f6294d6081c412981">calcSlaterDetAux</a>(Q, X);
  <a class="code" href="CenterofMass_8c.html#a1e6d03a8864c008d5eccd7a0ca7704f0">calcCMPosition</a>(Q, X, Xcm);
  <a class="code" href="CenterofMass_8c.html#a70f46c8dd6549d99121002d39a5b1e1e">calcCMVelocity</a>(Q, X, Vcm);  

  <span class="keywordflow">for</span> (i=0; i&lt;3; i++)
    Vcm[i] *= -1;
  <span class="keywordflow">for</span> (i=0; i&lt;3; i++)
    Xcm[i] *= -1;

  <a class="code" href="SlaterDet_8c.html#ad154093b24c00e82ac9129d87cd2e049" title="boost Slater determinant with speed v">boostSlaterDet</a>(Q, Vcm);
  <a class="code" href="SlaterDet_8c.html#a5463a8afc7565b2711169b605aad5ca3" title="move Slater determinant by vector d">moveSlaterDet</a>(Q, Xcm);

  <span class="comment">// orient the nucleus along the main axes</span>

  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, gamma;
  <a class="code" href="SlaterDet_8c.html#ac1dfa773b90a1f5f6294d6081c412981">calcSlaterDetAux</a>(Q, X);
  <a class="code" href="SpatialOrientation_8c.html#ac976e85596d5fab5140b3e9cd76ee1a4">calcOrientedOrientation</a>(Q, X, &amp;alpha, &amp;beta, &amp;gamma);
  <a class="code" href="SlaterDet_8c.html#a8737af9032a8d87843782a88228fef00" title="rotate Slater determinant by euler angles">rotateSlaterDet</a>(Q, -gamma, -beta, -alpha);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae3a4b38044ff7cac304d3258825f4ce8"></a><!-- doxytag: member="SlaterDet.h::moveboostSlaterDet" ref="ae3a4b38044ff7cac304d3258825f4ce8" args="(SlaterDet *Q, SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void moveboostSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>move and boost center of mass to origin </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00273">273</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8c_source.html#l00264">boostSlaterDet()</a>, <a class="el" href="CenterofMass_8c_source.html#l00071">calcCMPosition()</a>, <a class="el" href="CenterofMass_8c_source.html#l00085">calcCMVelocity()</a>, <a class="el" href="SlaterDet_8c_source.html#l00432">calcSlaterDetAux()</a>, and <a class="el" href="SlaterDet_8c_source.html#l00255">moveSlaterDet()</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l01216">ef()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l01248">egradf()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l01345">egradh()</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l01320">eh()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  <span class="comment">// move SlaterDet to origin in phase space</span>

  <span class="keywordtype">double</span> Xcm[3], Vcm[3];
  <a class="code" href="SlaterDet_8c.html#ac1dfa773b90a1f5f6294d6081c412981">calcSlaterDetAux</a>(Q, X);
  <a class="code" href="CenterofMass_8c.html#a1e6d03a8864c008d5eccd7a0ca7704f0">calcCMPosition</a>(Q, X, Xcm);
  <a class="code" href="CenterofMass_8c.html#a70f46c8dd6549d99121002d39a5b1e1e">calcCMVelocity</a>(Q, X, Vcm);  

  <span class="keywordflow">for</span> (i=0; i&lt;3; i++)
    Vcm[i] *= -1;
  <span class="keywordflow">for</span> (i=0; i&lt;3; i++)
    Xcm[i] *= -1;

  <a class="code" href="SlaterDet_8c.html#ad154093b24c00e82ac9129d87cd2e049" title="boost Slater determinant with speed v">boostSlaterDet</a>(Q, Vcm);
  <a class="code" href="SlaterDet_8c.html#a5463a8afc7565b2711169b605aad5ca3" title="move Slater determinant by vector d">moveSlaterDet</a>(Q, Xcm);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5463a8afc7565b2711169b605aad5ca3"></a><!-- doxytag: member="SlaterDet.h::moveSlaterDet" ref="a5463a8afc7565b2711169b605aad5ca3" args="(SlaterDet *Q, double d[3])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void moveSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>d</em>[3]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>move Slater determinant by vector d </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00255">255</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="Gaussian_8c_source.html#l00024">moveGaussian()</a>, and <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00497">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="DiagonalDensityHOSlave_8c_source.html#l00026">DiagonalDensityHOSlave()</a>, <a class="el" href="DiClusterMulticonfig_8c_source.html#l00182">DiClusterMulticonfigGet()</a>, <a class="el" href="DiClusterMultiProjSlaterDet_8c_source.html#l00175">DiClusterMultiProjSlaterDetGet()</a>, <a class="el" href="DiClusterProjParSlaterDet_8c_source.html#l00116">DiClusterProjSlaterDetGet()</a>, <a class="el" href="FormfactorSlave_8c_source.html#l00026">FormfactorSlave()</a>, <a class="el" href="SlaterDet_8c_source.html#l00359">invertcmSlaterDet()</a>, <a class="el" href="joinsldets_8c_source.html#l00025">main()</a>, <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, <a class="el" href="SlaterDet_8c_source.html#l00310">moveboostorientSlaterDet()</a>, <a class="el" href="SlaterDet_8c_source.html#l00273">moveboostSlaterDet()</a>, <a class="el" href="OneNucleonOvlapsSlave_8c_source.html#l00033">OneNucleonOvlapsSlave()</a>, <a class="el" href="ProjectionSlave_8c_source.html#l00028">ProjectionSlave()</a>, and <a class="el" href="TwoNucleonOvlapsSlave_8c_source.html#l00034">TwoNucleonOvlapsSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++)
    <a class="code" href="Gaussian_8c.html#af8befaf2546d597e54846b354c988547" title="move Gaussian by d">moveGaussian</a>(&amp;Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i], d);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6a41a03f939c76a6a27eb78fd46a1ebc"></a><!-- doxytag: member="SlaterDet.h::normalizeSlaterDet" ref="a6a41a03f939c76a6a27eb78fd46a1ebc" args="(SlaterDet *Q, SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalizeSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>normalize <a class="el" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a> </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00241">241</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8c_source.html#l00468">calcSlaterDetAuxod()</a>, <a class="el" href="Gaussian_8h_source.html#l00021">Gaussian::chi</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, and <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>.</p>

<p>Referenced by <a class="el" href="minenergy_8c_source.html#l00071">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <a class="code" href="SlaterDet_8c.html#ad3679a655d9b6019619456e5b7961638">calcSlaterDetAuxod</a>(Q, Q, X);
  <span class="keywordtype">double</span> norm = sqrt(creal(X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>));
  <span class="keywordtype">double</span> normsp = pow(norm, 1.0/Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>);

  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++) {
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i].<a class="code" href="structGaussian.html#a95da0e93add3c73c0fef74054aaf5c21" title="complex spinor, additional freedom to give norm and phase">chi</a>[0] /= normsp;
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i].<a class="code" href="structGaussian.html#a95da0e93add3c73c0fef74054aaf5c21" title="complex spinor, additional freedom to give norm and phase">chi</a>[1] /= normsp;
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4352c529278dcdf99e15254e4d1ce9c0"></a><!-- doxytag: member="SlaterDet.h::orientSlaterDet" ref="a4352c529278dcdf99e15254e4d1ce9c0" args="(SlaterDet *Q, SlaterDetAux *X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void orientSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>orient main axes </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00339">339</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00107">alpha</a>, <a class="el" href="SpatialOrientation_8c_source.html#l00198">calcOrientedOrientation()</a>, <a class="el" href="SlaterDet_8c_source.html#l00432">calcSlaterDetAux()</a>, and <a class="el" href="SlaterDet_8c_source.html#l00294">rotateSlaterDet()</a>.</p>

<p>Referenced by <a class="el" href="calcdensities_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="comment">// orient the nucleus along the main axes</span>

  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, gamma;
  <a class="code" href="SlaterDet_8c.html#ac1dfa773b90a1f5f6294d6081c412981">calcSlaterDetAux</a>(Q, X);
  <a class="code" href="SpatialOrientation_8c.html#ac976e85596d5fab5140b3e9cd76ee1a4">calcOrientedOrientation</a>(Q, X, &amp;alpha, &amp;beta, &amp;gamma);
  <a class="code" href="SlaterDet_8c.html#a8737af9032a8d87843782a88228fef00" title="rotate Slater determinant by euler angles">rotateSlaterDet</a>(Q, -gamma, -beta, -alpha);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a45f5f0c4355fdf5dc10d5a5de969da62"></a><!-- doxytag: member="SlaterDet.h::readSlaterDet" ref="a45f5f0c4355fdf5dc10d5a5de969da62" args="(FILE *fp, SlaterDet *Q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readSlaterDet </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>read parameters of Slater determinant Q from file Q will be initialized </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00088">88</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="Gaussian_8h_source.html#l00022">Gaussian::a</a>, <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00023">Gaussian::b</a>, <a class="el" href="SlaterDet_8c_source.html#l00086">BUFSIZE</a>, <a class="el" href="Gaussian_8h_source.html#l00021">Gaussian::chi</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="utils_8c_source.html#l00087">stripstr()</a>, <a class="el" href="Gaussian_8h_source.html#l00020">Gaussian::xi</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="SlaterDet_8c_source.html#l00162">readSlaterDetfromFile()</a>, <a class="el" href="SimpleSlaterDet_8c_source.html#l00063">SimpleSlaterDetRead()</a>, <a class="el" href="SymmetricMultiSlaterDet_8c_source.html#l00072">SymmetricMultiSlaterDetRead()</a>, and <a class="el" href="SymmetricSlaterDet_8c_source.html#l00069">SymmetricSlaterDetRead()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span> buf[BUFSIZE];
  <span class="keywordtype">int</span> i;
  
  <span class="keywordflow">do</span>
    fgets(buf, <a class="code" href="SlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
  <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;SlaterDet&gt;&quot;</span>, 11) &amp;&amp; !feof(fp));
  <span class="keywordflow">if</span> (feof(fp)) {
    fprintf(stderr, <span class="stringliteral">&quot;did&#39;t find &lt;SlaterDet&gt;\n&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  fgets(buf, <a class="code" href="SlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
  <span class="keywordflow">if</span> (sscanf(buf, <span class="stringliteral">&quot;%d %d %d&quot;</span>, &amp;Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>, &amp;Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a>, &amp;Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>) != 3) {
    fprintf(stderr, <span class="stringliteral">&quot;malformed line\n&gt;&gt;%s&lt;&lt;\n&quot;</span>, <a class="code" href="utils_8c.html#af86aada130a5db5b0f52154718d67c44" title="strips strip from str">stripstr</a>(buf, <span class="stringliteral">&quot;\n&quot;</span>));
    <span class="keywordflow">return</span> -1;
  }
  <span class="keywordflow">if</span> (Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> != Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a>+Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>) {
    fprintf(stderr, <span class="stringliteral">&quot;proton and neutron number don&#39;t sum up in line\n&gt;&gt;%s&lt;&lt;\n&quot;</span>,
            <a class="code" href="utils_8c.html#af86aada130a5db5b0f52154718d67c44" title="strips strip from str">stripstr</a>(buf, <span class="stringliteral">&quot;\n&quot;</span>));
    <span class="keywordflow">return</span> -1;
  }
  fgets(buf, <a class="code" href="SlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
  <span class="keywordflow">if</span> (sscanf(buf, <span class="stringliteral">&quot;%d&quot;</span>, &amp;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>) != 1) {
    fprintf(stderr, <span class="stringliteral">&quot;malformed line\n&gt;&gt;%s&lt;&lt;\n&quot;</span>, <a class="code" href="utils_8c.html#af86aada130a5db5b0f52154718d67c44" title="strips strip from str">stripstr</a>(buf, <span class="stringliteral">&quot;\n&quot;</span>));
    <span class="keywordflow">return</span> -1;
  }

  Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a> = malloc(Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a> = malloc(Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; i++) {
    Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[i] = 0;
    Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[i] = 0;
  }
  Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a> = malloc(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<a class="code" href="structGaussian.html">Gaussian</a>));

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, xi;
  <span class="keywordtype">double</span> chi0re, chi0im, chi1re, chi1im;
  <span class="keywordtype">double</span> are, aim, b0re, b0im, b1re, b1im, b2re, b2im; 
  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++) {
    fgets(buf, <a class="code" href="SlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
    <span class="keywordflow">if</span> (sscanf(buf, <span class="stringliteral">&quot;%d %d &quot;</span>
               <span class="stringliteral">&quot;(%lf,%lf) (%lf,%lf) (%lf,%lf) (%lf,%lf) (%lf,%lf) (%lf,%lf)&quot;</span>, 
               &amp;k, &amp;xi, &amp;chi0re, &amp;chi0im, &amp;chi1re, &amp;chi1im, 
               &amp;are, &amp;aim, &amp;b0re, &amp;b0im, &amp;b1re, &amp;b1im, &amp;b2re, &amp;b2im) != 14) {
      fprintf(stderr, <span class="stringliteral">&quot;malformed line\n&gt;&gt;%s&lt;&lt;\n&quot;</span>, 
              <a class="code" href="utils_8c.html#af86aada130a5db5b0f52154718d67c44" title="strips strip from str">stripstr</a>(buf,<span class="stringliteral">&quot;\n&quot;</span>));
      <span class="keywordflow">return</span> -1;
    }
    Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[k]++;
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i].<a class="code" href="structGaussian.html#a3102697cdce1aedb094cd515f6cd5a47" title="isospin +/- 1 (proton/neutron)">xi</a> = xi;
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i].<a class="code" href="structGaussian.html#a95da0e93add3c73c0fef74054aaf5c21" title="complex spinor, additional freedom to give norm and phase">chi</a>[0] = chi0re + <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>*chi0im;
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i].<a class="code" href="structGaussian.html#a95da0e93add3c73c0fef74054aaf5c21" title="complex spinor, additional freedom to give norm and phase">chi</a>[1] = chi1re + <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>*chi1im;
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i].<a class="code" href="structGaussian.html#a4d7abfae9328f879eb63aa513d57fd74" title="complex width">a</a> = are + <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>*aim;
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i].<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[0] = b0re + <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>*b0im;
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i].<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[1] = b1re + <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>*b1im;
    Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i].<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[2] = b2re + <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>*b2im;
  }     
  <span class="keywordflow">for</span> (k=1; k&lt;Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; k++) 
    Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[k] = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[k-1]+Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[k-1];
         
  fgets(buf, <a class="code" href="SlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
  <span class="keywordflow">if</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;/SlaterDet&gt;&quot;</span>, 12)) {
    fprintf(stderr, <span class="stringliteral">&quot;did&#39;t find &lt;/SlaterDet&gt;\n&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3ebf34d0b05c3dcde99a34ddb61c49e4"></a><!-- doxytag: member="SlaterDet.h::readSlaterDetfromFile" ref="a3ebf34d0b05c3dcde99a34ddb61c49e4" args="(SlaterDet *Q, const char *fname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readSlaterDetfromFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fname</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>read Slater determinant Q from file Q will be initialized </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00162">162</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8c_source.html#l00088">readSlaterDet()</a>.</p>

<p>Referenced by <a class="el" href="ParameterizationClusterFMD_8c_source.html#l00107">ClusterFMDread()</a>, <a class="el" href="ParameterizationCluster_8c_source.html#l00091">Clusterread()</a>, <a class="el" href="ParameterizationClustersFMD_8c_source.html#l00107">ClustersFMDread()</a>, <a class="el" href="ParameterizationCoreFMD_8c_source.html#l00099">CoreFMDread()</a>, <a class="el" href="DiClusterMulticonfig_8c_source.html#l00362">DiClusterMulticonfigRead()</a>, <a class="el" href="DiClusterMultiProjSlaterDet_8c_source.html#l00253">DiClusterMultiProjSlaterDetRead()</a>, <a class="el" href="DiClusterProjParSlaterDet_8c_source.html#l00155">DiClusterProjSlaterDetRead()</a>, <a class="el" href="calcbasisovlap_8c_source.html#l00087">main()</a>, and <a class="el" href="Projection_8c_source.html#l01873">readMulticonfigfile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  FILE* fp;

  <span class="keywordflow">if</span> (!(fp = fopen(fname, <span class="stringliteral">&quot;r&quot;</span>))) {  
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for reading\n&quot;</span>, fname);
    <span class="keywordflow">return</span> -1;
  }

  fprintf(stderr, <span class="stringliteral">&quot;... reading SlaterDet from file %s\n&quot;</span>, fname);

  <span class="keywordtype">int</span> err = <a class="code" href="SlaterDet_8c.html#a45f5f0c4355fdf5dc10d5a5de969da62">readSlaterDet</a>(fp, Q);
  fclose(fp);

  <span class="keywordflow">return</span> err;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="acb9aa75178acc11ffabfb94f0247ee6c"></a><!-- doxytag: member="SlaterDet.h::rotateSlaterDet" ref="acb9aa75178acc11ffabfb94f0247ee6c" args="(SlaterDet *Q, double alpha, double beta, double gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>gamma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>rotate Slater determinant by euler angles </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00294">294</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="Gaussian_8c_source.html#l00046">rotateGaussian()</a>, <a class="el" href="rotationmatrices_8c_source.html#l00050">rotatemat2()</a>, and <a class="el" href="rotationmatrices_8c_source.html#l00084">rotatemat3()</a>.</p>

<p>Referenced by <a class="el" href="angprojection_8c_source.html#l00092">_estimateangkappa()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00301">calcConstraintD3H()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00370">calcConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00439">calcConstraintSyz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00331">calcgradConstraintD3H()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00398">calcgradConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00467">calcgradConstraintSyz()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00958">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00390">calcorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00777">calcprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="DiagonalDensityHOSlave_8c_source.html#l00026">DiagonalDensityHOSlave()</a>, <a class="el" href="DiClusterMulticonfig_8c_source.html#l00182">DiClusterMulticonfigGet()</a>, <a class="el" href="DiClusterMultiProjSlaterDet_8c_source.html#l00175">DiClusterMultiProjSlaterDetGet()</a>, <a class="el" href="DiClusterProjParSlaterDet_8c_source.html#l00116">DiClusterProjSlaterDetGet()</a>, <a class="el" href="FormfactorSlave_8c_source.html#l00026">FormfactorSlave()</a>, <a class="el" href="calcdensities3d_8c_source.html#l00032">main()</a>, <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, <a class="el" href="SlaterDet_8c_source.html#l00310">moveboostorientSlaterDet()</a>, <a class="el" href="OneNucleonOvlapsSlave_8c_source.html#l00033">OneNucleonOvlapsSlave()</a>, <a class="el" href="SlaterDet_8c_source.html#l00339">orientSlaterDet()</a>, <a class="el" href="ProjectionSlave_8c_source.html#l00028">ProjectionSlave()</a>, and <a class="el" href="TwoNucleonOvlapsSlave_8c_source.html#l00034">TwoNucleonOvlapsSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> euler[3] = { a, b, g };

  complex <span class="keywordtype">double</span> R2[2][2];
  <a class="code" href="rotationmatrices_8c.html#a35bedbe2765f5d99ca0f5fa72e50f0e1" title="spinor rotation matrix">rotatemat2</a>(euler, R2);

  <span class="keywordtype">double</span> R3[3][3];
  <a class="code" href="rotationmatrices_8c.html#a927b76dce98d7889615bc1118ece7706" title="vector rotation matrix">rotatemat3</a>(euler, R3);

  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++)
    <a class="code" href="Gaussian_8c.html#af534f5c66daf844c857fc9cb61ca7693">rotateGaussian</a>(&amp;Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i], R3, R2);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad97350a50ef6bd07d50ed483af579542"></a><!-- doxytag: member="SlaterDet.h::scaleSlaterDet" ref="ad97350a50ef6bd07d50ed483af579542" args="(SlaterDet *Q, double kappa)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scaleSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>kappa</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>scale Slater determinant </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00396">396</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, and <a class="el" href="Gaussian_8c_source.html#l00077">scaleGaussian()</a>.</p>

<p>Referenced by <a class="el" href="sldet2fmdpara_8c_source.html#l00108">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++)
    <a class="code" href="Gaussian_8c.html#ad9bf36d5b778c0f741e398e2c9aa44d9" title="scale lengths by kappa">scaleGaussian</a>(&amp;Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i], kappa);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aea63bd7a51a1011e0e2024429f41c6e6"></a><!-- doxytag: member="SlaterDet.h::timerevertSlaterDet" ref="aea63bd7a51a1011e0e2024429f41c6e6" args="(SlaterDet *Q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timerevertSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>time revert Slater determinant </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00387">387</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, and <a class="el" href="Gaussian_8c_source.html#l00063">timerevertGaussian()</a>.</p>

<p>Referenced by <a class="el" href="TimeReversal_8c_source.html#l00041">calcTimeReversal()</a>, <a class="el" href="TimeReversal_8c_source.html#l00062">calcTimeReversalod()</a>, and <a class="el" href="transformsldet_8c_source.html#l00027">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; i++)
    <a class="code" href="Gaussian_8c.html#a32985da262d1721699840a4acc325508" title="time reversal operator">timerevertGaussian</a>(&amp;Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[i]);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1046a070a040e038cac232d20a205093"></a><!-- doxytag: member="SlaterDet.h::writeSlaterDet" ref="a1046a070a040e038cac232d20a205093" args="(FILE *fp, const SlaterDet *Q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeSlaterDet </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>write parameters of Slater determinant Q in file </p>

<p>Definition at line <a class="el" href="SlaterDet_8c_source.html#l00061">61</a> of file <a class="el" href="SlaterDet_8c_source.html">SlaterDet.c</a>.</p>

<p>References <a class="el" href="Gaussian_8h_source.html#l00022">Gaussian::a</a>, <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Gaussian_8h_source.html#l00023">Gaussian::b</a>, <a class="el" href="Gaussian_8h_source.html#l00021">Gaussian::chi</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="Gaussian_8h_source.html#l00020">Gaussian::xi</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2_8c_source.html#l00150">egradf()</a>, and <a class="el" href="joinsldets_8c_source.html#l00025">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, i, idx;

  fprintf(fp, <span class="stringliteral">&quot;&lt;SlaterDet&gt;\n&quot;</span>);
  fprintf(fp, <span class="stringliteral">&quot;%d %d %d\n&quot;</span>, Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>, Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a>, Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>);
  fprintf(fp, <span class="stringliteral">&quot;%d\n&quot;</span>, Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>);
  <span class="keywordflow">for</span> (k=0; k&lt;Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; k++)
    <span class="keywordflow">for</span> (i=0; i&lt;Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>[k]; i++) {
      idx = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>[k]+i;
      fprintf(fp,
              <span class="stringliteral">&quot;%2d  %+2d  (%12.8f,%12.8f)(%12.8f,%12.8f)  (%12.8f,%12.8f)  (%12.8f,%12.8f)(%12.8f,%12.8f)(%12.8f,%12.8f)\n&quot;</span>,
            k, Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#a3102697cdce1aedb094cd515f6cd5a47" title="isospin +/- 1 (proton/neutron)">xi</a>, 
            creal(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#a95da0e93add3c73c0fef74054aaf5c21" title="complex spinor, additional freedom to give norm and phase">chi</a>[0]), cimag(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#a95da0e93add3c73c0fef74054aaf5c21" title="complex spinor, additional freedom to give norm and phase">chi</a>[0]), 
            creal(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#a95da0e93add3c73c0fef74054aaf5c21" title="complex spinor, additional freedom to give norm and phase">chi</a>[1]), cimag(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#a95da0e93add3c73c0fef74054aaf5c21" title="complex spinor, additional freedom to give norm and phase">chi</a>[1]),
            creal(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#a4d7abfae9328f879eb63aa513d57fd74" title="complex width">a</a>), cimag(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#a4d7abfae9328f879eb63aa513d57fd74" title="complex width">a</a>),
            creal(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[0]), cimag(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[0]),
            creal(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[1]), cimag(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[1]),
            creal(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[2]), cimag(Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>[idx].<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[2]));
  }

  fprintf(fp, <span class="stringliteral">&quot;&lt;/SlaterDet&gt;\n&quot;</span>);
}
</pre></div></p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
