<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/MultiSlaterDet.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>fmd/MultiSlaterDet.h File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;complex.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Projection_8h_source.html">Projection.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Observables_8h_source.html">Observables.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Symmetry_8h_source.html">Symmetry.h</a>&quot;</code><br/>

<p><a href="MultiSlaterDet_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structIndices.html">Indices</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__MSD__.html">_MSD_</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#a5de5d183f9a6a8d53316f743e1ca6dc2">NMAX</a>&nbsp;&nbsp;&nbsp;10</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__MSD__.html">_MSD_</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#afa20607e9538b1c53c88d17d218cbc82">MultiSlaterDet</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#aeb9c0b0c54f48ada63a9c1b8b7683e2e">extractIndicesfromString</a> (char **str, <a class="el" href="structIndices.html">Indices</a> *Ind)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#a91d5b4deab687d45ccd81990914b95e4">IndicestoStr</a> (const <a class="el" href="structIndices.html">Indices</a> *Ind)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#a74a52c6573866d58f51e7733bef5a678">readMultiSlaterDetfromFile</a> (<a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structIndices.html">Indices</a> *Ind, const char *fname)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#a90a9f616d6587aeb3d8dbd44258110b5">initprojectedMultiMBME</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *QA, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *QB)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#a4d3438d9bba7d7c79b1b52398f94de62">readprojectedMultiMBMEfromFile</a> (const char *mbfilea, const char *mbfileb, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *QA, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *QB, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, void **obsme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#aa0b1e0fbd816be9bd0e25a7907cd8ae4">calcprojectedMultiMBME</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *QA, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *QB, void **obsme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#a93c3e43f7fe22b20cbe9c9a4c49cd998">writeprojectedMultiMBMEtoFile</a> (const char *mbfilea, const char *mbfileb, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *QA, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *QB, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, void **obsme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#a8d9d4a5da3d20043389d0dad8d149388">calcMultiEigenstatesMulti</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structInteraction.html">Interaction</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ae051dcd567638cf29379a3fec796679c">Int</a>, const <a class="el" href="structObservablesod.html">Observablesod</a> ****obs, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Ep, const <a class="el" href="structIndices.html">Indices</a> *In, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, <a class="el" href="structEigenstates.html">Eigenstates</a> *multiE, <a class="el" href="structAmplitudes.html">Amplitudes</a> *multiA, double thresh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#ae3b59c98a5fc7bfa57943a16433bf36d">calcexpectprojectedMultiMBME</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const void *mbme, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structIndices.html">Indices</a> *In, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E, void *expectmbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#a72a97049ab2b6317d1ca1d48389d3816">calctransitionprojectedMultiMBME</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const void *mbme, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structIndices.html">Indices</a> *In, const <a class="el" href="structIndices.html">Indices</a> *Inp, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, int np, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Ep, void *transmbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#acb8c1ee49806f2cf7cee284464ecf981">writeMultiEigenstatestoFile</a> (const char *fname, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const char *mbfile, const <a class="el" href="structIndices.html">Indices</a> *In, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#aa0927c7080e17e5af785de468357bd6c">writeMultiMulticonfigfile</a> (const char *fname, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const char **mbfile, const <a class="el" href="structIndices.html">Indices</a> *In, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="MultiSlaterDet_8h.html#ac81ab06089de20c64b4f14d7309d3b8d">readMultiMulticonfigfile</a> (const char *fname, char ***mbfilep, <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> **<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="structIndices.html">Indices</a> **Inp, int *nstates, <a class="el" href="structEigenstates.html">Eigenstates</a> *E)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>set of Many-body states described by multiple Slaterdets</p>
<p>(c) 2005 Thomas Neff </p>

<p>Definition in file <a class="el" href="MultiSlaterDet_8h_source.html">MultiSlaterDet.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a5de5d183f9a6a8d53316f743e1ca6dc2"></a><!-- doxytag: member="MultiSlaterDet.h::NMAX" ref="a5de5d183f9a6a8d53316f743e1ca6dc2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NMAX&nbsp;&nbsp;&nbsp;10</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>generic description of a set of N many-body states described by a common set of n Slater determinants </p>

<p>Definition at line <a class="el" href="MultiSlaterDet_8h_source.html#l00027">27</a> of file <a class="el" href="MultiSlaterDet_8h_source.html">MultiSlaterDet.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="afa20607e9538b1c53c88d17d218cbc82"></a><!-- doxytag: member="MultiSlaterDet.h::MultiSlaterDet" ref="afa20607e9538b1c53c88d17d218cbc82" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__MSD__.html">_MSD_</a> <a class="el" href="struct__MSD__.html">MultiSlaterDet</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8h_source.html#l00046">46</a> of file <a class="el" href="MultiSlaterDet_8h_source.html">MultiSlaterDet.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae3b59c98a5fc7bfa57943a16433bf36d"></a><!-- doxytag: member="MultiSlaterDet.h::calcexpectprojectedMultiMBME" ref="ae3b59c98a5fc7bfa57943a16433bf36d" args="(const Projection *P, const ManyBodyOperator *Op, const void *mbme, const MultiSlaterDet *Q, const Indices *In, int n, const Eigenstates *E, void *expectmbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcexpectprojectedMultiMBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIndices.html">Indices</a> *&nbsp;</td>
          <td class="paramname"> <em>In</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>expectmbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00727">727</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00032">Indices::idx</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00030">Indices::N</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00031">Indices::n</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00040">_MSD_::symmetry</a>, <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>, and <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlapmulti_8c_source.html#l00087">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> p,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,i;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, k1, k2;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, r, nu;
  <span class="keywordtype">int</span> idx;
  <span class="keywordtype">int</span> rank=Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  <span class="keywordtype">int</span> size=Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  complex double (****me)[(rank+1)*size] = mbme;
  complex double (**expme)[size] = expectmbme;
 
  <span class="keywordtype">int</span> dimj;
  <span class="keywordtype">int</span> a, b, aa, bb;
  <span class="keywordtype">int</span> idxa, idxb;
  <span class="keywordtype">int</span> Idxaa, Idxbb;
  <a class="code" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sa, Sb;

  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {

      idx = idxpij(jmax,p,j);
      dimj=E-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>*(j+1);
      <span class="keywordflow">for</span> (i=0; i&lt;E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[idx]; i++) {

        <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
          expme[idx][i][l] = 0.0;
        
        idxb=-1;
        <span class="keywordflow">for</span> (b=0; b&lt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; b++)
          <span class="keywordflow">for</span> (bb=0; bb&lt;In[b].<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>; bb++) {
            idxb++;
            Idxbb = In[b].<a class="code" href="structIndices.html#ac1c3f9f2bca1f1934a43e9def6599a4f">idx</a>[bb];
            Sb = Q[b].<a class="code" href="struct__MSD__.html#a34f5b97aa2ded110084030cb5128620f" title="Symmetry.">symmetry</a>(&amp;Q[b], Idxbb);
            <span class="keywordflow">for</span> (k2=-j; k2&lt;=j; k2=k2+2) {
              idxa=-1;
              <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
                <span class="keywordflow">for</span> (aa=0; aa&lt;In[a].<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>; aa++) {
                  idxa++;
                  Idxaa = In[a].<a class="code" href="structIndices.html#ac1c3f9f2bca1f1934a43e9def6599a4f">idx</a>[aa];
                  Sa = Q[a].<a class="code" href="struct__MSD__.html#a34f5b97aa2ded110084030cb5128620f" title="Symmetry.">symmetry</a>(&amp;Q[a], Idxaa);
                  <span class="keywordflow">for</span> (k1=-j; k1&lt;=j; k1=k1+2)       
                    <span class="keywordflow">for</span> (k=max(-j,k1-rank); k&lt;=min(j,k1+rank); k=k+2) {
                      nu=k1-k;
                      <span class="keywordflow">if</span> (<a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sa, p, j, k1) &amp;&amp;
                          <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sb, p, j, k2)) {
                        <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                          expme[idx][i][l] +=
                            <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(j, rank, j, k, nu, k1)*
                            me[a+b*n][Idxaa+Idxbb*In[a].<a class="code" href="structIndices.html#abfe5e6bb66f0da8ad7d27585ea390c01" title="out of N many-body states">N</a>][idx][idxjmk(j,k,k2)][(nu+rank)/2+l*(rank+1)]*
                            conj(E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[idx][idxjm(j,k1) + idxa*(j+1) + i*dimj])*
                            E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[idx][idxjm(j,k2)+ idxb*(j+1) + i*dimj];
                      }
                    }
                }               
            }
          }
      }
    }                   
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8d9d4a5da3d20043389d0dad8d149388"></a><!-- doxytag: member="MultiSlaterDet.h::calcMultiEigenstatesMulti" ref="a8d9d4a5da3d20043389d0dad8d149388" args="(const Projection *P, const Interaction *Int, const Observablesod ****obs, const Eigenstates *Ep, const Indices *In, int n, Eigenstates *multiE, Amplitudes *multiA, double thresh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcMultiEigenstatesMulti </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structInteraction.html">Interaction</a> *&nbsp;</td>
          <td class="paramname"> <em>Int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structObservablesod.html">Observablesod</a> ****&nbsp;</td>
          <td class="paramname"> <em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIndices.html">Indices</a> *&nbsp;</td>
          <td class="paramname"> <em>In</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>multiE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structAmplitudes.html">Amplitudes</a> *&nbsp;</td>
          <td class="paramname"> <em>multiA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>thresh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00563">563</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00155">Amplitudes::amp</a>, <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="cmat_8c_source.html#l00264">generalizedeigensystem()</a>, <a class="el" href="Observables_8h_source.html#l00040">Observablesod::h</a>, <a class="el" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00032">Indices::idx</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="Observables_8h_source.html#l00039">Observablesod::n</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00030">Indices::N</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00031">Indices::n</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="Projection_8h_source.html#l00154">Amplitudes::ngood</a>, <a class="el" href="Projection_8h_source.html#l00146">Eigenstates::ngood</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00143">Eigenstates::v</a>, <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00121">V</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiprojmulti_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=multiE-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>;
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;

  complex <span class="keywordtype">double</span>* <a class="code" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(dim*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  complex <span class="keywordtype">double</span>* <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(dim*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  complex <span class="keywordtype">double</span>* v = malloc(dim*(jmax+1)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  complex <span class="keywordtype">double</span>* <a class="code" href="MinimizerDONLP2multivapp_8c.html#ada7b84dafb505b22eca2753ef852e94a">V</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(dim*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  
  <span class="keywordtype">int</span> a, aa, b, bb;
  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, ipj, i, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;
  <span class="keywordtype">int</span> smalldim, fulldim, d;
  <span class="keywordtype">int</span> ai, bi, iai, ibi, idxa, idxb, idxai, idxbi;
  <span class="keywordtype">double</span> norma2, normb2, normi2;

  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
      fulldim = dim*(j+1);

      ipj=idxpij(jmax,p,j);

      <span class="comment">// how many good basis states do we really have ?</span>
      smalldim=0;
      idxa=-1;
      <span class="keywordflow">for</span> (a=0; a&lt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; a++)
        <span class="keywordflow">for</span> (aa=0; aa&lt;In[a].<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>; aa++) {
          idxa++;
          smalldim += Ep[idxa].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj];
        }

      <span class="comment">// do we have at least a one-dimensional space</span>
      <span class="keywordflow">if</span> (smalldim == 0) {
        multiE-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[ipj] = 0;
      } <span class="keywordflow">else</span> {

        idxb=-1; idxbi=-1;
        <span class="keywordflow">for</span> (b=0; b&lt;n; b++)
          <span class="keywordflow">for</span> (bb=0; bb&lt;In[b].<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>; bb++) {
            idxb++;
            <span class="keywordflow">for</span> (bi=0; bi&lt;Ep[idxb].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj]; bi++) {
              ibi=Ep[idxb].<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipj][bi];
              normb2=Ep[idxb].<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][ibi];
              idxbi++;
              idxa=-1; idxai=-1;
              <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
                <span class="keywordflow">for</span> (aa=0; aa&lt;In[a].<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>; aa++) {
                  idxa++;
                  <span class="keywordflow">for</span> (ai=0; ai&lt;Ep[idxa].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj]; ai++) {
                    iai=Ep[idxa].<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipj][ai];
                    norma2=Ep[idxa].<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][iai];
                    idxai++;
                    N[idxai+idxbi*smalldim] = 0.0;
                    H[idxai+idxbi*smalldim] = 0.0;

                    <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
                      <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2) {
                        N[idxai+idxbi*smalldim] +=
                          conj(Ep[idxa].V[ipj][idxjm(j,m)+iai*(j+1)])*
                          obsme[a+b*n][In[a].<a class="code" href="structIndices.html#ac1c3f9f2bca1f1934a43e9def6599a4f">idx</a>[aa]+In[b].<a class="code" href="structIndices.html#ac1c3f9f2bca1f1934a43e9def6599a4f">idx</a>[bb]*In[a].<a class="code" href="structIndices.html#abfe5e6bb66f0da8ad7d27585ea390c01" title="out of N many-body states">N</a>][ipj][idxjmk(j,m,k)].n*
                          Ep[idxb].<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][idxjm(j,k)+ibi*(j+1)]/
                          sqrt(norma2*normb2);
                         
                        H[idxai+idxbi*smalldim] +=
                          conj(Ep[idxa].V[ipj][idxjm(j,m)+iai*(j+1)])*
                          obsme[a+b*n][In[a].<a class="code" href="structIndices.html#ac1c3f9f2bca1f1934a43e9def6599a4f">idx</a>[aa]+In[b].<a class="code" href="structIndices.html#ac1c3f9f2bca1f1934a43e9def6599a4f">idx</a>[bb]*In[a].<a class="code" href="structIndices.html#abfe5e6bb66f0da8ad7d27585ea390c01" title="out of N many-body states">N</a>][ipj][idxjmk(j,m,k)].h*
                          Ep[idxb].<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][idxjm(j,k)+ibi*(j+1)]/
                          sqrt(norma2*normb2);  

                      }
                  }
                }
            }   
          }                   

        <a class="code" href="cmat_8c.html#aab30acd19149c3014405da4f585d4bb5">generalizedeigensystem</a>(H, N, smalldim, thresh, 
                               v, V, 
                               &amp;d);

        <span class="comment">// embed solution into full space</span>

        <span class="comment">// real dimension of eigenspace, may be smaller than smalldim</span>
        multiE-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[ipj] = d;

        <span class="keywordflow">for</span> (i=0; i&lt;d; i++) {
          multiE-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[ipj][i] = v[i];

          idxa=-1;
          <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
            <span class="keywordflow">for</span> (aa=0; aa&lt;In[a].<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>; aa++) {
              idxa++;
              <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
                multiE-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][idxjm(j,k)+idxa*(j+1)+i*fulldim] = 0.0;
            }

          idxa=-1; idxai=-1;
          <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
            <span class="keywordflow">for</span> (aa=0; aa&lt;In[a].<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>; aa++) {
              idxa++;
              <span class="keywordflow">for</span> (ai=0; ai&lt;Ep[idxa].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj]; ai++) {
                idxai++;
                iai = Ep[idxa].<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipj][ai];
                norma2 = Ep[idxa].<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][iai];

                <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2) {

                  multiE-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][idxjm(j,k)+idxa*(j+1)+i*fulldim] += 
                    Ep[idxa].V[ipj][idxjm(j,k)+iai*(j+1)]/sqrt(norma2)*
                    V[idxai+i*smalldim];
                }
              }                               
            }
        }

        <span class="comment">// calculate Amplitudes</span>

        <span class="keywordflow">for</span> (i=0; i&lt;d; i++) {

          normi2 = 0.0;
          <span class="keywordflow">for</span> (idxbi=0; idxbi&lt;smalldim; idxbi++)
            <span class="keywordflow">for</span> (idxai=0; idxai&lt;smalldim; idxai++)
              normi2 += conj(V[idxai+i*smalldim])*
                N[idxai+idxbi*smalldim]*V[idxbi+i*smalldim];

          multiE-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][i] = normi2;

          idxa=-1; idxai=-1;
          <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
            <span class="keywordflow">for</span> (aa=0; aa&lt;In[a].<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>; aa++) {
              idxa++;

              multiA-&gt;<a class="code" href="structAmplitudes.html#a3192b8e5338e5ac43d813833b09ad221">ngood</a>[ipj][idxa] = Ep[idxa].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj];
          
              <span class="keywordflow">for</span> (ai=0; ai&lt;Ep[idxa].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj]; ai++) {
                idxai++;
                norma2 = N[idxai+idxai*smalldim];
                multiA-&gt;<a class="code" href="structAmplitudes.html#a1608d319a33b0263e17f0ac70993cce2">amp</a>[ipj][ai+idxa*(j+1)+i*fulldim] = 0.0;
                <span class="keywordflow">for</span> (idxbi=0; idxbi&lt;smalldim; idxbi++)
                  multiA-&gt;<a class="code" href="structAmplitudes.html#a1608d319a33b0263e17f0ac70993cce2">amp</a>[ipj][ai+idxa*(j+1)+i*fulldim] +=
                    N[idxai+idxbi*smalldim]*V[idxbi+i*smalldim]/
                    sqrt(norma2*normi2);
              }
            }
        }
        
      }

   }

  free(H); free(N);
  free(v); free(V);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa0b1e0fbd816be9bd0e25a7907cd8ae4"></a><!-- doxytag: member="MultiSlaterDet.h::calcprojectedMultiMBME" ref="aa0b1e0fbd816be9bd0e25a7907cd8ae4" args="(const Projection *P, const ManyBodyOperator *Op, const MultiSlaterDet *QA, const MultiSlaterDet *QB, void **obsme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcprojectedMultiMBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>QA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>QB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&nbsp;</td>
          <td class="paramname"> <em>obsme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00307">307</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="cmprojection_8c_source.html#l00128">_estimateacm()</a>, <a class="el" href="angprojection_8c_source.html#l00092">_estimateangkappa()</a>, <a class="el" href="angprojection_8c_source.html#l00125">_getangkappacrit()</a>, <a class="el" href="angprojection_8c_source.html#l00131">_initangintegration()</a>, <a class="el" href="cmprojection_8c_source.html#l00147">_initcmintegration()</a>, <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00037">_MSD_::A</a>, <a class="el" href="SlaterDet_8c_source.html#l00032">allocateSlaterDet()</a>, <a class="el" href="SlaterDet_8c_source.html#l00405">allocateSlaterDetAux()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00107">alpha</a>, <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00108">angpara</a>, <a class="el" href="Symmetry_8h_source.html#l00020">axial</a>, <a class="el" href="SlaterDet_8c_source.html#l00468">calcSlaterDetAuxod()</a>, <a class="el" href="SlaterDet_8c_source.html#l00180">copySlaterDet()</a>, <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="angprojection_8c_source.html#l00077">freeAngintegration()</a>, <a class="el" href="cmprojection_8c_source.html#l00298">freecmintegration()</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00042">_MSD_::get</a>, <a class="el" href="angprojection_8c_source.html#l00250">getangintegrationpoint()</a>, <a class="el" href="cmprojection_8c_source.html#l00305">getcmintegrationpoint()</a>, <a class="el" href="SlaterDet_8c_source.html#l00350">invertSlaterDet()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00303">MAX</a>, <a class="el" href="Projection_8h_source.html#l00118">ManyBodyOperator::me</a>, <a class="el" href="SlaterDet_8c_source.html#l00255">moveSlaterDet()</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="Projection_8h_source.html#l00083">angintegrationpara::n</a>, <a class="el" href="Projection_8h_source.html#l00041">cmintegrationpara::n</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00038">_MSD_::N</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00039">_MSD_::n</a>, <a class="el" href="MinimizerDONLP2vappcm_8c_source.html#l00104">ncm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00117">ManyBodyOperator::par</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00076">Q</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00130">Qp</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00131">Qpp</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="SlaterDet_8c_source.html#l00294">rotateSlaterDet()</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00040">_MSD_::symmetry</a>, <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>, <a class="el" href="Symmetry_8c_source.html#l00076">SymmetrytoStr()</a>, <a class="el" href="donlp2_8h_source.html#l00057">val</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00041">_MSD_::weight</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00077">X</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlapmulti_8c_source.html#l00087">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> size=Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  <span class="keywordtype">int</span> rank=Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  complex double (***<a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>)[(rank+1)*size] = mbme;

  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> odd = P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;

  <span class="comment">// loop over the individual SlaterDets in the MultiSlaterDets</span>
  <span class="keywordtype">int</span> nA = MBA-&gt;n; <span class="keywordtype">int</span> nB = MBB-&gt;n;
  <span class="keywordtype">int</span> iA, iB;

  <span class="keywordtype">int</span> NA = MBA-&gt;N; <span class="keywordtype">int</span> NB = MBB-&gt;N;
  <span class="keywordtype">int</span> IA, IB;

  <a class="code" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a> <a class="code" href="MinimizerDONLP2_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a9e0195b1777800e72b4f7af51f0c3945">Qpp</a>;
  <a class="code" href="SlaterDet_8c.html#a0fe6e8eefc302957926038529e37e7c9" title="allocate memory for SlaterDet">allocateSlaterDet</a>(&amp;Q, MBA-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>);
  <a class="code" href="SlaterDet_8c.html#a0fe6e8eefc302957926038529e37e7c9" title="allocate memory for SlaterDet">allocateSlaterDet</a>(&amp;Qp, MBB-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>);
  <a class="code" href="SlaterDet_8c.html#a0fe6e8eefc302957926038529e37e7c9" title="allocate memory for SlaterDet">allocateSlaterDet</a>(&amp;Qpp, MBB-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>);

  <a class="code" href="structSlaterDetAux.html">SlaterDetAux</a> <a class="code" href="MinimizerDONLP2_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>;
  <a class="code" href="SlaterDet_8c.html#a6489b81747a0bf6bab1e09d136f45065" title="allocate memory for SlaterDetAux">allocateSlaterDetAux</a>(&amp;X, <a class="code" href="MultiSlaterDet_8c.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(MBA-&gt;A, MBB-&gt;A));

  <a class="code" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, Sp;
  <span class="keywordtype">int</span> axialsym;

  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, r;
  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;


  <span class="comment">// set matrix elements to zero</span>
  <span class="keywordflow">for</span> (IB=0; IB&lt;NB; IB++)
    <span class="keywordflow">for</span> (IA=0; IA&lt;NA; IA++)
      <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
        <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
          <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
            <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2)
              <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                <span class="keywordflow">for</span> (r=0; r&lt;=rank; r++)
                  <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[IA+IB*NA][idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)] = 0.0;
        }                       


  <span class="comment">// we need a common denominaotor for the NA*NB matrix elements</span>
  <span class="comment">// all states have axial symmetry ? use axial as indicator</span>
  <span class="comment">// also spherical will be tretated like axial</span>

  S=0;
  axialsym=1;
  <span class="keywordflow">for</span> (IA=0; IA&lt;NA; IA++)
    axialsym &amp;= hasAxialSymmetry(MBA-&gt;symmetry(MBA, IA));
  <span class="keywordflow">if</span> (axialsym)
    setSymmetry(&amp;S, <a class="code" href="Symmetry_8h.html#ab48899087cc647f0f791ed0c459adc53ab22f0ff9db3be11856d1b582fd09f474">axial</a>);

  Sp=0;
  axialsym=1;
  <span class="keywordflow">for</span> (IB=0; IB&lt;NB; IB++)
    axialsym &amp;= hasAxialSymmetry(MBB-&gt;symmetry(MBB, IB));
  <span class="keywordflow">if</span> (axialsym)
    setSymmetry(&amp;Sp, <a class="code" href="Symmetry_8h.html#ab48899087cc647f0f791ed0c459adc53ab22f0ff9db3be11856d1b582fd09f474">axial</a>);

  fprintf(stderr, <span class="stringliteral">&quot;Symmetry - MBA: %s, MBB: %s\n&quot;</span>, <a class="code" href="Symmetry_8c.html#a57aa62a08fd12aa6fd7da2355ffb0ea0" title="get String with Symmetry">SymmetrytoStr</a>(S), <a class="code" href="Symmetry_8c.html#a57aa62a08fd12aa6fd7da2355ffb0ea0" title="get String with Symmetry">SymmetrytoStr</a>(Sp)); 

  <span class="keywordtype">double</span> kappaA[nA], kappaB[nB];
  <span class="keywordtype">double</span> acmA[nA], acmB[nB];
  
  <span class="keywordflow">for</span> (iA=0; iA&lt;nA; iA++) {
    MBA-&gt;get(MBA, iA, &amp;Q);
    kappaA[iA] = <a class="code" href="angprojection_8c.html#a96407d07755537e4db8a7047f7a3549d">_estimateangkappa</a>(&amp;Q);
    acmA[iA] = <a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(&amp;Q);
  }

  <span class="keywordflow">for</span> (iB=0; iB&lt;nB; iB++) {
    MBB-&gt;get(MBB, iB, &amp;Qp);
    kappaB[iB] = <a class="code" href="angprojection_8c.html#a96407d07755537e4db8a7047f7a3549d">_estimateangkappa</a>(&amp;Qp);
    acmB[iB] = <a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(&amp;Qp);
  }

  fprintf(stderr, <span class="stringliteral">&quot;kappacrit: %6.2f\n&quot;</span>, <a class="code" href="angprojection_8c.html#a58a9090fd80baea2ab54d2032e2531fd">_getangkappacrit</a>());
  fprintf(stderr, <span class="stringliteral">&quot;kappa - MBA: [%6.2f - %6.2f], MBB: [%6.2f - %6.2f]\n&quot;</span>,
          dminarray(kappaA, nA), dmaxarray(kappaA, nA),
          dminarray(kappaB, nB), dmaxarray(kappaB, nB));


  <span class="keywordtype">int</span> c=0; 
  <span class="keywordtype">int</span> cmax=nA*nB; 

  <span class="keywordflow">for</span> (iB=0; iB&lt;nB; iB++) {
    MBB-&gt;get(MBB, iB, &amp;Qp);

    <span class="keywordflow">for</span> (iA=0; iA&lt;nA; iA++) {
      MBA-&gt;get(MBA, iA, &amp;Q);

      <span class="comment">// progress indicator</span>
      c++;
      <span class="keywordflow">if</span> (c%100==0) fprintf(stderr, <span class="stringliteral">&quot;%d%%&quot;</span>, (100*c)/cmax);
      <span class="keywordflow">if</span> (c%10==0) fprintf(stderr, <span class="stringliteral">&quot;.&quot;</span>);

      <span class="comment">// norms of SlaterDets</span>
      <span class="comment">// calcSlaterDetAuxod(&amp;Q, &amp;Q, &amp;X);</span>
      <span class="comment">// double norm = sqrt(creal(X.ovlap));</span>

      <span class="comment">// calcSlaterDetAuxod(&amp;Qp, &amp;Qp, &amp;X);</span>
      <span class="comment">// double normp = sqrt(creal(X.ovlap));  </span>

      <span class="comment">// set up cm integration</span>
      <a class="code" href="structcmintegrationpara.html">cmintegrationpara</a> <a class="code" href="structcmpara.html">cmpara</a>;
      <span class="keywordtype">double</span> cmalpha = 0.5/(acmA[iA]+acmB[iB]);
      <a class="code" href="cmprojection_8c.html#afd49fd9499450859075a07b9c48230d3">_initcmintegration</a>(P, cmalpha, &amp;cmpara);
      <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2vappcm_8c.html#a8a5e05e8fcc2b05354bff66fc1b1755c">ncm</a> = cmpara.<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>;

      <span class="comment">// set up ang integration</span>
      <a class="code" href="structangintegrationpara.html">angintegrationpara</a> <a class="code" href="MinimizerDONLP2multivappcm_8c.html#a49105e626fcbcb1b768fedd076a84bd6">angpara</a>;
      <span class="keywordtype">double</span> angkappa = dmin(kappaA[iA], kappaB[iB]);
      <a class="code" href="angprojection_8c.html#a80b9d82dadcaadc0a6026004285b49f4">_initangintegration</a>(P, angkappa, S, Sp, &amp;angpara);
      <span class="keywordtype">int</span> nang = angpara.<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a>;

      <span class="keywordtype">int</span> icm; 
      <span class="keywordtype">double</span> xcm[3]; <span class="keywordtype">double</span> weightcm;

      <span class="keywordtype">int</span> iang;
      <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, gamma; <span class="keywordtype">double</span> weightang;

      complex <span class="keywordtype">double</span> sval[(rank+1)*size];
      <span class="keywordtype">double</span> weight;
      <span class="keywordtype">int</span> ip;

      <span class="keywordflow">for</span> (icm=0; icm&lt;ncm; icm++) {
        <a class="code" href="cmprojection_8c.html#a4cde89930e46342aae042ab854f2290b">getcmintegrationpoint</a>(icm, &amp;cmpara, xcm, &amp;weightcm);

        <span class="keywordflow">for</span> (iang=0; iang&lt;nang; iang++) {
          <a class="code" href="angprojection_8c.html#a84c53149d9af0a652cb6486c9516cbb5">getangintegrationpoint</a>(iang, &amp;angpara, &amp;alpha, &amp;beta, &amp;gamma, &amp;weightang);
          <span class="comment">// weight = 1.0/(2*norm*normp)*weightcm*weightang;</span>
          weight = 0.5*weightcm*weightang;
      
          <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(&amp;Qp, &amp;Qpp);
          <a class="code" href="SlaterDet_8c.html#a5463a8afc7565b2711169b605aad5ca3" title="move Slater determinant by vector d">moveSlaterDet</a>(&amp;Qpp, xcm);
          <a class="code" href="SlaterDet_8c.html#a8737af9032a8d87843782a88228fef00" title="rotate Slater determinant by euler angles">rotateSlaterDet</a>(&amp;Qpp, alpha, beta, gamma);

          <span class="keywordflow">for</span> (ip=0; ip&lt;=1; ip++) {
            <span class="keywordflow">if</span> (ip) <a class="code" href="SlaterDet_8c.html#ad0aa11be18d42c1cc26c2ad1380feb2a" title="invert Slater determinant in origin">invertSlaterDet</a>(&amp;Qpp);

            <span class="comment">// can only calculate Auxiliaries if Sldets are compatible</span>
            <span class="keywordflow">if</span> (Q.<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> == Qp.<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> &amp;&amp; Q.<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> == Qp.<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> &amp;&amp; Q.<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a> == Qp.<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>)
              <a class="code" href="SlaterDet_8c.html#ad3679a655d9b6019619456e5b7961638">calcSlaterDetAuxod</a>(&amp;Q, &amp;Qpp, &amp;X);
            Op-&gt;<a class="code" href="structManyBodyOperator.html#aba2e7e550190ee2ec6e75c23c55fee2d">me</a>(Op-&gt;<a class="code" href="structManyBodyOperator.html#a05268b1b149040fd992263f2e22de7ec">par</a>, &amp;Q, &amp;Qpp, &amp;X, sval);

            complex <span class="keywordtype">double</span> w, wA, wB;
            <a class="code" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> SA, SB;
            <span class="keywordflow">for</span> (IB=0; IB&lt;NB; IB++) {
              SB = MBB-&gt;symmetry(MBB, IB);
              wB = MBB-&gt;weight(MBB, IB, iB);
              <span class="keywordflow">for</span> (IA=0; IA&lt;NA; IA++) {
                SA = MBA-&gt;symmetry(MBA, IA);
                wA = MBA-&gt;weight(MBA, IA, iA);
                <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
                  <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2)
                    <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
                      <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2) {
                        <span class="keywordflow">if</span> ((Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a> != 0 || <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(SA, p, j, m)) &amp;&amp;
                            <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(SB, p, j, k)) {
                          w = conj(wA)*wB*       
                            weight * (p &amp;&amp; ip%2 ? -1 : 1)*
                            (j+1)/(8*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(M_PI))*Djmkstar(j,m,k,alpha,beta,gamma);
                          <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                            <span class="keywordflow">for</span> (r=0; r&lt;=rank; r++)
                              <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[IA+IB*NA][idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)] += w*sval[r+l*(rank+1)];
                    }   
                  }
              }
            }   
          }

        }

      } 

      <a class="code" href="angprojection_8c.html#a5c0336acd3f2e1e48e88942a353129cd">freeAngintegration</a>(&amp;angpara);
      <a class="code" href="cmprojection_8c.html#a7ae9754fe9db92205d761777cfa5e336">freecmintegration</a>(&amp;cmpara);
      
    }
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a72a97049ab2b6317d1ca1d48389d3816"></a><!-- doxytag: member="MultiSlaterDet.h::calctransitionprojectedMultiMBME" ref="a72a97049ab2b6317d1ca1d48389d3816" args="(const Projection *P, const ManyBodyOperator *Op, const void *mbme, const MultiSlaterDet *Q, const MultiSlaterDet *Qp, const Indices *In, const Indices *Inp, int n, int np, const Eigenstates *E, const Eigenstates *Ep, void *transmbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calctransitionprojectedMultiMBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIndices.html">Indices</a> *&nbsp;</td>
          <td class="paramname"> <em>In</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIndices.html">Indices</a> *&nbsp;</td>
          <td class="paramname"> <em>Inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>transmbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00894">894</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00032">Indices::idx</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00030">Indices::N</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00031">Indices::n</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00114">ManyBodyOperator::pi</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00040">_MSD_::symmetry</a>, <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>, and <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>.</p>

<p>Referenced by <a class="el" href="calctransitionsmulti_8c_source.html#l00028">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> pini,jini,iini, pfin,jfin,ifin;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, kfin, kini;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, nu;
  <span class="keywordtype">int</span> p=Op-&gt;<a class="code" href="structManyBodyOperator.html#a78ec7c9f2238907255cf499427676907" title="parity of operator, 0 positve, 1 negative">pi</a>;
  <span class="keywordtype">int</span> size=Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  <span class="keywordtype">int</span> rank=Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  <span class="keywordtype">int</span> oddini=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  complex double (****me)[(rank+1)*size] = mbme;
  complex double (****transme)[size] = transmbme;

  <span class="keywordtype">int</span> afin, aini;
  <span class="keywordtype">int</span> aafin, aaini;
  <span class="keywordtype">int</span> dimini, dimfin;
  <span class="keywordtype">int</span> idxini, idxfin;
  <span class="keywordtype">int</span> idxaini, idxafin;
  <span class="keywordtype">int</span> Idxaaini, Idxaafin;
  <a class="code" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sini, Sfin;

  complex <span class="keywordtype">double</span>* meVwork = malloc(Efin-&gt;n*Eini-&gt;n*(jmax+1)*(jmax+1)*size*(rank+1)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (pini=0; pini&lt;=1; pini++)
    <span class="keywordflow">for</span> (jini=oddini; jini&lt;jmax; jini=jini+2) {
      
      idxini = idxpij(jmax,pini,jini);
      dimini=Eini-&gt;n*(jini+1);

      pfin=(pini+p)%2;
      <span class="keywordflow">for</span> (jfin=abs(jini-rank); jfin&lt;=min(jmax-1,jini+rank); jfin=jfin+2) {

        idxfin = idxpij(jmax,pfin,jfin);
        dimfin=Efin-&gt;n*(jfin+1);

        complex double (*meV)[dimini][(jini+1)][size*(rank+1)] = meVwork;

        <span class="keywordflow">for</span> (iini=0; iini&lt;Eini-&gt;dim[idxini]; iini++) {
          idxafin=-1;
          <span class="keywordflow">for</span> (afin=0; afin&lt;nfin; afin++)
            <span class="keywordflow">for</span> (aafin=0; aafin&lt;Infin[afin].n; aafin++) {
              idxafin++;
              <span class="keywordflow">for</span> (k=-jini; k&lt;=jini; k=k+2)
                <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                  <span class="keywordflow">for</span> (nu=-rank; nu&lt;=rank; nu=nu+2)
                    meV[idxafin][iini][idxjm(jini,k)][(nu+rank)/2+l*(rank+1)] = 0.0;
            }
        }

        <span class="keywordflow">for</span> (iini=0; iini&lt;Eini-&gt;dim[idxini]; iini++) {
          idxafin=-1;
          <span class="keywordflow">for</span> (afin=0; afin&lt;nfin; afin++)
            <span class="keywordflow">for</span> (aafin=0; aafin&lt;Infin[afin].n; aafin++) {
              idxafin++;
              Idxaafin = Infin[afin].idx[aafin];
              Sfin = Qfin[afin].symmetry(&amp;Qfin[afin], Idxaafin);

              <span class="keywordflow">for</span> (k=-jini; k&lt;=jini; k=k+2) {
                idxaini=-1;
                <span class="keywordflow">for</span> (aini=0; aini&lt;nini; aini++)
                  <span class="keywordflow">for</span> (aaini=0; aaini&lt;Inini[aini].n; aaini++) {
                    idxaini++;
                    Idxaaini = Inini[aini].idx[aaini];
                    Sini = Qini[aini].symmetry(&amp;Qini[aini], Idxaaini);

                    <span class="keywordflow">for</span> (kini=-jini; kini&lt;=jini; kini=kini+2)
                      <span class="keywordflow">if</span> (<a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sini, pini, jini, kini)) {
              
                        <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                          <span class="keywordflow">for</span> (nu=-rank; nu&lt;=rank; nu=nu+2)
                            meV[idxafin][iini][idxjm(jini,k)][(nu+rank)/2+l*(rank+1)] +=
                              me[afin+aini*nfin][Idxaafin+Idxaaini*Infin[afin].N][idxini][idxjmk(jini,k,kini)][(nu+rank)/2+l*(rank+1)]*
                              Eini-&gt;V[idxini][idxjm(jini,kini)+idxaini*(jini+1)+iini*dimini];
                      } 
                  }     
              }
            }
        }

        <span class="keywordflow">for</span> (iini=0; iini&lt;Eini-&gt;dim[idxini]; iini++)
          <span class="keywordflow">for</span> (ifin=0; ifin&lt;Efin-&gt;dim[idxfin]; ifin++) {

            <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
              transme[idxfin][idxini][ifin][iini][l] = 0.0;

            idxafin=-1;
            <span class="keywordflow">for</span> (afin=0; afin&lt;nfin; afin++)
              <span class="keywordflow">for</span> (aafin=0; aafin&lt;Infin[afin].n; aafin++) {
                idxafin++;
                Idxaafin = Infin[afin].idx[aafin];
                Sfin = Qfin[afin].symmetry(&amp;Qfin[afin], Idxaafin);
                      
                <span class="keywordflow">for</span> (kfin=-jfin; kfin&lt;=jfin; kfin=kfin+2)
                  <span class="keywordflow">for</span> (k=max(-jini,kfin-rank); k&lt;=min(jini,kfin+rank); k=k+2) {
                    nu = kfin-k;
                    <span class="keywordflow">if</span> (<a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sfin, pfin, jfin, kfin)) {
                      <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                        transme[idxfin][idxini][ifin][iini][l] +=
                          <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(jini, rank, jfin, k, nu, kfin)*
                          conj(Efin-&gt;V[idxfin][idxjm(jfin,kfin)+idxafin*(jfin+1)+ifin*dimfin])*
                          meV[idxafin][iini][idxjm(jini,k)][(nu+rank)/2+l*(rank+1)];
                    }     
                  }
              }  
          }     
      }
    }

  free(meVwork);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aeb9c0b0c54f48ada63a9c1b8b7683e2e"></a><!-- doxytag: member="MultiSlaterDet.h::extractIndicesfromString" ref="aeb9c0b0c54f48ada63a9c1b8b7683e2e" args="(char **str, Indices *Ind)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void extractIndicesfromString </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIndices.html">Indices</a> *&nbsp;</td>
          <td class="paramname"> <em>Ind</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00041">41</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="MultiSlaterDet_8h_source.html#l00032">Indices::idx</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00031">Indices::n</a>, and <a class="el" href="MultiSlaterDet_8h_source.html#l00030">Indices::N</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlapmulti_8c_source.html#l00087">main()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l01088">readMultiMulticonfigfile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  Ind-&gt;<a class="code" href="structIndices.html#abfe5e6bb66f0da8ad7d27585ea390c01" title="out of N many-body states">N</a> = 0;
  Ind-&gt;<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a> = 0;
  <span class="keywordflow">for</span> (i=0; i&lt;NMAX; i++)
    Ind-&gt;<a class="code" href="structIndices.html#ac1c3f9f2bca1f1934a43e9def6599a4f">idx</a>[i] = 0;

  <span class="keywordtype">char</span> *c, *s = *str;

  i = 0;
  <span class="keywordflow">while</span>(1) {
    c = strtok(s, <span class="stringliteral">&quot;: &gt;&quot;</span>);

    <span class="keywordflow">if</span> (c == NULL) {
      *str = NULL;
      <span class="keywordflow">return</span>;
    }

    <span class="keywordflow">if</span> (isdigit(*c)) 
      Ind-&gt;<a class="code" href="structIndices.html#ac1c3f9f2bca1f1934a43e9def6599a4f">idx</a>[i++] = atoi(c);
    <span class="keywordflow">else</span> {
      Ind-&gt;<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a> = i;
      *str = c;
      <span class="keywordflow">return</span>;
    }
    s = NULL;
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a91d5b4deab687d45ccd81990914b95e4"></a><!-- doxytag: member="MultiSlaterDet.h::IndicestoStr" ref="a91d5b4deab687d45ccd81990914b95e4" args="(const Indices *Ind)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* IndicestoStr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structIndices.html">Indices</a> *&nbsp;</td>
          <td class="paramname"> <em>Ind</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00073">73</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="MultiSlaterDet_8h_source.html#l00031">Indices::n</a>, and <a class="el" href="MultiSlaterDet_8h_source.html#l00030">Indices::N</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l01017">writeMultiEigenstatestoFile()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l01051">writeMultiMulticonfigfile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span>* str;

  str = malloc(20*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
  str[0] = <span class="charliteral">&#39;\0&#39;</span>;

  <span class="comment">// all indices means empty string</span>
  <span class="keywordflow">if</span> (Ind-&gt;<a class="code" href="structIndices.html#abfe5e6bb66f0da8ad7d27585ea390c01" title="out of N many-body states">N</a> == Ind-&gt;<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>)
    <span class="keywordflow">return</span> str;
    
  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;Ind-&gt;<a class="code" href="structIndices.html#a6d98d6fb921dd51862b4164cb09d6515" title="describe n many-body states">n</a>; i++)
    sprintf(str, <span class="stringliteral">&quot;%s%d:&quot;</span>, str, i);
  
  str[strlen(str)-1] = <span class="charliteral">&#39;\0&#39;</span>;
  <span class="keywordflow">return</span> str;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a90a9f616d6587aeb3d8dbd44258110b5"></a><!-- doxytag: member="MultiSlaterDet.h::initprojectedMultiMBME" ref="a90a9f616d6587aeb3d8dbd44258110b5" args="(const Projection *P, const ManyBodyOperator *Op, const MultiSlaterDet *QA, const MultiSlaterDet *QB)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* initprojectedMultiMBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>QA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>QB</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00176">176</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="Projection_8c_source.html#l00309">initprojectedMBME()</a>, and <a class="el" href="MultiSlaterDet_8h_source.html#l00038">_MSD_::N</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlapmulti_8c_source.html#l00087">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> NA = MBA-&gt;N;
  <span class="keywordtype">int</span> NB = MBB-&gt;N;

  <span class="keywordtype">void</span>** me = malloc(NA*NB*<span class="keyword">sizeof</span>(<span class="keywordtype">void</span>*));
  
  <span class="keywordtype">int</span> iA, iB;
  <span class="keywordflow">for</span> (iB=0; iB&lt;NB; iB++)
    <span class="keywordflow">for</span> (iA=0; iA&lt;NA; iA++)
      me[iA+iB*NA] = <a class="code" href="Projection_8c.html#acef8d2b9b483edf18c061e6c4fb464d2" title="store projected MEs between two ManyBody states">initprojectedMBME</a>(P, Op);

  <span class="keywordflow">return</span> me;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac81ab06089de20c64b4f14d7309d3b8d"></a><!-- doxytag: member="MultiSlaterDet.h::readMultiMulticonfigfile" ref="ac81ab06089de20c64b4f14d7309d3b8d" args="(const char *fname, char ***mbfilep, Projection *P, MultiSlaterDet **Qp, Indices **Inp, int *nstates, Eigenstates *E)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readMultiMulticonfigfile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char ***&nbsp;</td>
          <td class="paramname"> <em>mbfilep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__MSD__.html">MultiSlaterDet</a> **&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIndices.html">Indices</a> **&nbsp;</td>
          <td class="paramname"> <em>Inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>nstates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l01088">1088</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="MultiSlaterDet_8h_source.html#l00037">_MSD_::A</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00094">BUFSIZE</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00041">extractIndicesfromString()</a>, <a class="el" href="Projection_8c_source.html#l00102">initProjection()</a>, <a class="el" href="utils_8c_source.html#l00183">md5hash()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00108">projpar</a>, <a class="el" href="Projection_8c_source.html#l01681">readEigenstates()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l00096">readMultiSlaterDetfromFile()</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlapmulti_8c_source.html#l00087">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  FILE* fp;
  <span class="keywordtype">char</span> buf[BUFSIZE];
  <span class="keywordtype">int</span> i, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
  <span class="keywordtype">char</span> msldetfname[255], md5msldetfname[33];

  <span class="keywordflow">if</span> (!(fp = fopen(fname, <span class="stringliteral">&quot;r&quot;</span>))) {
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for reading\n&quot;</span>, fname);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">// get the Projection parameters</span>
  <span class="keywordflow">do</span>    
    fgets(buf, <a class="code" href="MultiSlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
  <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;Multiconfprojected &quot;</span>, 19) &amp;&amp; !feof(fp));
  <span class="keywordflow">if</span> (feof(fp)) {
    fprintf(stderr, <span class="stringliteral">&quot;didn&#39;t find &lt;Multiconfprojected ...&gt;\n&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>;
  <span class="keywordtype">char</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>[40];
  sscanf(buf, <span class="stringliteral">&quot;&lt;Multiconfprojected %d %d %s&gt;&quot;</span>, &amp;n, &amp;dim, projpar);
  *nstates = n;

  <span class="comment">// read the Slater determinants</span>
  *mbfilep = (<span class="keywordtype">char</span>**) malloc(n*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *));
  <span class="keywordflow">for</span> (i=0; i&lt;n; i++)
    (*mbfilep)[i] = (<span class="keywordtype">char</span>*) malloc(255*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
  *Qp = malloc(n*<span class="keyword">sizeof</span>(<a class="code" href="struct__MSD__.html">MultiSlaterDet</a>));
  *Inp = malloc(n*<span class="keyword">sizeof</span>(<a class="code" href="structIndices.html">Indices</a>));
  <span class="keywordtype">char</span>* fileIn = malloc(255*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
  <span class="keywordflow">for</span> (i=0; i&lt;n; i++) {
    <span class="keywordflow">do</span>  
      fgets(buf, <a class="code" href="MultiSlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
    <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;MBFile &quot;</span>, 7) &amp;&amp; !feof(fp));
    <span class="keywordflow">if</span> (feof(fp)) {
      fprintf(stderr, <span class="stringliteral">&quot;...   did&#39;t find &lt;SlaterDetFile ...&gt;\n&quot;</span>);
      fclose(fp);
      <span class="keywordflow">return</span> -1;
    }
    sscanf(buf, <span class="stringliteral">&quot;&lt;MBFile %s %s %s&gt;&quot;</span>, msldetfname, md5msldetfname, fileIn);
    <a class="code" href="MultiSlaterDet_8c.html#aeb9c0b0c54f48ada63a9c1b8b7683e2e">extractIndicesfromString</a>(&amp;fileIn, &amp;(*Inp)[i]);
    <span class="keywordflow">if</span> (strncmp(md5msldetfname, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(msldetfname), 32)) {
      fprintf(stderr, <span class="stringliteral">&quot;...    MultiSlaterDetFile %s changed\n&quot;</span>, msldetfname);
      <span class="keywordflow">return</span> -1;
    }
    strcpy((*mbfilep)[i], msldetfname);
    <span class="keywordflow">if</span> (<a class="code" href="MultiSlaterDet_8c.html#a1314981c2216f7ca18928d2679178535">readMultiSlaterDetfromFile</a>(&amp;(*Qp)[i], &amp;(*Inp)[i], msldetfname))
      <span class="keywordflow">return</span> -1;
  }
  
  <span class="comment">// odd or even ?</span>
  <span class="keywordtype">int</span> odd = Qp[0]-&gt;<a class="code" href="struct__MSD__.html#a999772a06b90565150e39f99d8429589" title="particle number">A</a> % 2;

  <span class="comment">// initialize Projection</span>
  <a class="code" href="Projection_8c.html#a8933a4a47f0572f2e2943562cd45aac5">initProjection</a>(P, odd, projpar);

  <span class="comment">// read the Eigenstates</span>
  <span class="keywordflow">if</span> (<a class="code" href="Projection_8c.html#a21bd7a5920ce98dea99f5ecbe591b799">readEigenstates</a>(fp, P, E, dim))
    <span class="keywordflow">return</span> -1;

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a74a52c6573866d58f51e7733bef5a678"></a><!-- doxytag: member="MultiSlaterDet.h::readMultiSlaterDetfromFile" ref="a74a52c6573866d58f51e7733bef5a678" args="(MultiSlaterDet *Q, Indices *Ind, const char *fname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readMultiSlaterDetfromFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIndices.html">Indices</a> *&nbsp;</td>
          <td class="paramname"> <em>Ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fname</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00096">96</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="MultiSlaterDet_8c_source.html#l00094">BUFSIZE</a>, <a class="el" href="DiClusterMulticonfig_8c_source.html#l00362">DiClusterMulticonfigRead()</a>, <a class="el" href="DiClusterMultiProjSlaterDet_8c_source.html#l00253">DiClusterMultiProjSlaterDetRead()</a>, <a class="el" href="DiClusterProjParSlaterDet_8c_source.html#l00155">DiClusterProjSlaterDetRead()</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00032">Indices::idx</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00031">Indices::n</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00038">_MSD_::N</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00030">Indices::N</a>, <a class="el" href="SimpleSlaterDet_8c_source.html#l00063">SimpleSlaterDetRead()</a>, <a class="el" href="utils_8c_source.html#l00087">stripstr()</a>, <a class="el" href="SymmetricMultiSlaterDet_8c_source.html#l00072">SymmetricMultiSlaterDetRead()</a>, and <a class="el" href="SymmetricSlaterDet_8c_source.html#l00069">SymmetricSlaterDetRead()</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlapmulti_8c_source.html#l00087">main()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l01088">readMultiMulticonfigfile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  FILE* fp;

  <span class="keywordflow">if</span> (!(fp = fopen(fname, <span class="stringliteral">&quot;r&quot;</span>))) {  
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for reading\n&quot;</span>, fname);
    <span class="keywordflow">return</span> -1;
  }

  fprintf(stderr, <span class="stringliteral">&quot;... reading MultiSlaterDet from file %s\n&quot;</span>, fname);

  <span class="keywordtype">char</span> buf[BUFSIZE];

  <span class="keywordflow">do</span>
    fgets(buf, <a class="code" href="MultiSlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
  <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;SlaterDet&quot;</span>, 10) &amp;&amp; 
         strncmp(buf, <span class="stringliteral">&quot;&lt;MultiSlaterDet&quot;</span>, 14) &amp;&amp; !feof(fp));
  <span class="keywordflow">if</span> (feof(fp)) {
    fprintf(stderr, <span class="stringliteral">&quot;did&#39;t find &lt;MultiSlaterDet ...&gt;\n&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">// simple SlaterDet</span>
  <span class="keywordflow">if</span> (!strncmp(buf, <span class="stringliteral">&quot;&lt;SlaterDet&gt;&quot;</span>, 11)) {
    rewind(fp);
    <span class="keywordflow">if</span> (<a class="code" href="SimpleSlaterDet_8c.html#ad5dcd8ae4325fdbed69ab9156970e326">SimpleSlaterDetRead</a>(fp, MB))
      <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">else</span> {
    <span class="keywordtype">char</span> Mname[80];
    sscanf(buf, <span class="stringliteral">&quot;&lt;MultiSlaterDet %s&gt;&quot;</span>, Mname);
    <a class="code" href="utils_8c.html#af86aada130a5db5b0f52154718d67c44" title="strips strip from str">stripstr</a>(Mname, <span class="stringliteral">&quot;&gt;&quot;</span>);

    <span class="keywordflow">if</span> (!strcmp(Mname, <span class="stringliteral">&quot;SymmetricSlaterDet&quot;</span>)) {
      <span class="keywordflow">if</span> (<a class="code" href="SymmetricSlaterDet_8c.html#a56d2f9ccb07b74815a13db61b1f98532">SymmetricSlaterDetRead</a>(fp, MB))
        <span class="keywordflow">return</span> -1;
    }    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(Mname, <span class="stringliteral">&quot;SymmetricMultiSlaterDet&quot;</span>)) {
      <span class="keywordflow">if</span> (<a class="code" href="SymmetricMultiSlaterDet_8c.html#aa29037d39669201e203eb2e7eaf6886b">SymmetricMultiSlaterDetRead</a>(fp, MB))
        <span class="keywordflow">return</span> -1;
    }    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(Mname, <span class="stringliteral">&quot;DiClusterProjSlaterDet&quot;</span>)) {
      <span class="keywordflow">if</span> (<a class="code" href="DiClusterProjParSlaterDet_8c.html#a621d89e97a7f3c27f8466a6e7c630897">DiClusterProjSlaterDetRead</a>(fp, MB))
        <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(Mname, <span class="stringliteral">&quot;DiClusterMultiProjSlaterDet&quot;</span>)) {
      <span class="keywordflow">if</span> (<a class="code" href="DiClusterMultiProjSlaterDet_8c.html#a8a6329d9dc25564be51437e29c7e112a">DiClusterMultiProjSlaterDetRead</a>(fp, MB))
        <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(Mname, <span class="stringliteral">&quot;DiClusterMulticonfig&quot;</span>)) {
      <span class="keywordflow">if</span> (<a class="code" href="DiClusterMulticonfig_8c.html#a1e4d542a496ea39ebd6e714124b014fc">DiClusterMulticonfigRead</a>(fp, MB))
        <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">else</span> {
      fprintf(stderr, <span class="stringliteral">&quot;MultiSlaterDet %s not known !\n&quot;</span>, Mname);
      <span class="keywordflow">return</span> -1;
    }
  }

  In-&gt;N = MB-&gt;N;

  <span class="comment">// no indices selected, then take all possible ones</span>
  <span class="keywordflow">if</span> (In-&gt;n == 0) {
    In-&gt;n = In-&gt;N;
    <span class="keywordtype">int</span> i;
    <span class="keywordflow">for</span> (i=0; i&lt;In-&gt;N; i++)
      In-&gt;idx[i] = i;
  }
  
  <span class="keywordflow">if</span> (In-&gt;n &gt; In-&gt;N) {
    fprintf(stderr, <span class="stringliteral">&quot;too many Indices\n&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4d3438d9bba7d7c79b1b52398f94de62"></a><!-- doxytag: member="MultiSlaterDet.h::readprojectedMultiMBMEfromFile" ref="a4d3438d9bba7d7c79b1b52398f94de62" args="(const char *mbfilea, const char *mbfileb, const MultiSlaterDet *QA, const MultiSlaterDet *QB, const Projection *P, const ManyBodyOperator *Op, void **obsme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readprojectedMultiMBMEfromFile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mbfilea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mbfileb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>QA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>QB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&nbsp;</td>
          <td class="paramname"> <em>obsme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00193">193</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="MultiSlaterDet_8c_source.html#l00094">BUFSIZE</a>, <a class="el" href="utils_8c_source.html#l00106">fileexists()</a>, <a class="el" href="utils_8c_source.html#l00149">filepart()</a>, <a class="el" href="utils_8c_source.html#l00183">md5hash()</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00038">_MSD_::N</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="Projection_8c_source.html#l00055">ProjectiontoStr()</a>, <a class="el" href="Projection_8c_source.html#l00433">readprojectedMBME()</a>, and <a class="el" href="MultiSlaterDet_8h_source.html#l00040">_MSD_::symmetry</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlapmulti_8c_source.html#l00087">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  gzFile mefp;
  <span class="keywordtype">char</span> mefilename[255];
  <span class="keywordtype">char</span> buf[BUFSIZE];
  <span class="keywordtype">char</span> fnam[255], md5fnam[33];
  <span class="keywordtype">char</span> fileS[80];

  snprintf(mefilename, 255, <span class="stringliteral">&quot;ME/%s--%s--%s--%s.gz&quot;</span>, 
           Op-&gt;<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a>, 
           <a class="code" href="utils_8c.html#a72e38b8773b63e202dbebc40c3346988" title="get the file component of fullname">filepart</a>(mbfilea), 
           <a class="code" href="utils_8c.html#a72e38b8773b63e202dbebc40c3346988" title="get the file component of fullname">filepart</a>(mbfileb), 
           <a class="code" href="Projection_8c.html#ac87bb7fb183abeb15fc0454df5babd55">ProjectiontoStr</a>(P));

  <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#a80285197256014b2324f0b874a91cb19" title="check if file exists and is readable (returns 0 for success)">fileexists</a>(mefilename)) {
      fprintf(stderr, <span class="stringliteral">&quot;... %s does not exist\n&quot;</span>, mefilename);
      <span class="keywordflow">return</span> -1;
    }

  <span class="keywordflow">if</span> (!(mefp = gzopen(mefilename, <span class="stringliteral">&quot;r&quot;</span>))) {
    fprintf(stderr, <span class="stringliteral">&quot;... couldn&#39;t open %s for reading\n&quot;</span>, mefilename);
    <span class="keywordflow">return</span> -1;
  }
  fprintf(stderr, <span class="stringliteral">&quot;... reading matrix elements from file %s\n&quot;</span>, mefilename);

  <span class="comment">// do many-body files match ?</span>
  <span class="comment">// agreement of Symmetries not checked</span>
  <span class="keywordflow">do</span>
    gzgets(mefp, buf, <a class="code" href="MultiSlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);
  <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;MBFile &quot;</span>, 7) &amp;&amp; !gzeof(mefp));
  <span class="keywordflow">if</span> (gzeof(mefp)) {
    fprintf(stderr, <span class="stringliteral">&quot;...   did&#39;t find &lt;MBFile ...&gt;\n&quot;</span>);
    gzclose(mefp);
    <span class="keywordflow">return</span> -2;
  }
  sscanf(buf, <span class="stringliteral">&quot;&lt;MBFile %s %s %s&gt;&quot;</span>, fnam, md5fnam, fileS);
  <span class="keywordflow">if</span> (strncmp(md5fnam, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfilea), 32)) {
    fprintf(stderr, <span class="stringliteral">&quot;...    MBFile does not match with existing ME\n&quot;</span>);
    <span class="keywordflow">return</span> -2;
  }

  <span class="keywordflow">do</span>
    gzgets(mefp, buf, <a class="code" href="MultiSlaterDet_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);
  <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;MBFile &quot;</span>, 7) &amp;&amp; !gzeof(mefp));
  <span class="keywordflow">if</span> (gzeof(mefp)) {
    fprintf(stderr, <span class="stringliteral">&quot;...    did&#39;t find &lt;MBFile ...&gt;\n&quot;</span>);
    gzclose(mefp);
    <span class="keywordflow">return</span> -2;
  }
  sscanf(buf, <span class="stringliteral">&quot;&lt;MBFile %s %s %s&gt;&quot;</span>, fnam, md5fnam, fileS);
  <span class="keywordflow">if</span> (strncmp(md5fnam, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfileb), 32)) {
    fprintf(stderr, <span class="stringliteral">&quot;...    MBFile does not match with existing ME\n&quot;</span>);
    gzclose(mefp);
    <span class="keywordflow">return</span> -2;
  }

  <span class="comment">// now read the matrix elements</span>
  <span class="keywordtype">int</span> NA = MBA-&gt;N; <span class="keywordtype">int</span> NB = MBB-&gt;N;
  <span class="keywordtype">int</span> iA, iB;
  <a class="code" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> SA, SB;
  <span class="keywordtype">int</span> res = 0;

  <span class="keywordflow">for</span> (iB=0; iB&lt;NB; iB++) {
    SB = MBB-&gt;symmetry(MBB, iB);
    <span class="keywordflow">for</span> (iA=0; iA&lt;NA; iA++) {
      SA = MBA-&gt;symmetry(MBA, iA); 
      res &amp;= <a class="code" href="Projection_8c.html#a24221ca9708e29fc5ea20304505d5399">readprojectedMBME</a>(mefp, P, Op, SA, SB, mbme[iA+iB*NA]); 
    }
  }

  gzclose(mefp);
  <span class="keywordflow">return</span> res;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="acb8c1ee49806f2cf7cee284464ecf981"></a><!-- doxytag: member="MultiSlaterDet.h::writeMultiEigenstatestoFile" ref="acb8c1ee49806f2cf7cee284464ecf981" args="(const char *fname, const Projection *P, const char *mbfile, const Indices *In, const Eigenstates *E)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeMultiEigenstatestoFile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mbfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIndices.html">Indices</a> *&nbsp;</td>
          <td class="paramname"> <em>In</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l01017">1017</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l00046">fprintinfo()</a>, <a class="el" href="Projection_8c_source.html#l00178">fprintProjectinfo()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00073">IndicestoStr()</a>, <a class="el" href="utils_8c_source.html#l00183">md5hash()</a>, <a class="el" href="Projection_8c_source.html#l00055">ProjectiontoStr()</a>, and <a class="el" href="Projection_8c_source.html#l01633">writeEigenstates()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  FILE* fp;
  <span class="keywordtype">char</span> filename[255];

  snprintf(filename, 255, <span class="stringliteral">&quot;%s.estates&quot;</span>, fname);

  <span class="keywordflow">if</span> (!(fp = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>))) {
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for writing\n&quot;</span>, filename);
    <span class="keywordflow">return</span> -1;
  }     

  <a class="code" href="utils_8c.html#ae3c710edac30cf257199e6595212a75a" title="print info about running process">fprintinfo</a>(fp);
  <a class="code" href="Projection_8c.html#af11f2a70292f93f6b5983cfc4f26d774">fprintProjectinfo</a>(fp, P);
  fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
  fprintf(fp, <span class="stringliteral">&quot;&lt;Projected %s&gt;\n&quot;</span>, <a class="code" href="Projection_8c.html#ac87bb7fb183abeb15fc0454df5babd55">ProjectiontoStr</a>(P));

  fprintf(fp, <span class="stringliteral">&quot;&lt;MultiSlaterDet %s %s %s&gt;\n&quot;</span>,
          mbfile, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfile), <a class="code" href="MultiSlaterDet_8c.html#a91d5b4deab687d45ccd81990914b95e4">IndicestoStr</a>(In));
  fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
    
  <a class="code" href="Projection_8c.html#a6efb4a37227aadf15910f7270a97a486">writeEigenstates</a>(fp, P, E);

  fprintf(fp, <span class="stringliteral">&quot;&lt;/Projected&gt;\n&quot;</span>);
  fclose(fp);

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa0927c7080e17e5af785de468357bd6c"></a><!-- doxytag: member="MultiSlaterDet.h::writeMultiMulticonfigfile" ref="aa0927c7080e17e5af785de468357bd6c" args="(const char *fname, const Projection *P, const char **mbfile, const Indices *In, int n, const Eigenstates *E)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeMultiMulticonfigfile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>mbfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structIndices.html">Indices</a> *&nbsp;</td>
          <td class="paramname"> <em>In</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l01051">1051</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l00046">fprintinfo()</a>, <a class="el" href="Projection_8c_source.html#l00178">fprintProjectinfo()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00073">IndicestoStr()</a>, <a class="el" href="utils_8c_source.html#l00183">md5hash()</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="Projection_8c_source.html#l00055">ProjectiontoStr()</a>, and <a class="el" href="Projection_8c_source.html#l01633">writeEigenstates()</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiprojmulti_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  FILE* fp;
  <span class="keywordtype">char</span> filename[255];

  snprintf(filename, 255, <span class="stringliteral">&quot;%s.states&quot;</span>, fname);

  <span class="keywordflow">if</span> (!(fp = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>))) {
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for writing\n&quot;</span>, filename);
    <span class="keywordflow">return</span> -1;
  }     

  <a class="code" href="utils_8c.html#ae3c710edac30cf257199e6595212a75a" title="print info about running process">fprintinfo</a>(fp);
  <a class="code" href="Projection_8c.html#af11f2a70292f93f6b5983cfc4f26d774">fprintProjectinfo</a>(fp, P);
  fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
  fprintf(fp, <span class="stringliteral">&quot;&lt;Multiconfprojected %d %d %s&gt;\n&quot;</span>, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, E-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>, <a class="code" href="Projection_8c.html#ac87bb7fb183abeb15fc0454df5babd55">ProjectiontoStr</a>(P));

  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++)
    fprintf(fp, <span class="stringliteral">&quot;&lt;MBFile %s %s %s&gt;\n&quot;</span>,
            mbfile[i], <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfile[i]), <a class="code" href="MultiSlaterDet_8c.html#a91d5b4deab687d45ccd81990914b95e4">IndicestoStr</a>(&amp;In[i]));
  fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
    
  <a class="code" href="Projection_8c.html#a6efb4a37227aadf15910f7270a97a486">writeEigenstates</a>(fp, P, E);

  fprintf(fp, <span class="stringliteral">&quot;&lt;/Multiconfprojected&gt;\n&quot;</span>);
  fclose(fp);

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a93c3e43f7fe22b20cbe9c9a4c49cd998"></a><!-- doxytag: member="MultiSlaterDet.h::writeprojectedMultiMBMEtoFile" ref="a93c3e43f7fe22b20cbe9c9a4c49cd998" args="(const char *mbfilea, const char *mbfileb, const MultiSlaterDet *QA, const MultiSlaterDet *QB, const Projection *P, const ManyBodyOperator *Op, void **obsme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeprojectedMultiMBMEtoFile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mbfilea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mbfileb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>QA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__MSD__.html">MultiSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>QB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&nbsp;</td>
          <td class="paramname"> <em>obsme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MultiSlaterDet_8c_source.html#l00497">497</a> of file <a class="el" href="MultiSlaterDet_8c_source.html">MultiSlaterDet.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l00118">ensuredir()</a>, <a class="el" href="utils_8c_source.html#l00149">filepart()</a>, <a class="el" href="utils_8c_source.html#l00051">gzprintinfo()</a>, <a class="el" href="utils_8c_source.html#l00183">md5hash()</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00038">_MSD_::N</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="Projection_8c_source.html#l00055">ProjectiontoStr()</a>, <a class="el" href="MultiSlaterDet_8h_source.html#l00040">_MSD_::symmetry</a>, and <a class="el" href="Projection_8c_source.html#l00348">writeprojectedMBME()</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlapmulti_8c_source.html#l00087">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  gzFile mefp;
  <span class="keywordtype">char</span> mefilename[255];

  <a class="code" href="utils_8c.html#a91bd1e9936bf548fc21c811e258c81e9" title="check for existence, create if not of directory">ensuredir</a>(<span class="stringliteral">&quot;ME&quot;</span>);

  snprintf(mefilename, 255, <span class="stringliteral">&quot;ME/%s--%s--%s--%s.gz&quot;</span>, 
           Op-&gt;<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a>, 
           <a class="code" href="utils_8c.html#a72e38b8773b63e202dbebc40c3346988" title="get the file component of fullname">filepart</a>(mbfilea), 
           <a class="code" href="utils_8c.html#a72e38b8773b63e202dbebc40c3346988" title="get the file component of fullname">filepart</a>(mbfileb), 
           <a class="code" href="Projection_8c.html#ac87bb7fb183abeb15fc0454df5babd55">ProjectiontoStr</a>(P));

  <span class="keywordflow">if</span> (!(mefp = gzopen(mefilename, <span class="stringliteral">&quot;w&quot;</span>))) {
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for writing\n&quot;</span>, mefilename);
    <span class="keywordflow">return</span> -1;
  }
    
  <a class="code" href="utils_8c.html#a109d01ec3cb7ea341ed78e31316661b8" title="print info about running process">gzprintinfo</a>(mefp);

  <span class="keywordtype">int</span> NA = MBA-&gt;N; <span class="keywordtype">int</span> NB = MBB-&gt;N;
  <span class="keywordtype">int</span> IA, IB;
  <a class="code" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> SA, SB;
  <span class="keywordtype">char</span> syma[80] = <span class="stringliteral">&quot;&quot;</span>, symb[80] = <span class="stringliteral">&quot;&quot;</span>;
  
  <span class="keywordflow">for</span> (IA=0; IA&lt;NA; IA++) {
    SA = MBA-&gt;symmetry(MBA, IA);
    sprintf(syma, <span class="stringliteral">&quot;%s%d:&quot;</span>, syma, SA);
  }
  syma[strlen(syma)-1] = <span class="charliteral">&#39;\0&#39;</span>;

  <span class="keywordflow">for</span> (IB=0; IB&lt;NB; IB++) {
    SB = MBB-&gt;symmetry(MBB, IB);
    sprintf(symb, <span class="stringliteral">&quot;%s%d:&quot;</span>, symb, SB);
  }
  symb[strlen(symb)-1] = <span class="charliteral">&#39;\0&#39;</span>;

  gzprintf(mefp, <span class="stringliteral">&quot;&lt;MBFile %s %s %s&gt;\n&quot;</span>, 
           mbfilea, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfilea), syma);
  gzprintf(mefp, <span class="stringliteral">&quot;&lt;MBFile %s %s %s&gt;\n&quot;</span>, 
           mbfileb, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfileb), symb);

  <span class="comment">// write matrix elements</span>

  <span class="keywordtype">int</span> res = 0;

  <span class="keywordflow">for</span> (IB=0; IB&lt;NB; IB++) {
    SB = MBB-&gt;symmetry(MBB, IB);
    <span class="keywordflow">for</span> (IA=0; IA&lt;NA; IA++) {
      SA = MBA-&gt;symmetry(MBA, IA); 

      gzprintf(mefp, <span class="stringliteral">&quot;\n# Matrixelement :%d  :%d\n&quot;</span>, IA, IB);
      res &amp;= <a class="code" href="Projection_8c.html#a086dc7277e11cd8a2335f25cb14c66b8">writeprojectedMBME</a>(mefp, P, Op, SA, SB, mbme[IA+IB*NA]); 
    }
  }

  gzclose(mefp);
  <span class="keywordflow">return</span> res;
} 
</pre></div></p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
