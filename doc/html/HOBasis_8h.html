<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/HOBasis.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>fmd/HOBasis.h File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;<a class="el" href="Gaussian_8h_source.html">fmd/Gaussian.h</a>&gt;</code><br/>

<p><a href="HOBasis_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structHOSPState.html">HOSPState</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a694e963fcc125104dfaff0e3c7deb3ac">HONMAX</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a8855282f2404cbb204ab288ef9db9d46">HODIMMAX</a>&nbsp;&nbsp;&nbsp;(HONMAX+1)*(HONMAX+2)*(HONMAX+3)/6</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a4d01c511e1f8d952bea0f01d67b70c92">initHOBasis</a> (int nmax)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a331ea1f326cb2b1c9f5c974db0296f2a">dimHOBasis</a> (int nmax)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structHOSPState.html">HOSPState</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a8c9a794db9f2767707ae0a4fc9e28190">getHOspstate</a> (int idx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a78572aa0e3fc33e5bbb453b03db0d764">HOspstateidx</a> (const <a class="el" href="structHOSPState.html">HOSPState</a> *spstate)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a8f9242ba521192defbb05c248df2c84c">HOxinljmidx</a> (int xi, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, int <a class="el" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, int twoj, int twom)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a262e1f40bbdeb886d7abb9aba8012f9b">labelHOshell</a> (int <a class="el" href="MinimizerDONLP2vappiso_8c.html#a2a1e3f56f0e0fbb27c7d7c5359b9a572">N</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a26ec7640351d490f76d81537fcbb4632">labelHOorbit</a> (int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, int <a class="el" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, int twoj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#a471d02a0f45c883ab41b31d61ba7770b">labelHOspstate</a> (const <a class="el" href="structHOSPState.html">HOSPState</a> *spstate)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="HOBasis_8h.html#abb8edcb88d79fcc75efd7486f9cf91af">amplitudesHOGaussian</a> (const <a class="el" href="structGaussian.html">Gaussian</a> *G, int nmax, double omega, complex double *amp)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>define single-particle Harmonic oscillator basis</p>
<p>(c) 2006 Thomas Neff </p>

<p>Definition in file <a class="el" href="HOBasis_8h_source.html">HOBasis.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a8855282f2404cbb204ab288ef9db9d46"></a><!-- doxytag: member="HOBasis.h::HODIMMAX" ref="a8855282f2404cbb204ab288ef9db9d46" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HODIMMAX&nbsp;&nbsp;&nbsp;(HONMAX+1)*(HONMAX+2)*(HONMAX+3)/6</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8h_source.html#l00025">25</a> of file <a class="el" href="HOBasis_8h_source.html">HOBasis.h</a>.</p>

</div>
</div>
<a class="anchor" id="a694e963fcc125104dfaff0e3c7deb3ac"></a><!-- doxytag: member="HOBasis.h::HONMAX" ref="a694e963fcc125104dfaff0e3c7deb3ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HONMAX&nbsp;&nbsp;&nbsp;8</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8h_source.html#l00021">21</a> of file <a class="el" href="HOBasis_8h_source.html">HOBasis.h</a>.</p>

<p>Referenced by <a class="el" href="calcoccupationnumbersho_8c_source.html#l00030">main()</a>, <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00102">writeprojectedDiagonalDensityMatrixHO()</a>, and <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00205">writeprojectedDiagonalTransitionDensityMatrixHO()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="abb8edcb88d79fcc75efd7486f9cf91af"></a><!-- doxytag: member="HOBasis.h::amplitudesHOGaussian" ref="abb8edcb88d79fcc75efd7486f9cf91af" args="(const Gaussian *G, int nmax, double omega, complex double *amp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void amplitudesHOGaussian </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structGaussian.html">Gaussian</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double *&nbsp;</td>
          <td class="paramname"> <em>amp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8c_source.html#l01104">1104</a> of file <a class="el" href="HOBasis_8c_source.html">HOBasis.c</a>.</p>

<p>References <a class="el" href="Gaussian_8h_source.html#l00022">Gaussian::a</a>, <a class="el" href="HOBasis_8c_source.html#l00028">ABS</a>, <a class="el" href="HOBasis_8c_source.html#l00060">ampcart</a>, <a class="el" href="Gaussian_8h_source.html#l00023">Gaussian::b</a>, <a class="el" href="Gaussian_8h_source.html#l00021">Gaussian::chi</a>, <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="HOBasis_8c_source.html#l00135">dimHOBasis()</a>, <a class="el" href="HOBasis_8c.html#a82b58d6179c109c562e4544b65b24172">HOnlm</a>, <a class="el" href="HOBasis_8c.html#aff54fe156803911e200115adf4e4cb7f">HOnxnynz</a>, <a class="el" href="HOBasis_8c_source.html#l00037">invHOBasis</a>, <a class="el" href="physics_8c_source.html#l00034">mnucleon</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00105">n0</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, and <a class="el" href="Gaussian_8h_source.html#l00020">Gaussian::xi</a>.</p>

<p>Referenced by <a class="el" href="DensityMatrixHO_8c_source.html#l00094">calcDensityMatrixHOod()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a> = 1/(<a class="code" href="physics_8c.html#a1dab0fecd9e5a7a2380c40a21d2bfae8" title="nucleon mass [fm^-1]">mnucleon</a>*omega);
  <span class="keywordtype">int</span> d = <a class="code" href="HOBasis_8c.html#a331ea1f326cb2b1c9f5c974db0296f2a">dimHOBasis</a>(nmax);

  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;d; i++)
    amp[i] = 0.0;

  <span class="comment">// first calculate ovlaps with cartesian HO basis states</span>

  <span class="keywordflow">for</span> (i=0; i&lt;3; i++)
    <a class="code" href="HOBasis_8c.html#ae814641619401c84c00ad75565ef0340">ampcart</a>[0][i] = ng0(alpha, G-&gt;<a class="code" href="structGaussian.html#a4d7abfae9328f879eb63aa513d57fd74" title="complex width">a</a>, G-&gt;<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[i]);

  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
  <span class="keywordflow">for</span> (n=1; n&lt;=nmax; n++)
    <span class="keywordflow">for</span> (i=0; i&lt;3; i++) 
      <a class="code" href="HOBasis_8c.html#ae814641619401c84c00ad75565ef0340">ampcart</a>[n][i] = <a class="code" href="HOBasis_8c.html#ae814641619401c84c00ad75565ef0340">ampcart</a>[0][i]* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>(n, alpha, G-&gt;<a class="code" href="structGaussian.html#a4d7abfae9328f879eb63aa513d57fd74" title="complex width">a</a>, G-&gt;<a class="code" href="structGaussian.html#aad8e447fed578c05fdda15ffcb15c590" title="complex position in phase space">b</a>[i]);

  <span class="comment">// transform into ovlaps in xinljm basis with Smirnov and </span>
  <span class="comment">// Clebsch-Gordan coefficients</span>

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a>, inxnynz, inlm, ixi, twol, twoml, twoms, twom, twoj, lj, ixinljm;
  complex <span class="keywordtype">double</span> ampnlm, ampchi;
    
  <span class="keywordflow">for</span> (N=0; N&lt;=nmax; N++) {

    <span class="keywordflow">for</span> (inlm=<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#a52df11f58a9e155aa83187a53749863a">n0</a>[N]; inlm&lt;<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#a52df11f58a9e155aa83187a53749863a">n0</a>[N]+<a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>[N]; inlm++) {

      ampnlm = 0.0;
      <span class="keywordflow">for</span> (inxnynz=<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#a52df11f58a9e155aa83187a53749863a">n0</a>[N]; inxnynz&lt;<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#a52df11f58a9e155aa83187a53749863a">n0</a>[N]+dim[N]; inxnynz++) {
        ampnlm += <a class="code" href="HOBasis_8c.html#a577596155ed0ab7e5e6c386ba17fce55">smirnov</a>[N][(inxnynz-<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#a52df11f58a9e155aa83187a53749863a">n0</a>[N])+(inlm-<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#a52df11f58a9e155aa83187a53749863a">n0</a>[N])*dim[N]]*
          <a class="code" href="HOBasis_8c.html#ae814641619401c84c00ad75565ef0340">ampcart</a>[<a class="code" href="HOBasis_8c.html#aff54fe156803911e200115adf4e4cb7f">HOnxnynz</a>[inxnynz].nx][0]*
          <a class="code" href="HOBasis_8c.html#ae814641619401c84c00ad75565ef0340">ampcart</a>[<a class="code" href="HOBasis_8c.html#aff54fe156803911e200115adf4e4cb7f">HOnxnynz</a>[inxnynz].ny][1]*
          <a class="code" href="HOBasis_8c.html#ae814641619401c84c00ad75565ef0340">ampcart</a>[<a class="code" href="HOBasis_8c.html#aff54fe156803911e200115adf4e4cb7f">HOnxnynz</a>[inxnynz].nz][2];
      }

      ixi = (G-&gt;<a class="code" href="structGaussian.html#a3102697cdce1aedb094cd515f6cd5a47" title="isospin +/- 1 (proton/neutron)">xi</a> == +1 ? 0 : 1);
      n = <a class="code" href="HOBasis_8c.html#a82b58d6179c109c562e4544b65b24172">HOnlm</a>[inlm].n;
      twol = 2*<a class="code" href="HOBasis_8c.html#a82b58d6179c109c562e4544b65b24172">HOnlm</a>[inlm].l; twoml = 2*<a class="code" href="HOBasis_8c.html#a82b58d6179c109c562e4544b65b24172">HOnlm</a>[inlm].m;

      <span class="keywordflow">for</span> (twoms=-1; twoms&lt;=+1; twoms=twoms+2) {
        twom = twoml + twoms;
        
        ampchi = G-&gt;<a class="code" href="structGaussian.html#a95da0e93add3c73c0fef74054aaf5c21" title="complex spinor, additional freedom to give norm and phase">chi</a>[twoms == +1 ? 0 : 1];

        <span class="keywordflow">for</span> (twoj=<a class="code" href="HOBasis_8c.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(twol-1); twoj&lt;=twol+1; twoj = twoj+2) {

          <span class="keywordflow">if</span> (<a class="code" href="HOBasis_8c.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(twom) &lt;= twoj) {
            lj = (twol+twoj-1)/2;
            
            ixinljm = <a class="code" href="HOBasis_8c.html#a7eda2b83115226868a6c0ac95cb827c8">invHOBasis</a>[ixi][n][lj][(twoj+twom)/2];

            amp[ixinljm] += <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(twol, 1, twoj, twoml, twoms, twom)* ampchi*ampnlm;
          }
        }
      }
    }
  }
  
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a331ea1f326cb2b1c9f5c974db0296f2a"></a><!-- doxytag: member="HOBasis.h::dimHOBasis" ref="a331ea1f326cb2b1c9f5c974db0296f2a" args="(int nmax)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dimHOBasis </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nmax</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8c_source.html#l00135">135</a> of file <a class="el" href="HOBasis_8c_source.html">HOBasis.c</a>.</p>

<p>Referenced by <a class="el" href="HOBasis_8c_source.html#l01104">amplitudesHOGaussian()</a>, <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00068">calcDiagonalDensityMatrixHOod()</a>, and <a class="el" href="calcoccupationnumbersho_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> 2*2*(nmax+1)*(nmax+2)*(nmax+3)/6;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8c9a794db9f2767707ae0a4fc9e28190"></a><!-- doxytag: member="HOBasis.h::getHOspstate" ref="a8c9a794db9f2767707ae0a4fc9e28190" args="(int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structHOSPState.html">HOSPState</a>* getHOspstate </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8c_source.html#l00141">141</a> of file <a class="el" href="HOBasis_8c_source.html">HOBasis.c</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> &amp;<a class="code" href="HOBasis_8c.html#a7efa592deb0ae73ec290b56ab3bb02bc">HOBasis</a>[idx];
} 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a78572aa0e3fc33e5bbb453b03db0d764"></a><!-- doxytag: member="HOBasis.h::HOspstateidx" ref="a78572aa0e3fc33e5bbb453b03db0d764" args="(const HOSPState *spstate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int HOspstateidx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structHOSPState.html">HOSPState</a> *&nbsp;</td>
          <td class="paramname"> <em>spstate</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8c_source.html#l00147">147</a> of file <a class="el" href="HOBasis_8c_source.html">HOBasis.c</a>.</p>

<p>References <a class="el" href="HOBasis_8c_source.html#l00037">invHOBasis</a>, <a class="el" href="HOBasis_8h_source.html#l00033">HOSPState::lj</a>, <a class="el" href="HOBasis_8h_source.html#l00034">HOSPState::m</a>, <a class="el" href="HOBasis_8h_source.html#l00032">HOSPState::n</a>, and <a class="el" href="HOBasis_8h_source.html#l00031">HOSPState::xi</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="HOBasis_8c.html#a7eda2b83115226868a6c0ac95cb827c8">invHOBasis</a>[sp-&gt;xi][sp-&gt;n][sp-&gt;lj][(ljtotwoj(sp-&gt;lj)+sp-&gt;m)/2];
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8f9242ba521192defbb05c248df2c84c"></a><!-- doxytag: member="HOBasis.h::HOxinljmidx" ref="a8f9242ba521192defbb05c248df2c84c" args="(int xi, int n, int l, int twoj, int twom)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int HOxinljmidx </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>xi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>twoj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>twom</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8c_source.html#l00153">153</a> of file <a class="el" href="HOBasis_8c_source.html">HOBasis.c</a>.</p>

<p>References <a class="el" href="HOBasis_8c_source.html#l00037">invHOBasis</a>.</p>

<p>Referenced by <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00068">calcDiagonalDensityMatrixHOod()</a>, and <a class="el" href="calcoccupationnumbersho_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="HOBasis_8c.html#a7eda2b83115226868a6c0ac95cb827c8">invHOBasis</a>[xi == +1 ? 0 : 1][<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>][(2*<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>+twoj-1)/2][(twoj+twom)/2];
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4d01c511e1f8d952bea0f01d67b70c92"></a><!-- doxytag: member="HOBasis.h::initHOBasis" ref="a4d01c511e1f8d952bea0f01d67b70c92" args="(int nmax)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initHOBasis </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nmax</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8c_source.html#l00064">64</a> of file <a class="el" href="HOBasis_8c_source.html">HOBasis.c</a>.</p>

<p>References <a class="el" href="HOBasis_8c_source.html#l00028">ABS</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="HOBasis_8c.html#a82b58d6179c109c562e4544b65b24172">HOnlm</a>, <a class="el" href="HOBasis_8c.html#aff54fe156803911e200115adf4e4cb7f">HOnxnynz</a>, <a class="el" href="HOBasis_8c_source.html#l00037">invHOBasis</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8h_source.html#l00033">HOSPState::lj</a>, <a class="el" href="HOBasis_8h_source.html#l00034">HOSPState::m</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="HOBasis_8h_source.html#l00032">HOSPState::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00105">n0</a>, <a class="el" href="HOBasis_8c_source.html#l00043">nx</a>, <a class="el" href="HOBasis_8c_source.html#l00044">ny</a>, <a class="el" href="HOBasis_8c_source.html#l00045">nz</a>, and <a class="el" href="HOBasis_8h_source.html#l00031">HOSPState::xi</a>.</p>

<p>Referenced by <a class="el" href="DiagonalDensityHOSlave_8c_source.html#l00026">DiagonalDensityHOSlave()</a>, and <a class="el" href="calcoccupationnumbersho_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a>;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a02d47a4f36ec0bcce348696534567e30">nx</a>, <a class="code" href="HOBasis_8c.html#a147a8b14bbd79c0f1a3457805e2065ba">ny</a>, <a class="code" href="HOBasis_8c.html#ac2eda98bb6d7e89cc3239973db2800cf">nz</a>;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>;
  <span class="keywordtype">int</span> xi, twoj, lj, twom;
  <span class="keywordtype">int</span> i;

  i=0;
  <span class="keywordflow">for</span> (N=0; N&lt;=nmax; N++) {
    <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>[N] = (N+1)*(N+2)/2;
    <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#a52df11f58a9e155aa83187a53749863a">n0</a>[N] = i;

    <span class="keywordflow">for</span> (nx=N; nx&gt;=0; nx--)
      <span class="keywordflow">for</span> (ny=N-nx; ny&gt;=0; ny--) {
        nz = N-nx-ny;

        <span class="comment">// fprintf(stderr, &quot;%d: (nx,ny,nz) = (%d,%d,%d)\n&quot;, i, nx, ny, nz);</span>

        <a class="code" href="HOBasis_8c.html#aff54fe156803911e200115adf4e4cb7f">HOnxnynz</a>[i].nx = nx;
        <a class="code" href="HOBasis_8c.html#aff54fe156803911e200115adf4e4cb7f">HOnxnynz</a>[i].ny = ny;
        <a class="code" href="HOBasis_8c.html#aff54fe156803911e200115adf4e4cb7f">HOnxnynz</a>[i].nz = nz;

        i++;
      }
  }

  i=0;
  <span class="keywordflow">for</span> (N=0; N&lt;=nmax; N++) {
    <span class="keywordflow">for</span> (n=N/2; n&gt;=0; n--) {
      l=N-2*n;
      <span class="keywordflow">for</span> (m=-l; m&lt;=l; m++) {

        <span class="comment">// fprintf(stderr, &quot;%d: (n, l, m) = (%d,%d,%d)\n&quot;, i, n, l, m);</span>

        <a class="code" href="HOBasis_8c.html#a82b58d6179c109c562e4544b65b24172">HOnlm</a>[i].n = n;
        <a class="code" href="HOBasis_8c.html#a82b58d6179c109c562e4544b65b24172">HOnlm</a>[i].l = l;
        <a class="code" href="HOBasis_8c.html#a82b58d6179c109c562e4544b65b24172">HOnlm</a>[i].m = m;

        i++;
      }
    }
  }
  

  i=0;
  <span class="keywordflow">for</span> (xi=0; xi&lt;=1; xi++) {
    <span class="keywordflow">for</span> (N=0; N&lt;=nmax; N++) {
      <span class="keywordflow">for</span> (n=N/2; n&gt;=0; n--) {
        l=N-2*n;
        <span class="keywordflow">for</span> (twoj=<a class="code" href="HOBasis_8c.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(2*l-1); twoj&lt;=2*l+1; twoj=twoj+2) {
          lj = (2*l+twoj-1)/2;
          <span class="keywordflow">for</span> (twom=-twoj; twom&lt;=twoj; twom=twom+2) {

            <a class="code" href="HOBasis_8c.html#a7efa592deb0ae73ec290b56ab3bb02bc">HOBasis</a>[i].<a class="code" href="structHOSPState.html#aef54e6d28299bf9ce7796767c7b304f7" title="isospin [+1|-1]">xi</a> = xi ? -1 : +1;
            <a class="code" href="HOBasis_8c.html#a7efa592deb0ae73ec290b56ab3bb02bc">HOBasis</a>[i].<a class="code" href="structHOSPState.html#a985e6c5da189f4e98abf7444bd2044e1" title="n=0,1,...">n</a> = n;
            <a class="code" href="HOBasis_8c.html#a7efa592deb0ae73ec290b56ab3bb02bc">HOBasis</a>[i].<a class="code" href="structHOSPState.html#ab4193d7c56bc578e8fc5c17fe94c3659" title="lj=0,1,2,...">lj</a> = lj;
            <a class="code" href="HOBasis_8c.html#a7efa592deb0ae73ec290b56ab3bb02bc">HOBasis</a>[i].<a class="code" href="structHOSPState.html#a16a72d94bdf8aa25b6b92fd5cf8941ca" title="m=-2j,...,2j">m</a> = twom;

            <a class="code" href="HOBasis_8c.html#a7eda2b83115226868a6c0ac95cb827c8">invHOBasis</a>[xi][n][lj][(twoj+twom)/2] = i;
            
            i++;
          }
        }
      }
    }
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a26ec7640351d490f76d81537fcbb4632"></a><!-- doxytag: member="HOBasis.h::labelHOorbit" ref="a26ec7640351d490f76d81537fcbb4632" args="(int n, int l, int twoj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* labelHOorbit </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>twoj</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8c_source.html#l00171">171</a> of file <a class="el" href="HOBasis_8c_source.html">HOBasis.c</a>.</p>

<p>References <a class="el" href="HOBasis_8c_source.html#l00168">jlabel</a>.</p>

<p>Referenced by <a class="el" href="calcoccupationnumbersho_8c_source.html#l00030">main()</a>, <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00102">writeprojectedDiagonalDensityMatrixHO()</a>, and <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00205">writeprojectedDiagonalTransitionDensityMatrixHO()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span>* label = malloc(7*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
  sprintf(label, <span class="stringliteral">&quot;%d%c%d/2&quot;</span>,
          <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, <a class="code" href="HOBasis_8c.html#a9b9af4fa15bf311d47b5ab0fad2af883">jlabel</a>[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>], twoj);
  <span class="keywordflow">return</span> label;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a262e1f40bbdeb886d7abb9aba8012f9b"></a><!-- doxytag: member="HOBasis.h::labelHOshell" ref="a262e1f40bbdeb886d7abb9aba8012f9b" args="(int N)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* labelHOshell </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>N</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8c_source.html#l00162">162</a> of file <a class="el" href="HOBasis_8c_source.html">HOBasis.c</a>.</p>

<p>References <a class="el" href="HOBasis_8c_source.html#l00159">shelllabel</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="HOBasis_8c.html#ab5d582b1f77d80d2e995398581f39879">shelllabel</a>[<a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a>];
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a471d02a0f45c883ab41b31d61ba7770b"></a><!-- doxytag: member="HOBasis.h::labelHOspstate" ref="a471d02a0f45c883ab41b31d61ba7770b" args="(const HOSPState *spstate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* labelHOspstate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structHOSPState.html">HOSPState</a> *&nbsp;</td>
          <td class="paramname"> <em>spstate</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="HOBasis_8c_source.html#l00180">180</a> of file <a class="el" href="HOBasis_8c_source.html">HOBasis.c</a>.</p>

<p>References <a class="el" href="HOBasis_8c_source.html#l00168">jlabel</a>, <a class="el" href="HOBasis_8h_source.html#l00033">HOSPState::lj</a>, <a class="el" href="HOBasis_8h_source.html#l00034">HOSPState::m</a>, <a class="el" href="HOBasis_8h_source.html#l00032">HOSPState::n</a>, and <a class="el" href="HOBasis_8h_source.html#l00031">HOSPState::xi</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span>* label = malloc(14*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
  sprintf(label, <span class="stringliteral">&quot;%c%d%c%d/2,%+d/2&quot;</span>, 
          sp-&gt;xi == +1 ? <span class="charliteral">&#39;p&#39;</span> : <span class="charliteral">&#39;n&#39;</span>, 
          sp-&gt;n, 
          <a class="code" href="HOBasis_8c.html#a9b9af4fa15bf311d47b5ab0fad2af883">jlabel</a>[ljtotwol(sp-&gt;lj)/2],
          ljtotwoj(sp-&gt;lj),
          sp-&gt;m);
  <span class="keywordflow">return</span> label;
}
</pre></div></p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
