<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: numerics/interpol.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>numerics/interpol.c File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="fortranc_8h_source.html">fortranc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="interpol_8h_source.html">interpol.h</a>&quot;</code><br/>

<p><a href="interpol_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void FORTRAN()&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interpol_8c.html#a9819ab01517f85d423bd3f6a88b6b901">dcsint</a> (int *IENT, double *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a42bf114ffec8bfeca4505f9598b1bc74">H</a>, int *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a2a1e3f56f0e0fbb27c7d7c5359b9a572">N</a>, double *TNODE, double *G, double *END1, double *ENDN, double *B, double *C, double *D)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interpol_8c.html#a302c8c8848ead6aed5f190ed9f163a2a">initInterpolzeroderivative</a> (<a class="el" href="structinterpolpara.html">interpolpara</a> *ipp, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, double h, double *<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>, double *f)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interpol_8c.html#a44b2e83b303d536ddb4c7a30233f8a95">freeInterpol</a> (<a class="el" href="structinterpolpara.html">interpolpara</a> *ipp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interpol_8c.html#a22f4e97ed7ca9e188dc4e074a1b2e5a7">sqr</a> (double <a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interpol_8c.html#a43adca125f47695ddf35a28ef3643779">cbe</a> (double <a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interpol_8c.html#a497223abd3bffd55a30cddc3ac170942">calcInterpol</a> (const <a class="el" href="structinterpolpara.html">interpolpara</a> *p, double <a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>interpolate data by cubic spline uses routine from toms 547</p>
<p>2006 Thomas Neff </p>

<p>Definition in file <a class="el" href="interpol_8c_source.html">interpol.c</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a497223abd3bffd55a30cddc3ac170942"></a><!-- doxytag: member="interpol.c::calcInterpol" ref="a497223abd3bffd55a30cddc3ac170942" args="(const interpolpara *p, double x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calcInterpol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structinterpolpara.html">interpolpara</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpol_8c_source.html#l00062">62</a> of file <a class="el" href="interpol_8c_source.html">interpol.c</a>.</p>

<p>References <a class="el" href="interpol_8h_source.html#l00021">interpolpara::B</a>, <a class="el" href="interpol_8h_source.html#l00022">interpolpara::C</a>, <a class="el" href="interpol_8c_source.html#l00060">cbe()</a>, <a class="el" href="interpol_8h_source.html#l00023">interpolpara::D</a>, <a class="el" href="interpol_8h_source.html#l00020">interpolpara::G</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="interpol_8h_source.html#l00017">interpolpara::n</a>, <a class="el" href="TwoBodyDensity_8c_source.html#l00030">sqr()</a>, and <a class="el" href="interpol_8h_source.html#l00019">interpolpara::T</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i=0;

  <span class="keywordflow">if</span> (x &lt; p-&gt;T[0] || <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a> &gt; p-&gt;<a class="code" href="structinterpolpara.html#a141e9baada209f0abe8a55cfd80a285c">T</a>[p-&gt;<a class="code" href="structinterpolpara.html#ac650cd6231ab199d05859d4e930bd3c7">n</a>-1]) {
    fprintf(stderr, <span class="stringliteral">&quot;interpol: argument %f outside interpolation range\n&quot;</span>, <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>);
    <span class="keywordflow">return</span> 0.0;
  }

  <span class="keywordflow">while</span> (i &lt; p-&gt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> - 1) {
    <span class="keywordflow">if</span> (x &lt;= p-&gt;T[i+1])
      <span class="keywordflow">break</span>;
    i++;
  }

  <span class="keywordflow">return</span> (p-&gt;<a class="code" href="structinterpolpara.html#a1b93307638c6cd5e01ede3bf368b83d9">G</a>[i] + 
          p-&gt;<a class="code" href="structinterpolpara.html#a8c6203f59329b193abcbdd6a3a7ffa93">B</a>[i]*(<a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a> - p-&gt;<a class="code" href="structinterpolpara.html#a141e9baada209f0abe8a55cfd80a285c">T</a>[i]) +
          p-&gt;<a class="code" href="structinterpolpara.html#a2749b3d795df291a7fa37d011743be7f">C</a>[i]*<a class="code" href="TwoBodyDensity_8c.html#a22f4e97ed7ca9e188dc4e074a1b2e5a7">sqr</a>(<a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a> - p-&gt;<a class="code" href="structinterpolpara.html#a141e9baada209f0abe8a55cfd80a285c">T</a>[i]) +
          p-&gt;<a class="code" href="structinterpolpara.html#a495895f15b32b84006f1d0f99537ead1">D</a>[i]*<a class="code" href="interpol_8c.html#a43adca125f47695ddf35a28ef3643779">cbe</a>(<a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a> - p-&gt;<a class="code" href="structinterpolpara.html#a141e9baada209f0abe8a55cfd80a285c">T</a>[i]));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a43adca125f47695ddf35a28ef3643779"></a><!-- doxytag: member="interpol.c::cbe" ref="a43adca125f47695ddf35a28ef3643779" args="(double x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cbe </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpol_8c_source.html#l00060">60</a> of file <a class="el" href="interpol_8c_source.html">interpol.c</a>.</p>

<p>Referenced by <a class="el" href="interpol_8c_source.html#l00062">calcInterpol()</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>*<a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>*<a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9819ab01517f85d423bd3f6a88b6b901"></a><!-- doxytag: member="interpol.c::dcsint" ref="a9819ab01517f85d423bd3f6a88b6b901" args="(int *IENT, double *H, int *N, double *TNODE, double *G, double *END1, double *ENDN, double *B, double *C, double *D)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FORTRAN() dcsint </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>IENT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>TNODE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>END1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>ENDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>D</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="interpol_8c_source.html#l00024">initInterpolzeroderivative()</a>.</p>

</div>
</div>
<a class="anchor" id="a44b2e83b303d536ddb4c7a30233f8a95"></a><!-- doxytag: member="interpol.c::freeInterpol" ref="a44b2e83b303d536ddb4c7a30233f8a95" args="(interpolpara *ipp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freeInterpol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structinterpolpara.html">interpolpara</a> *&nbsp;</td>
          <td class="paramname"> <em>ipp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpol_8c_source.html#l00049">49</a> of file <a class="el" href="interpol_8c_source.html">interpol.c</a>.</p>

<p>References <a class="el" href="interpol_8h_source.html#l00021">interpolpara::B</a>, <a class="el" href="interpol_8h_source.html#l00022">interpolpara::C</a>, <a class="el" href="interpol_8h_source.html#l00023">interpolpara::D</a>, <a class="el" href="interpol_8h_source.html#l00020">interpolpara::G</a>, and <a class="el" href="interpol_8h_source.html#l00019">interpolpara::T</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  free(ipp-&gt;<a class="code" href="structinterpolpara.html#a141e9baada209f0abe8a55cfd80a285c">T</a>);
  free(ipp-&gt;<a class="code" href="structinterpolpara.html#a1b93307638c6cd5e01ede3bf368b83d9">G</a>);
  free(ipp-&gt;<a class="code" href="structinterpolpara.html#a8c6203f59329b193abcbdd6a3a7ffa93">B</a>);
  free(ipp-&gt;<a class="code" href="structinterpolpara.html#a2749b3d795df291a7fa37d011743be7f">C</a>);
  free(ipp-&gt;<a class="code" href="structinterpolpara.html#a495895f15b32b84006f1d0f99537ead1">D</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a302c8c8848ead6aed5f190ed9f163a2a"></a><!-- doxytag: member="interpol.c::initInterpolzeroderivative" ref="a302c8c8848ead6aed5f190ed9f163a2a" args="(interpolpara *ipp, int n, double h, double *x, double *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initInterpolzeroderivative </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structinterpolpara.html">interpolpara</a> *&nbsp;</td>
          <td class="paramname"> <em>ipp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>f</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpol_8c_source.html#l00024">24</a> of file <a class="el" href="interpol_8c_source.html">interpol.c</a>.</p>

<p>References <a class="el" href="interpol_8h_source.html#l00021">interpolpara::B</a>, <a class="el" href="interpol_8h_source.html#l00022">interpolpara::C</a>, <a class="el" href="interpol_8h_source.html#l00023">interpolpara::D</a>, <a class="el" href="interpol_8c.html#a9819ab01517f85d423bd3f6a88b6b901">dcsint()</a>, <a class="el" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>, <a class="el" href="interpol_8h_source.html#l00020">interpolpara::G</a>, <a class="el" href="interpol_8h_source.html#l00018">interpolpara::h</a>, <a class="el" href="interpol_8h_source.html#l00017">interpolpara::n</a>, and <a class="el" href="interpol_8h_source.html#l00019">interpolpara::T</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  ipp-&gt;<a class="code" href="structinterpolpara.html#ac650cd6231ab199d05859d4e930bd3c7">n</a> = <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
  ipp-&gt;<a class="code" href="structinterpolpara.html#aaed4dff74e532d7a701f514c533318b1">h</a> = h;
  
  ipp-&gt;<a class="code" href="structinterpolpara.html#a141e9baada209f0abe8a55cfd80a285c">T</a> = malloc(<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
  ipp-&gt;<a class="code" href="structinterpolpara.html#a1b93307638c6cd5e01ede3bf368b83d9">G</a> = malloc(<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
  ipp-&gt;<a class="code" href="structinterpolpara.html#a8c6203f59329b193abcbdd6a3a7ffa93">B</a> = malloc(<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
  ipp-&gt;<a class="code" href="structinterpolpara.html#a2749b3d795df291a7fa37d011743be7f">C</a> = malloc(<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
  ipp-&gt;<a class="code" href="structinterpolpara.html#a495895f15b32b84006f1d0f99537ead1">D</a> = malloc(<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++)
    ipp-&gt;<a class="code" href="structinterpolpara.html#a141e9baada209f0abe8a55cfd80a285c">T</a>[i] = <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>[i];
  for (i=0; i&lt;n; i++)
    ipp-&gt;<a class="code" href="structinterpolpara.html#a1b93307638c6cd5e01ede3bf368b83d9">G</a>[i] = f[i];

  <span class="keywordtype">int</span> IENT=1;
  <span class="keywordtype">double</span> END1=0.0; <span class="keywordtype">double</span> ENDN=0.0;
  <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="interpol_8c.html#a9819ab01517f85d423bd3f6a88b6b901">dcsint</a>)(&amp;IENT, &amp;h, &amp;n, ipp-&gt;<a class="code" href="structinterpolpara.html#a141e9baada209f0abe8a55cfd80a285c">T</a>, ipp-&gt;<a class="code" href="structinterpolpara.html#a1b93307638c6cd5e01ede3bf368b83d9">G</a>, &amp;END1, &amp;ENDN, 
                  ipp-&gt;<a class="code" href="structinterpolpara.html#a8c6203f59329b193abcbdd6a3a7ffa93">B</a>, ipp-&gt;<a class="code" href="structinterpolpara.html#a2749b3d795df291a7fa37d011743be7f">C</a>, ipp-&gt;<a class="code" href="structinterpolpara.html#a495895f15b32b84006f1d0f99537ead1">D</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a22f4e97ed7ca9e188dc4e074a1b2e5a7"></a><!-- doxytag: member="interpol.c::sqr" ref="a22f4e97ed7ca9e188dc4e074a1b2e5a7" args="(double x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sqr </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="interpol_8c_source.html#l00059">59</a> of file <a class="el" href="interpol_8c_source.html">interpol.c</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>*<a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>; }
</pre></div></p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:37 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
