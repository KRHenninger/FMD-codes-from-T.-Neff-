<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/TwoNucleonOvlaps.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>fmd/TwoNucleonOvlaps.h File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Projection_8h_source.html">Projection.h</a>&quot;</code><br/>

<p><a href="TwoNucleonOvlaps_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#ae33c0e023fb0910fc860ff1eff826899">NSPECT</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#a3826d43474e5dbf51dceeb9139424b65">DIMSPECT</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#ab671ca0c88534d52f37d97f859724ae3">NSPECY</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#a8676f56fa2c8355341de6cd91fce76bd">DIMSPECY</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#af6f0837c4fc06557f1e794dd7b4b7215">initOpTwoNucleonOvlapsT</a> (<a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#ac2dd5946e6d66da867e0d4c02e3ffec2">initOpTwoNucleonOvlapsY</a> (<a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#a813228f3a44d04c8acac4f7a36d44af4">calcTwoNucleonOvlapsTod</a> (<a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, complex double *specamplitude)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#aca4839b03efec1a48345e36681a38f47">calcTwoNucleonOvlapsYod</a> (<a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, complex double *specamplitude)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#a1f423615182ab53d6dd2201e12defe74">writeTwoNucleonOvlapsT</a> (FILE *fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *p, int jfin, int pfin, int afin, int jini, int pini, int aini, void *specamplitudeme, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Efin, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Eini)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#a2de3e55fcc2cf2103dbfbbdd52842c8c">writeTwoNucleonOvlapsY</a> (FILE *fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *p, int jfin, int pfin, int afin, int jini, int pini, int aini, void *specamplitudeme, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Efin, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Eini)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#a27618835b886ee86f9707dac5260c475">OpTwoNucleonOvlapT</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#a23a6348eedc1b188ead3687598bbf416">OpTwoNucleonOvlapY</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structManyBodyOperators.html">ManyBodyOperators</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#a6855ba60fa34935959b73f65750280d2">OpTwoNucleonOvlapsT</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structManyBodyOperators.html">ManyBodyOperators</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="TwoNucleonOvlaps_8h.html#ade9c32f91dd05269ada365952484874c">OpTwoNucleonOvlapsY</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>calculate two-nucleon spectroscopic amplitudes in momentum space</p>
<p>(c) 2012 Thomas Neff </p>

<p>Definition in file <a class="el" href="TwoNucleonOvlaps_8h_source.html">TwoNucleonOvlaps.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a3826d43474e5dbf51dceeb9139424b65"></a><!-- doxytag: member="TwoNucleonOvlaps.h::DIMSPECT" ref="a3826d43474e5dbf51dceeb9139424b65" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIMSPECT&nbsp;&nbsp;&nbsp;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00032">32</a> of file <a class="el" href="TwoNucleonOvlaps_8h_source.html">TwoNucleonOvlaps.h</a>.</p>

<p>Referenced by <a class="el" href="TwoNucleonOvlapsSlave_8c_source.html#l00034">TwoNucleonOvlapsSlave()</a>.</p>

</div>
</div>
<a class="anchor" id="a8676f56fa2c8355341de6cd91fce76bd"></a><!-- doxytag: member="TwoNucleonOvlaps.h::DIMSPECY" ref="a8676f56fa2c8355341de6cd91fce76bd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIMSPECY&nbsp;&nbsp;&nbsp;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00035">35</a> of file <a class="el" href="TwoNucleonOvlaps_8h_source.html">TwoNucleonOvlaps.h</a>.</p>

<p>Referenced by <a class="el" href="TwoNucleonOvlapsSlave_8c_source.html#l00034">TwoNucleonOvlapsSlave()</a>.</p>

</div>
</div>
<a class="anchor" id="ae33c0e023fb0910fc860ff1eff826899"></a><!-- doxytag: member="TwoNucleonOvlaps.h::NSPECT" ref="ae33c0e023fb0910fc860ff1eff826899" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NSPECT&nbsp;&nbsp;&nbsp;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00031">31</a> of file <a class="el" href="TwoNucleonOvlaps_8h_source.html">TwoNucleonOvlaps.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab671ca0c88534d52f37d97f859724ae3"></a><!-- doxytag: member="TwoNucleonOvlaps.h::NSPECY" ref="ab671ca0c88534d52f37d97f859724ae3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NSPECY&nbsp;&nbsp;&nbsp;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00034">34</a> of file <a class="el" href="TwoNucleonOvlaps_8h_source.html">TwoNucleonOvlaps.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a813228f3a44d04c8acac4f7a36d44af4"></a><!-- doxytag: member="TwoNucleonOvlaps.h::calcTwoNucleonOvlapsTod" ref="a813228f3a44d04c8acac4f7a36d44af4" args="(TwoNucleonOvlapsPara *par, const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, complex double *specamplitude)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcTwoNucleonOvlapsTod </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double *&nbsp;</td>
          <td class="paramname"> <em>specamplitude</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00305">305</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8c_source.html#l00264">boostSlaterDet()</a>, <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="SlaterDet_8c_source.html#l00180">copySlaterDet()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00049">dimoT</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00060">dimoY</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="SlaterDet_8c_source.html#l00041">initSlaterDet()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00048">ioT</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00059">ioY</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="physics_8c_source.html#l00033">mneutron</a>, <a class="el" href="physics_8c_source.html#l00032">mproton</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00026">TwoNucleonOvlapsPara::nalpha</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00027">TwoNucleonOvlapsPara::ncosb</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00025">TwoNucleonOvlapsPara::npoints</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00074">q</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00076">Q</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00024">TwoNucleonOvlapsPara::qmax</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00028">TwoNucleonOvlapsPara::recoil</a>, <a class="el" href="gaussquad_8c_source.html#l00255">ShiftedPeriodicTrapezoidalPoints()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00043">specTJ</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00047">specTj</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00044">specTL</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00045">specTl</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00046">specTS</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="sphericalharmonics_8c_source.html#l00025">Y()</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="TwoNucleonOvlapsSlave_8c_source.html#l00034">TwoNucleonOvlapsSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> qmax = par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa6f0b6c0bdaad678c47351e501d98160">qmax</a>;
  <span class="keywordtype">int</span> ialphaQ, ialphaq, nalpha = par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a775a5401cefa646649998e9db1ec4240">nalpha</a>;
  <span class="keywordtype">int</span> icosbQ, icosbq, ncosb = par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a79b23a8d691e8452632b0576d7de7883">ncosb</a>;
  <span class="keywordtype">int</span> npoints = par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>; <span class="keywordtype">int</span> npoints2 = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(npoints);
  <span class="keywordtype">int</span> ML, ml, ms1, ms2, MS, mj, M, o, iQ, iq;
  <span class="keywordtype">int</span> L, <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, S, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, J;
  <span class="keywordtype">double</span> alphaQ, alphaq, betaQ, betaq, weightQ, weightq;
  <span class="keywordtype">double</span> Ql, ql, Q[3], <a class="code" href="MinimizerDONLP2_8c.html#a116d67c73cdfa395275c96c0151ddcd4">q</a>[3], k1[3], k2[3];
  complex <span class="keywordtype">double</span> sa[2][2];
  <span class="keywordtype">int</span> gaussoverlapsdone = 0;

  <span class="comment">// initialize workspace if necessary</span>
  <span class="keywordflow">if</span> (!QAp) {
    QAp = malloc(<span class="keyword">sizeof</span>(<a class="code" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a>));
    <a class="code" href="SlaterDet_8c.html#a16db6f53cfee239b7d506c86bc372686">initSlaterDet</a>(QA, QAp);
    
    <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(QB-&gt;A)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
    nlu = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(QB-&gt;A)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  }

  <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(QA, QAp);

  <span class="comment">// add two nucleons with momenta q1 and q2</span>
  <span class="comment">// proton/proton or neutron/neutron</span>
  <span class="keywordtype">int</span> iso1, iso2;
  <span class="keywordflow">if</span> (QA-&gt;Z == QB-&gt;Z) {
    iso1 = -1; iso2 = -1;
  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (QA-&gt;Z+1 == QB-&gt;Z) {
    fprintf(stderr, <span class="stringliteral">&quot;pn case not implemented yet !\n&quot;</span>);
    exit(-1);
  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (QA-&gt;Z+2 == QB-&gt;Z) {
    iso1 = +1; iso2 = +1;
  }

  <span class="keywordtype">double</span> massA = QA-&gt;Z*<a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a>+QA-&gt;N*<a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>;
  <span class="keywordtype">double</span> mass1 = (iso1 == +1) ? <a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a> : <a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>;
  <span class="keywordtype">double</span> mass2 = (iso2 == +1) ? <a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a> : <a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>;

  <span class="keywordflow">for</span> (o=0; o&lt;NSPECT; o++)
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="TwoNucleonOvlaps_8c.html#aa74aac286de883ea1bd19034aa987dd5">dimoT</a>[o]*npoints2; i++)
      specamplitude[i+<a class="code" href="TwoNucleonOvlaps_8c.html#a74a1c4825e0e0b1ac48a4cc87d5e0d7c">ioT</a>[o]*npoints2] = 0.0;

  <span class="keywordtype">double</span> alphal[nalpha], walphal[nalpha];
  <span class="keywordtype">double</span> cosbl[ncosb], wcosbl[ncosb];
  
  <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(nalpha, 0, 2*M_PI, 0.0, alphal, walphal);
  <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(ncosb, -1, 1, cosbl, wcosbl); 

  <span class="keywordflow">for</span> (iQ=0; iQ&lt;npoints; iQ++) {
    Ql = 2*qmax* iQ/(npoints-1);
    <span class="keywordflow">for</span> (ialphaQ=0; ialphaQ&lt;nalpha; ialphaQ++)
      <span class="keywordflow">for</span> (icosbQ=0; icosbQ&lt;ncosb; icosbQ++) {
        alphaQ = alphal[ialphaQ];
        betaQ = acos(cosbl[icosbQ]);
        weightQ = walphal[ialphaQ]*wcosbl[icosbQ];

        Q[0] = Ql*cos(alphaQ)*sin(betaQ); 
        Q[1] = Ql*sin(alphaQ)*sin(betaQ);
        Q[2] = Ql*cos(betaQ);

        <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#ac48b7a72227d617ba438b7b32fd3b02b">recoil</a>) {
          <span class="comment">// boost QA by -Q</span>
          <span class="keywordtype">double</span> VcmA[3] = {-Q[0]/massA, -Q[1]/massA, -Q[2]/massA};
          <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(QA, QAp);
          <a class="code" href="SlaterDet_8c.html#ad154093b24c00e82ac9129d87cd2e049" title="boost Slater determinant with speed v">boostSlaterDet</a>(QAp, VcmA);
          gaussoverlapsdone = 0;
        }

        <span class="keywordflow">if</span> (!gaussoverlapsdone) {
          calcOvlapsAB(QAp, QB, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
          gaussoverlapsdone = 1;
        }

        <span class="keywordflow">for</span> (iq=0; iq&lt;npoints; iq++) {
          ql = qmax* iq/(npoints-1);
          <span class="keywordflow">for</span> (ialphaq=0; ialphaq&lt;nalpha; ialphaq++)
            <span class="keywordflow">for</span> (icosbq=0; icosbq&lt;ncosb; icosbq++) {
              alphaq = alphal[ialphaq];
              betaq = acos(cosbl[icosbq]);
              weightq = walphal[ialphaq]*wcosbl[icosbq];

              q[0] = ql*cos(alphaq)*sin(betaq); 
              q[1] = ql*sin(alphaq)*sin(betaq);
              q[2] = ql*cos(betaq);

              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++) {
                k1[i] = q[i] + mass1/(mass1+mass2)*Q[i];
                k2[i] = -q[i] + mass2/(mass1+mass2)*Q[i];
              }

              calcSpecOvlaps(QAp, iso1, k1, iso2, k2, QB, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, nlu, sa);

              <span class="keywordflow">for</span> (ms1=-1; ms1&lt;=1; ms1=ms1+2) {
                <span class="keywordflow">for</span> (ms2=-1; ms2&lt;=1; ms2=ms2+2) {

                  <span class="keywordflow">for</span> (o=0; o&lt;NSPECT; o++) {
                    l = <a class="code" href="TwoNucleonOvlaps_8c.html#a9fdc7db95307db0488033b1745ae3659">specTl</a>[o]; S = <a class="code" href="TwoNucleonOvlaps_8c.html#a799c0d3c76c8c033ab6f51729aeac0b2">specTS</a>[o]; j = <a class="code" href="TwoNucleonOvlaps_8c.html#a346389ced6c5a76ae3efbe7ef4850c95">specTj</a>[o];
                    L = <a class="code" href="TwoNucleonOvlaps_8c.html#a359edb37c2ff443095909d7b0325ddbf">specTL</a>[o]; J = <a class="code" href="TwoNucleonOvlaps_8c.html#ae8fd57e78f344134feed2c77c779d666">specTJ</a>[o];
                    
                    MS = ms1+ms2;
                    <span class="keywordflow">if</span> (-S&lt;=MS &amp;&amp; MS &lt;= S) {
                      <span class="keywordflow">for</span> (M=-J; M&lt;=J; M=M+2) {
                        <span class="keywordflow">for</span> (ML=-L; ML&lt;=L; ML=ML+2) {
                          mj = M-ML;
                          <span class="keywordflow">if</span> (-j&lt;=mj &amp;&amp; mj&lt;=j) {
                            ml = mj-MS;
                            <span class="keywordflow">if</span> (-l&lt;=ml &amp;&amp; ml&lt;=l) {

                              <span class="comment">// are the phase factors correct ?</span>

                              specamplitude[(-M+J)/2 + (iq+iQ*npoints)*<a class="code" href="TwoNucleonOvlaps_8c.html#a9ba4ab984e4b0c07b26bd049de110f36">dimoY</a>[o] + <a class="code" href="TwoNucleonOvlaps_8c.html#a024792bb15077ceb38a449c4a68ec3d2">ioY</a>[o]*npoints2] += 1.0/sqrt(2.0)*weightQ*weightq*
                                ((1-ms1)%4 ? -1 : +1)* ((1-ms2)%4 ? -1 : +1)*
                                ((l-ml)%4 ? -1 : +1)* ((L-ML)%4 ? -1 : +1)*
                                <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(L, j, J, ML, mj, M)*
                                <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(l, S, j, ml, MS, mj)*
                                <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(1, 1, S, ms1, ms2, MS)* 
                                sa[(ms1+1)/2][(ms2+1)/2]* 
                                conj(<a class="code" href="sphericalharmonics_8c.html#a4517398bd7d1af1c7b318fab1d18dde0">Y</a>(L,ML,betaQ,alphaQ))*
                                conj(<a class="code" href="sphericalharmonics_8c.html#a4517398bd7d1af1c7b318fab1d18dde0">Y</a>(l,ml,betaq,alphaq));
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
        }
      }
  }     
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aca4839b03efec1a48345e36681a38f47"></a><!-- doxytag: member="TwoNucleonOvlaps.h::calcTwoNucleonOvlapsYod" ref="aca4839b03efec1a48345e36681a38f47" args="(TwoNucleonOvlapsPara *par, const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, complex double *specamplitude)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcTwoNucleonOvlapsYod </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double *&nbsp;</td>
          <td class="paramname"> <em>specamplitude</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00444">444</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8c_source.html#l00264">boostSlaterDet()</a>, <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="SlaterDet_8c_source.html#l00180">copySlaterDet()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00060">dimoY</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="SlaterDet_8c_source.html#l00041">initSlaterDet()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00059">ioY</a>, <a class="el" href="physics_8c_source.html#l00033">mneutron</a>, <a class="el" href="physics_8c_source.html#l00032">mproton</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00026">TwoNucleonOvlapsPara::nalpha</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00027">TwoNucleonOvlapsPara::ncosb</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00025">TwoNucleonOvlapsPara::npoints</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00024">TwoNucleonOvlapsPara::qmax</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00028">TwoNucleonOvlapsPara::recoil</a>, <a class="el" href="gaussquad_8c_source.html#l00255">ShiftedPeriodicTrapezoidalPoints()</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00054">specYJ</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00055">specYj1</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00057">specYj2</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00056">specYl1</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00058">specYl2</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="sphericalharmonics_8c_source.html#l00025">Y()</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="TwoNucleonOvlapsSlave_8c_source.html#l00034">TwoNucleonOvlapsSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> qmax = par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa6f0b6c0bdaad678c47351e501d98160">qmax</a>;
  <span class="keywordtype">int</span> ialpha1, ialpha2, nalpha = par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a775a5401cefa646649998e9db1ec4240">nalpha</a>;
  <span class="keywordtype">int</span> icosb1, icosb2, ncosb = par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a79b23a8d691e8452632b0576d7de7883">ncosb</a>;
  <span class="keywordtype">int</span> npoints = par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>; <span class="keywordtype">int</span> npoints2 = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(npoints);
  <span class="keywordtype">int</span> m1, m2, ml1, ml2, ms1, ms2, M, o, i1, i2;
  <span class="keywordtype">int</span> j1, j2, l1, l2, J;
  <span class="keywordtype">double</span> alpha1, alpha2, beta1, beta2, weight1, weight2;
  <span class="keywordtype">double</span> q1l, q2l, q1[3], q2[3], k1[3], k2[3];
  complex <span class="keywordtype">double</span> sa[2][2];
  <span class="keywordtype">int</span> gaussoverlapsdone = 0;

  <span class="comment">// initialize workspace if necessary</span>
  <span class="keywordflow">if</span> (!QAp) {
    QAp = malloc(<span class="keyword">sizeof</span>(<a class="code" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a>));
    <a class="code" href="SlaterDet_8c.html#a16db6f53cfee239b7d506c86bc372686">initSlaterDet</a>(QA, QAp);
    
    <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(QB-&gt;A)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
    nlu = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(QB-&gt;A)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  }

  <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(QA, QAp);

  <span class="comment">// add two nucleons with momenta q1 and q2</span>
  <span class="comment">// proton/proton or neutron/neutron</span>
  <span class="keywordtype">int</span> iso1, iso2;
  <span class="keywordflow">if</span> (QA-&gt;Z == QB-&gt;Z) {
    iso1 = -1; iso2 = -1;
  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (QA-&gt;Z+1 == QB-&gt;Z) {
    fprintf(stderr, <span class="stringliteral">&quot;pn case not implemented yet !\n&quot;</span>);
    exit(-1);
  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (QA-&gt;Z+2 == QB-&gt;Z) {
    iso1 = +1; iso2 = +1;
  }

  <span class="keywordtype">double</span> massA = QA-&gt;Z*<a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a>+QA-&gt;N*<a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>;
  <span class="keywordtype">double</span> massB = QB-&gt;Z*<a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a>+QB-&gt;N*<a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>;
  <span class="keywordtype">double</span> mass1 = (iso1 == +1) ? <a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a> : <a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>;
  <span class="keywordtype">double</span> mass2 = (iso2 == +1) ? <a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a> : <a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>;

  <span class="keywordflow">for</span> (o=0; o&lt;NSPECY; o++)
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="TwoNucleonOvlaps_8c.html#a9ba4ab984e4b0c07b26bd049de110f36">dimoY</a>[o]*npoints2; i++)
      specamplitude[i+<a class="code" href="TwoNucleonOvlaps_8c.html#a024792bb15077ceb38a449c4a68ec3d2">ioY</a>[o]*npoints2] = 0.0;

  <span class="keywordtype">double</span> alphal[nalpha], walphal[nalpha];
  <span class="keywordtype">double</span> cosbl[ncosb], wcosbl[ncosb];
  
  <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(nalpha, 0, 2*M_PI, 0.0, alphal, walphal);
  <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(ncosb, -1, 1, cosbl, wcosbl); 

  <span class="keywordflow">for</span> (i1=0; i1&lt;npoints; i1++) {
    q1l = qmax* i1/(npoints-1);
    <span class="keywordflow">for</span> (i2=0; i2&lt;npoints; i2++) {
      q2l = qmax* i2/(npoints-1);

      <span class="keywordflow">for</span> (ialpha1=0; ialpha1&lt;nalpha; ialpha1++)
        <span class="keywordflow">for</span> (icosb1=0; icosb1&lt;ncosb; icosb1++) {
          alpha1 = alphal[ialpha1];
          beta1 = acos(cosbl[icosb1]);
          weight1 = walphal[ialpha1]*wcosbl[icosb1];
          
          q1[0] = q1l*cos(alpha1)*sin(beta1); 
          q1[1] = q1l*sin(alpha1)*sin(beta1);
          q1[2] = q1l*cos(beta1); 

          <span class="keywordflow">for</span> (ialpha2=0; ialpha2&lt;nalpha; ialpha2++)
            <span class="keywordflow">for</span> (icosb2=0; icosb2&lt;ncosb; icosb2++) {
              alpha2 = alphal[ialpha2];
              beta2 = acos(cosbl[icosb2]);
              weight2 = walphal[ialpha2]*wcosbl[icosb2];

              q2[0] = q2l*cos(alpha2)*sin(beta2); 
              q2[1] = q2l*sin(alpha2)*sin(beta2);
              q2[2] = q2l*cos(beta2);

              <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#ac48b7a72227d617ba438b7b32fd3b02b">recoil</a>) {
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++) {
                  k1[i] = q1[i] - mass1/(mass1+massA)*q2[i];
                  k2[i] = q2[i];
                } 
              } <span class="keywordflow">else</span> {
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++) {
                  k1[i] = q1[i];
                  k2[i] = q2[i];
                }
              }

              <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#ac48b7a72227d617ba438b7b32fd3b02b">recoil</a>) {
                <span class="comment">// boost QA by -(k1+k2)</span>
                <span class="keywordtype">double</span> VcmA[3] = {-(k1[0]+k2[0])/massA, -(k1[1]+k2[1])/massA, -(k1[2]+k2[2])/massA};
                <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(QA, QAp);
                <a class="code" href="SlaterDet_8c.html#ad154093b24c00e82ac9129d87cd2e049" title="boost Slater determinant with speed v">boostSlaterDet</a>(QAp, VcmA);
                gaussoverlapsdone = 0;
              }

              <span class="keywordflow">if</span> (!gaussoverlapsdone) {
                calcOvlapsAB(QAp, QB, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
                gaussoverlapsdone = 1;
              }

              calcSpecOvlaps(QAp, iso1, k1, iso2, k2, QB, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, nlu, sa);

              <span class="keywordflow">for</span> (ms1=-1; ms1&lt;=1; ms1=ms1+2) {
                <span class="keywordflow">for</span> (ms2=-1; ms2&lt;=1; ms2=ms2+2) {
                  <span class="keywordflow">for</span> (o=0; o&lt;NSPECY; o++) {
                    j1 = <a class="code" href="TwoNucleonOvlaps_8c.html#a3c1af70613ec7cb550287e08f1ba42c7">specYj1</a>[o]; l1 = <a class="code" href="TwoNucleonOvlaps_8c.html#ab528d6375a5e17995edb97c011d33bc6">specYl1</a>[o];
                    j2 = <a class="code" href="TwoNucleonOvlaps_8c.html#a7522d17c378108314aff68325abfa8e7">specYj2</a>[o]; l2 = <a class="code" href="TwoNucleonOvlaps_8c.html#a1c8359131136f3e2224fe8bb41b2ddfa">specYl2</a>[o];
                    J = <a class="code" href="TwoNucleonOvlaps_8c.html#a27f5b4cbfbdbb5033be3ee065cdce2f7">specYJ</a>[o];
                    
                    <span class="keywordflow">for</span> (M=-J; M&lt;=J; M=M+2) {
                      <span class="keywordflow">for</span> (m1=-j1; m1&lt;=j1; m1=m1+2) {
                        m2 = M-m1;
                        <span class="keywordflow">if</span> (-j2&lt;=m2 &amp;&amp; m2&lt;=j2) {
                          ml1 = m1-ms1;
                          <span class="keywordflow">if</span> (-l1&lt;=ml1 &amp;&amp; ml1&lt;=l1) {
                            ml2 = m2-ms2;
                            <span class="keywordflow">if</span> (-l2&lt;=ml2 &amp;&amp; ml2&lt;=l2) {

                              specamplitude[(-M+J)/2 + (i1+i2*npoints)*<a class="code" href="TwoNucleonOvlaps_8c.html#a9ba4ab984e4b0c07b26bd049de110f36">dimoY</a>[o] + <a class="code" href="TwoNucleonOvlaps_8c.html#a024792bb15077ceb38a449c4a68ec3d2">ioY</a>[o]*npoints2] += 1.0/sqrt(2.0)*weight1*weight2*
                                <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(j1, j2, J, m1, m2, M)*
                                ((j1-m1)%4 ? -1 : +1)* ((j2-m2)%4 ? -1 : +1)*
                                <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(l1, 1, j1, ml1, ms1, m1)*
                                <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(l2, 1, j2, ml2, ms2, m2)* 
                                sa[(ms1+1)/2][(ms2+1)/2]* 
                                conj(<a class="code" href="sphericalharmonics_8c.html#a4517398bd7d1af1c7b318fab1d18dde0">Y</a>(l1,ml1,beta1,alpha1))*
                                conj(<a class="code" href="sphericalharmonics_8c.html#a4517398bd7d1af1c7b318fab1d18dde0">Y</a>(l2,ml2,beta2,alpha2));
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
        }
    }
  }     
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="af6f0837c4fc06557f1e794dd7b4b7215"></a><!-- doxytag: member="TwoNucleonOvlaps.h::initOpTwoNucleonOvlapsT" ref="af6f0837c4fc06557f1e794dd7b4b7215" args="(TwoNucleonOvlapsPara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initOpTwoNucleonOvlapsT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00085">85</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="Projection_8h_source.html#l00130">ManyBodyOperators::dim</a>, <a class="el" href="Projection_8h_source.html#l00118">ManyBodyOperator::me</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00026">TwoNucleonOvlapsPara::nalpha</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="Projection_8h_source.html#l00127">ManyBodyOperators::name</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00027">TwoNucleonOvlapsPara::ncosb</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00025">TwoNucleonOvlapsPara::npoints</a>, <a class="el" href="Projection_8h_source.html#l00117">ManyBodyOperator::par</a>, <a class="el" href="Projection_8h_source.html#l00129">ManyBodyOperators::par</a>, <a class="el" href="Projection_8h_source.html#l00114">ManyBodyOperator::pi</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00024">TwoNucleonOvlapsPara::qmax</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00028">TwoNucleonOvlapsPara::recoil</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="Projection_8h_source.html#l00131">ManyBodyOperators::size</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00043">specTJ</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00045">specTl</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00044">specTL</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00042">specTlabel</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="calctwonucleonovlapst_8c_source.html#l00047">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span>* name = malloc(60);
  sprintf(name, <span class="stringliteral">&quot;TwoNucleonOvlapsT-%05.2f-%d-%d-%d%s&quot;</span>,
          par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa6f0b6c0bdaad678c47351e501d98160">qmax</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a775a5401cefa646649998e9db1ec4240">nalpha</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a79b23a8d691e8452632b0576d7de7883">ncosb</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#ac48b7a72227d617ba438b7b32fd3b02b">recoil</a> ? <span class="stringliteral">&quot;-recoil&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);

  <a class="code" href="TwoNucleonOvlaps_8c.html#a6855ba60fa34935959b73f65750280d2">OpTwoNucleonOvlapsT</a>.<a class="code" href="structManyBodyOperators.html#a331636b79824e209f31a9bfcac5bc026">name</a> = name;
  <a class="code" href="TwoNucleonOvlaps_8c.html#a6855ba60fa34935959b73f65750280d2">OpTwoNucleonOvlapsT</a>.<a class="code" href="structManyBodyOperators.html#aa1b09f1ea3ecfedd76ca27f7954ce65b" title="has to be the same for all Operators">dim</a> = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>);
  <a class="code" href="TwoNucleonOvlaps_8c.html#a6855ba60fa34935959b73f65750280d2">OpTwoNucleonOvlapsT</a>.<a class="code" href="structManyBodyOperators.html#a94494657638d56cc4a332f00aefcd1e4">size</a> = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>);
  <a class="code" href="TwoNucleonOvlaps_8c.html#a6855ba60fa34935959b73f65750280d2">OpTwoNucleonOvlapsT</a>.<a class="code" href="structManyBodyOperators.html#a63b81b5a508a075fd10b76ebd219094f" title="the same for all operators">par</a> = par;

  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;NSPECT; i++) {
    <span class="keywordtype">char</span>* name = malloc(60);
    sprintf(name, <span class="stringliteral">&quot;TwoNucleonOvlapsT%s-%05.2f-%d-%d-%d%s&quot;</span>,
            <a class="code" href="TwoNucleonOvlaps_8c.html#aea5d50fbbddf58a24113562b2a76b177">specTlabel</a>[i],
            par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa6f0b6c0bdaad678c47351e501d98160">qmax</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a775a5401cefa646649998e9db1ec4240">nalpha</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a79b23a8d691e8452632b0576d7de7883">ncosb</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#ac48b7a72227d617ba438b7b32fd3b02b">recoil</a> ? <span class="stringliteral">&quot;-recoil&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);
    <a class="code" href="TwoNucleonOvlaps_8c.html#a70b2ba6112c8d54f6ef8c508cd9ed4be">OpTwoNucleonOvlapT</a>[i].<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a> = name;
    <a class="code" href="TwoNucleonOvlaps_8c.html#a70b2ba6112c8d54f6ef8c508cd9ed4be">OpTwoNucleonOvlapT</a>[i].<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a> = <a class="code" href="TwoNucleonOvlaps_8c.html#ae8fd57e78f344134feed2c77c779d666">specTJ</a>[i];
    <a class="code" href="TwoNucleonOvlaps_8c.html#a70b2ba6112c8d54f6ef8c508cd9ed4be">OpTwoNucleonOvlapT</a>[i].<a class="code" href="structManyBodyOperator.html#a78ec7c9f2238907255cf499427676907" title="parity of operator, 0 positve, 1 negative">pi</a> = (<a class="code" href="TwoNucleonOvlaps_8c.html#a359edb37c2ff443095909d7b0325ddbf">specTL</a>[i]+<a class="code" href="TwoNucleonOvlaps_8c.html#a9fdc7db95307db0488033b1745ae3659">specTl</a>[i]) % 4 ? 1 : 0;
    <a class="code" href="TwoNucleonOvlaps_8c.html#a70b2ba6112c8d54f6ef8c508cd9ed4be">OpTwoNucleonOvlapT</a>[i].<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a> = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>);
    <a class="code" href="TwoNucleonOvlaps_8c.html#a70b2ba6112c8d54f6ef8c508cd9ed4be">OpTwoNucleonOvlapT</a>[i].<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a> = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>);
    <a class="code" href="TwoNucleonOvlaps_8c.html#a70b2ba6112c8d54f6ef8c508cd9ed4be">OpTwoNucleonOvlapT</a>[i].<a class="code" href="structManyBodyOperator.html#a05268b1b149040fd992263f2e22de7ec">par</a> = par;
    <a class="code" href="TwoNucleonOvlaps_8c.html#a70b2ba6112c8d54f6ef8c508cd9ed4be">OpTwoNucleonOvlapT</a>[i].<a class="code" href="structManyBodyOperator.html#aba2e7e550190ee2ec6e75c23c55fee2d">me</a> = NULL;
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac2dd5946e6d66da867e0d4c02e3ffec2"></a><!-- doxytag: member="TwoNucleonOvlaps.h::initOpTwoNucleonOvlapsY" ref="ac2dd5946e6d66da867e0d4c02e3ffec2" args="(TwoNucleonOvlapsPara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initOpTwoNucleonOvlapsY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00112">112</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="Projection_8h_source.html#l00130">ManyBodyOperators::dim</a>, <a class="el" href="Projection_8h_source.html#l00118">ManyBodyOperator::me</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00026">TwoNucleonOvlapsPara::nalpha</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="Projection_8h_source.html#l00127">ManyBodyOperators::name</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00027">TwoNucleonOvlapsPara::ncosb</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00025">TwoNucleonOvlapsPara::npoints</a>, <a class="el" href="Projection_8h_source.html#l00117">ManyBodyOperator::par</a>, <a class="el" href="Projection_8h_source.html#l00129">ManyBodyOperators::par</a>, <a class="el" href="Projection_8h_source.html#l00114">ManyBodyOperator::pi</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00024">TwoNucleonOvlapsPara::qmax</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00028">TwoNucleonOvlapsPara::recoil</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="Projection_8h_source.html#l00131">ManyBodyOperators::size</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00054">specYJ</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00056">specYl1</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00058">specYl2</a>, <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00053">specYlabel</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="calctwonucleonovlapsy_8c_source.html#l00047">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span>* name = malloc(60);
  sprintf(name, <span class="stringliteral">&quot;TwoNucleonOvlapsY-%05.2f-%d-%d-%d%s&quot;</span>,
          par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa6f0b6c0bdaad678c47351e501d98160">qmax</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a775a5401cefa646649998e9db1ec4240">nalpha</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a79b23a8d691e8452632b0576d7de7883">ncosb</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#ac48b7a72227d617ba438b7b32fd3b02b">recoil</a> ? <span class="stringliteral">&quot;-recoil&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);

  <a class="code" href="TwoNucleonOvlaps_8c.html#ade9c32f91dd05269ada365952484874c">OpTwoNucleonOvlapsY</a>.<a class="code" href="structManyBodyOperators.html#a331636b79824e209f31a9bfcac5bc026">name</a> = name;
  <a class="code" href="TwoNucleonOvlaps_8c.html#ade9c32f91dd05269ada365952484874c">OpTwoNucleonOvlapsY</a>.<a class="code" href="structManyBodyOperators.html#aa1b09f1ea3ecfedd76ca27f7954ce65b" title="has to be the same for all Operators">dim</a> = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>);
  <a class="code" href="TwoNucleonOvlaps_8c.html#ade9c32f91dd05269ada365952484874c">OpTwoNucleonOvlapsY</a>.<a class="code" href="structManyBodyOperators.html#a94494657638d56cc4a332f00aefcd1e4">size</a> = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>);
  <a class="code" href="TwoNucleonOvlaps_8c.html#ade9c32f91dd05269ada365952484874c">OpTwoNucleonOvlapsY</a>.<a class="code" href="structManyBodyOperators.html#a63b81b5a508a075fd10b76ebd219094f" title="the same for all operators">par</a> = par;

  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;NSPECY; i++) {
    <span class="keywordtype">char</span>* name = malloc(60);
    sprintf(name, <span class="stringliteral">&quot;TwoNucleonOvlapsY%s-%05.2f-%d-%d-%d%s&quot;</span>,
            <a class="code" href="TwoNucleonOvlaps_8c.html#a6f74e58d5909ea2c356a90ec85e08b1b">specYlabel</a>[i],
            par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa6f0b6c0bdaad678c47351e501d98160">qmax</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a775a5401cefa646649998e9db1ec4240">nalpha</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#a79b23a8d691e8452632b0576d7de7883">ncosb</a>, par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#ac48b7a72227d617ba438b7b32fd3b02b">recoil</a> ? <span class="stringliteral">&quot;-recoil&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);
    <a class="code" href="TwoNucleonOvlaps_8c.html#a3ab3751ac697c946839953ae37685c08">OpTwoNucleonOvlapY</a>[i].<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a> = name;
    <a class="code" href="TwoNucleonOvlaps_8c.html#a3ab3751ac697c946839953ae37685c08">OpTwoNucleonOvlapY</a>[i].<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a> = <a class="code" href="TwoNucleonOvlaps_8c.html#a27f5b4cbfbdbb5033be3ee065cdce2f7">specYJ</a>[i];
    <a class="code" href="TwoNucleonOvlaps_8c.html#a3ab3751ac697c946839953ae37685c08">OpTwoNucleonOvlapY</a>[i].<a class="code" href="structManyBodyOperator.html#a78ec7c9f2238907255cf499427676907" title="parity of operator, 0 positve, 1 negative">pi</a> = (<a class="code" href="TwoNucleonOvlaps_8c.html#ab528d6375a5e17995edb97c011d33bc6">specYl1</a>[i]+<a class="code" href="TwoNucleonOvlaps_8c.html#a1c8359131136f3e2224fe8bb41b2ddfa">specYl2</a>[i]) % 4 ? 1 : 0;
    <a class="code" href="TwoNucleonOvlaps_8c.html#a3ab3751ac697c946839953ae37685c08">OpTwoNucleonOvlapY</a>[i].<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a> = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>);
    <a class="code" href="TwoNucleonOvlaps_8c.html#a3ab3751ac697c946839953ae37685c08">OpTwoNucleonOvlapY</a>[i].<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a> = <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(par-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>);
    <a class="code" href="TwoNucleonOvlaps_8c.html#a3ab3751ac697c946839953ae37685c08">OpTwoNucleonOvlapY</a>[i].<a class="code" href="structManyBodyOperator.html#a05268b1b149040fd992263f2e22de7ec">par</a> = par;
    <a class="code" href="TwoNucleonOvlaps_8c.html#a3ab3751ac697c946839953ae37685c08">OpTwoNucleonOvlapY</a>[i].<a class="code" href="structManyBodyOperator.html#aba2e7e550190ee2ec6e75c23c55fee2d">me</a> = NULL;
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1f423615182ab53d6dd2201e12defe74"></a><!-- doxytag: member="TwoNucleonOvlaps.h::writeTwoNucleonOvlapsT" ref="a1f423615182ab53d6dd2201e12defe74" args="(FILE *fp, const Projection *P, const TwoNucleonOvlapsPara *p, int jfin, int pfin, int afin, int jini, int pini, int aini, void *specamplitudeme, const Eigenstates *Efin, const Eigenstates *Eini)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeTwoNucleonOvlapsT </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>jfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>afin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>jini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>aini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>specamplitudeme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Efin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Eini</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00591">591</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00025">TwoNucleonOvlapsPara::npoints</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00074">q</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00076">Q</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00024">TwoNucleonOvlapsPara::qmax</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="calctwonucleonovlapst_8c_source.html#l00047">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> ipjfin = idxpij(jmax,pfin,jfin);
  <span class="keywordtype">int</span> ipjini = idxpij(jmax,pini,jini);
  <span class="keywordtype">int</span> npoints = p-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>;
  <span class="keywordtype">double</span> qmax = p-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa6f0b6c0bdaad678c47351e501d98160">qmax</a>;
  <span class="keywordtype">int</span> idxfin = Efin-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipjfin][afin];
  <span class="keywordtype">int</span> idxini = Eini-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipjini][aini];
  <span class="keywordtype">double</span> normfin = Efin-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipjfin][idxfin];
  <span class="keywordtype">double</span> normini = Eini-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipjini][idxini];
  complex double (****specampme)[npoints] = specamplitudeme;
  complex <span class="keywordtype">double</span> *sa = specampme[ipjfin][ipjini][idxfin][idxini];
  <span class="keywordtype">int</span> iQ, iq;
  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="code" href="MinimizerDONLP2_8c.html#a116d67c73cdfa395275c96c0151ddcd4">q</a>;
  complex <span class="keywordtype">double</span> ml;
  
  <span class="comment">// calculate spectroscopic factor</span>
  <span class="keywordtype">double</span> dQ = 2*qmax/(npoints-1);
  <span class="keywordtype">double</span> dq = qmax/(npoints-1);

  <span class="keywordtype">double</span> S = 0.0;
  <span class="keywordflow">for</span> (iQ=0; iQ&lt;npoints; iQ++) {
    Q = iQ*dQ;
    <span class="keywordflow">for</span> (iq=0; iq&lt;npoints; iq++) {
      q = iq*dq;

      S += dq*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(q)*dQ*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(Q)* (jfin+1.0)/(jini+1.0)*
        <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(cabs(sa[iq+iQ*npoints]))/(normfin*normini);
    }
  }
  fprintf(stderr, <span class="stringliteral">&quot;Spectroscopic factor: %6.3f\n&quot;</span>, S);

  <span class="keywordflow">for</span> (iQ=0; iQ&lt;npoints; iQ++) {
    Q = iQ*dQ;

    <span class="keywordflow">for</span> (iq=0; iq&lt;npoints; iq++) {
      q = iq*dq;

      ml = sqrt((jfin+1.0)/(jini+1.0))* sa[iq+iQ*npoints]/sqrt(normfin*normini);

      fprintf(fp, <span class="stringliteral">&quot;(%13.5g, %13.5g)\t&quot;</span>, creal(ml), cimag(ml));
    }
    fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
  }

}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2de3e55fcc2cf2103dbfbbdd52842c8c"></a><!-- doxytag: member="TwoNucleonOvlaps.h::writeTwoNucleonOvlapsY" ref="a2de3e55fcc2cf2103dbfbbdd52842c8c" args="(FILE *fp, const Projection *P, const TwoNucleonOvlapsPara *p, int jfin, int pfin, int afin, int jini, int pini, int aini, void *specamplitudeme, const Eigenstates *Efin, const Eigenstates *Eini)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeTwoNucleonOvlapsY </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structTwoNucleonOvlapsPara.html">TwoNucleonOvlapsPara</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>jfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>afin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>jini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>aini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>specamplitudeme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Efin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Eini</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00647">647</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00025">TwoNucleonOvlapsPara::npoints</a>, <a class="el" href="TwoNucleonOvlaps_8h_source.html#l00024">TwoNucleonOvlapsPara::qmax</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="calctwonucleonovlapsy_8c_source.html#l00047">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> ipjfin = idxpij(jmax,pfin,jfin);
  <span class="keywordtype">int</span> ipjini = idxpij(jmax,pini,jini);
  <span class="keywordtype">int</span> npoints = p-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa5f57b94398f01a1104d7fd96743b429">npoints</a>;
  <span class="keywordtype">double</span> qmax = p-&gt;<a class="code" href="structTwoNucleonOvlapsPara.html#aa6f0b6c0bdaad678c47351e501d98160">qmax</a>;
  <span class="keywordtype">int</span> idxfin = Efin-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipjfin][afin];
  <span class="keywordtype">int</span> idxini = Eini-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipjini][aini];
  <span class="keywordtype">double</span> normfin = Efin-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipjfin][idxfin];
  <span class="keywordtype">double</span> normini = Eini-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipjini][idxini];
  complex double (****specampme)[npoints] = specamplitudeme;
  complex <span class="keywordtype">double</span> *sa = specampme[ipjfin][ipjini][idxfin][idxini];
  <span class="keywordtype">int</span> i1, i2;
  <span class="keywordtype">double</span> q1, q2;
  complex <span class="keywordtype">double</span> ml;
  
  <span class="comment">// calculate spectroscopic factor</span>
  <span class="keywordtype">double</span> dq = qmax/(npoints-1);

  <span class="keywordtype">double</span> S = 0.0;
  <span class="keywordflow">for</span> (i2=0; i2&lt;npoints; i2++) {
    q2 = i2*dq;
    <span class="keywordflow">for</span> (i1=0; i1&lt;npoints; i1++) {
      q1 = i1*dq;

      S += dq*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(q1)*dq*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(q2)* (jfin+1.0)/(jini+1.0)*
        <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(cabs(sa[i1+i2*npoints]))/(normfin*normini);
    }
  }
  fprintf(stderr, <span class="stringliteral">&quot;Spectroscopic factor: %6.3f\n&quot;</span>, S);

  <span class="keywordflow">for</span> (i1=0; i1&lt;npoints; i1++) {
    q1 = i1*dq;

    <span class="keywordflow">for</span> (i2=0; i2&lt;npoints; i2++) {
      q2 = i2*dq;

      ml = sqrt((jfin+1.0)/(jini+1.0))* sa[i1+i2*npoints]/sqrt(normfin*normini);

      fprintf(fp, <span class="stringliteral">&quot;(%13.5g, %13.5g)\t&quot;</span>, creal(ml), cimag(ml));
    }
    fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
  }

}
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a6855ba60fa34935959b73f65750280d2"></a><!-- doxytag: member="TwoNucleonOvlaps.h::OpTwoNucleonOvlapsT" ref="a6855ba60fa34935959b73f65750280d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structManyBodyOperators.html">ManyBodyOperators</a> <a class="el" href="TwoNucleonOvlaps_8h.html#a6855ba60fa34935959b73f65750280d2">OpTwoNucleonOvlapsT</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00072">72</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>Referenced by <a class="el" href="calctwonucleonovlapst_8c_source.html#l00047">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ade9c32f91dd05269ada365952484874c"></a><!-- doxytag: member="TwoNucleonOvlaps.h::OpTwoNucleonOvlapsY" ref="ade9c32f91dd05269ada365952484874c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structManyBodyOperators.html">ManyBodyOperators</a> <a class="el" href="TwoNucleonOvlaps_8h.html#ade9c32f91dd05269ada365952484874c">OpTwoNucleonOvlapsY</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00078">78</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>Referenced by <a class="el" href="calctwonucleonovlapsy_8c_source.html#l00047">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a27618835b886ee86f9707dac5260c475"></a><!-- doxytag: member="TwoNucleonOvlaps.h::OpTwoNucleonOvlapT" ref="a27618835b886ee86f9707dac5260c475" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> <a class="el" href="TwoNucleonOvlaps_8h.html#a27618835b886ee86f9707dac5260c475">OpTwoNucleonOvlapT</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00067">67</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>Referenced by <a class="el" href="calctwonucleonovlapst_8c_source.html#l00047">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a23a6348eedc1b188ead3687598bbf416"></a><!-- doxytag: member="TwoNucleonOvlaps.h::OpTwoNucleonOvlapY" ref="a23a6348eedc1b188ead3687598bbf416" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> <a class="el" href="TwoNucleonOvlaps_8h.html#a23a6348eedc1b188ead3687598bbf416">OpTwoNucleonOvlapY</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TwoNucleonOvlaps_8c_source.html#l00069">69</a> of file <a class="el" href="TwoNucleonOvlaps_8c_source.html">TwoNucleonOvlaps.c</a>.</p>

<p>Referenced by <a class="el" href="calctwonucleonovlapsy_8c_source.html#l00047">main()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
