<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/Projection.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>fmd/Projection.h File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;zlib.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Interaction_8h_source.html">Interaction.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Observables_8h_source.html">Observables.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Symmetry_8h_source.html">Symmetry.h</a>&quot;</code><br/>

<p><a href="Projection_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcmprodpara.html">cmprodpara</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcmpolypara.html">cmpolypara</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structangprodpara.html">angprodpara</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structangzcwpara.html">angzcwpara</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structangzcwintegrationpara.html">angzcwintegrationpara</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structangprodintegrationpara.html">angprodintegrationpara</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structangintegrationpara.html">angintegrationpara</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structProjection.html">Projection</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="structProjection.html" title="Projection.">Projection</a>.  <a href="structProjection.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">General ManyBody Operator.  <a href="structManyBodyOperator.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structManyBodyOperators.html">ManyBodyOperators</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Collection of ManyBody Operators.  <a href="structManyBodyOperators.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structEigenstates.html">Eigenstates</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Container for <a class="el" href="structEigenstates.html" title="Container for Eigenstates.">Eigenstates</a>.  <a href="structEigenstates.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structAmplitudes.html">Amplitudes</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a6f799b3fb32ecd6a70300d45fe1dfaad">JMAX</a>&nbsp;&nbsp;&nbsp;9</td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a8d869da79c82654982e95e61d10a64c4">CMNone</a>, 
<a class="el" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a0e967fc9236e1bb9b51ddb4c16fd096e">CMSimple</a>, 
<a class="el" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a3ebfa1463485cc7babb95b427075772a">CMProd</a>, 
<a class="el" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf">CMPoly</a>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Integration for CM projection using Product integration or Polyhedron points. </p>
 <a href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba55bf53a0f8c9f993e6faf4c61fe8ce10">AngNone</a>, 
<a class="el" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9610a33497e9e2e45e79bc44d5ef918f">AngProd</a>, 
<a class="el" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167babf044d8a168c981d4076daf448fae0fc">AngProdA</a>, 
<a class="el" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9ecd3bfb04930e544c099805a7b847a6">AngZCW</a>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Integration over Euler angles using Product integration or ZCW points. </p>
 <a href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167b">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a5dbae736727dbf5f2d43e571751344d1">AngmomtoStr</a> (int <a class="el" href="MinimizerDONLP2vappiso_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, int pi)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#ac87bb7fb183abeb15fc0454df5babd55">ProjectiontoStr</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a9cf9855bec48b5aac8d96335102c0afa">initAngintegration</a> (<a class="el" href="structangintegrationpara.html">angintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>, const char *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a5c0336acd3f2e1e48e88942a353129cd">freeAngintegration</a> (<a class="el" href="structangintegrationpara.html">angintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a8933a4a47f0572f2e2943562cd45aac5">initProjection</a> (<a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, int odd, const char *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#af11f2a70292f93f6b5983cfc4f26d774">fprintProjectinfo</a> (FILE *fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#ab04781bf318f9779ad81b00b7d9b1837">initprojectedVector</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#af1e4c360c6c9a7eb8cffcaa091201829">initprojectedVectornull</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#aef486ac2facdd165978efd4f5bc5009d">initprojectedtransitionVector</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, int np)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a76abdc07adaf79ddd74c8402f049c8a6">initprojectedtransitionVectornull</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, int np)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#acef8d2b9b483edf18c061e6c4fb464d2">initprojectedMBME</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">store projected MEs between two ManyBody states  <a href="#acef8d2b9b483edf18c061e6c4fb464d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#abf4911adb463930dc540277d1da25c35">initcmintegration</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a290947c34bd2d28ab9f553b424ce0b83">initCMintegration</a> (<a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>, const char *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#afd49fd9499450859075a07b9c48230d3">_initcmintegration</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, double <a class="el" href="physics_8h.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>, <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a2d6f83cd77e06f6e3706b09dcd0eec9b">reinitcmintegration</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a7ae9754fe9db92205d761777cfa5e336">freecmintegration</a> (<a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a4cde89930e46342aae042ab854f2290b">getcmintegrationpoint</a> (int i, const <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>, double <a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>[3], double *w)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#ae7ea91fc189ad0a0487363668e0ffa89">initangintegration</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, <a class="el" href="structangintegrationpara.html">angintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a96407d07755537e4db8a7047f7a3549d">_estimateangkappa</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a1fdfb90bdc7cedf8097a4c9c0e907653">_setangkappacrit</a> (double kappa)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a58a9090fd80baea2ab54d2032e2531fd">_getangkappacrit</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a80b9d82dadcaadc0a6026004285b49f4">_initangintegration</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, double kappa, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, <a class="el" href="structangintegrationpara.html">angintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a311baa8e8355d7a129021e5941641568">reinitangintegration</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, <a class="el" href="structangintegrationpara.html">angintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a84c53149d9af0a652cb6486c9516cbb5">getangintegrationpoint</a> (int i, const <a class="el" href="structangintegrationpara.html">angintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>, double *<a class="el" href="physics_8h.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>, double *beta, double *gamma, double *w)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a044ac20ed8962994aa88e59cbc93870e">calcprojectedMBME</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, void *mbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#aea2e08302b36a68b650325373e8139df">calcprojectedMBMEs</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperators.html">ManyBodyOperators</a> *Ops, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, void *mbmes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#af62aa4946bfad00289f9e804aba1bd6c">calcprojectedMBMEsingular</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, void *mbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a769abddc6e28e099e9725712b7ed2104">hermitizeprojectedMBME</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, void *mbme, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a086dc7277e11cd8a2335f25cb14c66b8">writeprojectedMBME</a> (gzFile fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, const void *mbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a9f0871c9ab882dc39462783988c4eab2">writeprojectedMBMEtoFile</a> (const char *mbfile, const char *mbfilep, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, const void *mbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a24221ca9708e29fc5ea20304505d5399">readprojectedMBME</a> (gzFile fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, void *mbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a56dd7948b0969a553329ddf6dcdc27c3">readprojectedMBMEfromFile</a> (const char *mbfile, const char *mbfilep, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> S, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> Sp, void *mbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a9be2f82e183827f27b5edbefcb794740">initEigenstates</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, <a class="el" href="structEigenstates.html">Eigenstates</a> *E, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a24150e1691aa16292612bec682cca3ae">initAmplitudes</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, <a class="el" href="structAmplitudes.html">Amplitudes</a> *A, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#ae1d7e6ab780b680233363090cdb2764f">calcEigenstates</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structInteraction.html">Interaction</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ae051dcd567638cf29379a3fec796679c">Int</a>, const <a class="el" href="structObservablesod.html">Observablesod</a> ***obsme, <a class="el" href="structEigenstates.html">Eigenstates</a> *E, double thresh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a2c888ae8f28458b06d1ccc71e4f31577">calcEigenstatesK</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structInteraction.html">Interaction</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ae051dcd567638cf29379a3fec796679c">Int</a>, const <a class="el" href="structObservablesod.html">Observablesod</a> ***obsme, <a class="el" href="structEigenstates.html">Eigenstates</a> *E, int K, double thresh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a056b9a28cb7f2d352eb665582e9be9fb">calcMultiEigenstates</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structInteraction.html">Interaction</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ae051dcd567638cf29379a3fec796679c">Int</a>, const <a class="el" href="structObservablesod.html">Observablesod</a> ***obsme, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Ep, <a class="el" href="structEigenstates.html">Eigenstates</a> *multiE, <a class="el" href="structAmplitudes.html">Amplitudes</a> *multiA, double thresh)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a8496ec48cbc243bb807deeb60339a251">calcexpectprojectedMBME</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const void *mbme, const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *S, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E, void *expectmbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a0aba2ec1c91bc314f7d6dd6529608050">calcexpectprojectedMBMEipj</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const void *mbme, const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *S, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E, int <a class="el" href="MinimizerDONLP2vappiso_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, int p, int i, void *expectmbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a54006a58b4e31d612773ec5019bd79ef">calctransitionprojectedMBME</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const void *mbme, const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *S, const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *Sp, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Ep, void *transmbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a00b2cd7ac851155cf70fc58d1cc3ab16">calctransitionprojectedMBMEipj</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *Op, const void *mbme, const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *S, const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *Sp, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Ep, int jini, int pini, int iini, int jfin, int pfin, int ifin, void *transmbme)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a465ddb73457c8835e9a944d35b54f79a">sortEigenstates</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structInteraction.html">Interaction</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ae051dcd567638cf29379a3fec796679c">Int</a>, const <a class="el" href="structObservablesod.html">Observablesod</a> **obs, <a class="el" href="structEigenstates.html">Eigenstates</a> *E, double minnorm, int all)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a6efb4a37227aadf15910f7270a97a486">writeEigenstates</a> (FILE *fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a21bd7a5920ce98dea99f5ecbe591b799">readEigenstates</a> (FILE *fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, <a class="el" href="structEigenstates.html">Eigenstates</a> *E, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a5935cc6b0a5d47d441ca31d6fedbe5cc">readEigenstatesfromFile</a> (const char *fname, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, <a class="el" href="structEigenstates.html">Eigenstates</a> *E, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#a217536fb9853df72dc83c7a27de713f0">writeMulticonfigfile</a> (const char *fname, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *S, const char **mbfile, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E, int <a class="el" href="donlp2_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Projection_8h.html#ae36142d2bd6e101eb90230d5cf022f37">readMulticonfigfile</a> (const char *fname, char ***slaterdetfile, <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, <a class="el" href="structSlaterDet.html">SlaterDet</a> **<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> **S, <a class="el" href="structEigenstates.html">Eigenstates</a> *E, int *nstates)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>angular momentum and linear momentum projection of matrix elements</p>
<p>(c) 2005-2011 Thomas Neff </p>

<p>Definition in file <a class="el" href="Projection_8h_source.html">Projection.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a6f799b3fb32ecd6a70300d45fe1dfaad"></a><!-- doxytag: member="Projection.h::JMAX" ref="a6f799b3fb32ecd6a70300d45fe1dfaad" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JMAX&nbsp;&nbsp;&nbsp;9</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8h_source.html#l00160">160</a> of file <a class="el" href="Projection_8h_source.html">Projection.h</a>.</p>

<p>Referenced by <a class="el" href="DiClusterMulticonfig_8c_source.html#l00362">DiClusterMulticonfigRead()</a>, <a class="el" href="DiClusterMultiProjSlaterDet_8c_source.html#l00253">DiClusterMultiProjSlaterDetRead()</a>, and <a class="el" href="Projection_8c_source.html#l00055">ProjectiontoStr()</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ae4d5251432e1a9e6803c0240cc492e18"></a><!-- doxytag: member="Projection.h::@25" ref="ae4d5251432e1a9e6803c0240cc492e18" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Integration for CM projection using Product integration or Polyhedron points. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ae4d5251432e1a9e6803c0240cc492e18a8d869da79c82654982e95e61d10a64c4"></a><!-- doxytag: member="CMNone" ref="ae4d5251432e1a9e6803c0240cc492e18a8d869da79c82654982e95e61d10a64c4" args="" -->CMNone</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae4d5251432e1a9e6803c0240cc492e18a0e967fc9236e1bb9b51ddb4c16fd096e"></a><!-- doxytag: member="CMSimple" ref="ae4d5251432e1a9e6803c0240cc492e18a0e967fc9236e1bb9b51ddb4c16fd096e" args="" -->CMSimple</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae4d5251432e1a9e6803c0240cc492e18a3ebfa1463485cc7babb95b427075772a"></a><!-- doxytag: member="CMProd" ref="ae4d5251432e1a9e6803c0240cc492e18a3ebfa1463485cc7babb95b427075772a" args="" -->CMProd</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf"></a><!-- doxytag: member="CMPoly" ref="ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf" args="" -->CMPoly</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="Projection_8h_source.html#l00025">25</a> of file <a class="el" href="Projection_8h_source.html">Projection.h</a>.</p>

<p><div class="fragment"><pre class="fragment">{ CMNone, CMSimple, CMProd, <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf">CMPoly</a> };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7ff5f2dff38e7639981794c43dc9167b"></a><!-- doxytag: member="Projection.h::@26" ref="a7ff5f2dff38e7639981794c43dc9167b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Integration over Euler angles using Product integration or ZCW points. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a7ff5f2dff38e7639981794c43dc9167ba55bf53a0f8c9f993e6faf4c61fe8ce10"></a><!-- doxytag: member="AngNone" ref="a7ff5f2dff38e7639981794c43dc9167ba55bf53a0f8c9f993e6faf4c61fe8ce10" args="" -->AngNone</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a7ff5f2dff38e7639981794c43dc9167ba9610a33497e9e2e45e79bc44d5ef918f"></a><!-- doxytag: member="AngProd" ref="a7ff5f2dff38e7639981794c43dc9167ba9610a33497e9e2e45e79bc44d5ef918f" args="" -->AngProd</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a7ff5f2dff38e7639981794c43dc9167babf044d8a168c981d4076daf448fae0fc"></a><!-- doxytag: member="AngProdA" ref="a7ff5f2dff38e7639981794c43dc9167babf044d8a168c981d4076daf448fae0fc" args="" -->AngProdA</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a7ff5f2dff38e7639981794c43dc9167ba9ecd3bfb04930e544c099805a7b847a6"></a><!-- doxytag: member="AngZCW" ref="a7ff5f2dff38e7639981794c43dc9167ba9ecd3bfb04930e544c099805a7b847a6" args="" -->AngZCW</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="Projection_8h_source.html#l00052">52</a> of file <a class="el" href="Projection_8h_source.html">Projection.h</a>.</p>

<p><div class="fragment"><pre class="fragment">{ AngNone, AngProd, AngProdA, <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9ecd3bfb04930e544c099805a7b847a6">AngZCW</a> };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a48b0cf8e41bc07938e5a8260c308f742"></a><!-- doxytag: member="Projection.h::_estimateacm" ref="a48b0cf8e41bc07938e5a8260c308f742" args="(const SlaterDet *Q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double _estimateacm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00128">128</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8c_source.html#l00432">calcSlaterDetAux()</a>, <a class="el" href="CenterofMass_8c_source.html#l00099">calcTCM()</a>, <a class="el" href="SlaterDet_8c_source.html#l00423">freeSlaterDetAux()</a>, <a class="el" href="SlaterDet_8c_source.html#l00414">initSlaterDetAux()</a>, <a class="el" href="physics_8c_source.html#l00033">mneutron</a>, <a class="el" href="physics_8c_source.html#l00032">mproton</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00077">X</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>, <a class="el" href="cmprojection_8c_source.html#l00224">initcmintegration()</a>, and <a class="el" href="cmprojection_8c_source.html#l00234">reinitcmintegration()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="comment">// do we have to initialize workspace first ?</span>
  <span class="comment">// if (X.Gaux == NULL)</span>
  <span class="comment">//   initSlaterDetAux(Q, &amp;X);</span>

  <a class="code" href="structSlaterDetAux.html">SlaterDetAux</a> <a class="code" href="MinimizerDONLP2_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>;
  <a class="code" href="SlaterDet_8c.html#a9d28b849a027b454fd2eddb812a884c5" title="init SlaterDetAux X">initSlaterDetAux</a>(Q, &amp;X);

  <span class="keywordtype">double</span> tcm;

  <a class="code" href="SlaterDet_8c.html#ac1dfa773b90a1f5f6294d6081c412981">calcSlaterDetAux</a>(Q, &amp;X);
  <a class="code" href="CenterofMass_8c.html#a27efee5e8e47c37f68fe08105bf1a152">calcTCM</a>(Q, &amp;X, &amp;tcm);
  <a class="code" href="SlaterDet_8c.html#a6d10ca2b062d871a6903292600c3125a" title="free memory used by SlaterDetAux X">freeSlaterDetAux</a>(&amp;X);
  
  <span class="keywordflow">return</span> (0.75/(tcm*(<a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a>*Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a>+<a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>*Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>)));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a96407d07755537e4db8a7047f7a3549d"></a><!-- doxytag: member="Projection.h::_estimateangkappa" ref="a96407d07755537e4db8a7047f7a3549d" args="(const SlaterDet *Q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double _estimateangkappa </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="angprojection_8c_source.html#l00092">92</a> of file <a class="el" href="angprojection_8c_source.html">angprojection.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8c_source.html#l00468">calcSlaterDetAuxod()</a>, <a class="el" href="SlaterDet_8c_source.html#l00180">copySlaterDet()</a>, <a class="el" href="SlaterDet_8c_source.html#l00041">initSlaterDet()</a>, <a class="el" href="SlaterDet_8c_source.html#l00414">initSlaterDetAux()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00068">log</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, and <a class="el" href="SlaterDet_8c_source.html#l00294">rotateSlaterDet()</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>, <a class="el" href="angprojection_8c_source.html#l00210">initangintegration()</a>, and <a class="el" href="angprojection_8c_source.html#l00225">reinitangintegration()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keywordtype">double</span> cosb0 = 0.5;

  <span class="keywordtype">double</span> ovl0;
  complex <span class="keywordtype">double</span> ovlcosb0;
   
  <span class="comment">// do we have to (re)initialize workspace first ?</span>
  <span class="keywordflow">if</span> (<a class="code" href="MinimizerDONLP2multivapp_8c.html#a9e0195b1777800e72b4f7af51f0c3945">Qpp</a>.<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> &lt; Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>) {
    <a class="code" href="SlaterDet_8c.html#a16db6f53cfee239b7d506c86bc372686">initSlaterDet</a>(Q, &amp;<a class="code" href="MinimizerDONLP2multivapp_8c.html#a9e0195b1777800e72b4f7af51f0c3945">Qpp</a>);
    <a class="code" href="SlaterDet_8c.html#a9d28b849a027b454fd2eddb812a884c5" title="init SlaterDetAux X">initSlaterDetAux</a>(Q, &amp;Xpp);
  }

  <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(Q, &amp;<a class="code" href="MinimizerDONLP2multivapp_8c.html#a9e0195b1777800e72b4f7af51f0c3945">Qpp</a>);
  <a class="code" href="SlaterDet_8c.html#ad3679a655d9b6019619456e5b7961638">calcSlaterDetAuxod</a>(Q, &amp;<a class="code" href="MinimizerDONLP2multivapp_8c.html#a9e0195b1777800e72b4f7af51f0c3945">Qpp</a>, &amp;Xpp);
  ovl0 = Xpp.<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>;

  <a class="code" href="SlaterDet_8c.html#a8737af9032a8d87843782a88228fef00" title="rotate Slater determinant by euler angles">rotateSlaterDet</a>(&amp;<a class="code" href="MinimizerDONLP2multivapp_8c.html#a9e0195b1777800e72b4f7af51f0c3945">Qpp</a>, 0.0,acos(cosb0),0.0);
  <a class="code" href="SlaterDet_8c.html#ad3679a655d9b6019619456e5b7961638">calcSlaterDetAuxod</a>(Q, &amp;<a class="code" href="MinimizerDONLP2multivapp_8c.html#a9e0195b1777800e72b4f7af51f0c3945">Qpp</a>, &amp;Xpp);
  ovlcosb0 = Xpp.<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>;

  <span class="keywordflow">return</span> (<a class="code" href="MinimizerDONLP2_8c.html#a4fe6497d2ca697003ddd3e2f1f8ec44f">log</a>(cabs(ovlcosb0/ovl0))/<a class="code" href="MinimizerDONLP2_8c.html#a4fe6497d2ca697003ddd3e2f1f8ec44f">log</a>(cosb0));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a58a9090fd80baea2ab54d2032e2531fd"></a><!-- doxytag: member="Projection.h::_getangkappacrit" ref="a58a9090fd80baea2ab54d2032e2531fd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double _getangkappacrit </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="angprojection_8c_source.html#l00125">125</a> of file <a class="el" href="angprojection_8c_source.html">angprojection.c</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, and <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> (kappacrit);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a80b9d82dadcaadc0a6026004285b49f4"></a><!-- doxytag: member="Projection.h::_initangintegration" ref="a80b9d82dadcaadc0a6026004285b49f4" args="(const Projection *P, double kappa, Symmetry S, Symmetry Sp, angintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _initangintegration </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structangintegrationpara.html">angintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="angprojection_8c_source.html#l00131">131</a> of file <a class="el" href="angprojection_8c_source.html">angprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00070">angprodintegrationpara::alpha</a>, <a class="el" href="Projection_8h_source.html#l00097">Projection::ang</a>, <a class="el" href="Projection_8h_source.html#l00052">AngNone</a>, <a class="el" href="Projection_8h_source.html#l00099">Projection::angprod</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProd</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProdA</a>, <a class="el" href="Projection_8h_source.html#l00100">Projection::angzcw</a>, <a class="el" href="Projection_8h_source.html#l00052">AngZCW</a>, <a class="el" href="Projection_8h_source.html#l00073">angprodintegrationpara::beta</a>, <a class="el" href="Projection_8h_source.html#l00076">angprodintegrationpara::gamma</a>, <a class="el" href="gaussquad_8c_source.html#l00139">GaussExponentialPoints()</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="Projection_8h_source.html#l00060">angzcwpara::idx</a>, <a class="el" href="Projection_8h_source.html#l00065">angzcwintegrationpara::idx</a>, <a class="el" href="Projection_8h_source.html#l00083">angintegrationpara::n</a>, <a class="el" href="Projection_8h_source.html#l00069">angprodintegrationpara::nalpha</a>, <a class="el" href="zcw_8c_source.html#l00058">nangles3()</a>, <a class="el" href="Projection_8h_source.html#l00055">angprodpara::nazimuth</a>, <a class="el" href="Projection_8h_source.html#l00072">angprodintegrationpara::nbeta</a>, <a class="el" href="Projection_8h_source.html#l00056">angprodpara::nbeta</a>, <a class="el" href="Projection_8h_source.html#l00075">angprodintegrationpara::ngamma</a>, <a class="el" href="Projection_8h_source.html#l00086">angintegrationpara::prod</a>, <a class="el" href="gaussquad_8c_source.html#l00255">ShiftedPeriodicTrapezoidalPoints()</a>, <a class="el" href="Symmetry_8h_source.html#l00019">spherical</a>, <a class="el" href="Projection_8h_source.html#l00082">angintegrationpara::type</a>, <a class="el" href="Projection_8h_source.html#l00071">angprodintegrationpara::walpha</a>, <a class="el" href="Projection_8h_source.html#l00074">angprodintegrationpara::wbeta</a>, <a class="el" href="Projection_8h_source.html#l00077">angprodintegrationpara::wgamma</a>, and <a class="el" href="Projection_8h_source.html#l00085">angintegrationpara::zcw</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>, and <a class="el" href="angprojection_8c_source.html#l00210">initangintegration()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> = P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a>;

  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba55bf53a0f8c9f993e6faf4c61fe8ce10">AngNone</a>) {
    par-&gt;<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a> = 1;
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9ecd3bfb04930e544c099805a7b847a6">AngZCW</a>) {
    par-&gt;<a class="code" href="structangintegrationpara.html#a51f700dc1c0da486dd4c1dad7cfe03fd">zcw</a>.<a class="code" href="structangzcwintegrationpara.html#a1b5b2155e111db96eccc7fc63055c36a">idx</a> = P-&gt;<a class="code" href="structProjection.html#a24b0c733ce6d8f892575554682ef2947">angzcw</a>.<a class="code" href="structangzcwpara.html#a10bdceb86e6bb8dceb15668131ef278b">idx</a>;
    par-&gt;<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a> = <a class="code" href="zcw_8c.html#a5be18be997b229d9106a4ddda9a8cafd">nangles3</a>(P-&gt;<a class="code" href="structProjection.html#a24b0c733ce6d8f892575554682ef2947">angzcw</a>.<a class="code" href="structangzcwpara.html#a10bdceb86e6bb8dceb15668131ef278b">idx</a>);
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9610a33497e9e2e45e79bc44d5ef918f">AngProd</a> || P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167babf044d8a168c981d4076daf448fae0fc">AngProdA</a>) {
    <span class="keywordtype">int</span> nbeta = P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#abcad02e655573d2040ce82457bbd4cc7">nbeta</a>;
    <span class="keywordtype">int</span> nazim = P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a>;

    <span class="comment">// use Gauss-Legendre integration for cos(beta)</span>
    <span class="comment">// if overlap is very strongly peaked, use Gauss-Exponential </span>

    <span class="keywordflow">if</span> (hasSymmetry(S, <a class="code" href="Symmetry_8h.html#ab48899087cc647f0f791ed0c459adc53a93d6901f160899d15f69322530595f4f">spherical</a>))
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a> = 1;
    <span class="keywordflow">else</span>        
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a> = nbeta;    

    par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a7854cddeff892c4ecdc5115ea29fd363">beta</a> = malloc(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a704c16042520b3a9b6ce333c92aa4a49">wbeta</a> = malloc(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

    <span class="keywordflow">if</span> (kappa &lt; kappacrit)
      <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>, -1.0, 1.0, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a7854cddeff892c4ecdc5115ea29fd363">beta</a>, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a704c16042520b3a9b6ce333c92aa4a49">wbeta</a>);
    <span class="keywordflow">else</span>
      <a class="code" href="gaussquad_8c.html#aea10f097c3eca7c79d204df3dec9e585" title="Divide weights by Exponential weight function.">GaussExponentialPoints</a>(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>, -1.0, 1.0, kappa, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a7854cddeff892c4ecdc5115ea29fd363">beta</a>, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a704c16042520b3a9b6ce333c92aa4a49">wbeta</a>);

    <span class="comment">// azimuthal integration can be skipped if symmetry allows</span>
    <span class="comment">// trapezoidal rule with shifted grid points</span>
    <span class="comment">// special handling for rotatez2, rotatez3 ?</span>
    <span class="keywordtype">double</span> shift = 0.25;

    <span class="keywordflow">if</span> (hasAxialSymmetry(S))
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#aba31aafae956674b4d3b9facae60afa5">nalpha</a> = 1;
    <span class="keywordflow">else</span>
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#aba31aafae956674b4d3b9facae60afa5">nalpha</a> = nazim;

    par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#acd9fae3f84610a923d30c38486bea4fd">alpha</a> = malloc(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#aba31aafae956674b4d3b9facae60afa5">nalpha</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a438803d307266d5a768336b4c19f5e47">walpha</a> = malloc(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#aba31aafae956674b4d3b9facae60afa5">nalpha</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

    <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#aba31aafae956674b4d3b9facae60afa5">nalpha</a>, 0, 2*M_PI, shift,
                                     par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#acd9fae3f84610a923d30c38486bea4fd">alpha</a>, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a438803d307266d5a768336b4c19f5e47">walpha</a>);

    <span class="keywordflow">if</span> (hasAxialSymmetry(Sp))
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a1202fcb525f75cf85af23194050b8c5d">ngamma</a> = 1;
    <span class="keywordflow">else</span>
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a1202fcb525f75cf85af23194050b8c5d">ngamma</a> = nazim;

    par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a39129cb326c1254a3cbcceba699d3280">gamma</a> = malloc(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a1202fcb525f75cf85af23194050b8c5d">ngamma</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a390b7936c8e1eb441363c605a5734405">wgamma</a> = malloc(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a1202fcb525f75cf85af23194050b8c5d">ngamma</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

    <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a1202fcb525f75cf85af23194050b8c5d">ngamma</a>, 0, 2*M_PI, shift,
                                     par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a39129cb326c1254a3cbcceba699d3280">gamma</a>, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a390b7936c8e1eb441363c605a5734405">wgamma</a>);

    par-&gt;<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a> = par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>* par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#aba31aafae956674b4d3b9facae60afa5">nalpha</a>* par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a1202fcb525f75cf85af23194050b8c5d">ngamma</a>;
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="afd49fd9499450859075a07b9c48230d3"></a><!-- doxytag: member="Projection.h::_initcmintegration" ref="afd49fd9499450859075a07b9c48230d3" args="(const Projection *P, double alpha, cmintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _initcmintegration </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00147">147</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00102">Projection::cm</a>, <a class="el" href="Projection_8h_source.html#l00025">CMNone</a>, <a class="el" href="Projection_8h_source.html#l00105">Projection::cmpoly</a>, <a class="el" href="Projection_8h_source.html#l00025">CMPoly</a>, <a class="el" href="Projection_8h_source.html#l00104">Projection::cmprod</a>, <a class="el" href="Projection_8h_source.html#l00025">CMProd</a>, <a class="el" href="Projection_8h_source.html#l00025">CMSimple</a>, <a class="el" href="cmprojection_8c_source.html#l00031">CUB</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="gaussquad_8c_source.html#l00188">GaussSqrHermitePoints()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00041">cmintegrationpara::n</a>, <a class="el" href="Projection_8h_source.html#l00030">cmprodpara::nphi</a>, <a class="el" href="Projection_8h_source.html#l00035">cmpolypara::npoly</a>, <a class="el" href="Projection_8h_source.html#l00034">cmpolypara::nr</a>, <a class="el" href="Projection_8h_source.html#l00028">cmprodpara::nr</a>, <a class="el" href="donlp2_8h_source.html#l00052">nr</a>, <a class="el" href="Projection_8h_source.html#l00029">cmprodpara::ntheta</a>, <a class="el" href="HOBasis_8c_source.html#l00043">nx</a>, <a class="el" href="cmprojection_8c_source.html#l00057">polyhedron</a>, <a class="el" href="gaussquad_8c_source.html#l00255">ShiftedPeriodicTrapezoidalPoints()</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>, and <a class="el" href="cmprojection_8c_source.html#l00224">initcmintegration()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a8d869da79c82654982e95e61d10a64c4">CMNone</a>) {
    par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 1;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a> = malloc(3*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a> = malloc(1*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][0] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][1] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][2] = 0.0; 
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[0] = 1.0;
  } 

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a0e967fc9236e1bb9b51ddb4c16fd096e">CMSimple</a>) {
    par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 1;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a> = malloc(3*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a> = malloc(1*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][0] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][1] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][2] = 0.0; 
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[0] = 0.125*pow(M_PI*<a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>,-1.5);
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a3ebfa1463485cc7babb95b427075772a">CMProd</a>) {
    <span class="keywordtype">int</span> <a class="code" href="donlp2_8h.html#a2833bf188e6bf292fa7d61e2dd54d622">nr</a>=P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#aceeaab6ba25f876de7f218c9e797cf01">nr</a>; 
    <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a02d47a4f36ec0bcce348696534567e30">nx</a>=P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#af7d2985994407467340336b7dd1b683e">ntheta</a>; <span class="keywordtype">int</span> nphi=P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#a44027ab99975309599367c045379d55d">nphi</a>;
    
    <span class="keywordtype">double</span> pointr[nr], weightr[nr];
    <a class="code" href="gaussquad_8c.html#aee65fcd1581a362adaba774793e24c5e">GaussSqrHermitePoints</a>(nr, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, pointr, weightr);

    <span class="keywordtype">double</span> pointx[nx], weightx[nx];
    <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(nx, -1.0, 1.0, pointx, weightx);

    <span class="keywordtype">double</span> pointphi[nphi], weightphi[nphi];
    <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(nphi, 0, 2*M_PI, 0.00,
                                     pointphi, weightphi);

    par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = nr*nx*nphi;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a> = malloc(3*par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a> = malloc(par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

    <span class="keywordtype">int</span> i=0;
    <span class="keywordtype">int</span> ir, ix, iphi;
    <span class="keywordflow">for</span> (ir=0; ir&lt;nr; ir++)
      <span class="keywordflow">for</span> (ix=0; ix&lt;nx; ix++)
        <span class="keywordflow">for</span> (iphi=0; iphi&lt;nphi; iphi++) {
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][0] = pointr[ir]*sqrt(1-<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(pointx[ix]))*cos(pointphi[iphi]);
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][1] = pointr[ir]*sqrt(1-<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(pointx[ix]))*sin(pointphi[iphi]);
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][2] = pointr[ir]*pointx[ix];
          par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i] = 1/<a class="code" href="cmprojection_8c.html#a6468750a80f532995d7f387427b4176a">CUB</a>(2*M_PI)*
            weightr[ir]*weightx[ix]*weightphi[iphi];
          i++;
        }
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf">CMPoly</a>) {
    <span class="keywordtype">int</span> nr=P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a>; 
    <span class="keywordtype">int</span> npoly=P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a>;
    
    <span class="keywordtype">double</span> pointr[nr], weightr[nr];
    <a class="code" href="gaussquad_8c.html#aee65fcd1581a362adaba774793e24c5e">GaussSqrHermitePoints</a>(nr, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, pointr, weightr);

    par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = nr*npoly;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a> = malloc(3*par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a> = malloc(par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

    <span class="keywordtype">int</span> i=0;    
    <span class="keywordtype">int</span> ir, ipoly, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;   
    <span class="keywordflow">for</span> (ir=0; ir&lt;nr; ir++)
      <span class="keywordflow">for</span> (ipoly=0; ipoly&lt;npoly; ipoly++) {
        <span class="keywordflow">for</span> (j=0; j&lt;3; j++)
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][j] = pointr[ir]*<a class="code" href="cmprojection_8c.html#af5b681c73567b823d57c18d3cdabb2ab">polyhedron</a>[npoly][ipoly][j];
        par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i] = 1/<a class="code" href="cmprojection_8c.html#a6468750a80f532995d7f387427b4176a">CUB</a>(2*M_PI)*
          weightr[ir]*(4*M_PI/npoly);
        i++;
      }
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1fdfb90bdc7cedf8097a4c9c0e907653"></a><!-- doxytag: member="Projection.h::_setangkappacrit" ref="a1fdfb90bdc7cedf8097a4c9c0e907653" args="(double kappa)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _setangkappacrit </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>kappa</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="angprojection_8c_source.html#l00120">120</a> of file <a class="el" href="angprojection_8c_source.html">angprojection.c</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiprojmulti_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  kappacrit = kappa;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5dbae736727dbf5f2d43e571751344d1"></a><!-- doxytag: member="Projection.h::AngmomtoStr" ref="a5dbae736727dbf5f2d43e571751344d1" args="(int j, int pi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* AngmomtoStr </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00042">42</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>Referenced by <a class="el" href="calcchargedensities_8c_source.html#l00029">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span>* str = malloc(5*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));

  <span class="keywordflow">if</span> (<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>%2) 
    sprintf(str, <span class="stringliteral">&quot;%d2%c&quot;</span>, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, pi ? <span class="charliteral">&#39;-&#39;</span> : <span class="charliteral">&#39;+&#39;</span>);
  <span class="keywordflow">else</span>
    sprintf(str, <span class="stringliteral">&quot;%d%c&quot;</span>, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>/2, pi ? <span class="charliteral">&#39;-&#39;</span> : <span class="charliteral">&#39;+&#39;</span>);

  <span class="keywordflow">return</span> str;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae1d7e6ab780b680233363090cdb2764f"></a><!-- doxytag: member="Projection.h::calcEigenstates" ref="ae1d7e6ab780b680233363090cdb2764f" args="(const Projection *P, const Interaction *Int, const Observablesod ***obsme, Eigenstates *E, double thresh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcEigenstates </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structInteraction.html">Interaction</a> *&nbsp;</td>
          <td class="paramname"> <em>Int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structObservablesod.html">Observablesod</a> ***&nbsp;</td>
          <td class="paramname"> <em>obsme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>thresh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01235">1235</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="cmat_8c_source.html#l00264">generalizedeigensystem()</a>, <a class="el" href="Observables_8h_source.html#l00040">Observablesod::h</a>, <a class="el" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="cmat_8c_source.html#l00070">multcmat()</a>, <a class="el" href="Observables_8h_source.html#l00039">Observablesod::n</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>, and <a class="el" href="Projection_8h_source.html#l00143">Eigenstates::v</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiproj_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = E-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>;
  <span class="keywordtype">int</span> odd = P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;

  complex <span class="keywordtype">double</span>* <a class="code" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(n*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  complex <span class="keywordtype">double</span>* <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(n*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  complex <span class="keywordtype">double</span>* N2 = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(n*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordtype">int</span> a, b;
  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, i;
  <span class="keywordtype">int</span> nj, ipj;

  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {

      nj = n*(j+1);
      ipj = idxpij(jmax,p,j);

      <span class="keywordflow">for</span> (b=0; b&lt;n; b++)
        <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
          <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
            <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2) {
              N[idxnjm(a,j,m) + idxnjm(b,j,k)*nj] = 
                obsme[a+b*n][ipj][idxjmk(j,m,k)].<a class="code" href="structObservablesod.html#a8c9da6cf3aa140f99b6b3f58a8f20182">n</a>;

              H[idxnjm(a,j,m) + idxnjm(b,j,k)*nj] = 
                obsme[a+b*n][ipj][idxjmk(j,m,k)].<a class="code" href="structObservablesod.html#a8c2c7596d9d5853b8f1701fe351dc300">h</a>;
            }

      <a class="code" href="cmat_8c.html#aab30acd19149c3014405da4f585d4bb5">generalizedeigensystem</a>(H, N, nj, thresh, 
                             E-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[ipj], E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj], 
                             &amp;E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[ipj]);

      <span class="comment">// normalize eigenvectors such that norm = \sum_M |&lt;Q|Q;JMalpha&gt;|^2</span>

      <a class="code" href="cmat_8c.html#a32a89cb47e192550e5d5373dad79bcde" title="multiply complex matrices C = A.B">multcmat</a>(N, N, N2, nj);

      <span class="keywordflow">for</span> (i=0; i&lt;E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[ipj]; i++) {
        
        <span class="keywordtype">double</span> norm2=0.0, ovl2 = 0.0;
        <span class="keywordflow">for</span> (b=0; b&lt;nj; b++)
          <span class="keywordflow">for</span> (a=0; a&lt;nj; a++) {
            norm2 += conj(E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][a+i*nj])*N[a+b*nj]*E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][b+i*nj];
            ovl2 += conj(E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][a+i*nj])*N2[a+b*nj]*E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][b+i*nj];
          }
        
        <span class="comment">// sort out unphysical (due to numerics) states</span>
        <span class="keywordtype">double</span> scale;
        <span class="keywordflow">if</span> (norm2 &lt; 0.0 || ovl2 &lt; 0.0 || isnan(norm2) || isnan(ovl2))
          scale = 0.0;
        <span class="keywordflow">else</span>
          scale = sqrt(ovl2)/norm2;

        <span class="keywordflow">for</span> (a=0; a&lt;nj; a++)
          E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][a+i*nj] *= scale;

        E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][i] = 0.0;
        for (b=0; b&lt;nj; b++)
          <span class="keywordflow">for</span> (a=0; a&lt;nj; a++)
            E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][i] += 
              conj(E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][a+i*nj])*N[a+b*nj]*E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][b+i*nj];
      }

   }

  free(H); free(N); free(N2);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2c888ae8f28458b06d1ccc71e4f31577"></a><!-- doxytag: member="Projection.h::calcEigenstatesK" ref="a2c888ae8f28458b06d1ccc71e4f31577" args="(const Projection *P, const Interaction *Int, const Observablesod ***obsme, Eigenstates *E, int K, double thresh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcEigenstatesK </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structInteraction.html">Interaction</a> *&nbsp;</td>
          <td class="paramname"> <em>Int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structObservablesod.html">Observablesod</a> ***&nbsp;</td>
          <td class="paramname"> <em>obsme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>thresh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01309">1309</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="cmat_8c_source.html#l00264">generalizedeigensystem()</a>, <a class="el" href="Observables_8h_source.html#l00040">Observablesod::h</a>, <a class="el" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Observables_8h_source.html#l00039">Observablesod::n</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>, and <a class="el" href="Projection_8h_source.html#l00143">Eigenstates::v</a>.</p>

<p>Referenced by <a class="el" href="calcenergyproj_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = E-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>;
  <span class="keywordtype">int</span> odd = P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;

  complex <span class="keywordtype">double</span>* <a class="code" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(n*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  complex <span class="keywordtype">double</span>* <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(n*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  
  <span class="keywordtype">int</span> a, b;
  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, i;
  <span class="keywordtype">int</span> nj, ipj;

  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
      nj = n*(j+1);
      ipj = idxpij(jmax,p,j);

      <span class="keywordflow">for</span> (b=0; b&lt;n; b++)
        <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
          <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
            <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2) {
              N[idxnjm(a,j,m) + idxnjm(b,j,k)*nj] =  
                (m == K &amp;&amp; k == K) ? obsme[a+b*n][ipj][idxjmk(j,m,k)].<a class="code" href="structObservablesod.html#a8c9da6cf3aa140f99b6b3f58a8f20182">n</a> : 0.0;

              H[idxnjm(a,j,m) + idxnjm(b,j,k)*nj] = 
                (m == K &amp;&amp; k == K) ? obsme[a+b*n][ipj][idxjmk(j,m,k)].<a class="code" href="structObservablesod.html#a8c2c7596d9d5853b8f1701fe351dc300">h</a> : 0.0;
            }

      <a class="code" href="cmat_8c.html#aab30acd19149c3014405da4f585d4bb5">generalizedeigensystem</a>(H, N, nj, thresh, 
                             E-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[ipj], E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj], 
                             &amp;E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[ipj]);

      <span class="keywordflow">for</span> (i=0; i&lt;E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[ipj]; i++) {
        E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][i] = 0.0;
        <span class="keywordflow">for</span> (b=0; b&lt;nj; b++)
          <span class="keywordflow">for</span> (a=0; a&lt;nj; a++)
            E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][i] += 
              conj(E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][a+i*nj])*N[a+b*nj]*E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][b+i*nj];
      }

   }

  free(H); free(N);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8496ec48cbc243bb807deeb60339a251"></a><!-- doxytag: member="Projection.h::calcexpectprojectedMBME" ref="a8496ec48cbc243bb807deeb60339a251" args="(const Projection *P, const ManyBodyOperator *Op, const void *mbme, const Symmetry *S, const Eigenstates *E, void *expectmbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcexpectprojectedMBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>expectmbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate expectation values with matrix elements mbme and eigenvectors E </p>

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00880">880</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>, and <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlap_8c_source.html#l00087">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> p,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,i;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, k1, k2;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, nu;
  <span class="keywordtype">int</span> a, b;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=E-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>;
  <span class="keywordtype">int</span> idx;
  <span class="keywordtype">int</span> nj;
  <span class="keywordtype">int</span> rank=Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  <span class="keywordtype">int</span> size=Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  complex double (***me)[(rank+1)*size] = mbme;
  complex double (**expme)[size] = expectmbme;
 
  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {

      idx = idxpij(jmax,p,j);
      nj=n*(j+1);
      <span class="keywordflow">for</span> (i=0; i&lt;E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[idx]; i++) {

        <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
          expme[idx][i][l] = 0.0;

        <span class="keywordflow">for</span> (b=0; b&lt;n; b++)
          <span class="keywordflow">for</span> (k2=-j; k2&lt;=j; k2=k2+2)
            <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
              <span class="keywordflow">for</span> (k1=-j; k1&lt;=j; k1=k1+2)           
                <span class="keywordflow">for</span> (k=max(-j,k1-rank); k&lt;=min(j,k1+rank); k=k+2) {
                  nu=k1-k;
                  <span class="keywordflow">if</span> (<a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(S[a], p, j, k1) &amp;&amp;
                      <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(S[b], p, j, k2)) {
                    <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                      expme[idx][i][l] +=
                        <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(j, rank, j, k, nu, k1)*
                        conj(E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[idx][idxnjm(a,j,k1) + i*nj])*
                        me[a+b*n][idx][idxjmk(j,k,k2)][(nu+rank)/2+l*(rank+1)]*
                        E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[idx][idxnjm(b,j,k2) + i*nj];
                  }
                }
      }         
    }           
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0aba2ec1c91bc314f7d6dd6529608050"></a><!-- doxytag: member="Projection.h::calcexpectprojectedMBMEipj" ref="a0aba2ec1c91bc314f7d6dd6529608050" args="(const Projection *P, const ManyBodyOperator *Op, const void *mbme, const Symmetry *S, const Eigenstates *E, int j, int p, int i, void *expectmbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcexpectprojectedMBMEipj </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>expectmbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00933">933</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>, and <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>.</p>

<p>Referenced by <a class="el" href="calcchargedensities_8c_source.html#l00029">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, k1, k2;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, nu;
  <span class="keywordtype">int</span> a, b;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=E-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>;
  <span class="keywordtype">int</span> idx;
  <span class="keywordtype">int</span> ii;
  <span class="keywordtype">int</span> nj;
  <span class="keywordtype">int</span> rank=Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  <span class="keywordtype">int</span> size=Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  complex double (***me)[(rank+1)*size] = mbme;
  complex double (**expme)[size] = expectmbme;
 
  idx = idxpij(jmax,p,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>);
  ii = E-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[idx][i];
  nj=n*(<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>+1);

  <span class="comment">// allocate space for expectation values</span>
  expme[idx] = malloc(nj*size*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
    expme[idx][ii][l] = 0.0;

  <span class="keywordflow">for</span> (b=0; b&lt;n; b++)
    <span class="keywordflow">for</span> (k2=-<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>; k2&lt;=<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>; k2=k2+2)
      <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
        <span class="keywordflow">for</span> (k1=-<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>; k1&lt;=<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>; k1=k1+2)         
          <span class="keywordflow">for</span> (k=max(-<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,k1-rank); k&lt;=min(<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,k1+rank); k=k+2) {
            nu=k1-k;
            <span class="keywordflow">if</span> (<a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(S[a], p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, k1) &amp;&amp;
                <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(S[b], p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, k2)) {
              <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                expme[idx][ii][l] +=
                  <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, rank, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, k, nu, k1)*
                  conj(E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[idx][idxnjm(a,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,k1) + ii*nj])*
                  me[a+b*n][idx][idxjmk(<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,k,k2)][(nu+rank)/2+l*(rank+1)]*
                  E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[idx][idxnjm(b,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,k2) + ii*nj];
            }
          }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a056b9a28cb7f2d352eb665582e9be9fb"></a><!-- doxytag: member="Projection.h::calcMultiEigenstates" ref="a056b9a28cb7f2d352eb665582e9be9fb" args="(const Projection *P, const Interaction *Int, const Observablesod ***obsme, const Eigenstates *Ep, Eigenstates *multiE, Amplitudes *multiA, double thresh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcMultiEigenstates </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structInteraction.html">Interaction</a> *&nbsp;</td>
          <td class="paramname"> <em>Int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structObservablesod.html">Observablesod</a> ***&nbsp;</td>
          <td class="paramname"> <em>obsme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>multiE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structAmplitudes.html">Amplitudes</a> *&nbsp;</td>
          <td class="paramname"> <em>multiA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>thresh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01488">1488</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00155">Amplitudes::amp</a>, <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="cmat_8c_source.html#l00264">generalizedeigensystem()</a>, <a class="el" href="Observables_8h_source.html#l00040">Observablesod::h</a>, <a class="el" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Observables_8h_source.html#l00039">Observablesod::n</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00154">Amplitudes::ngood</a>, <a class="el" href="Projection_8h_source.html#l00146">Eigenstates::ngood</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00143">Eigenstates::v</a>, <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00121">V</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiproj_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=multiE-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>;
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;

  complex <span class="keywordtype">double</span>* <a class="code" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(n*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  complex <span class="keywordtype">double</span>* <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(n*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  complex <span class="keywordtype">double</span>* v = malloc(n*(jmax+1)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  complex <span class="keywordtype">double</span>* <a class="code" href="MinimizerDONLP2multivapp_8c.html#ada7b84dafb505b22eca2753ef852e94a">V</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(n*(jmax+1))*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  
  <span class="keywordtype">int</span> a, b;
  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, ipj, i, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>, d;
  <span class="keywordtype">int</span> ai, bi, iai, ibi, idxa, idxb;
  <span class="keywordtype">double</span> norma2, normb2, normi2;        

  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
      ipj=idxpij(jmax,p,j);

      dim=0;
      <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
        dim += Ep[a].ngood[ipj];

      <span class="comment">// do we have at least a one-dimensional space</span>
      <span class="keywordflow">if</span> (dim ==0) {
        multiE-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[ipj] = 0;
      } <span class="keywordflow">else</span> {

      idxb=-1;
      <span class="keywordflow">for</span> (b=0; b&lt;n; b++)
        <span class="keywordflow">for</span> (bi=0; bi&lt;Ep[b].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj]; bi++) {
          ibi=Ep[b].<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipj][bi];
          normb2=Ep[b].<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][ibi];
          idxb++;
          idxa=-1;
          <span class="keywordflow">for</span> (a=0; a&lt;n; a++)   
            <span class="keywordflow">for</span> (ai=0; ai&lt;Ep[a].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj]; ai++) {
              iai=Ep[a].<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipj][ai];
              norma2=Ep[a].<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][iai];
              idxa++;
              N[idxa+idxb*dim] = 0.0;
              H[idxa+idxb*dim] = 0.0;

              <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
                <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2) {
                  N[idxa+idxb*dim] +=
                    conj(Ep[a].V[ipj][idxjm(j,m)+iai*(j+1)])*
                    obsme[a+b*n][ipj][idxjmk(j,m,k)].<a class="code" href="structObservablesod.html#a8c9da6cf3aa140f99b6b3f58a8f20182">n</a>*
                    Ep[b].<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][idxjm(j,k)+ibi*(j+1)]/
                    sqrt(norma2*normb2);
                         
                  H[idxa+idxb*dim] +=
                    conj(Ep[a].V[ipj][idxjm(j,m)+iai*(j+1)])*
                    obsme[a+b*n][ipj][idxjmk(j,m,k)].<a class="code" href="structObservablesod.html#a8c2c7596d9d5853b8f1701fe351dc300">h</a>*
                    Ep[b].<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][idxjm(j,k)+ibi*(j+1)]/
                    sqrt(norma2*normb2);

                }
            }   
        }      

      <span class="comment">/* debugging</span>
<span class="comment"></span>
<span class="comment">      fprintf(stderr, &quot;\nJ^pi = %s\n\n&quot;, AngmomtoStr(j, p));</span>
<span class="comment">      </span>
<span class="comment">      fprintf(stderr, &quot;N matrix\n&quot;);</span>
<span class="comment">      fprintcmat(stderr, dim, N);</span>
<span class="comment"></span>
<span class="comment">      fprintf(stderr, &quot;H matrix\n&quot;);</span>
<span class="comment">      fprintcmat(stderr, dim, H);</span>
<span class="comment"></span>
<span class="comment">      */</span>

      <a class="code" href="cmat_8c.html#aab30acd19149c3014405da4f585d4bb5">generalizedeigensystem</a>(H, N, dim, thresh, 
                             v, V, 
                             &amp;d);

      <span class="comment">// embed solution into full space</span>

      multiE-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[ipj] = d;
      <span class="keywordtype">int</span> nj=n*(j+1);

      <span class="keywordflow">for</span> (i=0; i&lt;d; i++) {
        multiE-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[ipj][i] = v[i];

        <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2) {
          idxa = -1;
          <span class="keywordflow">for</span> (a=0; a&lt;n; a++) {
            multiE-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][idxnjm(a,j,k)+i*nj] = 0.0;

            <span class="keywordflow">for</span> (ai=0; ai&lt;Ep[a].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj]; ai++) {
              idxa++;
              iai = Ep[a].<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipj][ai];
              norma2 = Ep[a].<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][iai];

              multiE-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][idxnjm(a,j,k)+i*nj] += 
                Ep[a].<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[ipj][idxjm(j,k)+iai*(j+1)]/sqrt(norma2)*
                  V[idxa+i*dim];
            }
          }                                   
        }
      }

      <span class="comment">// calculate Amplitudes</span>

      <span class="keywordflow">for</span> (i=0; i&lt;d; i++) {

        normi2 = 0.0;
        <span class="keywordflow">for</span> (idxb=0; idxb&lt;dim; idxb++)
          <span class="keywordflow">for</span> (idxa=0; idxa&lt;dim; idxa++)
            normi2 += conj(V[idxa+i*dim])*N[idxa+idxb*dim]*V[idxb+i*dim];

        multiE-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][i] = normi2;

        idxa = -1;
        <span class="keywordflow">for</span> (a=0; a&lt;n; a++) {
          multiA-&gt;<a class="code" href="structAmplitudes.html#a3192b8e5338e5ac43d813833b09ad221">ngood</a>[ipj][a] = Ep[a].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj];
          
          <span class="keywordflow">for</span> (ai=0; ai&lt;Ep[a].<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[ipj]; ai++) {
            idxa++;
            norma2 = N[idxa+idxa*dim];

            multiA-&gt;<a class="code" href="structAmplitudes.html#a1608d319a33b0263e17f0ac70993cce2">amp</a>[ipj][ai+a*(j+1)+i*n*(j+1)] = 0.0;
            <span class="keywordflow">for</span> (idxb=0; idxb&lt;dim; idxb++)
              multiA-&gt;<a class="code" href="structAmplitudes.html#a1608d319a33b0263e17f0ac70993cce2">amp</a>[ipj][ai+a*(j+1)+i*n*(j+1)] +=
                N[idxa+idxb*dim]*V[idxb+i*dim]/sqrt(norma2*normi2);
          }
        }
      }

      }
   }

  free(H); free(N);
  free(v); free(V);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a044ac20ed8962994aa88e59cbc93870e"></a><!-- doxytag: member="Projection.h::calcprojectedMBME" ref="a044ac20ed8962994aa88e59cbc93870e" args="(const Projection *P, const ManyBodyOperator *Op, const SlaterDet *Q, const SlaterDet *Qp, Symmetry S, Symmetry Sp, void *mbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcprojectedMBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00605">605</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00107">alpha</a>, <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00108">angpara</a>, <a class="el" href="SlaterDet_8c_source.html#l00468">calcSlaterDetAuxod()</a>, <a class="el" href="SlaterDet_8c_source.html#l00520">calcSlaterDetAuxodsingular()</a>, <a class="el" href="SlaterDet_8c_source.html#l00180">copySlaterDet()</a>, <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="SlaterDet_8c_source.html#l00053">freeSlaterDet()</a>, <a class="el" href="SlaterDet_8c_source.html#l00423">freeSlaterDetAux()</a>, <a class="el" href="angprojection_8c_source.html#l00250">getangintegrationpoint()</a>, <a class="el" href="cmprojection_8c_source.html#l00305">getcmintegrationpoint()</a>, <a class="el" href="angprojection_8c_source.html#l00210">initangintegration()</a>, <a class="el" href="cmprojection_8c_source.html#l00224">initcmintegration()</a>, <a class="el" href="SlaterDet_8c_source.html#l00041">initSlaterDet()</a>, <a class="el" href="SlaterDet_8c_source.html#l00414">initSlaterDetAux()</a>, <a class="el" href="SlaterDet_8c_source.html#l00350">invertSlaterDet()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Projection_8h_source.html#l00118">ManyBodyOperator::me</a>, <a class="el" href="SlaterDet_8c_source.html#l00255">moveSlaterDet()</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="Projection_8h_source.html#l00083">angintegrationpara::n</a>, <a class="el" href="Projection_8h_source.html#l00041">cmintegrationpara::n</a>, <a class="el" href="MinimizerDONLP2vappcm_8c_source.html#l00104">ncm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00117">ManyBodyOperator::par</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00131">Qpp</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="SlaterDet_8c_source.html#l00294">rotateSlaterDet()</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>, <a class="el" href="donlp2_8h_source.html#l00057">val</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00077">X</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlap_8c_source.html#l00087">main()</a>, and <a class="el" href="calcenergymultiprojsel_8c_source.html#l00290">readorcalcandwriteprojectedMBMEfromtoFile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> size=Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> rank=Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  complex double (**<a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>)[(rank+1)*size] = mbme;

  <a class="code" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a9e0195b1777800e72b4f7af51f0c3945">Qpp</a>;
  <a class="code" href="structSlaterDetAux.html">SlaterDetAux</a> <a class="code" href="MinimizerDONLP2_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>;

  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> odd = P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;

  <span class="comment">// norms of SlaterDets</span>
  <a class="code" href="SlaterDet_8c.html#a9d28b849a027b454fd2eddb812a884c5" title="init SlaterDetAux X">initSlaterDetAux</a>(Q, &amp;X);

  <span class="comment">// calcSlaterDetAuxod(Q, Q, &amp;X);</span>
  <span class="comment">// double norm = sqrt(creal(X.ovlap));</span>

  <span class="comment">// initSlaterDetAux(Qp, &amp;X);</span>
  <span class="comment">// calcSlaterDetAuxod(Qp, Qp, &amp;X);</span>
  <span class="comment">// double normp = sqrt(creal(X.ovlap));  </span>

  <span class="comment">// set up cm integration</span>
  <a class="code" href="structcmintegrationpara.html">cmintegrationpara</a> <a class="code" href="structcmpara.html">cmpara</a>;
  <a class="code" href="cmprojection_8c.html#abf4911adb463930dc540277d1da25c35">initcmintegration</a>(P, Q, Qp, &amp;cmpara);
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2vappcm_8c.html#a8a5e05e8fcc2b05354bff66fc1b1755c">ncm</a> = cmpara.<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>;

  <span class="comment">// set up angular momentum integration</span>
  <a class="code" href="structangintegrationpara.html">angintegrationpara</a> <a class="code" href="MinimizerDONLP2multivappcm_8c.html#a49105e626fcbcb1b768fedd076a84bd6">angpara</a>;
  <a class="code" href="angprojection_8c.html#ae7ea91fc189ad0a0487363668e0ffa89">initangintegration</a>(P, Q, Qp, S, Sp, &amp;angpara);
  <span class="keywordtype">int</span> nang = angpara.<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a>;

  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, r;
  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;

  <span class="comment">// set matrix elements to zero</span>
  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
      <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
        <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2)
          <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
            <span class="keywordflow">for</span> (r=0; r&lt;=rank; r++)
              <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)] = 0.0;
    }   

  <a class="code" href="SlaterDet_8c.html#a16db6f53cfee239b7d506c86bc372686">initSlaterDet</a>(Qp, &amp;Qpp);
  
  <span class="keywordtype">int</span> icm; 
  <span class="keywordtype">double</span> xcm[3]; <span class="keywordtype">double</span> weightcm;

  <span class="keywordtype">int</span> iang;
  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, gamma; <span class="keywordtype">double</span> weightang;

  complex <span class="keywordtype">double</span> sval[(rank+1)*size];
  <span class="keywordtype">double</span> weight;
  <span class="keywordtype">int</span> ip;

  <span class="keywordflow">for</span> (icm=0; icm&lt;ncm; icm++) {
    <a class="code" href="cmprojection_8c.html#a4cde89930e46342aae042ab854f2290b">getcmintegrationpoint</a>(icm, &amp;cmpara, xcm, &amp;weightcm);

    <span class="keywordflow">for</span> (iang=0; iang&lt;nang; iang++) {
      <a class="code" href="angprojection_8c.html#a84c53149d9af0a652cb6486c9516cbb5">getangintegrationpoint</a>(iang, &amp;angpara, &amp;alpha, &amp;beta, &amp;gamma, &amp;weightang);
      <span class="comment">// weight = 1.0/(2*norm*normp)*weightcm*weightang;</span>
      weight = 0.5*weightcm*weightang;
      
      <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(Qp, &amp;Qpp);
      <a class="code" href="SlaterDet_8c.html#a5463a8afc7565b2711169b605aad5ca3" title="move Slater determinant by vector d">moveSlaterDet</a>(&amp;Qpp, xcm);
      <a class="code" href="SlaterDet_8c.html#a8737af9032a8d87843782a88228fef00" title="rotate Slater determinant by euler angles">rotateSlaterDet</a>(&amp;Qpp, alpha, beta, gamma);

      <span class="keywordflow">for</span> (ip=0; ip&lt;=1; ip++) {
          <span class="keywordflow">if</span> (ip) <a class="code" href="SlaterDet_8c.html#ad0aa11be18d42c1cc26c2ad1380feb2a" title="invert Slater determinant in origin">invertSlaterDet</a>(&amp;Qpp);

          <span class="comment">// can only calculate Auxilliaries if Sldets are compatible</span>
          <span class="keywordflow">if</span> (Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> == Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>) {
            <span class="keywordflow">if</span> (Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> == Qp-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> &amp;&amp; Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a> == Qp-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>)
              <a class="code" href="SlaterDet_8c.html#ad3679a655d9b6019619456e5b7961638">calcSlaterDetAuxod</a>(Q, &amp;Qpp, &amp;X);
            <span class="keywordflow">else</span>
              <a class="code" href="SlaterDet_8c.html#a861e4c675c3918393d69a81090376053">calcSlaterDetAuxodsingular</a>(Q, &amp;Qpp, &amp;X);
          }
          Op-&gt;<a class="code" href="structManyBodyOperator.html#aba2e7e550190ee2ec6e75c23c55fee2d">me</a>(Op-&gt;<a class="code" href="structManyBodyOperator.html#a05268b1b149040fd992263f2e22de7ec">par</a>, Q, &amp;Qpp, &amp;X, sval);

          complex <span class="keywordtype">double</span> w;
          <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
            <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2)
              <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
                <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2) {
                  <span class="keywordflow">if</span> ((Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a> != 0 || <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(S, p, j, m)) &amp;&amp;
                      <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sp, p, j, k)) {
                    w = weight * (p &amp;&amp; ip%2 ? -1 : 1)*
                      (j+1)/(8*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(M_PI))*Djmkstar(j,m,k,alpha,beta,gamma);
                    <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                      <span class="keywordflow">for</span> (r=0; r&lt;=rank; r++)
                        <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)] += 
                          w*sval[r+l*(rank+1)];
                  }     
                }       
      }

    }

  }
  <a class="code" href="SlaterDet_8c.html#a6d10ca2b062d871a6903292600c3125a" title="free memory used by SlaterDetAux X">freeSlaterDetAux</a>(&amp;X);
  <a class="code" href="SlaterDet_8c.html#adc279637790bc3303e9dca688966a7ab" title="free memory used by Slater determinant Q">freeSlaterDet</a>(&amp;Qpp);
}       
</pre></div></p>

</div>
</div>
<a class="anchor" id="aea2e08302b36a68b650325373e8139df"></a><!-- doxytag: member="Projection.h::calcprojectedMBMEs" ref="aea2e08302b36a68b650325373e8139df" args="(const Projection *P, const ManyBodyOperators *Ops, const SlaterDet *Q, const SlaterDet *Qp, Symmetry S, Symmetry Sp, void *mbmes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcprojectedMBMEs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperators.html">ManyBodyOperators</a> *&nbsp;</td>
          <td class="paramname"> <em>Ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>mbmes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00715">715</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00107">alpha</a>, <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00108">angpara</a>, <a class="el" href="SlaterDet_8c_source.html#l00468">calcSlaterDetAuxod()</a>, <a class="el" href="SlaterDet_8c_source.html#l00520">calcSlaterDetAuxodsingular()</a>, <a class="el" href="SlaterDet_8c_source.html#l00180">copySlaterDet()</a>, <a class="el" href="Projection_8h_source.html#l00130">ManyBodyOperators::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="SlaterDet_8c_source.html#l00053">freeSlaterDet()</a>, <a class="el" href="SlaterDet_8c_source.html#l00423">freeSlaterDetAux()</a>, <a class="el" href="angprojection_8c_source.html#l00250">getangintegrationpoint()</a>, <a class="el" href="cmprojection_8c_source.html#l00305">getcmintegrationpoint()</a>, <a class="el" href="angprojection_8c_source.html#l00210">initangintegration()</a>, <a class="el" href="cmprojection_8c_source.html#l00224">initcmintegration()</a>, <a class="el" href="SlaterDet_8c_source.html#l00041">initSlaterDet()</a>, <a class="el" href="SlaterDet_8c_source.html#l00414">initSlaterDetAux()</a>, <a class="el" href="SlaterDet_8c_source.html#l00350">invertSlaterDet()</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00041">io</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Projection_8h_source.html#l00133">ManyBodyOperators::me</a>, <a class="el" href="SlaterDet_8c_source.html#l00255">moveSlaterDet()</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="Projection_8h_source.html#l00128">ManyBodyOperators::n</a>, <a class="el" href="Projection_8h_source.html#l00083">angintegrationpara::n</a>, <a class="el" href="Projection_8h_source.html#l00041">cmintegrationpara::n</a>, <a class="el" href="MinimizerDONLP2vappcm_8c_source.html#l00104">ncm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00132">ManyBodyOperators::Op</a>, <a class="el" href="Projection_8h_source.html#l00129">ManyBodyOperators::par</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00131">Qpp</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="SlaterDet_8c_source.html#l00294">rotateSlaterDet()</a>, <a class="el" href="Projection_8h_source.html#l00131">ManyBodyOperators::size</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>, <a class="el" href="donlp2_8h_source.html#l00057">val</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00077">X</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="calcformfactorsme_8c_source.html#l00029">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> size=Ops-&gt;<a class="code" href="structManyBodyOperators.html#a94494657638d56cc4a332f00aefcd1e4">size</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Ops-&gt;<a class="code" href="structManyBodyOperators.html#aa1b09f1ea3ecfedd76ca27f7954ce65b" title="has to be the same for all Operators">dim</a>;
  complex <span class="keywordtype">double</span> ***<a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a> = mbme;

  <a class="code" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a9e0195b1777800e72b4f7af51f0c3945">Qpp</a>;
  <a class="code" href="structSlaterDetAux.html">SlaterDetAux</a>  <a class="code" href="MinimizerDONLP2_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>;

  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> odd = P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;

  <span class="comment">// norms of SlaterDets</span>
  <a class="code" href="SlaterDet_8c.html#a9d28b849a027b454fd2eddb812a884c5" title="init SlaterDetAux X">initSlaterDetAux</a>(Q, &amp;X);
  <span class="comment">// calcSlaterDetAuxod(Q, Q, &amp;X);</span>
  <span class="comment">// double norm = sqrt(creal(X.ovlap));</span>

  <span class="comment">// initSlaterDetAux(Qp, &amp;X);</span>
  <span class="comment">// calcSlaterDetAuxod(Qp, Qp, &amp;X);</span>
  <span class="comment">// double normp = sqrt(creal(X.ovlap));  </span>

  <span class="comment">// set up cm integration</span>
  <a class="code" href="structcmintegrationpara.html">cmintegrationpara</a> <a class="code" href="structcmpara.html">cmpara</a>;
  <a class="code" href="cmprojection_8c.html#abf4911adb463930dc540277d1da25c35">initcmintegration</a>(P, Q, Qp, &amp;cmpara);
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2vappcm_8c.html#a8a5e05e8fcc2b05354bff66fc1b1755c">ncm</a> = cmpara.<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>;

  <span class="comment">// set up angular momentum integration</span>
  <a class="code" href="structangintegrationpara.html">angintegrationpara</a> <a class="code" href="MinimizerDONLP2multivappcm_8c.html#a49105e626fcbcb1b768fedd076a84bd6">angpara</a>;
  <a class="code" href="angprojection_8c.html#ae7ea91fc189ad0a0487363668e0ffa89">initangintegration</a>(P, Q, Qp, S, Sp, &amp;angpara);
  <span class="keywordtype">int</span> nang = angpara.<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a>;

  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, r;
  <span class="keywordtype">int</span> o, p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;

  <span class="comment">// helpful for indexing matrix elements</span>

  <span class="keywordtype">int</span> ranko[Ops-&gt;<a class="code" href="structManyBodyOperators.html#ab95444d93053e68e632c2ca2948b6177" title="number of operators">n</a>];
  <span class="keywordflow">for</span> (o=0; o&lt;Ops-&gt;<a class="code" href="structManyBodyOperators.html#ab95444d93053e68e632c2ca2948b6177" title="number of operators">n</a>; o++)
    ranko[o] = Ops-&gt;<a class="code" href="structManyBodyOperators.html#aec0b3262bd8c350633c8ba56cd09f16f">Op</a>[o].<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;

  <span class="keywordtype">int</span> sizeo[Ops-&gt;<a class="code" href="structManyBodyOperators.html#ab95444d93053e68e632c2ca2948b6177" title="number of operators">n</a>];
  for (o=0; o&lt;Ops-&gt;<a class="code" href="structManyBodyOperators.html#ab95444d93053e68e632c2ca2948b6177" title="number of operators">n</a>; o++)
    sizeo[o] = size*(ranko[o]+1);

  <span class="keywordtype">int</span> <a class="code" href="OneNucleonOvlaps_8c.html#a13396ab49d1309c7c94166be31333904">io</a>[Ops-&gt;<a class="code" href="structManyBodyOperators.html#ab95444d93053e68e632c2ca2948b6177" title="number of operators">n</a>]; io[0] = 0;
  <span class="keywordflow">for</span> (o=0; o&lt;Ops-&gt;<a class="code" href="structManyBodyOperators.html#ab95444d93053e68e632c2ca2948b6177" title="number of operators">n</a>-1; o++)
    io[o+1] = io[o]+sizeo[o];

  <span class="keywordtype">int</span> no=0;
  <span class="keywordflow">for</span> (o=0; o&lt;Ops-&gt;<a class="code" href="structManyBodyOperators.html#ab95444d93053e68e632c2ca2948b6177" title="number of operators">n</a>; o++)
    no += sizeo[o];


  <span class="comment">// set matrix elements to zero</span>
  <span class="keywordflow">for</span> (o=0; o&lt;Ops-&gt;<a class="code" href="structManyBodyOperators.html#ab95444d93053e68e632c2ca2948b6177" title="number of operators">n</a>; o++)
    <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
      <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
        <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
          <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2)
            <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
              <span class="keywordflow">for</span> (r=0; r&lt;=ranko[o]; r++)
                val[o][idxpij(jmax,p,j)][r+l*(ranko[o]+1)+idxjmk(j,m,k)*sizeo[o]] = 0.0;
    }   

  <a class="code" href="SlaterDet_8c.html#a16db6f53cfee239b7d506c86bc372686">initSlaterDet</a>(Qp, &amp;Qpp);
  
  <span class="keywordtype">int</span> icm; 
  <span class="keywordtype">double</span> xcm[3]; <span class="keywordtype">double</span> weightcm;

  <span class="keywordtype">int</span> iang;
  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, gamma; <span class="keywordtype">double</span> weightang;


  complex <span class="keywordtype">double</span> sval[no];
  <span class="keywordtype">double</span> weight;
  <span class="keywordtype">int</span> ip;

  <span class="keywordflow">for</span> (icm=0; icm&lt;ncm; icm++) {
    <a class="code" href="cmprojection_8c.html#a4cde89930e46342aae042ab854f2290b">getcmintegrationpoint</a>(icm, &amp;cmpara, xcm, &amp;weightcm);

    <span class="keywordflow">for</span> (iang=0; iang&lt;nang; iang++) {
      <a class="code" href="angprojection_8c.html#a84c53149d9af0a652cb6486c9516cbb5">getangintegrationpoint</a>(iang, &amp;angpara, &amp;alpha, &amp;beta, &amp;gamma, &amp;weightang);
      <span class="comment">// weight = 1.0/(2*norm*normp)*weightcm*weightang;</span>
      weight = 0.5*weightcm*weightang;
      
      <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(Qp, &amp;Qpp);
      <a class="code" href="SlaterDet_8c.html#a5463a8afc7565b2711169b605aad5ca3" title="move Slater determinant by vector d">moveSlaterDet</a>(&amp;Qpp, xcm);
      <a class="code" href="SlaterDet_8c.html#a8737af9032a8d87843782a88228fef00" title="rotate Slater determinant by euler angles">rotateSlaterDet</a>(&amp;Qpp, alpha, beta, gamma);

      <span class="keywordflow">for</span> (ip=0; ip&lt;=1; ip++) {
          <span class="keywordflow">if</span> (ip) <a class="code" href="SlaterDet_8c.html#ad0aa11be18d42c1cc26c2ad1380feb2a" title="invert Slater determinant in origin">invertSlaterDet</a>(&amp;Qpp);

          <span class="comment">// can only calculate Auxilliaries if Sldets are compatible</span>
          <span class="keywordflow">if</span> (Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> == Qp-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>) {
            <span class="keywordflow">if</span> (Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> == Qp-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a> &amp;&amp; Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a> == Qp-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>)
              <a class="code" href="SlaterDet_8c.html#ad3679a655d9b6019619456e5b7961638">calcSlaterDetAuxod</a>(Q, &amp;Qpp, &amp;X);
            <span class="keywordflow">else</span>
              <a class="code" href="SlaterDet_8c.html#a861e4c675c3918393d69a81090376053">calcSlaterDetAuxodsingular</a>(Q, &amp;Qpp, &amp;X);
          }
          Ops-&gt;<a class="code" href="structManyBodyOperators.html#aed28a6d83fca31b2794173c96dd2d769">me</a>(Ops-&gt;<a class="code" href="structManyBodyOperators.html#a63b81b5a508a075fd10b76ebd219094f" title="the same for all operators">par</a>, Q, &amp;Qpp, &amp;X, sval);

          complex <span class="keywordtype">double</span> w;
          <span class="keywordflow">for</span> (o=0; o&lt;Ops-&gt;<a class="code" href="structManyBodyOperators.html#ab95444d93053e68e632c2ca2948b6177" title="number of operators">n</a>; o++)
            <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
              <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2)
                <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
                  <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2) {
                    <span class="keywordflow">if</span> ((ranko[o] != 0 || <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(S, p, j, m)) &amp;&amp;
                        <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sp, p, j, k)) {
                      w = weight * (p &amp;&amp; ip%2 ? -1 : 1)*
                        (j+1)/(8*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(M_PI))*Djmkstar(j,m,k,alpha,beta,gamma);
                      <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                        <span class="keywordflow">for</span> (r=0; r&lt;=ranko[o]; r++)
                          val[o][idxpij(jmax,p,j)][r+l*(ranko[o]+1)+idxjmk(j,m,k)*sizeo[o]] += 
                            w*sval[r+l*(ranko[o]+1)+io[o]];
                  }     
                }       
      }

    }

  }     
  <a class="code" href="SlaterDet_8c.html#a6d10ca2b062d871a6903292600c3125a" title="free memory used by SlaterDetAux X">freeSlaterDetAux</a>(&amp;X);
  <a class="code" href="SlaterDet_8c.html#adc279637790bc3303e9dca688966a7ab" title="free memory used by Slater determinant Q">freeSlaterDet</a>(&amp;Qpp);
}       
</pre></div></p>

</div>
</div>
<a class="anchor" id="af62aa4946bfad00289f9e804aba1bd6c"></a><!-- doxytag: member="Projection.h::calcprojectedMBMEsingular" ref="af62aa4946bfad00289f9e804aba1bd6c" args="(const Projection *P, const ManyBodyOperator *Op, const SlaterDet *Q, const SlaterDet *Qp, Symmetry S, Symmetry Sp, void *mbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcprojectedMBMEsingular </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a54006a58b4e31d612773ec5019bd79ef"></a><!-- doxytag: member="Projection.h::calctransitionprojectedMBME" ref="a54006a58b4e31d612773ec5019bd79ef" args="(const Projection *P, const ManyBodyOperator *Op, const void *mbme, const Symmetry *S, const Symmetry *Sp, const Eigenstates *E, const Eigenstates *Ep, void *transmbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calctransitionprojectedMBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>transmbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate transition strengths with matrix elements mbme and eigenvectors E </p>

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01060">1060</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00114">ManyBodyOperator::pi</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>, and <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>.</p>

<p>Referenced by <a class="el" href="calconenucleonovlaps_8c_source.html#l00047">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{       
  <span class="keywordtype">int</span> pini,jini,iini, pfin,jfin,ifin;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, kfin, kini;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, nu;
  <span class="keywordtype">int</span> afin, aini;
  <span class="keywordtype">int</span> nfin=Efin-&gt;n;
  <span class="keywordtype">int</span> nini=Eini-&gt;n;
  <span class="keywordtype">int</span> njini, njfin;
  <span class="keywordtype">int</span> idxini, idxfin;
  <span class="keywordtype">int</span> p=Op-&gt;<a class="code" href="structManyBodyOperator.html#a78ec7c9f2238907255cf499427676907" title="parity of operator, 0 positve, 1 negative">pi</a>;
  <span class="keywordtype">int</span> size=Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  <span class="keywordtype">int</span> rank=Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  <span class="keywordtype">int</span> oddini=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  complex double (***me)[(rank+1)*size] = mbme;
  complex double (****transme)[size] = transmbme;

  complex <span class="keywordtype">double</span>* meVwork = malloc(nfin*nini*(jmax+1)*(jmax+1)*size*(rank+1)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (pini=0; pini&lt;=1; pini++)
    <span class="keywordflow">for</span> (jini=oddini; jini&lt;jmax; jini=jini+2) {
      
      idxini = idxpij(jmax,pini,jini);
      njini=nini*(jini+1);

      pfin=(pini+p)%2;
      <span class="keywordflow">for</span> (jfin=abs(jini-rank); jfin&lt;=min(jmax-1,jini+rank); jfin=jfin+2) {

        idxfin = idxpij(jmax,pfin,jfin);
        njfin=nfin*(jfin+1);

        complex double (*meV)[nini*(jini+1)][(jini+1)][size*(rank+1)] = meVwork;

        <span class="keywordflow">for</span> (iini=0; iini&lt;Eini-&gt;dim[idxini]; iini++)
          <span class="keywordflow">for</span> (afin=0; afin&lt;nfin; afin++)
            <span class="keywordflow">for</span> (k=-jini; k&lt;=jini; k=k+2)
              <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                <span class="keywordflow">for</span> (nu=-rank; nu&lt;=rank; nu=nu+2)
                  meV[afin][iini][idxjm(jini,k)][(nu+rank)/2+l*(rank+1)] = 0.0;

        <span class="keywordflow">for</span> (iini=0; iini&lt;Eini-&gt;dim[idxini]; iini++)
          <span class="keywordflow">for</span> (afin=0; afin&lt;nfin; afin++)
            <span class="keywordflow">for</span> (k=-jini; k&lt;=jini; k=k+2)
              <span class="keywordflow">for</span> (aini=0; aini&lt;nini; aini++)
                <span class="keywordflow">for</span> (kini=-jini; kini&lt;=jini; kini=kini+2)
                  <span class="keywordflow">if</span> (<a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sini[aini], pini, jini, kini)) {
              
                    <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                      <span class="keywordflow">for</span> (nu=-rank; nu&lt;=rank; nu=nu+2)
                        meV[afin][iini][idxjm(jini,k)][(nu+rank)/2+l*(rank+1)] +=
                          me[afin+aini*nfin][idxini][idxjmk(jini,k,kini)][(nu+rank)/2+l*(rank+1)]*

                          Eini-&gt;V[idxini][idxnjm(aini,jini,kini) + iini*njini];
                  }


        <span class="keywordflow">for</span> (iini=0; iini&lt;Eini-&gt;dim[idxini]; iini++)
          <span class="keywordflow">for</span> (ifin=0; ifin&lt;Efin-&gt;dim[idxfin]; ifin++) {

            <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
              transme[idxfin][idxini][ifin][iini][l] = 0.0;

            <span class="keywordflow">for</span> (afin=0; afin&lt;nfin; afin++)
              <span class="keywordflow">for</span> (kfin=-jfin; kfin&lt;=jfin; kfin=kfin+2)
                <span class="keywordflow">for</span> (k=max(-jini,kfin-rank); k&lt;=min(jini,kfin+rank); k=k+2) {
                  nu = kfin-k;
                  <span class="keywordflow">if</span> (<a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sfin[afin], pfin, jfin, kfin)) {
                    <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                      transme[idxfin][idxini][ifin][iini][l] +=
                        <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(jini, rank, jfin, k, nu, kfin)*
                        conj(Efin-&gt;V[idxfin][idxnjm(afin,jfin,kfin) + ifin*njfin])*
                        meV[afin][iini][idxjm(jini,k)][(nu+rank)/2+l*(rank+1)];
                  }
                }
          }     
      }                 
    }
  
  free(meVwork);
}       
</pre></div></p>

</div>
</div>
<a class="anchor" id="a00b2cd7ac851155cf70fc58d1cc3ab16"></a><!-- doxytag: member="Projection.h::calctransitionprojectedMBMEipj" ref="a00b2cd7ac851155cf70fc58d1cc3ab16" args="(const Projection *P, const ManyBodyOperator *Op, const void *mbme, const Symmetry *S, const Symmetry *Sp, const Eigenstates *E, const Eigenstates *Ep, int jini, int pini, int iini, int jfin, int pfin, int ifin, void *transmbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calctransitionprojectedMBMEipj </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>jini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>iini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>jfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ifin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>transmbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01151">1151</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00114">ManyBodyOperator::pi</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>, and <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>.</p>

<p>Referenced by <a class="el" href="calctransitionchargedensities_8c_source.html#l00029">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{       
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, kfin, kini;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, nu;
  <span class="keywordtype">int</span> afin, aini;
  <span class="keywordtype">int</span> nfin=Efin-&gt;n;
  <span class="keywordtype">int</span> nini=Eini-&gt;n;
  <span class="keywordtype">int</span> njini, njfin;
  <span class="keywordtype">int</span> idxini, idxfin;
  <span class="keywordtype">int</span> iiini, iifin;
  <span class="keywordtype">int</span> p=Op-&gt;<a class="code" href="structManyBodyOperator.html#a78ec7c9f2238907255cf499427676907" title="parity of operator, 0 positve, 1 negative">pi</a>;
  <span class="keywordtype">int</span> size=Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  <span class="keywordtype">int</span> rank=Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  <span class="keywordtype">int</span> oddini=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  complex double (***me)[(rank+1)*size] = mbme;
  complex double (****transme)[size] = transmbme;

  idxini = idxpij(jmax,pini,jini);
  iiini = Eini-&gt;index[idxini][iini];
  njini=nini*(jini+1);

  idxfin = idxpij(jmax,pfin,jfin);
  iifin = Efin-&gt;index[idxfin][ifin];
  njfin=nfin*(jfin+1);

  <span class="comment">// allocate space for transition matrix elements</span>
  transme[idxfin][idxini][iifin] = malloc(njini*size*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));

  <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
    transme[idxfin][idxini][iifin][iiini][l] = 0.0;

  <span class="keywordflow">for</span> (aini=0; aini&lt;nini; aini++)
    <span class="keywordflow">for</span> (kini=-jini; kini&lt;=jini; kini=kini+2)
      <span class="keywordflow">for</span> (afin=0; afin&lt;nfin; afin++)
        <span class="keywordflow">for</span> (kfin=-jfin; kfin&lt;=jfin; kfin=kfin+2)
          <span class="keywordflow">for</span> (k=max(-jini,kfin-rank); k&lt;=min(jini,kfin+rank); k=k+2) {
            nu = kfin-k;
            <span class="keywordflow">if</span> (<a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sfin[afin], pfin, jfin, kfin) &amp;&amp;
                <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sini[aini], pini, jini, kini)) {
              <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
                transme[idxfin][idxini][iifin][iiini][l] +=
                  <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(jini, rank, jfin, k, nu, kfin)*
                  conj(Efin-&gt;V[idxfin][idxnjm(afin,jfin,kfin) + iifin*njfin])*
                  me[afin+aini*nfin][idxini][idxjmk(jini,k,kini)][(nu+rank)/2+l*(rank+1)]*
                  Eini-&gt;V[idxini][idxnjm(aini,jini,kini) + iiini*njini];
            }
          }
}       
</pre></div></p>

</div>
</div>
<a class="anchor" id="af11f2a70292f93f6b5983cfc4f26d774"></a><!-- doxytag: member="Projection.h::fprintProjectinfo" ref="af11f2a70292f93f6b5983cfc4f26d774" args="(FILE *fp, const Projection *P)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fprintProjectinfo </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00178">178</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00097">Projection::ang</a>, <a class="el" href="Projection_8h_source.html#l00052">AngNone</a>, <a class="el" href="Projection_8h_source.html#l00099">Projection::angprod</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProd</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProdA</a>, <a class="el" href="Projection_8h_source.html#l00100">Projection::angzcw</a>, <a class="el" href="Projection_8h_source.html#l00052">AngZCW</a>, <a class="el" href="Projection_8h_source.html#l00102">Projection::cm</a>, <a class="el" href="Projection_8h_source.html#l00025">CMNone</a>, <a class="el" href="Projection_8h_source.html#l00105">Projection::cmpoly</a>, <a class="el" href="Projection_8h_source.html#l00025">CMPoly</a>, <a class="el" href="Projection_8h_source.html#l00104">Projection::cmprod</a>, <a class="el" href="Projection_8h_source.html#l00025">CMProd</a>, <a class="el" href="Projection_8h_source.html#l00025">CMSimple</a>, <a class="el" href="Projection_8h_source.html#l00060">angzcwpara::idx</a>, <a class="el" href="zcw_8c_source.html#l00058">nangles3()</a>, <a class="el" href="Projection_8h_source.html#l00055">angprodpara::nazimuth</a>, <a class="el" href="Projection_8h_source.html#l00056">angprodpara::nbeta</a>, <a class="el" href="Projection_8h_source.html#l00030">cmprodpara::nphi</a>, <a class="el" href="Projection_8h_source.html#l00035">cmpolypara::npoly</a>, <a class="el" href="Projection_8h_source.html#l00034">cmpolypara::nr</a>, <a class="el" href="Projection_8h_source.html#l00028">cmprodpara::nr</a>, <a class="el" href="Projection_8h_source.html#l00029">cmprodpara::ntheta</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiproj_8c_source.html#l00052">main()</a>, <a class="el" href="Projection_8c_source.html#l01836">writeMulticonfigfile()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l01017">writeMultiEigenstatestoFile()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l01051">writeMultiMulticonfigfile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba55bf53a0f8c9f993e6faf4c61fe8ce10">AngNone</a>)
    fprintf(fp, <span class="stringliteral">&quot;# angular momentum projeciton - none\n&quot;</span>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9610a33497e9e2e45e79bc44d5ef918f">AngProd</a>)
    fprintf(fp, <span class="stringliteral">&quot;# angular momentum projection - product integration with %d,%d,%d points (%d angles)\n&quot;</span>, 
            P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a>, 
            P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#abcad02e655573d2040ce82457bbd4cc7">nbeta</a>, P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a>,
            <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a>)*P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#abcad02e655573d2040ce82457bbd4cc7">nbeta</a>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167babf044d8a168c981d4076daf448fae0fc">AngProdA</a>)
    fprintf(fp, <span class="stringliteral">&quot;# angular momentum projection - adaptive product integration with %d,%d,%d points (%d angles)\n&quot;</span>, 
            P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a>, 
            P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#abcad02e655573d2040ce82457bbd4cc7">nbeta</a>, P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a>,
            <a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a>)*P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#abcad02e655573d2040ce82457bbd4cc7">nbeta</a>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9ecd3bfb04930e544c099805a7b847a6">AngZCW</a>)
    fprintf(fp, <span class="stringliteral">&quot;# angular momentum projection - integration using ZCW set %d (%d angles)\n&quot;</span>,
            P-&gt;<a class="code" href="structProjection.html#a24b0c733ce6d8f892575554682ef2947">angzcw</a>.<a class="code" href="structangzcwpara.html#a10bdceb86e6bb8dceb15668131ef278b">idx</a>, <a class="code" href="zcw_8c.html#a5be18be997b229d9106a4ddda9a8cafd">nangles3</a>(P-&gt;<a class="code" href="structProjection.html#a24b0c733ce6d8f892575554682ef2947">angzcw</a>.<a class="code" href="structangzcwpara.html#a10bdceb86e6bb8dceb15668131ef278b">idx</a>));

  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a8d869da79c82654982e95e61d10a64c4">CMNone</a>)
    fprintf(fp, <span class="stringliteral">&quot;# center of mass projection - none\n&quot;</span>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a0e967fc9236e1bb9b51ddb4c16fd096e">CMSimple</a>)
    fprintf(fp, <span class="stringliteral">&quot;# center of mass projection - simple\n&quot;</span>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a3ebfa1463485cc7babb95b427075772a">CMProd</a>)
    fprintf(fp, <span class="stringliteral">&quot;# center of mass projection - product integration with %d,%d,%d points\n&quot;</span>,
            P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#aceeaab6ba25f876de7f218c9e797cf01">nr</a>, P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#af7d2985994407467340336b7dd1b683e">ntheta</a>, P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#a44027ab99975309599367c045379d55d">nphi</a>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf">CMPoly</a>)
    fprintf(fp, <span class="stringliteral">&quot;# center of mass projection - integration using %d %s points\n&quot;</span>,
            P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a>, (P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> == 4 ? <span class="stringliteral">&quot;tetrahedral&quot;</span> : <span class="stringliteral">&quot;octahedral&quot;</span>));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5c0336acd3f2e1e48e88942a353129cd"></a><!-- doxytag: member="Projection.h::freeAngintegration" ref="a5c0336acd3f2e1e48e88942a353129cd" args="(angintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freeAngintegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structangintegrationpara.html">angintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="angprojection_8c_source.html#l00077">77</a> of file <a class="el" href="angprojection_8c_source.html">angprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00070">angprodintegrationpara::alpha</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProd</a>, <a class="el" href="Projection_8h_source.html#l00073">angprodintegrationpara::beta</a>, <a class="el" href="Projection_8h_source.html#l00086">angintegrationpara::prod</a>, <a class="el" href="Projection_8h_source.html#l00082">angintegrationpara::type</a>, <a class="el" href="Projection_8h_source.html#l00071">angprodintegrationpara::walpha</a>, and <a class="el" href="Projection_8h_source.html#l00074">angprodintegrationpara::wbeta</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, and <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span>(par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9610a33497e9e2e45e79bc44d5ef918f">AngProd</a>) {
    free(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a7854cddeff892c4ecdc5115ea29fd363">beta</a>);
    free(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a704c16042520b3a9b6ce333c92aa4a49">wbeta</a>);
    free(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#acd9fae3f84610a923d30c38486bea4fd">alpha</a>);
    free(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a438803d307266d5a768336b4c19f5e47">walpha</a>);
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7ae9754fe9db92205d761777cfa5e336"></a><!-- doxytag: member="Projection.h::freecmintegration" ref="a7ae9754fe9db92205d761777cfa5e336" args="(cmintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freecmintegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00298">298</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, and <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  free(par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>);
  free(par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a84c53149d9af0a652cb6486c9516cbb5"></a><!-- doxytag: member="Projection.h::getangintegrationpoint" ref="a84c53149d9af0a652cb6486c9516cbb5" args="(int i, const angintegrationpara *par, double *alpha, double *beta, double *gamma, double *w)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getangintegrationpoint </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structangintegrationpara.html">angintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>w</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="angprojection_8c_source.html#l00250">250</a> of file <a class="el" href="angprojection_8c_source.html">angprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00070">angprodintegrationpara::alpha</a>, <a class="el" href="Projection_8h_source.html#l00052">AngNone</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProd</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProdA</a>, <a class="el" href="Projection_8h_source.html#l00052">AngZCW</a>, <a class="el" href="Projection_8h_source.html#l00073">angprodintegrationpara::beta</a>, <a class="el" href="Projection_8h_source.html#l00076">angprodintegrationpara::gamma</a>, <a class="el" href="zcw_8c_source.html#l00069">getangles3()</a>, <a class="el" href="Projection_8h_source.html#l00065">angzcwintegrationpara::idx</a>, <a class="el" href="Projection_8h_source.html#l00083">angintegrationpara::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00069">angprodintegrationpara::nalpha</a>, <a class="el" href="Projection_8h_source.html#l00072">angprodintegrationpara::nbeta</a>, <a class="el" href="Projection_8h_source.html#l00086">angintegrationpara::prod</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00082">angintegrationpara::type</a>, <a class="el" href="Projection_8h_source.html#l00071">angprodintegrationpara::walpha</a>, <a class="el" href="Projection_8h_source.html#l00074">angprodintegrationpara::wbeta</a>, <a class="el" href="Projection_8h_source.html#l00077">angprodintegrationpara::wgamma</a>, and <a class="el" href="Projection_8h_source.html#l00085">angintegrationpara::zcw</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2proj_8c_source.html#l00410">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00390">calcorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00179">calcprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00037">calcprojectedMBMEmpi()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00194">calcprojectedMBMEsmpi()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, and <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  assert(i &lt; par-&gt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);

  <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba55bf53a0f8c9f993e6faf4c61fe8ce10">AngNone</a>) {
    *<a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a> = 0.0; *beta = 0.0; *gamma = 0.0;
    *w = 8*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(M_PI);
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9ecd3bfb04930e544c099805a7b847a6">AngZCW</a>) {
    <a class="code" href="zcw_8c.html#a966eb7c85d09ceced440c4b2ddac66e7">getangles3</a>(par-&gt;<a class="code" href="structangintegrationpara.html#a51f700dc1c0da486dd4c1dad7cfe03fd">zcw</a>.<a class="code" href="structangzcwintegrationpara.html#a1b5b2155e111db96eccc7fc63055c36a">idx</a>, i, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, gamma);
    *w = 8*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(M_PI)/par-&gt;<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a>;
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9610a33497e9e2e45e79bc44d5ef918f">AngProd</a> || par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167babf044d8a168c981d4076daf448fae0fc">AngProdA</a>) {
    <span class="keywordtype">int</span> ibeta, ialpha, igamma;
    
    ibeta = i % par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>;
    ialpha = (i/par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>) % par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#aba31aafae956674b4d3b9facae60afa5">nalpha</a>;
    igamma = i/(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>*par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#aba31aafae956674b4d3b9facae60afa5">nalpha</a>);

    *beta = acos(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a7854cddeff892c4ecdc5115ea29fd363">beta</a>[ibeta]);
    *<a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a> = par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#acd9fae3f84610a923d30c38486bea4fd">alpha</a>[ialpha];
    *gamma = par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a39129cb326c1254a3cbcceba699d3280">gamma</a>[igamma];
    *w = par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a704c16042520b3a9b6ce333c92aa4a49">wbeta</a>[ibeta]*
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a438803d307266d5a768336b4c19f5e47">walpha</a>[ialpha]*par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a390b7936c8e1eb441363c605a5734405">wgamma</a>[igamma];
  }
    
  <span class="comment">// fprintf(stderr, &quot;ang integration point: (%8.5f, %8.5f, %8.5f) weight %8.5f\n&quot;, </span>
  <span class="comment">//         *alpha, *beta, *gamma, *w);</span>
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4cde89930e46342aae042ab854f2290b"></a><!-- doxytag: member="Projection.h::getcmintegrationpoint" ref="a4cde89930e46342aae042ab854f2290b" args="(int i, const cmintegrationpara *par, double x[3], double *w)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getcmintegrationpoint </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>w</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00305">305</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00497">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00037">calcprojectedMBMEmpi()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00194">calcprojectedMBMEsmpi()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, and <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  assert(i &lt; par-&gt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;
  <span class="keywordflow">for</span> (j=0; j&lt;3; j++)
    <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>[j] = par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][j];
  
  *w = par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i];

  <span class="comment">// fprintf(stderr, &quot;cm integration point: (%8.5f, %8.5f, %8.5f) weight %8.5f\n&quot;, </span>
  <span class="comment">//         x[0], x[1], x[2], *w);</span>
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a769abddc6e28e099e9725712b7ed2104"></a><!-- doxytag: member="Projection.h::hermitizeprojectedMBME" ref="a769abddc6e28e099e9725712b7ed2104" args="(const Projection *P, const ManyBodyOperator *Op, void *mbme, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hermitizeprojectedMBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00845">845</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, and <a class="el" href="donlp2_8h_source.html#l00057">val</a>.</p>

<p>Referenced by <a class="el" href="calcchargedensities_8c_source.html#l00029">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> size=Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> rank=Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  complex double (***<a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>)[(rank+1)*size] = mbme;

  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> odd = P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;

  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;
  <span class="keywordtype">int</span> a,b;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, r;

  complex <span class="keywordtype">double</span> valu, vall;

  <span class="comment">// hermitize matrix elements</span>
  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2)
      <span class="keywordflow">for</span> (b=0; b&lt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; b++)
        <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
          <span class="keywordflow">for</span> (a=0; a&lt;n; a++)
            <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2)
              <span class="keywordflow">for</span> (l=0; l&lt;dim; l++) 
                <span class="keywordflow">for</span> (r=0; r&lt;=rank+1; r++) {
                  valu = <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[a+b*n][idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)];
                  vall = <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[b+a*n][idxpij(jmax,p,j)][idxjmk(j,k,m)][r+l*(rank+1)];
                  <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[a+b*n][idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)] = 0.5*(valu+conj(vall));
                  <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>[b+a*n][idxpij(jmax,p,j)][idxjmk(j,k,m)][r+l*(rank+1)] = 0.5*(conj(valu)+vall);
              }
}    
</pre></div></p>

</div>
</div>
<a class="anchor" id="a24150e1691aa16292612bec682cca3ae"></a><!-- doxytag: member="Projection.h::initAmplitudes" ref="a24150e1691aa16292612bec682cca3ae" args="(const Projection *P, Amplitudes *A, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initAmplitudes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structAmplitudes.html">Amplitudes</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01227">1227</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00155">Amplitudes::amp</a>, <a class="el" href="Projection_8c_source.html#l00241">initprojectedmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00209">initprojectedvector()</a>, <a class="el" href="Projection_8h_source.html#l00153">Amplitudes::n</a>, and <a class="el" href="Projection_8h_source.html#l00154">Amplitudes::ngood</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiproj_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  A-&gt;<a class="code" href="structAmplitudes.html#aeb28e7c61eb781e59b43e00dabb8bf79">n</a> = <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
  A-&gt;<a class="code" href="structAmplitudes.html#a3192b8e5338e5ac43d813833b09ad221">ngood</a> = <a class="code" href="Projection_8c.html#a84110f2d4600522fbbd3d392ccb28fce">initprojectedvector</a>(P, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
  A-&gt;<a class="code" href="structAmplitudes.html#a1608d319a33b0263e17f0ac70993cce2">amp</a> = <a class="code" href="Projection_8c.html#abb5a41706e33979ad3bdc5f7f03f301e">initprojectedmatrix</a>(P, <span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>), <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae7ea91fc189ad0a0487363668e0ffa89"></a><!-- doxytag: member="Projection.h::initangintegration" ref="ae7ea91fc189ad0a0487363668e0ffa89" args="(const Projection *P, const SlaterDet *Q, const SlaterDet *Qp, Symmetry S, Symmetry Sp, angintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initangintegration </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structangintegrationpara.html">angintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="angprojection_8c_source.html#l00210">210</a> of file <a class="el" href="angprojection_8c_source.html">angprojection.c</a>.</p>

<p>References <a class="el" href="angprojection_8c_source.html#l00092">_estimateangkappa()</a>, <a class="el" href="angprojection_8c_source.html#l00131">_initangintegration()</a>, <a class="el" href="Projection_8h_source.html#l00097">Projection::ang</a>, and <a class="el" href="Projection_8h_source.html#l00052">AngProdA</a>.</p>

<p>Referenced by <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00037">calcprojectedMBMEmpi()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00194">calcprojectedMBMEsmpi()</a>, and <a class="el" href="minenergyconvap_8c_source.html#l00083">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> kappa = 0.0; 
  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167babf044d8a168c981d4076daf448fae0fc">AngProdA</a>) {
    kappa = dmin(<a class="code" href="angprojection_8c.html#a96407d07755537e4db8a7047f7a3549d">_estimateangkappa</a>(Q), <a class="code" href="angprojection_8c.html#a96407d07755537e4db8a7047f7a3549d">_estimateangkappa</a>(Qp));
    fprintf(stderr, <span class="stringliteral">&quot;kappa: %8.3f\n&quot;</span>, kappa);
  }

  <a class="code" href="angprojection_8c.html#a80b9d82dadcaadc0a6026004285b49f4">_initangintegration</a>(P, kappa,  S, Sp, par);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9cf9855bec48b5aac8d96335102c0afa"></a><!-- doxytag: member="Projection.h::initAngintegration" ref="a9cf9855bec48b5aac8d96335102c0afa" args="(angintegrationpara *par, const char *projpar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int initAngintegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structangintegrationpara.html">angintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>projpar</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="angprojection_8c_source.html#l00028">28</a> of file <a class="el" href="angprojection_8c_source.html">angprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00070">angprodintegrationpara::alpha</a>, <a class="el" href="Projection_8h_source.html#l00073">angprodintegrationpara::beta</a>, <a class="el" href="Projection_8h_source.html#l00076">angprodintegrationpara::gamma</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="Projection_8h_source.html#l00065">angzcwintegrationpara::idx</a>, <a class="el" href="Projection_8h_source.html#l00083">angintegrationpara::n</a>, <a class="el" href="Projection_8h_source.html#l00069">angprodintegrationpara::nalpha</a>, <a class="el" href="zcw_8c_source.html#l00058">nangles3()</a>, <a class="el" href="Projection_8h_source.html#l00072">angprodintegrationpara::nbeta</a>, <a class="el" href="Projection_8h_source.html#l00075">angprodintegrationpara::ngamma</a>, <a class="el" href="Projection_8h_source.html#l00086">angintegrationpara::prod</a>, <a class="el" href="gaussquad_8c_source.html#l00255">ShiftedPeriodicTrapezoidalPoints()</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00082">angintegrationpara::type</a>, <a class="el" href="Projection_8h_source.html#l00071">angprodintegrationpara::walpha</a>, <a class="el" href="Projection_8h_source.html#l00074">angprodintegrationpara::wbeta</a>, <a class="el" href="Projection_8h_source.html#l00077">angprodintegrationpara::wgamma</a>, and <a class="el" href="Projection_8h_source.html#l00085">angintegrationpara::zcw</a>.</p>

<p>Referenced by <a class="el" href="minenergyconmultivapp_8c_source.html#l00086">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span> projparcpy[strlen(<a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>)];
  strcpy(projparcpy, <a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>);
  <span class="keywordtype">char</span>* c = projparcpy;
        
  c = strtok(c, <span class="stringliteral">&quot;-&quot;</span>);

  <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;ang&quot;</span>, 3)) {
    c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
    <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;none&quot;</span>, 4)) {
      par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> = AngNone;
      par-&gt;<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a> = 1;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;zcw&quot;</span>, 3)) {
      par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> = AngZCW;
      c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
      par-&gt;<a class="code" href="structangintegrationpara.html#a51f700dc1c0da486dd4c1dad7cfe03fd">zcw</a>.<a class="code" href="structangzcwintegrationpara.html#a1b5b2155e111db96eccc7fc63055c36a">idx</a> = atoi(c);
      par-&gt;<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a> = <a class="code" href="zcw_8c.html#a5be18be997b229d9106a4ddda9a8cafd">nangles3</a>(par-&gt;<a class="code" href="structangintegrationpara.html#a51f700dc1c0da486dd4c1dad7cfe03fd">zcw</a>.<a class="code" href="structangzcwintegrationpara.html#a1b5b2155e111db96eccc7fc63055c36a">idx</a>);
    } <span class="keywordflow">else</span> {
      par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> = AngProd;
      <span class="keywordtype">int</span> nbeta = atoi(c);
      c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
      <span class="keywordtype">int</span> nazimuth = atoi(c);

      par-&gt;<a class="code" href="structangintegrationpara.html#a4b08f3ab8ebe1b43dc13c7e4223d3156">n</a> = nbeta*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(nazimuth);

      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a> = nbeta;
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a7854cddeff892c4ecdc5115ea29fd363">beta</a> = malloc(nbeta*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a704c16042520b3a9b6ce333c92aa4a49">wbeta</a> = malloc(nbeta*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
      <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(nbeta, -1.0, 1.0, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a7854cddeff892c4ecdc5115ea29fd363">beta</a>, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a704c16042520b3a9b6ce333c92aa4a49">wbeta</a>);
    
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#aba31aafae956674b4d3b9facae60afa5">nalpha</a> = nazimuth;
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#acd9fae3f84610a923d30c38486bea4fd">alpha</a> = malloc(nazimuth*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a438803d307266d5a768336b4c19f5e47">walpha</a> = malloc(nazimuth*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
      <span class="keywordtype">double</span> shift = 0.25;
      <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(nazimuth, 0, 2*M_PI, shift,
                                       par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#acd9fae3f84610a923d30c38486bea4fd">alpha</a>, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a438803d307266d5a768336b4c19f5e47">walpha</a>);

      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a1202fcb525f75cf85af23194050b8c5d">ngamma</a> = nazimuth;
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a39129cb326c1254a3cbcceba699d3280">gamma</a> = par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#acd9fae3f84610a923d30c38486bea4fd">alpha</a>;
      par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a390b7936c8e1eb441363c605a5734405">wgamma</a> = par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a438803d307266d5a768336b4c19f5e47">walpha</a>;

    }
  }

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="abf4911adb463930dc540277d1da25c35"></a><!-- doxytag: member="Projection.h::initcmintegration" ref="abf4911adb463930dc540277d1da25c35" args="(const Projection *P, const SlaterDet *Q, const SlaterDet *Qp, cmintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initcmintegration </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00224">224</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="cmprojection_8c_source.html#l00128">_estimateacm()</a>, <a class="el" href="cmprojection_8c_source.html#l00147">_initcmintegration()</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00107">alpha</a>.</p>

<p>Referenced by <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00037">calcprojectedMBMEmpi()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, and <a class="el" href="Projectionmpi_8c_source.html#l00194">calcprojectedMBMEsmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a> = 0.5/(<a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(Q)+<a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(Qp));

  <a class="code" href="cmprojection_8c.html#afd49fd9499450859075a07b9c48230d3">_initcmintegration</a>(P, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, par);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a290947c34bd2d28ab9f553b424ce0b83"></a><!-- doxytag: member="Projection.h::initCMintegration" ref="a290947c34bd2d28ab9f553b424ce0b83" args="(cmintegrationpara *par, const char *projpar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initCMintegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>projpar</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00069">69</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00041">cmintegrationpara::n</a>, <a class="el" href="Projection_8h_source.html#l00030">cmprodpara::nphi</a>, <a class="el" href="Projection_8h_source.html#l00035">cmpolypara::npoly</a>, <a class="el" href="Projection_8h_source.html#l00028">cmprodpara::nr</a>, <a class="el" href="Projection_8h_source.html#l00034">cmpolypara::nr</a>, <a class="el" href="donlp2_8h_source.html#l00052">nr</a>, <a class="el" href="Projection_8h_source.html#l00029">cmprodpara::ntheta</a>, <a class="el" href="Projection_8h_source.html#l00044">cmintegrationpara::poly</a>, <a class="el" href="Projection_8h_source.html#l00043">cmintegrationpara::prod</a>, <a class="el" href="Projection_8h_source.html#l00040">cmintegrationpara::type</a>, <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="minenergyconmultivappcm_8c_source.html#l00086">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span> projparcpy[strlen(<a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>)];
  strcpy(projparcpy, <a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>);
  <span class="keywordtype">char</span>* c = projparcpy;

  <span class="comment">// default is CMNone</span>
  <a class="code" href="structcmpara.html">cmpara</a>-&gt;type = CMNone;
  <a class="code" href="structcmpara.html">cmpara</a>-&gt;n = 1;

  c = strtok(c, <span class="stringliteral">&quot;-&quot;</span>);
  <span class="keywordflow">while</span> (c &amp;&amp; strncmp(c, <span class="stringliteral">&quot;cm&quot;</span>, 2)) { 
    c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>); 
  };
  
  <span class="keywordflow">if</span> (c) {
    c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
    <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;none&quot;</span>, 4)) {
      <a class="code" href="structcmpara.html">cmpara</a>-&gt;type = CMNone;
      <a class="code" href="structcmpara.html">cmpara</a>-&gt;n = 1;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;simple&quot;</span>, 6)) {
      <a class="code" href="structcmpara.html">cmpara</a>-&gt;type = CMSimple;
      <a class="code" href="structcmpara.html">cmpara</a>-&gt;n = 1;
    } <span class="keywordflow">else</span> {
      <span class="keywordtype">int</span> <a class="code" href="donlp2_8h.html#a2833bf188e6bf292fa7d61e2dd54d622">nr</a> = atoi(c);
      c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
      <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;tet&quot;</span>, 3)) {
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;type = CMPoly;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;poly.nr = nr;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;poly.npoly = 4;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;n = 4*nr;
      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;oct&quot;</span>, 3)) {
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;type = CMPoly;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;poly.nr = nr;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;poly.npoly = 6;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;n = 6*nr;
      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;cbe&quot;</span>, 3)) {
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;type = CMPoly;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;poly.nr = nr;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;poly.npoly = 8;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;n = 8*nr;
      } <span class="keywordflow">else</span> {
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;type = CMProd;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;prod.nr = nr;
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;prod.ntheta = atoi(c);
        c = strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;prod.nphi = atoi(c);
        <a class="code" href="structcmpara.html">cmpara</a>-&gt;n = nr*<a class="code" href="structcmpara.html">cmpara</a>-&gt;prod.ntheta*<a class="code" href="structcmpara.html">cmpara</a>-&gt;prod.nphi;
      }
    }
  }

  <a class="code" href="structcmpara.html">cmpara</a>-&gt;x = malloc(3*<a class="code" href="structcmpara.html">cmpara</a>-&gt;n*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
  <a class="code" href="structcmpara.html">cmpara</a>-&gt;w = malloc(<a class="code" href="structcmpara.html">cmpara</a>-&gt;n*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9be2f82e183827f27b5edbefcb794740"></a><!-- doxytag: member="Projection.h::initEigenstates" ref="a9be2f82e183827f27b5edbefcb794740" args="(const Projection *P, Eigenstates *E, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initEigenstates </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01212">1212</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="Projection_8c_source.html#l00241">initprojectedmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00209">initprojectedvector()</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="Projection_8h_source.html#l00146">Eigenstates::ngood</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>, and <a class="el" href="Projection_8h_source.html#l00143">Eigenstates::v</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiproj_8c_source.html#l00052">main()</a>, and <a class="el" href="Projection_8c_source.html#l01681">readEigenstates()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;

  E-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a> = <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;

  E-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a> = <a class="code" href="Projection_8c.html#a84110f2d4600522fbbd3d392ccb28fce">initprojectedvector</a>(P, <span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>), <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
  E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a> = <a class="code" href="Projection_8c.html#abb5a41706e33979ad3bdc5f7f03f301e">initprojectedmatrix</a>(P, <span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>), <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
  E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a> = <a class="code" href="Projection_8c.html#a84110f2d4600522fbbd3d392ccb28fce">initprojectedvector</a>(P, <span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>), <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
  E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a> = malloc((jmax+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  E-&gt;<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a> = malloc((jmax+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
  E-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a> = <a class="code" href="Projection_8c.html#a84110f2d4600522fbbd3d392ccb28fce">initprojectedvector</a>(P, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="acef8d2b9b483edf18c061e6c4fb464d2"></a><!-- doxytag: member="Projection.h::initprojectedMBME" ref="acef8d2b9b483edf18c061e6c4fb464d2" args="(const Projection *P, const ManyBodyOperator *Op)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* initprojectedMBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>store projected MEs between two ManyBody states </p>

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00309">309</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8c_source.html#l00241">initprojectedmatrix()</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, and <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00176">initprojectedMultiMBME()</a>, <a class="el" href="calcbasisovlap_8c_source.html#l00087">main()</a>, and <a class="el" href="calcenergymultiprojsel_8c_source.html#l00290">readorcalcandwriteprojectedMBMEfromtoFile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="Projection_8c.html#abb5a41706e33979ad3bdc5f7f03f301e">initprojectedmatrix</a>(P, (Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>+1)*Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>), 1);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aef486ac2facdd165978efd4f5bc5009d"></a><!-- doxytag: member="Projection.h::initprojectedtransitionVector" ref="aef486ac2facdd165978efd4f5bc5009d" args="(const Projection *P, const ManyBodyOperator *Op, int n, int np)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* initprojectedtransitionVector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>np</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00328">328</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8c_source.html#l00256">initprojectedtransitionvector()</a>, <a class="el" href="Projection_8h_source.html#l00114">ManyBodyOperator::pi</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, and <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>.</p>

<p>Referenced by <a class="el" href="calconenucleonovlaps_8c_source.html#l00047">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="Projection_8c.html#a3225f075e7b00ee802171dd3be087536">initprojectedtransitionvector</a>(P, Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>, Op-&gt;<a class="code" href="structManyBodyOperator.html#a78ec7c9f2238907255cf499427676907" title="parity of operator, 0 positve, 1 negative">pi</a>, 
                                       Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>), 
                                       nfin, nini);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a76abdc07adaf79ddd74c8402f049c8a6"></a><!-- doxytag: member="Projection.h::initprojectedtransitionVectornull" ref="a76abdc07adaf79ddd74c8402f049c8a6" args="(const Projection *P, const ManyBodyOperator *Op, int n, int np)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* initprojectedtransitionVectornull </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>np</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00337">337</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8c_source.html#l00283">initprojectedtransitionvectornull()</a>, <a class="el" href="Projection_8h_source.html#l00114">ManyBodyOperator::pi</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, and <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>.</p>

<p>Referenced by <a class="el" href="calctransitionchargedensities_8c_source.html#l00029">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="Projection_8c.html#a221b6708e4642b8c6eb833e351a4e835">initprojectedtransitionvectornull</a>(P, Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>, Op-&gt;<a class="code" href="structManyBodyOperator.html#a78ec7c9f2238907255cf499427676907" title="parity of operator, 0 positve, 1 negative">pi</a>, 
                                           Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>), 
                                           nfin, nini);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab04781bf318f9779ad81b00b7d9b1837"></a><!-- doxytag: member="Projection.h::initprojectedVector" ref="ab04781bf318f9779ad81b00b7d9b1837" args="(const Projection *P, const ManyBodyOperator *Op, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* initprojectedVector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00315">315</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8c_source.html#l00209">initprojectedvector()</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, and <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlap_8c_source.html#l00087">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="Projection_8c.html#a84110f2d4600522fbbd3d392ccb28fce">initprojectedvector</a>(P, (Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>+1)*Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>), <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="af1e4c360c6c9a7eb8cffcaa091201829"></a><!-- doxytag: member="Projection.h::initprojectedVectornull" ref="af1e4c360c6c9a7eb8cffcaa091201829" args="(const Projection *P, const ManyBodyOperator *Op, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* initprojectedVectornull </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00321">321</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8c_source.html#l00225">initprojectedvectornull()</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, and <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>.</p>

<p>Referenced by <a class="el" href="calcchargedensities_8c_source.html#l00029">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="Projection_8c.html#a987206e03797318b0ba64aae88d57283">initprojectedvectornull</a>(P, (Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>+1)*Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>), <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8933a4a47f0572f2e2943562cd45aac5"></a><!-- doxytag: member="Projection.h::initProjection" ref="a8933a4a47f0572f2e2943562cd45aac5" args="(Projection *P, int odd, const char *projpar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int initProjection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>odd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>projpar</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00102">102</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00097">Projection::ang</a>, <a class="el" href="Projection_8h_source.html#l00099">Projection::angprod</a>, <a class="el" href="Projection_8h_source.html#l00100">Projection::angzcw</a>, <a class="el" href="Projection_8h_source.html#l00102">Projection::cm</a>, <a class="el" href="Projection_8h_source.html#l00105">Projection::cmpoly</a>, <a class="el" href="Projection_8h_source.html#l00104">Projection::cmprod</a>, <a class="el" href="Projection_8h_source.html#l00060">angzcwpara::idx</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="Projection_8h_source.html#l00055">angprodpara::nazimuth</a>, <a class="el" href="Projection_8h_source.html#l00056">angprodpara::nbeta</a>, <a class="el" href="Projection_8h_source.html#l00030">cmprodpara::nphi</a>, <a class="el" href="Projection_8h_source.html#l00035">cmpolypara::npoly</a>, <a class="el" href="Projection_8h_source.html#l00028">cmprodpara::nr</a>, <a class="el" href="Projection_8h_source.html#l00034">cmpolypara::nr</a>, <a class="el" href="donlp2_8h_source.html#l00052">nr</a>, <a class="el" href="Projection_8h_source.html#l00029">cmprodpara::ntheta</a>, and <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlapmulti_8c_source.html#l00087">main()</a>, <a class="el" href="Projection_8c_source.html#l01873">readMulticonfigfile()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l01088">readMultiMulticonfigfile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a> = odd;

  P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a> = JMAX;
  P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> = AngNone; P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> = CMSimple;

  <span class="keywordtype">char</span> projparcpy[strlen(<a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>)];
  strcpy(projparcpy, <a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>);
  <span class="keywordtype">char</span>* c = projparcpy;

  <span class="comment">// different jmax</span>
  c = strtok(c, <span class="stringliteral">&quot;-&quot;</span>);
  <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;jmax&quot;</span>, 4)) {
    c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
    P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a> = atoi(c)+1;
    c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
  }

  <span class="comment">// angular momentum projection</span>
  <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;ang&quot;</span>, 3)) {
    c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
    <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;none&quot;</span>, 4))
      P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> = AngNone;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;zcw&quot;</span>, 3)) {
      P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> = AngZCW;
      c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
      P-&gt;<a class="code" href="structProjection.html#a24b0c733ce6d8f892575554682ef2947">angzcw</a>.<a class="code" href="structangzcwpara.html#a10bdceb86e6bb8dceb15668131ef278b">idx</a> = atoi(c);
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;a&quot;</span>, 1)) {
      P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> = AngProdA;
      P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#abcad02e655573d2040ce82457bbd4cc7">nbeta</a> = atoi(++c);
      c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
      P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a> = atoi(c);
    } <span class="keywordflow">else</span> {
      P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> = AngProd;
      P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#abcad02e655573d2040ce82457bbd4cc7">nbeta</a> = atoi(c);
      c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
      P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a> = atoi(c);
    }
  }
    
  <span class="comment">// center of mass projection</span>
  c = strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
  <span class="keywordflow">if</span> (c &amp;&amp; !strncmp(c, <span class="stringliteral">&quot;cm&quot;</span>, 2)) {
    c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
    <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;none&quot;</span>, 4)) {
      P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> = CMNone; }
    <span class="keywordflow">else</span> {
      <span class="keywordtype">int</span> <a class="code" href="donlp2_8h.html#a2833bf188e6bf292fa7d61e2dd54d622">nr</a> = atoi(c);
      c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
      <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;tet&quot;</span>, 3)) {
        P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> = CMPoly;
        P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a> = nr;
        P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> = 4;
      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;oct&quot;</span>, 3)) {
        P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> = CMPoly;
        P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a> = nr;
        P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> = 6;
      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;cbe&quot;</span>, 3)) {
        P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> = CMPoly;
        P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a> = nr;
        P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> = 8;
      } <span class="keywordflow">else</span> {
        P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> = CMProd;
        P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#aceeaab6ba25f876de7f218c9e797cf01">nr</a> = nr;
        P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#af7d2985994407467340336b7dd1b683e">ntheta</a> = atoi(c);
        c = strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
        P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#a44027ab99975309599367c045379d55d">nphi</a> = atoi(c);
      }
    }
  }

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac87bb7fb183abeb15fc0454df5babd55"></a><!-- doxytag: member="Projection.h::ProjectiontoStr" ref="ac87bb7fb183abeb15fc0454df5babd55" args="(const Projection *P)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ProjectiontoStr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00055">55</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00097">Projection::ang</a>, <a class="el" href="Projection_8h_source.html#l00052">AngNone</a>, <a class="el" href="Projection_8h_source.html#l00099">Projection::angprod</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProd</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProdA</a>, <a class="el" href="Projection_8h_source.html#l00100">Projection::angzcw</a>, <a class="el" href="Projection_8h_source.html#l00052">AngZCW</a>, <a class="el" href="Projection_8h_source.html#l00102">Projection::cm</a>, <a class="el" href="Projection_8h_source.html#l00025">CMNone</a>, <a class="el" href="Projection_8h_source.html#l00105">Projection::cmpoly</a>, <a class="el" href="Projection_8h_source.html#l00025">CMPoly</a>, <a class="el" href="Projection_8h_source.html#l00104">Projection::cmprod</a>, <a class="el" href="Projection_8h_source.html#l00025">CMProd</a>, <a class="el" href="Projection_8h_source.html#l00025">CMSimple</a>, <a class="el" href="Projection_8h_source.html#l00060">angzcwpara::idx</a>, <a class="el" href="Projection_8h_source.html#l00160">JMAX</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="Projection_8h_source.html#l00055">angprodpara::nazimuth</a>, <a class="el" href="Projection_8h_source.html#l00056">angprodpara::nbeta</a>, <a class="el" href="Projection_8h_source.html#l00030">cmprodpara::nphi</a>, <a class="el" href="Projection_8h_source.html#l00035">cmpolypara::npoly</a>, <a class="el" href="Projection_8h_source.html#l00034">cmpolypara::nr</a>, <a class="el" href="Projection_8h_source.html#l00028">cmprodpara::nr</a>, and <a class="el" href="Projection_8h_source.html#l00029">cmprodpara::ntheta</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiproj_8c_source.html#l00052">main()</a>, <a class="el" href="Projection_8c_source.html#l01814">readEigenstatesfromFile()</a>, <a class="el" href="Projection_8c_source.html#l00526">readprojectedMBMEfromFile()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00193">readprojectedMultiMBMEfromFile()</a>, <a class="el" href="Projection_8c_source.html#l01836">writeMulticonfigfile()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l01017">writeMultiEigenstatestoFile()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l01051">writeMultiMulticonfigfile()</a>, <a class="el" href="Projection_8c_source.html#l00390">writeprojectedMBMEtoFile()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l00497">writeprojectedMultiMBMEtoFile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span>* suffix = malloc(36*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));

  <span class="keywordtype">char</span> jmaxsuf[10] = <span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a> != <a class="code" href="Projection_8h.html#a6f799b3fb32ecd6a70300d45fe1dfaad">JMAX</a>)
    sprintf(jmaxsuf, <span class="stringliteral">&quot;jmax-%d-&quot;</span>, P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>-1);

  <span class="keywordtype">char</span> angsuf[12];
  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba55bf53a0f8c9f993e6faf4c61fe8ce10">AngNone</a>)
    sprintf(angsuf, <span class="stringliteral">&quot;ang-none&quot;</span>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9610a33497e9e2e45e79bc44d5ef918f">AngProd</a>)
    sprintf(angsuf, <span class="stringliteral">&quot;ang-%d-%d&quot;</span>, P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#abcad02e655573d2040ce82457bbd4cc7">nbeta</a>, 
            P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167babf044d8a168c981d4076daf448fae0fc">AngProdA</a>)
    sprintf(angsuf, <span class="stringliteral">&quot;ang-a%d-%d&quot;</span>, P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#abcad02e655573d2040ce82457bbd4cc7">nbeta</a>,
            P-&gt;<a class="code" href="structProjection.html#a6e4a4c7f14e67a6eac1aed3b3f7072a3">angprod</a>.<a class="code" href="structangprodpara.html#a642cc11e3f6b0ccbb9a706fd301d48f7">nazimuth</a>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#abb780259fcb446fa48e69ac25e6c8ddd" title="type of angular momentum projection">ang</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167ba9ecd3bfb04930e544c099805a7b847a6">AngZCW</a>)
    sprintf(angsuf, <span class="stringliteral">&quot;ang-zcw-%d&quot;</span>, P-&gt;<a class="code" href="structProjection.html#a24b0c733ce6d8f892575554682ef2947">angzcw</a>.<a class="code" href="structangzcwpara.html#a10bdceb86e6bb8dceb15668131ef278b">idx</a>);

  <span class="keywordtype">char</span> cmsuf[14] = <span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a8d869da79c82654982e95e61d10a64c4">CMNone</a>)
    sprintf(cmsuf, <span class="stringliteral">&quot;-cm-none&quot;</span>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a0e967fc9236e1bb9b51ddb4c16fd096e">CMSimple</a>)
    ;
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a3ebfa1463485cc7babb95b427075772a">CMProd</a>)
    sprintf(cmsuf, <span class="stringliteral">&quot;-cm-%d-%d-%d&quot;</span>, P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#aceeaab6ba25f876de7f218c9e797cf01">nr</a>, P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#af7d2985994407467340336b7dd1b683e">ntheta</a>, 
            P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#a44027ab99975309599367c045379d55d">nphi</a>);
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf">CMPoly</a>) {
    <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> == 4) 
      sprintf(cmsuf, <span class="stringliteral">&quot;-cm-%d-tet&quot;</span>, P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a>);
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> == 6) 
      sprintf(cmsuf, <span class="stringliteral">&quot;-cm-%d-oct&quot;</span>, P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a>);
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> == 8) 
      sprintf(cmsuf, <span class="stringliteral">&quot;-cm-%d-cbe&quot;</span>, P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a>);
  }

  sprintf(suffix, <span class="stringliteral">&quot;%s%s%s&quot;</span>, jmaxsuf, angsuf, cmsuf);

  <span class="keywordflow">return</span> suffix;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a21bd7a5920ce98dea99f5ecbe591b799"></a><!-- doxytag: member="Projection.h::readEigenstates" ref="a21bd7a5920ce98dea99f5ecbe591b799" args="(FILE *fp, const Projection *P, Eigenstates *E, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readEigenstates </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01681">1681</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="DiClusterMulticonfig_8c_source.html#l00361">BUFSIZE</a>, <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="cmat_8c_source.html#l00189">freadcmatcols()</a>, <a class="el" href="cmat_8c_source.html#l00118">freadcvec()</a>, <a class="el" href="cmat_8c_source.html#l00085">freadivec()</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="Projection_8c_source.html#l01212">initEigenstates()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="Projection_8h_source.html#l00146">Eigenstates::ngood</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>, and <a class="el" href="Projection_8h_source.html#l00143">Eigenstates::v</a>.</p>

<p>Referenced by <a class="el" href="Projection_8c_source.html#l01814">readEigenstatesfromFile()</a>, <a class="el" href="Projection_8c_source.html#l01873">readMulticonfigfile()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l01088">readMultiMulticonfigfile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">char</span> buf[BUFSIZE];
  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;
  <span class="keywordtype">int</span> filep, filej, filedim, filegood;
  <span class="keywordtype">int</span> idx;
  <span class="keywordtype">int</span> nj;
  <span class="keywordtype">int</span> dimj;

  <a class="code" href="Projection_8c.html#a9be2f82e183827f27b5edbefcb794740">initEigenstates</a>(P, E, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);

  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
      idx = idxpij(jmax,p,j);
      nj = <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>*(j+1);

      <span class="keywordflow">do</span> 
        fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
      <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;Eigenstates &quot;</span>, 13) &amp;&amp; !feof(fp));
      <span class="keywordflow">if</span> (feof(fp)) {
        fprintf(stderr, <span class="stringliteral">&quot;didn&#39;t find &lt;Eigenstates ...&gt;\n&quot;</span>);
        <span class="keywordflow">return</span> -1;
      }
      sscanf(buf, <span class="stringliteral">&quot;&lt;Eigenstates %d %d&gt;&quot;</span>, &amp;filej, &amp;filep);
      <span class="keywordflow">if</span> (j != filej || p != filep) {
        fprintf(stderr, <span class="stringliteral">&quot;expected &lt;Eigenstates %d %d&gt;\n&quot;</span>, j, p);
        <span class="keywordflow">return</span> -1;
      }
      fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
      sscanf(buf, <span class="stringliteral">&quot;&lt;Indices %d %d&gt;&quot;</span>, &amp;filedim, &amp;filegood);
      E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[idx] = filedim;
      E-&gt;<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[idx] = filegood;
      <span class="keywordflow">if</span> (filedim &gt; 0) {
        dimj = filedim;
        <a class="code" href="cmat_8c.html#a2740ad63230d1f3545d27b878070d1bf" title="read integer vector from fp">freadivec</a>(fp, dimj, E-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[idx]);
        fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp); <span class="comment">// &lt;/Indices&gt;</span>
        fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp); <span class="comment">// &lt;Norms&gt;</span>
        <a class="code" href="cmat_8c.html#a2b53cd2e9f3d173306b7613f4ac10167" title="read vector from fp">freadcvec</a>(fp, dimj, E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[idx]);
        fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp); <span class="comment">// &lt;/Norms&gt;</span>
        fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp); <span class="comment">// &lt;Energies&gt;</span>
        <a class="code" href="cmat_8c.html#a2b53cd2e9f3d173306b7613f4ac10167" title="read vector from fp">freadcvec</a>(fp, dimj, E-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[idx]);
        fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp); <span class="comment">// &lt;/Energies&gt;</span>
        fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp); <span class="comment">// &lt;Eigenvectors&gt;</span>
        <a class="code" href="cmat_8c.html#a46cb0a80d9ddb8a96759c5e6ba8f4ec4" title="read colums of matrix from fp">freadcmatcols</a>(fp, nj, dimj, E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[idx]);
        fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp); <span class="comment">// &lt;/Eigenvectors&gt;</span>
      }
      fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
      <span class="keywordflow">if</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;/Eigenstates&gt;&quot;</span>, 14)) {
        fprintf(stderr, <span class="stringliteral">&quot;didn&#39;t find &lt;/Eigenstates&gt;\n&quot;</span>);
        <span class="keywordflow">return</span> -1;
      }
    }
  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5935cc6b0a5d47d441ca31d6fedbe5cc"></a><!-- doxytag: member="Projection.h::readEigenstatesfromFile" ref="a5935cc6b0a5d47d441ca31d6fedbe5cc" args="(const char *fname, const Projection *P, Eigenstates *E, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readEigenstatesfromFile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01814">1814</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8c_source.html#l00055">ProjectiontoStr()</a>, and <a class="el" href="Projection_8c_source.html#l01681">readEigenstates()</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiproj_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  FILE* fp;
  <span class="keywordtype">char</span> fullname[255];

  snprintf(fullname, 255, <span class="stringliteral">&quot;%s.%s.states&quot;</span>, fname, <a class="code" href="Projection_8c.html#ac87bb7fb183abeb15fc0454df5babd55">ProjectiontoStr</a>(P));

  <span class="keywordflow">if</span> (!(fp = fopen(fullname, <span class="stringliteral">&quot;r&quot;</span>))) {  
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for reading\n&quot;</span>, fullname);
    <span class="keywordflow">return</span> -1;
  }

  fprintf(stderr, <span class="stringliteral">&quot;... reading Eigenstates from file %s\n&quot;</span>, fullname);

  <span class="keywordtype">int</span> err=<a class="code" href="Projection_8c.html#a21bd7a5920ce98dea99f5ecbe591b799">readEigenstates</a>(fp, P, E, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
  fclose(fp);

  <span class="keywordflow">return</span> err;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae36142d2bd6e101eb90230d5cf022f37"></a><!-- doxytag: member="Projection.h::readMulticonfigfile" ref="ae36142d2bd6e101eb90230d5cf022f37" args="(const char *fname, char ***slaterdetfile, Projection *P, SlaterDet **Q, Symmetry **S, Eigenstates *E, int *nstates)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readMulticonfigfile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char ***&nbsp;</td>
          <td class="paramname"> <em>slaterdetfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSlaterDet.html">SlaterDet</a> **&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> **&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>nstates</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01873">1873</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="DiClusterMulticonfig_8c_source.html#l00361">BUFSIZE</a>, <a class="el" href="Projection_8c_source.html#l00102">initProjection()</a>, <a class="el" href="utils_8c_source.html#l00183">md5hash()</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00108">projpar</a>, <a class="el" href="Projection_8c_source.html#l01681">readEigenstates()</a>, and <a class="el" href="SlaterDet_8c_source.html#l00162">readSlaterDetfromFile()</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlap_8c_source.html#l00087">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  FILE* fp;
  <span class="keywordtype">char</span> buf[BUFSIZE];
  <span class="keywordtype">int</span> i, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
  <span class="keywordtype">char</span> sldetfname[255], md5sldetfname[33];

  <span class="keywordflow">if</span> (!(fp = fopen(fname, <span class="stringliteral">&quot;r&quot;</span>))) {
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for reading\n&quot;</span>, fname);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">// get the Projection parameters</span>
  <span class="keywordflow">do</span>    
    fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
  <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;Multiconfprojected &quot;</span>, 19) &amp;&amp; !feof(fp));
  <span class="keywordflow">if</span> (feof(fp)) {
    fprintf(stderr, <span class="stringliteral">&quot;didn&#39;t find &lt;Multiconfprojected ...&gt;\n&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  <span class="keywordtype">char</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>[40];
  sscanf(buf, <span class="stringliteral">&quot;&lt;Multiconfprojected %d %s&gt;&quot;</span>, &amp;n, projpar);
  *nstates = n;

  <span class="comment">// read the Slater determinants</span>
  *slaterdetfilep = (<span class="keywordtype">char</span>**) malloc(n*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *));
  <span class="keywordflow">for</span> (i=0; i&lt;n; i++)
    (*slaterdetfilep)[i] = (<span class="keywordtype">char</span>*) malloc(255*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
  *<a class="code" href="MinimizerDONLP2multivapp_8c.html#a302070733a377867b458d28f3146454f">Qp</a> = malloc(n*<span class="keyword">sizeof</span>(<a class="code" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a>));
  *Sp = malloc(n*<span class="keyword">sizeof</span>(<a class="code" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>));
  <span class="keywordtype">int</span> fileS;
  <span class="keywordflow">for</span> (i=0; i&lt;n; i++) {
    <span class="keywordflow">do</span>  
      fgets(buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>, fp);
    <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;MBFile &quot;</span>, 7) &amp;&amp; !feof(fp));
    <span class="keywordflow">if</span> (feof(fp)) {
      fprintf(stderr, <span class="stringliteral">&quot;...   did&#39;t find &lt;SlaterDetFile ...&gt;\n&quot;</span>);
      fclose(fp);
      <span class="keywordflow">return</span> -1;
    }
    sscanf(buf, <span class="stringliteral">&quot;&lt;MBFile %s %s %d&gt;&quot;</span>, sldetfname, md5sldetfname, &amp;fileS);
    <span class="keywordflow">if</span> (strncmp(md5sldetfname, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(sldetfname), 32)) {
      fprintf(stderr, <span class="stringliteral">&quot;...    SlaterDetFile %s changed\n&quot;</span>, sldetfname);
      <span class="keywordflow">return</span> -1;
    }
    strcpy((*slaterdetfilep)[i], sldetfname);
    <span class="keywordflow">if</span> (<a class="code" href="SlaterDet_8c.html#a3ebf34d0b05c3dcde99a34ddb61c49e4">readSlaterDetfromFile</a>(&amp;(*<a class="code" href="MinimizerDONLP2multivapp_8c.html#a302070733a377867b458d28f3146454f">Qp</a>)[i], sldetfname))
      <span class="keywordflow">return</span> -1;
    (*Sp)[i] = fileS;
  }
  
  <span class="comment">// odd or even ?</span>
  <span class="keywordtype">int</span> odd = <a class="code" href="MinimizerDONLP2multivapp_8c.html#a302070733a377867b458d28f3146454f">Qp</a>[0]-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a> % 2;

  <span class="comment">// initialize Projection</span>
  <a class="code" href="Projection_8c.html#a8933a4a47f0572f2e2943562cd45aac5">initProjection</a>(P, odd, projpar);

  <span class="comment">// read the Eigenstates</span>
  <span class="keywordflow">if</span> (<a class="code" href="Projection_8c.html#a21bd7a5920ce98dea99f5ecbe591b799">readEigenstates</a>(fp, P, E, n))
    <span class="keywordflow">return</span> -1;

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a24221ca9708e29fc5ea20304505d5399"></a><!-- doxytag: member="Projection.h::readprojectedMBME" ref="a24221ca9708e29fc5ea20304505d5399" args="(gzFile fp, const Projection *P, const ManyBodyOperator *Op, Symmetry S, Symmetry Sp, void *mbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readprojectedMBME </td>
          <td>(</td>
          <td class="paramtype">gzFile&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00433">433</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="DiClusterMulticonfig_8c_source.html#l00361">BUFSIZE</a>, <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="utils_8c_source.html#l00087">stripstr()</a>, and <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>.</p>

<p>Referenced by <a class="el" href="Projection_8c_source.html#l00526">readprojectedMBMEfromFile()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l00193">readprojectedMultiMBMEfromFile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> odd = P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> size = Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> rank = Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a> = Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  complex double (**me)[(rank+1)*size] = mbme;

  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, r;

  <span class="comment">// possibly initialize space for buffer</span>
  <span class="keywordflow">if</span> (!buf)
    buf = malloc(<a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);

  <span class="keywordtype">char</span> *c;
  <span class="keywordtype">double</span> ref, imf;

  <span class="comment">// initialize matrix elements to zero</span>
  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
      <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2)
        <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2)
          <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
            <span class="keywordflow">for</span> (r=0 ; r&lt;=rank; r++)
              me[idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)] = 0.0;
    }   

  <span class="keywordflow">do</span>
    gzgets(fp, buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);
  <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;ProjectedMBME &quot;</span>, 15) &amp;&amp; !gzeof(fp));
  <span class="keywordflow">if</span> (gzeof(fp)) {
    fprintf(stderr, <span class="stringliteral">&quot;did&#39;t find &lt;ProjectedMBME ...&gt;\n&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  <span class="keywordtype">char</span> opname[80];
  <span class="keywordtype">int</span> fileS, fileSp;
  sscanf(buf, <span class="stringliteral">&quot;&lt;ProjectedMBME %s %d %d&gt;&quot;</span>, opname, &amp;fileS, &amp;fileSp);
  <span class="keywordflow">if</span> (strcmp(<a class="code" href="utils_8c.html#af86aada130a5db5b0f52154718d67c44" title="strips strip from str">stripstr</a>(opname, <span class="stringliteral">&quot;&gt;&quot;</span>), Op-&gt;<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a>)) {
    fprintf(stderr, <span class="stringliteral">&quot;not %s matrixelements\n&quot;</span>, Op-&gt;<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a>);
    <span class="keywordflow">return</span> -1;
  }
  <span class="keywordflow">if</span> (fileS != S || fileSp != Sp) {
    fprintf(stderr, <span class="stringliteral">&quot;Symmetries don&#39;t match\n&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordtype">int</span> filej, filep;
  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
      gzgets(fp, buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);
      sscanf(buf, <span class="stringliteral">&quot;&lt;ProjectedME %d %d&gt;&quot;</span>, &amp;filej, &amp;filep);
      <span class="keywordflow">if</span> (filej != j || filep != p) {
        fprintf(stderr, <span class="stringliteral">&quot;malformed line\n&gt;&gt;%s&lt;&lt;\n&quot;</span>, <a class="code" href="utils_8c.html#af86aada130a5db5b0f52154718d67c44" title="strips strip from str">stripstr</a>(buf, <span class="stringliteral">&quot;\n&quot;</span>));
        <span class="keywordflow">return</span> -1;
      }

      <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2)
        <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2) {
          <span class="keywordflow">if</span> ((Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a> != 0 || <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(S, p, j, m)) &amp;&amp; 
              <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sp, p, j, k)) {
            gzgets(fp, buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);
            c = strtok(buf, <span class="stringliteral">&quot; ,()&quot;</span>);
            <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
              <span class="keywordflow">for</span> (r=0; r&lt;=rank; r++) {
                ref=atof(c); c=strtok(NULL, <span class="stringliteral">&quot; ,()&quot;</span>);
                imf=atof(c); c=strtok(NULL, <span class="stringliteral">&quot; ,()&quot;</span>);
                me[idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)] = ref+I*imf;
            }
          }
        }

      gzgets(fp, buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);
      <span class="keywordflow">if</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;/ProjectedME&gt;&quot;</span>, 14)) {
        fprintf(stderr, <span class="stringliteral">&quot;didn&#39;t find &lt;/ProjectedME&gt;\n&quot;</span>);
        <span class="keywordflow">return</span> -1;
      }
    }
  gzgets(fp, buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);
  <span class="keywordflow">if</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;/ProjectedMBME&gt;&quot;</span>, 16)) {
    fprintf(stderr, <span class="stringliteral">&quot;didn&#39;t find &lt;/ProjectedMBME&gt;\n&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56dd7948b0969a553329ddf6dcdc27c3"></a><!-- doxytag: member="Projection.h::readprojectedMBMEfromFile" ref="a56dd7948b0969a553329ddf6dcdc27c3" args="(const char *mbfile, const char *mbfilep, const Projection *P, const ManyBodyOperator *Op, Symmetry S, Symmetry Sp, void *mbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readprojectedMBMEfromFile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mbfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mbfilep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00526">526</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="DiClusterMulticonfig_8c_source.html#l00361">BUFSIZE</a>, <a class="el" href="utils_8c_source.html#l00106">fileexists()</a>, <a class="el" href="utils_8c_source.html#l00149">filepart()</a>, <a class="el" href="utils_8c_source.html#l00183">md5hash()</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="Projection_8c_source.html#l00055">ProjectiontoStr()</a>, <a class="el" href="Projection_8c_source.html#l00433">readprojectedMBME()</a>, <a class="el" href="utils_8c_source.html#l00098">strjoin()</a>, and <a class="el" href="Symmetry_8c_source.html#l00076">SymmetrytoStr()</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlap_8c_source.html#l00087">main()</a>, and <a class="el" href="calcenergymultiprojsel_8c_source.html#l00290">readorcalcandwriteprojectedMBMEfromtoFile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  gzFile mefp;
  <span class="keywordtype">char</span> mefilename[255];
  <span class="keywordtype">char</span> buf[BUFSIZE];
  <span class="keywordtype">char</span> fnam[255], md5fnam[33];
  <span class="keywordtype">int</span> fileS;

  snprintf(mefilename, 255, <span class="stringliteral">&quot;ME/%s--%s%s--%s%s--%s.gz&quot;</span>, 
           Op-&gt;<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a>, 
           (Sa==0 ? <span class="stringliteral">&quot;&quot;</span> : <a class="code" href="utils_8c.html#ab513af03cb4d827e200043bbc98cad12" title="join two strings">strjoin</a>(<a class="code" href="Symmetry_8c.html#a57aa62a08fd12aa6fd7da2355ffb0ea0" title="get String with Symmetry">SymmetrytoStr</a>(Sa), <span class="stringliteral">&quot;:&quot;</span>)), 
           <a class="code" href="utils_8c.html#a72e38b8773b63e202dbebc40c3346988" title="get the file component of fullname">filepart</a>(mbfilea), 
           (Sb==0 ? <span class="stringliteral">&quot;&quot;</span> : <a class="code" href="utils_8c.html#ab513af03cb4d827e200043bbc98cad12" title="join two strings">strjoin</a>(<a class="code" href="Symmetry_8c.html#a57aa62a08fd12aa6fd7da2355ffb0ea0" title="get String with Symmetry">SymmetrytoStr</a>(Sb), <span class="stringliteral">&quot;:&quot;</span>)), 
           <a class="code" href="utils_8c.html#a72e38b8773b63e202dbebc40c3346988" title="get the file component of fullname">filepart</a>(mbfileb), 
           <a class="code" href="Projection_8c.html#ac87bb7fb183abeb15fc0454df5babd55">ProjectiontoStr</a>(P));

  <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#a80285197256014b2324f0b874a91cb19" title="check if file exists and is readable (returns 0 for success)">fileexists</a>(mefilename)) {
      fprintf(stderr, <span class="stringliteral">&quot;... %s does not exist\n&quot;</span>, mefilename);
      <span class="keywordflow">return</span> -1;
    }

  <span class="keywordflow">if</span> (!(mefp = gzopen(mefilename, <span class="stringliteral">&quot;r&quot;</span>))) {
    fprintf(stderr, <span class="stringliteral">&quot;... couldn&#39;t open %s for reading\n&quot;</span>, mefilename);
    <span class="keywordflow">return</span> -1;
  }

  fprintf(stderr, <span class="stringliteral">&quot;... reading matrix elements from file %s\n&quot;</span>, mefilename);

  <span class="comment">// do many-body files match ?</span>
  <span class="keywordflow">do</span>
    gzgets(mefp, buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);
  <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;MBFile &quot;</span>, 7) &amp;&amp; !gzeof(mefp));
  <span class="keywordflow">if</span> (gzeof(mefp)) {
    fprintf(stderr, <span class="stringliteral">&quot;...   did&#39;t find &lt;MBFile ...&gt;\n&quot;</span>);
    gzclose(mefp);
    <span class="keywordflow">return</span> -2;
  }
  sscanf(buf, <span class="stringliteral">&quot;&lt;MBFile %s %s %d&gt;&quot;</span>, fnam, md5fnam, &amp;fileS);
  <span class="keywordflow">if</span> (strncmp(md5fnam, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfilea), 32)) {
    fprintf(stderr, <span class="stringliteral">&quot;...    MBFile does not match with existing ME\n&quot;</span>);
    <span class="keywordflow">return</span> -2;
  }
  <span class="keywordflow">if</span> (fileS != Sa) {
    fprintf(stderr, <span class="stringliteral">&quot;...    Symmetry does not match with existing ME\n&quot;</span>);
    <span class="keywordflow">return</span> -2;
  }
  <span class="keywordflow">do</span>
    gzgets(mefp, buf, <a class="code" href="DiClusterMulticonfig_8c.html#aeca034f67218340ecb2261a22c2f3dcd">BUFSIZE</a>);
  <span class="keywordflow">while</span> (strncmp(buf, <span class="stringliteral">&quot;&lt;MBFile &quot;</span>, 7) &amp;&amp; !gzeof(mefp));
  <span class="keywordflow">if</span> (gzeof(mefp)) {
    fprintf(stderr, <span class="stringliteral">&quot;...    did&#39;t find &lt;MBFile ...&gt;\n&quot;</span>);
    gzclose(mefp);
    <span class="keywordflow">return</span> -2;
  }
  sscanf(buf, <span class="stringliteral">&quot;&lt;MBFile %s %s %d&gt;&quot;</span>, fnam, md5fnam, &amp;fileS);
  <span class="keywordflow">if</span> (strncmp(md5fnam, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfileb), 32)) {
    fprintf(stderr, <span class="stringliteral">&quot;...    MBFile does not match with existing ME\n&quot;</span>);
    gzclose(mefp);
    <span class="keywordflow">return</span> -2;
  }
  <span class="keywordflow">if</span> (fileS != Sb) {
    fprintf(stderr, <span class="stringliteral">&quot;...    Symmetry does not match with existing ME\n&quot;</span>);
    <span class="keywordflow">return</span> -2;
  }

  <span class="comment">// now read the matrix elements</span>
  <span class="keywordtype">int</span> res;
  res = <a class="code" href="Projection_8c.html#a24221ca9708e29fc5ea20304505d5399">readprojectedMBME</a>(mefp, P, Op, Sa, Sb, mbme); 

  gzclose(mefp);
  <span class="keywordflow">return</span> res;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a311baa8e8355d7a129021e5941641568"></a><!-- doxytag: member="Projection.h::reinitangintegration" ref="a311baa8e8355d7a129021e5941641568" args="(const SlaterDet *Q, const SlaterDet *Qp, Symmetry S, Symmetry Sp, angintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reinitangintegration </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structangintegrationpara.html">angintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="angprojection_8c_source.html#l00225">225</a> of file <a class="el" href="angprojection_8c_source.html">angprojection.c</a>.</p>

<p>References <a class="el" href="angprojection_8c_source.html#l00092">_estimateangkappa()</a>, <a class="el" href="Projection_8h_source.html#l00052">AngProdA</a>, <a class="el" href="Projection_8h_source.html#l00073">angprodintegrationpara::beta</a>, <a class="el" href="gaussquad_8c_source.html#l00139">GaussExponentialPoints()</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="Projection_8h_source.html#l00072">angprodintegrationpara::nbeta</a>, <a class="el" href="Projection_8h_source.html#l00086">angintegrationpara::prod</a>, <a class="el" href="Projection_8h_source.html#l00082">angintegrationpara::type</a>, and <a class="el" href="Projection_8h_source.html#l00074">angprodintegrationpara::wbeta</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2vap_8c_source.html#l00569">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2vap_8c_source.html#l00289">calcprojectedHamiltonian()</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="comment">// we only have to modify something for adaptive integration</span>

  <span class="comment">// use Gauss-Legendre integration for cos(beta)</span>
  <span class="comment">// if overlap is very strongly peaked, use Gauss-Exponential </span>

  <span class="keywordtype">double</span> kappa = 0.0;

  <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structangintegrationpara.html#adcf74f982ccf4b6d73cb8157ce200e9b">type</a> == <a class="code" href="Projection_8h.html#a7ff5f2dff38e7639981794c43dc9167babf044d8a168c981d4076daf448fae0fc">AngProdA</a>) {

    kappa = dmin(<a class="code" href="angprojection_8c.html#a96407d07755537e4db8a7047f7a3549d">_estimateangkappa</a>(Q), <a class="code" href="angprojection_8c.html#a96407d07755537e4db8a7047f7a3549d">_estimateangkappa</a>(Qp));
    fprintf(stderr, <span class="stringliteral">&quot;estimated kappa: %8.3f\n&quot;</span>, kappa);

    <span class="keywordflow">if</span> (kappa &lt; kappacrit)
      <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>, -1.0, 1.0, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a7854cddeff892c4ecdc5115ea29fd363">beta</a>, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a704c16042520b3a9b6ce333c92aa4a49">wbeta</a>);
    <span class="keywordflow">else</span>
      <a class="code" href="gaussquad_8c.html#aea10f097c3eca7c79d204df3dec9e585" title="Divide weights by Exponential weight function.">GaussExponentialPoints</a>(par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#ac534bb07ba492155baa305ec3fb5c616">nbeta</a>, -1.0, 1.0, kappa, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a7854cddeff892c4ecdc5115ea29fd363">beta</a>, par-&gt;<a class="code" href="structangintegrationpara.html#a17268303840b4ee6e482a8858ae808eb">prod</a>.<a class="code" href="structangprodintegrationpara.html#a704c16042520b3a9b6ce333c92aa4a49">wbeta</a>);

  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2d6f83cd77e06f6e3706b09dcd0eec9b"></a><!-- doxytag: member="Projection.h::reinitcmintegration" ref="a2d6f83cd77e06f6e3706b09dcd0eec9b" args="(const SlaterDet *Q, const SlaterDet *Qp, cmintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reinitcmintegration </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00234">234</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="cmprojection_8c_source.html#l00128">_estimateacm()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00107">alpha</a>, <a class="el" href="Projection_8h_source.html#l00025">CMNone</a>, <a class="el" href="Projection_8h_source.html#l00025">CMPoly</a>, <a class="el" href="Projection_8h_source.html#l00025">CMProd</a>, <a class="el" href="Projection_8h_source.html#l00025">CMSimple</a>, <a class="el" href="cmprojection_8c_source.html#l00031">CUB</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="gaussquad_8c_source.html#l00188">GaussSqrHermitePoints()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00030">cmprodpara::nphi</a>, <a class="el" href="Projection_8h_source.html#l00035">cmpolypara::npoly</a>, <a class="el" href="Projection_8h_source.html#l00034">cmpolypara::nr</a>, <a class="el" href="Projection_8h_source.html#l00028">cmprodpara::nr</a>, <a class="el" href="donlp2_8h_source.html#l00052">nr</a>, <a class="el" href="Projection_8h_source.html#l00029">cmprodpara::ntheta</a>, <a class="el" href="HOBasis_8c_source.html#l00043">nx</a>, <a class="el" href="Projection_8h_source.html#l00044">cmintegrationpara::poly</a>, <a class="el" href="cmprojection_8c_source.html#l00057">polyhedron</a>, <a class="el" href="Projection_8h_source.html#l00043">cmintegrationpara::prod</a>, <a class="el" href="gaussquad_8c_source.html#l00255">ShiftedPeriodicTrapezoidalPoints()</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00040">cmintegrationpara::type</a>, <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00497">calcgradprojectedHamiltonianmatrix()</a>, and <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a> = 0.5/(<a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(Q)+<a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(Qp));

  <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a8d869da79c82654982e95e61d10a64c4">CMNone</a>) {
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[0] = 1.0;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][0] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][1] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][2] = 0.0; 
  } 

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a0e967fc9236e1bb9b51ddb4c16fd096e">CMSimple</a>) {
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[0] = 0.125*pow(M_PI*<a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>,-1.5);
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][0] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][1] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][2] = 0.0; 
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a3ebfa1463485cc7babb95b427075772a">CMProd</a>) {
    <span class="keywordtype">int</span> <a class="code" href="donlp2_8h.html#a2833bf188e6bf292fa7d61e2dd54d622">nr</a>=par-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#aceeaab6ba25f876de7f218c9e797cf01">nr</a>; 
    <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a02d47a4f36ec0bcce348696534567e30">nx</a>=par-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#af7d2985994407467340336b7dd1b683e">ntheta</a>; <span class="keywordtype">int</span> nphi=par-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#a44027ab99975309599367c045379d55d">nphi</a>;
    
    <span class="keywordtype">double</span> pointr[nr], weightr[nr];
    <a class="code" href="gaussquad_8c.html#aee65fcd1581a362adaba774793e24c5e">GaussSqrHermitePoints</a>(nr, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, pointr, weightr);

    <span class="keywordtype">double</span> pointx[nx], weightx[nx];
    <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(nx, -1.0, 1.0, pointx, weightx);

    <span class="keywordtype">double</span> pointphi[nphi], weightphi[nphi];
    <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(nphi, 0, 2*M_PI, 0.00,
                                     pointphi, weightphi);

    <span class="keywordtype">int</span> i=0;
    <span class="keywordtype">int</span> ir, ix, iphi;
    <span class="keywordflow">for</span> (ir=0; ir&lt;nr; ir++)
      <span class="keywordflow">for</span> (ix=0; ix&lt;nx; ix++)
        <span class="keywordflow">for</span> (iphi=0; iphi&lt;nphi; iphi++) {
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][0] = pointr[ir]*sqrt(1-<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(pointx[ix]))*cos(pointphi[iphi]);
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][1] = pointr[ir]*sqrt(1-<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(pointx[ix]))*sin(pointphi[iphi]);
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][2] = pointr[ir]*pointx[ix];
          par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i] = 1/<a class="code" href="cmprojection_8c.html#a6468750a80f532995d7f387427b4176a">CUB</a>(2*M_PI)*
            weightr[ir]*weightx[ix]*weightphi[iphi];
          i++;
        }
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf">CMPoly</a>) {
    <span class="keywordtype">int</span> nr=par-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a>; 
    <span class="keywordtype">int</span> npoly=par-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a>;
    
    <span class="keywordtype">double</span> pointr[nr], weightr[nr];
    <a class="code" href="gaussquad_8c.html#aee65fcd1581a362adaba774793e24c5e">GaussSqrHermitePoints</a>(nr, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, pointr, weightr);

    <span class="keywordtype">int</span> i=0;    
    <span class="keywordtype">int</span> ir, ipoly, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;   
    <span class="keywordflow">for</span> (ir=0; ir&lt;nr; ir++)
      <span class="keywordflow">for</span> (ipoly=0; ipoly&lt;npoly; ipoly++) {
        <span class="keywordflow">for</span> (j=0; j&lt;3; j++)
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][j] = pointr[ir]*<a class="code" href="cmprojection_8c.html#af5b681c73567b823d57c18d3cdabb2ab">polyhedron</a>[npoly][ipoly][j];
        par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i] = 1/<a class="code" href="cmprojection_8c.html#a6468750a80f532995d7f387427b4176a">CUB</a>(2*M_PI)*
          weightr[ir]*(4*M_PI/npoly);
        i++;
      }
  }  
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a465ddb73457c8835e9a944d35b54f79a"></a><!-- doxytag: member="Projection.h::sortEigenstates" ref="a465ddb73457c8835e9a944d35b54f79a" args="(const Projection *P, const Interaction *Int, const Observablesod **obs, Eigenstates *E, double minnorm, int all)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sortEigenstates </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structInteraction.html">Interaction</a> *&nbsp;</td>
          <td class="paramname"> <em>Int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structObservablesod.html">Observablesod</a> **&nbsp;</td>
          <td class="paramname"> <em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>minnorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>all</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01752">1752</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="Projection_8c_source.html#l01750">ERRJMAX</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="Projection_8c_source.html#l01749">MAXSTATES</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00146">Eigenstates::ngood</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, and <a class="el" href="donlp2_8h_source.html#l00057">val</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiproj_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=E-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>;

  <span class="keywordtype">int</span> p,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,i;
  <span class="keywordtype">int</span> dimj;
  <span class="keywordtype">int</span> nj;
  <span class="keywordtype">int</span> ngood;

  <span class="keywordtype">double</span> maxnorm;

  <span class="keyword">struct </span>merit {
    <span class="keywordtype">double</span> <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>;
    <span class="keywordtype">int</span> idx;
  } merits[n*(jmax+1)];

  maxnorm = 0.0;
  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2)
      <span class="keywordflow">for</span> (i=0; i&lt;E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[idxpij(jmax,p,j)]; i++)
        maxnorm = fmax(maxnorm, creal(obs[idxpij(jmax,p,j)][i].n));

  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
      nj = n*(j+1);
      dimj = E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[idxpij(jmax,p,j)];

      <span class="comment">// determine merits of eigenstates</span>
      <span class="keywordflow">for</span> (i=0; i&lt;dimj; i++) {
        merits[i].idx = i;

        <span class="comment">// norm too small ?</span>
        <span class="keywordflow">if</span> (creal(obs[idxpij(jmax,p,j)][i].n) &lt; minnorm*maxnorm)
          merits[i].val = -100000.0;    
        <span class="comment">// J2 looks suspicious ?</span>
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cabs(obs[idxpij(jmax,p,j)][i].j2/obs[idxpij(jmax,p,j)][i].n - 0.25*j*(j+2)) &gt; <a class="code" href="Projection_8c.html#a0e159c7238ca2b8eae27e904e8b0c60f">ERRJMAX</a>)
          merits[i].val = -100000.0;
        <span class="comment">// else use the energy</span>
        <span class="keywordflow">else</span>
          merits[i].val = -creal(obs[idxpij(jmax,p,j)][i].h/obs[idxpij(jmax,p,j)][i].n);
      }
        
      <span class="comment">// sort according to merits value</span>
      qsort(merits, dimj, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> merit), cmpmerit);

      i=0; <span class="keywordflow">while</span> (i&lt;dimj &amp;&amp; ( all || merits[i].<a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a> &gt; -100000.0)) i++;
      ngood = min(i,<a class="code" href="Projection_8c.html#a7c53005f48be691eb85407c5a9588267">MAXSTATES</a>);
      E-&gt;<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[idxpij(jmax,p,j)] = ngood;
      <span class="keywordflow">for</span> (i=0; i&lt;dimj; i++)
        E-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[idxpij(jmax,p,j)][i] = merits[i].idx;

    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6efb4a37227aadf15910f7270a97a486"></a><!-- doxytag: member="Projection.h::writeEigenstates" ref="a6efb4a37227aadf15910f7270a97a486" args="(FILE *fp, const Projection *P, const Eigenstates *E)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeEigenstates </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01633">1633</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00145">Eigenstates::dim</a>, <a class="el" href="cmat_8c_source.html#l00175">fprintcmatcols()</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="Projection_8h_source.html#l00142">Eigenstates::n</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00146">Eigenstates::ngood</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00144">Eigenstates::V</a>, and <a class="el" href="Projection_8h_source.html#l00143">Eigenstates::v</a>.</p>

<p>Referenced by <a class="el" href="Projection_8c_source.html#l01836">writeMulticonfigfile()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l01017">writeMultiEigenstatestoFile()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l01051">writeMultiMulticonfigfile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;
  <span class="keywordtype">int</span> i;
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=E-&gt;<a class="code" href="structEigenstates.html#aa5deea949876b2d562c5c5129c119e76">n</a>;
  <span class="keywordtype">int</span> idx;
  <span class="keywordtype">int</span> nj, dimj;

  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {
      idx = idxpij(jmax,p,j);
      nj = n*(j+1);
      dimj = E-&gt;<a class="code" href="structEigenstates.html#a4f66da767b0c0350e503f28d8f9961f0" title="number of eigenstates calculated by SVD">dim</a>[idx];

      fprintf(fp, <span class="stringliteral">&quot;&lt;Eigenstates %d %d&gt;\n&quot;</span>, j, p);
      fprintf(fp, <span class="stringliteral">&quot;&lt;Indices %2d %2d&gt;\n&quot;</span>, dimj, E-&gt;<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[idx]);
      <span class="keywordflow">if</span> (dimj &gt; 0) {
        <span class="keywordflow">for</span> (i=0; i&lt;dimj; i++)
          fprintf(fp, <span class="stringliteral">&quot;%2d   &quot;</span>, E-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[idx][i]);
        fprintf(fp, <span class="stringliteral">&quot;\n&lt;/Indices&gt;\n&quot;</span>);
        fprintf(fp, <span class="stringliteral">&quot;&lt;Norms&gt;\n&quot;</span>);
        <span class="keywordflow">for</span> (i=0; i&lt;dimj; i++)
          fprintf(fp, <span class="stringliteral">&quot;(%10.8f,%10.8f)   &quot;</span>,
                  creal(E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[idx][i]),
                  cimag(E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[idx][i]));
        fprintf(fp, <span class="stringliteral">&quot;\n&lt;/Norms&gt;\n&quot;</span>);
        fprintf(fp, <span class="stringliteral">&quot;&lt;Energies&gt;\n&quot;</span>);
        <span class="keywordflow">for</span> (i=0; i&lt;dimj; i++)
          fprintf(fp, <span class="stringliteral">&quot;(%8.5f,%8.5f)   &quot;</span>, 
                  creal(E-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[idx][i]),
                  cimag(E-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[idx][i]));
        fprintf(fp, <span class="stringliteral">&quot;\n&lt;/Energies&gt;\n&quot;</span>);
        fprintf(fp, <span class="stringliteral">&quot;&lt;Eigenvectors&gt;\n&quot;</span>);
        <a class="code" href="cmat_8c.html#afc76d7acbd75929591cc577301214b69" title="write colums of matrix to fp">fprintcmatcols</a>(fp, nj, dimj, E-&gt;<a class="code" href="structEigenstates.html#a6e03cbd0f964bc8d73161266831cc874" title="eigenvectors">V</a>[idx]);
        fprintf(fp, <span class="stringliteral">&quot;&lt;/Eigenvectors&gt;\n&quot;</span>);
      }
      fprintf(fp, <span class="stringliteral">&quot;&lt;/Eigenstates&gt;\n&quot;</span>);
    }
  
  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a217536fb9853df72dc83c7a27de713f0"></a><!-- doxytag: member="Projection.h::writeMulticonfigfile" ref="a217536fb9853df72dc83c7a27de713f0" args="(const char *fname, const Projection *P, Symmetry *S, const char **mbfile, const Eigenstates *E, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeMulticonfigfile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a> *&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>mbfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l01836">1836</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l00046">fprintinfo()</a>, <a class="el" href="Projection_8c_source.html#l00178">fprintProjectinfo()</a>, <a class="el" href="utils_8c_source.html#l00183">md5hash()</a>, <a class="el" href="Projection_8c_source.html#l00055">ProjectiontoStr()</a>, and <a class="el" href="Projection_8c_source.html#l01633">writeEigenstates()</a>.</p>

<p>Referenced by <a class="el" href="calcenergymultiproj_8c_source.html#l00052">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  FILE* fp;
  <span class="keywordtype">char</span> filename[255];

  snprintf(filename, 255, <span class="stringliteral">&quot;%s.states&quot;</span>, fname);

  <span class="keywordflow">if</span> (!(fp = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>))) {
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for writing\n&quot;</span>, filename);
    <span class="keywordflow">return</span> -1;
  }     

  <a class="code" href="utils_8c.html#ae3c710edac30cf257199e6595212a75a" title="print info about running process">fprintinfo</a>(fp);
  <a class="code" href="Projection_8c.html#af11f2a70292f93f6b5983cfc4f26d774">fprintProjectinfo</a>(fp, P);
  fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
  fprintf(fp, <span class="stringliteral">&quot;&lt;Multiconfprojected %d %s&gt;\n&quot;</span>, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, <a class="code" href="Projection_8c.html#ac87bb7fb183abeb15fc0454df5babd55">ProjectiontoStr</a>(P));

  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++)
    fprintf(fp, <span class="stringliteral">&quot;&lt;MBFile %s %s %d&gt;\n&quot;</span>,
            mbfile[i], <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfile[i]), S[i]);
  fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
    
  <a class="code" href="Projection_8c.html#a6efb4a37227aadf15910f7270a97a486">writeEigenstates</a>(fp, P, E);

  fprintf(fp, <span class="stringliteral">&quot;&lt;/Multiconfprojected&gt;\n&quot;</span>);
  fclose(fp);

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a086dc7277e11cd8a2335f25cb14c66b8"></a><!-- doxytag: member="Projection.h::writeprojectedMBME" ref="a086dc7277e11cd8a2335f25cb14c66b8" args="(gzFile fp, const Projection *P, const ManyBodyOperator *Op, Symmetry S, Symmetry Sp, const void *mbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeprojectedMBME </td>
          <td>(</td>
          <td class="paramtype">gzFile&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00348">348</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, and <a class="el" href="Symmetry_8c_source.html#l00019">SymmetryAllowed()</a>.</p>

<p>Referenced by <a class="el" href="Projection_8c_source.html#l00390">writeprojectedMBMEtoFile()</a>, and <a class="el" href="MultiSlaterDet_8c_source.html#l00497">writeprojectedMultiMBMEtoFile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> odd = P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> size = Op-&gt;<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a> = Op-&gt;<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  <span class="keywordtype">int</span> rank = Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a>;
  complex double (**me)[(rank+1)*size] = mbme;

  <span class="keywordtype">int</span> p, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, r;

  gzprintf(fp, <span class="stringliteral">&quot;&lt;ProjectedMBME %s %d %d&gt;\n&quot;</span>, Op-&gt;<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a>, S, Sp);
  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {

      gzprintf(fp, <span class="stringliteral">&quot;&lt;ProjectedME %d %d&gt;\n&quot;</span>, j, p); 
      <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2)
        <span class="keywordflow">for</span> (k=-j; k&lt;=j; k=k+2) {
          <span class="comment">// Sp fixes j, k</span>
          <span class="comment">// if Op is scalar also j,m fixed</span>
          <span class="keywordflow">if</span> ((Op-&gt;<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a> != 0 || <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(S, p, j, m)) &amp;&amp; 
              <a class="code" href="Symmetry_8c.html#aec41b8bd88dceb2a0c5c3c4c4a8fefdb" title="quantum numbers J^pi,K allowed by symmetry ?">SymmetryAllowed</a>(Sp, p, j, k)) {
            <span class="keywordflow">for</span> (l=0; l&lt;dim; l++)
              <span class="keywordflow">for</span> (r=0; r&lt;=rank; r++)
                gzprintf(fp, <span class="stringliteral">&quot;(%15.8e,%15.8e) &quot;</span>, 
                        creal(me[idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)]),
                        cimag(me[idxpij(jmax,p,j)][idxjmk(j,m,k)][r+l*(rank+1)]));
            gzprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
          }
        }
        gzprintf(fp, <span class="stringliteral">&quot;&lt;/ProjectedME&gt;\n&quot;</span>);

    }   
  gzprintf(fp, <span class="stringliteral">&quot;&lt;/ProjectedMBME&gt;\n&quot;</span>);

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9f0871c9ab882dc39462783988c4eab2"></a><!-- doxytag: member="Projection.h::writeprojectedMBMEtoFile" ref="a9f0871c9ab882dc39462783988c4eab2" args="(const char *mbfile, const char *mbfilep, const Projection *P, const ManyBodyOperator *Op, Symmetry S, Symmetry Sp, const void *mbme)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeprojectedMBMEtoFile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mbfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mbfilep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Symmetry_8h.html#abc0cfc197fb5dfb320dc8f2152faeb73">Symmetry</a>&nbsp;</td>
          <td class="paramname"> <em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>mbme</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Projection_8c_source.html#l00390">390</a> of file <a class="el" href="Projection_8c_source.html">Projection.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l00118">ensuredir()</a>, <a class="el" href="utils_8c_source.html#l00149">filepart()</a>, <a class="el" href="utils_8c_source.html#l00051">gzprintinfo()</a>, <a class="el" href="utils_8c_source.html#l00183">md5hash()</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="Projection_8c_source.html#l00055">ProjectiontoStr()</a>, <a class="el" href="utils_8c_source.html#l00098">strjoin()</a>, <a class="el" href="Symmetry_8c_source.html#l00076">SymmetrytoStr()</a>, and <a class="el" href="Projection_8c_source.html#l00348">writeprojectedMBME()</a>.</p>

<p>Referenced by <a class="el" href="calcbasisovlap_8c_source.html#l00087">main()</a>, and <a class="el" href="calcenergymultiprojsel_8c_source.html#l00290">readorcalcandwriteprojectedMBMEfromtoFile()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  gzFile mefp;
  <span class="keywordtype">char</span> mefilename[255];

  <a class="code" href="utils_8c.html#a91bd1e9936bf548fc21c811e258c81e9" title="check for existence, create if not of directory">ensuredir</a>(<span class="stringliteral">&quot;ME&quot;</span>);

  snprintf(mefilename, 255, <span class="stringliteral">&quot;ME/%s--%s%s--%s%s--%s.gz&quot;</span>, 
           Op-&gt;<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a>, 
           (Sa==0 ? <span class="stringliteral">&quot;&quot;</span> : <a class="code" href="utils_8c.html#ab513af03cb4d827e200043bbc98cad12" title="join two strings">strjoin</a>(<a class="code" href="Symmetry_8c.html#a57aa62a08fd12aa6fd7da2355ffb0ea0" title="get String with Symmetry">SymmetrytoStr</a>(Sa), <span class="stringliteral">&quot;:&quot;</span>)), 
           <a class="code" href="utils_8c.html#a72e38b8773b63e202dbebc40c3346988" title="get the file component of fullname">filepart</a>(mbfilea), 
           (Sb==0 ? <span class="stringliteral">&quot;&quot;</span> : <a class="code" href="utils_8c.html#ab513af03cb4d827e200043bbc98cad12" title="join two strings">strjoin</a>(<a class="code" href="Symmetry_8c.html#a57aa62a08fd12aa6fd7da2355ffb0ea0" title="get String with Symmetry">SymmetrytoStr</a>(Sb), <span class="stringliteral">&quot;:&quot;</span>)), 
           <a class="code" href="utils_8c.html#a72e38b8773b63e202dbebc40c3346988" title="get the file component of fullname">filepart</a>(mbfileb), 
           <a class="code" href="Projection_8c.html#ac87bb7fb183abeb15fc0454df5babd55">ProjectiontoStr</a>(P));

  <span class="keywordflow">if</span> (!(mefp = gzopen(mefilename, <span class="stringliteral">&quot;w&quot;</span>))) {
    fprintf(stderr, <span class="stringliteral">&quot;couldn&#39;t open %s for writing\n&quot;</span>, mefilename);
    <span class="keywordflow">return</span> -1;
  }
    
  <a class="code" href="utils_8c.html#a109d01ec3cb7ea341ed78e31316661b8" title="print info about running process">gzprintinfo</a>(mefp);

  gzprintf(mefp, <span class="stringliteral">&quot;&lt;MBFile %s %s %d&gt;\n&quot;</span>, 
           mbfilea, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfilea), Sa);
  gzprintf(mefp, <span class="stringliteral">&quot;&lt;MBFile %s %s %d&gt;\n\n&quot;</span>, 
           mbfileb, <a class="code" href="utils_8c.html#a70474eaf20d7c9cbd95b9d2b6fb6eb55" title="create md5 hash for file fname">md5hash</a>(mbfileb), Sb);

  <a class="code" href="Projection_8c.html#a086dc7277e11cd8a2335f25cb14c66b8">writeprojectedMBME</a>(mefp, P, Op, Sa, Sb, me);

  gzclose(mefp);

  <span class="keywordflow">return</span> 0;
} 
</pre></div></p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
