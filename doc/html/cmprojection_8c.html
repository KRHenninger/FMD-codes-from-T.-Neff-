<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/cmprojection.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>fmd/cmprojection.c File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="CenterofMass_8h_source.html">CenterofMass.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Projection_8h_source.html">Projection.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="physics_8h_source.html">misc/physics.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gaussquad_8h_source.html">numerics/gaussquad.h</a>&quot;</code><br/>

<p><a href="cmprojection_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)&nbsp;&nbsp;&nbsp;((<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)*(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#a6468750a80f532995d7f387427b4176a">CUB</a>(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)&nbsp;&nbsp;&nbsp;((<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)*(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)*(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>))</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#a01962eecd72394179321284a514a75b8">initCMintegration</a> (<a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="structcmpara.html">cmpara</a>, const char *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#afd49fd9499450859075a07b9c48230d3">_initcmintegration</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, double <a class="el" href="physics_8h.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>, <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#abf4911adb463930dc540277d1da25c35">initcmintegration</a> (const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#a2d6f83cd77e06f6e3706b09dcd0eec9b">reinitcmintegration</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#a7ae9754fe9db92205d761777cfa5e336">freecmintegration</a> (<a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#a4cde89930e46342aae042ab854f2290b">getcmintegrationpoint</a> (int i, const <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>, double <a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>[3], double *w)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#a257cc9882a74d9e9a560eb64ce94dbd1">linear</a> [1][3] = {{ 0., 0., 1.}}</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#a71664e4e8efbff0b37db1c6148a19a53">tetrahedron</a> [4][3]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#af3b97a4617428b51e5c2cc6ea1c840fe">octahedron</a> [6][3]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#afd1ded07497dd5d0aeed3229f1df2cfc">cube</a> [8][3]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double(*[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cmprojection_8c.html#af5b681c73567b823d57c18d3cdabb2ab">polyhedron</a> )[3]</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Gridpoints used for linear momentum projection</p>
<p>(c) 2004-2011 Thomas Neff </p>

<p>Definition in file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a6468750a80f532995d7f387427b4176a"></a><!-- doxytag: member="cmprojection.c::CUB" ref="a6468750a80f532995d7f387427b4176a" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CUB</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"><a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;((<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)*(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)*(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00031">31</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>Referenced by <a class="el" href="cmprojection_8c_source.html#l00147">_initcmintegration()</a>, and <a class="el" href="cmprojection_8c_source.html#l00234">reinitcmintegration()</a>.</p>

</div>
</div>
<a class="anchor" id="aa7866fa5e4e0ee9b034e9dab6599a9cc"></a><!-- doxytag: member="cmprojection.c::SQR" ref="aa7866fa5e4e0ee9b034e9dab6599a9cc" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SQR</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"><a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;((<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)*(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00030">30</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a48b0cf8e41bc07938e5a8260c308f742"></a><!-- doxytag: member="cmprojection.c::_estimateacm" ref="a48b0cf8e41bc07938e5a8260c308f742" args="(const SlaterDet *Q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double _estimateacm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00128">128</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8c_source.html#l00432">calcSlaterDetAux()</a>, <a class="el" href="CenterofMass_8c_source.html#l00099">calcTCM()</a>, <a class="el" href="SlaterDet_8c_source.html#l00423">freeSlaterDetAux()</a>, <a class="el" href="SlaterDet_8c_source.html#l00414">initSlaterDetAux()</a>, <a class="el" href="physics_8c_source.html#l00033">mneutron</a>, <a class="el" href="physics_8c_source.html#l00032">mproton</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00077">X</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>, <a class="el" href="cmprojection_8c_source.html#l00224">initcmintegration()</a>, and <a class="el" href="cmprojection_8c_source.html#l00234">reinitcmintegration()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="comment">// do we have to initialize workspace first ?</span>
  <span class="comment">// if (X.Gaux == NULL)</span>
  <span class="comment">//   initSlaterDetAux(Q, &amp;X);</span>

  <a class="code" href="structSlaterDetAux.html">SlaterDetAux</a> <a class="code" href="MinimizerDONLP2_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>;
  <a class="code" href="SlaterDet_8c.html#a9d28b849a027b454fd2eddb812a884c5" title="init SlaterDetAux X">initSlaterDetAux</a>(Q, &amp;X);

  <span class="keywordtype">double</span> tcm;

  <a class="code" href="SlaterDet_8c.html#ac1dfa773b90a1f5f6294d6081c412981">calcSlaterDetAux</a>(Q, &amp;X);
  <a class="code" href="CenterofMass_8c.html#a27efee5e8e47c37f68fe08105bf1a152">calcTCM</a>(Q, &amp;X, &amp;tcm);
  <a class="code" href="SlaterDet_8c.html#a6d10ca2b062d871a6903292600c3125a" title="free memory used by SlaterDetAux X">freeSlaterDetAux</a>(&amp;X);
  
  <span class="keywordflow">return</span> (0.75/(tcm*(<a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a>*Q-&gt;<a class="code" href="structSlaterDet.html#a6c7238078110732052290c5feb3fcecb" title="number of protons">Z</a>+<a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>*Q-&gt;<a class="code" href="structSlaterDet.html#aba9b875a3a8af9a9056dc7d1a48934ac" title="number of neutrons">N</a>)));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="afd49fd9499450859075a07b9c48230d3"></a><!-- doxytag: member="cmprojection.c::_initcmintegration" ref="afd49fd9499450859075a07b9c48230d3" args="(const Projection *P, double alpha, cmintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _initcmintegration </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00147">147</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00102">Projection::cm</a>, <a class="el" href="Projection_8h_source.html#l00025">CMNone</a>, <a class="el" href="Projection_8h_source.html#l00105">Projection::cmpoly</a>, <a class="el" href="Projection_8h_source.html#l00025">CMPoly</a>, <a class="el" href="Projection_8h_source.html#l00104">Projection::cmprod</a>, <a class="el" href="Projection_8h_source.html#l00025">CMProd</a>, <a class="el" href="Projection_8h_source.html#l00025">CMSimple</a>, <a class="el" href="cmprojection_8c_source.html#l00031">CUB</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="gaussquad_8c_source.html#l00188">GaussSqrHermitePoints()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00041">cmintegrationpara::n</a>, <a class="el" href="Projection_8h_source.html#l00030">cmprodpara::nphi</a>, <a class="el" href="Projection_8h_source.html#l00035">cmpolypara::npoly</a>, <a class="el" href="Projection_8h_source.html#l00034">cmpolypara::nr</a>, <a class="el" href="Projection_8h_source.html#l00028">cmprodpara::nr</a>, <a class="el" href="donlp2_8h_source.html#l00052">nr</a>, <a class="el" href="Projection_8h_source.html#l00029">cmprodpara::ntheta</a>, <a class="el" href="HOBasis_8c_source.html#l00043">nx</a>, <a class="el" href="cmprojection_8c_source.html#l00057">polyhedron</a>, <a class="el" href="gaussquad_8c_source.html#l00255">ShiftedPeriodicTrapezoidalPoints()</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>, and <a class="el" href="cmprojection_8c_source.html#l00224">initcmintegration()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a8d869da79c82654982e95e61d10a64c4">CMNone</a>) {
    par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 1;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a> = malloc(3*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a> = malloc(1*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][0] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][1] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][2] = 0.0; 
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[0] = 1.0;
  } 

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a0e967fc9236e1bb9b51ddb4c16fd096e">CMSimple</a>) {
    par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 1;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a> = malloc(3*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a> = malloc(1*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][0] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][1] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][2] = 0.0; 
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[0] = 0.125*pow(M_PI*<a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>,-1.5);
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a3ebfa1463485cc7babb95b427075772a">CMProd</a>) {
    <span class="keywordtype">int</span> <a class="code" href="donlp2_8h.html#a2833bf188e6bf292fa7d61e2dd54d622">nr</a>=P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#aceeaab6ba25f876de7f218c9e797cf01">nr</a>; 
    <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a02d47a4f36ec0bcce348696534567e30">nx</a>=P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#af7d2985994407467340336b7dd1b683e">ntheta</a>; <span class="keywordtype">int</span> nphi=P-&gt;<a class="code" href="structProjection.html#a4292128368222758301ad2c030afaac2">cmprod</a>.<a class="code" href="structcmprodpara.html#a44027ab99975309599367c045379d55d">nphi</a>;
    
    <span class="keywordtype">double</span> pointr[nr], weightr[nr];
    <a class="code" href="gaussquad_8c.html#aee65fcd1581a362adaba774793e24c5e">GaussSqrHermitePoints</a>(nr, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, pointr, weightr);

    <span class="keywordtype">double</span> pointx[nx], weightx[nx];
    <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(nx, -1.0, 1.0, pointx, weightx);

    <span class="keywordtype">double</span> pointphi[nphi], weightphi[nphi];
    <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(nphi, 0, 2*M_PI, 0.00,
                                     pointphi, weightphi);

    par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = nr*nx*nphi;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a> = malloc(3*par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a> = malloc(par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

    <span class="keywordtype">int</span> i=0;
    <span class="keywordtype">int</span> ir, ix, iphi;
    <span class="keywordflow">for</span> (ir=0; ir&lt;nr; ir++)
      <span class="keywordflow">for</span> (ix=0; ix&lt;nx; ix++)
        <span class="keywordflow">for</span> (iphi=0; iphi&lt;nphi; iphi++) {
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][0] = pointr[ir]*sqrt(1-<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(pointx[ix]))*cos(pointphi[iphi]);
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][1] = pointr[ir]*sqrt(1-<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(pointx[ix]))*sin(pointphi[iphi]);
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][2] = pointr[ir]*pointx[ix];
          par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i] = 1/<a class="code" href="cmprojection_8c.html#a6468750a80f532995d7f387427b4176a">CUB</a>(2*M_PI)*
            weightr[ir]*weightx[ix]*weightphi[iphi];
          i++;
        }
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structProjection.html#a87ccc3a184a97511dd0c056a0586a494" title="type of cm projection">cm</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf">CMPoly</a>) {
    <span class="keywordtype">int</span> nr=P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a>; 
    <span class="keywordtype">int</span> npoly=P-&gt;<a class="code" href="structProjection.html#a8e0c2249fe8e8f760f7e2fbd3629f474">cmpoly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a>;
    
    <span class="keywordtype">double</span> pointr[nr], weightr[nr];
    <a class="code" href="gaussquad_8c.html#aee65fcd1581a362adaba774793e24c5e">GaussSqrHermitePoints</a>(nr, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, pointr, weightr);

    par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = nr*npoly;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a> = malloc(3*par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a> = malloc(par-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

    <span class="keywordtype">int</span> i=0;    
    <span class="keywordtype">int</span> ir, ipoly, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;   
    <span class="keywordflow">for</span> (ir=0; ir&lt;nr; ir++)
      <span class="keywordflow">for</span> (ipoly=0; ipoly&lt;npoly; ipoly++) {
        <span class="keywordflow">for</span> (j=0; j&lt;3; j++)
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][j] = pointr[ir]*<a class="code" href="cmprojection_8c.html#af5b681c73567b823d57c18d3cdabb2ab">polyhedron</a>[npoly][ipoly][j];
        par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i] = 1/<a class="code" href="cmprojection_8c.html#a6468750a80f532995d7f387427b4176a">CUB</a>(2*M_PI)*
          weightr[ir]*(4*M_PI/npoly);
        i++;
      }
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7ae9754fe9db92205d761777cfa5e336"></a><!-- doxytag: member="cmprojection.c::freecmintegration" ref="a7ae9754fe9db92205d761777cfa5e336" args="(cmintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freecmintegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00298">298</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, and <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  free(par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>);
  free(par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4cde89930e46342aae042ab854f2290b"></a><!-- doxytag: member="cmprojection.c::getcmintegrationpoint" ref="a4cde89930e46342aae042ab854f2290b" args="(int i, const cmintegrationpara *par, double x[3], double *w)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getcmintegrationpoint </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>w</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00305">305</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00497">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>, <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00037">calcprojectedMBMEmpi()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00194">calcprojectedMBMEsmpi()</a>, <a class="el" href="MultiSlaterDet_8c_source.html#l00307">calcprojectedMultiMBME()</a>, and <a class="el" href="ProjectionMultimpi_8c_source.html#l00074">calcprojectedMultiMBMEmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  assert(i &lt; par-&gt;<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;
  <span class="keywordflow">for</span> (j=0; j&lt;3; j++)
    <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>[j] = par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][j];
  
  *w = par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i];

  <span class="comment">// fprintf(stderr, &quot;cm integration point: (%8.5f, %8.5f, %8.5f) weight %8.5f\n&quot;, </span>
  <span class="comment">//         x[0], x[1], x[2], *w);</span>
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="abf4911adb463930dc540277d1da25c35"></a><!-- doxytag: member="cmprojection.c::initcmintegration" ref="abf4911adb463930dc540277d1da25c35" args="(const Projection *P, const SlaterDet *Q, const SlaterDet *Qp, cmintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initcmintegration </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00224">224</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="cmprojection_8c_source.html#l00128">_estimateacm()</a>, <a class="el" href="cmprojection_8c_source.html#l00147">_initcmintegration()</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00107">alpha</a>.</p>

<p>Referenced by <a class="el" href="Projection_8c_source.html#l00605">calcprojectedMBME()</a>, <a class="el" href="Projectionmpi_8c_source.html#l00037">calcprojectedMBMEmpi()</a>, <a class="el" href="Projection_8c_source.html#l00715">calcprojectedMBMEs()</a>, and <a class="el" href="Projectionmpi_8c_source.html#l00194">calcprojectedMBMEsmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a> = 0.5/(<a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(Q)+<a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(Qp));

  <a class="code" href="cmprojection_8c.html#afd49fd9499450859075a07b9c48230d3">_initcmintegration</a>(P, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, par);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a01962eecd72394179321284a514a75b8"></a><!-- doxytag: member="cmprojection.c::initCMintegration" ref="a01962eecd72394179321284a514a75b8" args="(cmintegrationpara *cmpara, const char *projpar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initCMintegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>cmpara</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>projpar</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00069">69</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00041">cmintegrationpara::n</a>, <a class="el" href="Projection_8h_source.html#l00030">cmprodpara::nphi</a>, <a class="el" href="Projection_8h_source.html#l00035">cmpolypara::npoly</a>, <a class="el" href="Projection_8h_source.html#l00028">cmprodpara::nr</a>, <a class="el" href="Projection_8h_source.html#l00034">cmpolypara::nr</a>, <a class="el" href="donlp2_8h_source.html#l00052">nr</a>, <a class="el" href="Projection_8h_source.html#l00029">cmprodpara::ntheta</a>, <a class="el" href="Projection_8h_source.html#l00044">cmintegrationpara::poly</a>, <a class="el" href="Projection_8h_source.html#l00043">cmintegrationpara::prod</a>, <a class="el" href="Projection_8h_source.html#l00040">cmintegrationpara::type</a>, <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="minenergyconmultivappcm_8c_source.html#l00086">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span> projparcpy[strlen(<a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>)];
  strcpy(projparcpy, <a class="code" href="MinimizerDONLP2multivapp_8c.html#ae51b51057e3a9d5aa3905eed7979dca1">projpar</a>);
  <span class="keywordtype">char</span>* c = projparcpy;

  <span class="comment">// default is CMNone</span>
  cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> = CMNone;
  cmpara-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 1;

  c = strtok(c, <span class="stringliteral">&quot;-&quot;</span>);
  <span class="keywordflow">while</span> (c &amp;&amp; strncmp(c, <span class="stringliteral">&quot;cm&quot;</span>, 2)) { 
    c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>); 
  };
  
  <span class="keywordflow">if</span> (c) {
    c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
    <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;none&quot;</span>, 4)) {
      cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> = CMNone;
      cmpara-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 1;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;simple&quot;</span>, 6)) {
      cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> = CMSimple;
      cmpara-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 1;
    } <span class="keywordflow">else</span> {
      <span class="keywordtype">int</span> <a class="code" href="donlp2_8h.html#a2833bf188e6bf292fa7d61e2dd54d622">nr</a> = atoi(c);
      c=strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
      <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;tet&quot;</span>, 3)) {
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> = CMPoly;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a> = nr;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> = 4;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 4*nr;
      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;oct&quot;</span>, 3)) {
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> = CMPoly;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a> = nr;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> = 6;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 6*nr;
      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(c, <span class="stringliteral">&quot;cbe&quot;</span>, 3)) {
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> = CMPoly;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a> = nr;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a> = 8;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = 8*nr;
      } <span class="keywordflow">else</span> {
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> = CMProd;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#aceeaab6ba25f876de7f218c9e797cf01">nr</a> = nr;
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#af7d2985994407467340336b7dd1b683e">ntheta</a> = atoi(c);
        c = strtok(NULL, <span class="stringliteral">&quot;-&quot;</span>);
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#a44027ab99975309599367c045379d55d">nphi</a> = atoi(c);
        cmpara-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a> = nr*cmpara-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#af7d2985994407467340336b7dd1b683e">ntheta</a>*cmpara-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#a44027ab99975309599367c045379d55d">nphi</a>;
      }
    }
  }

  cmpara-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a> = malloc(3*cmpara-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
  cmpara-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a> = malloc(cmpara-&gt;<a class="code" href="structcmintegrationpara.html#ae1229cd214b908780ebc4ae9b66f5e19">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));

  <span class="keywordflow">return</span> 0;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2d6f83cd77e06f6e3706b09dcd0eec9b"></a><!-- doxytag: member="cmprojection.c::reinitcmintegration" ref="a2d6f83cd77e06f6e3706b09dcd0eec9b" args="(const SlaterDet *Q, const SlaterDet *Qp, cmintegrationpara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reinitcmintegration </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcmintegrationpara.html">cmintegrationpara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00234">234</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>References <a class="el" href="cmprojection_8c_source.html#l00128">_estimateacm()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00107">alpha</a>, <a class="el" href="Projection_8h_source.html#l00025">CMNone</a>, <a class="el" href="Projection_8h_source.html#l00025">CMPoly</a>, <a class="el" href="Projection_8h_source.html#l00025">CMProd</a>, <a class="el" href="Projection_8h_source.html#l00025">CMSimple</a>, <a class="el" href="cmprojection_8c_source.html#l00031">CUB</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="gaussquad_8c_source.html#l00188">GaussSqrHermitePoints()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00030">cmprodpara::nphi</a>, <a class="el" href="Projection_8h_source.html#l00035">cmpolypara::npoly</a>, <a class="el" href="Projection_8h_source.html#l00034">cmpolypara::nr</a>, <a class="el" href="Projection_8h_source.html#l00028">cmprodpara::nr</a>, <a class="el" href="donlp2_8h_source.html#l00052">nr</a>, <a class="el" href="Projection_8h_source.html#l00029">cmprodpara::ntheta</a>, <a class="el" href="HOBasis_8c_source.html#l00043">nx</a>, <a class="el" href="Projection_8h_source.html#l00044">cmintegrationpara::poly</a>, <a class="el" href="cmprojection_8c_source.html#l00057">polyhedron</a>, <a class="el" href="Projection_8h_source.html#l00043">cmintegrationpara::prod</a>, <a class="el" href="gaussquad_8c_source.html#l00255">ShiftedPeriodicTrapezoidalPoints()</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="Projection_8h_source.html#l00040">cmintegrationpara::type</a>, <a class="el" href="Projection_8h_source.html#l00047">cmintegrationpara::w</a>, and <a class="el" href="Projection_8h_source.html#l00046">cmintegrationpara::x</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00497">calcgradprojectedHamiltonianmatrix()</a>, and <a class="el" href="MinimizerDONLP2multivappcm_8c_source.html#l00315">calcprojectedHamiltonianmatrix()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a> = 0.5/(<a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(Q)+<a class="code" href="cmprojection_8c.html#a48b0cf8e41bc07938e5a8260c308f742">_estimateacm</a>(Qp));

  <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a8d869da79c82654982e95e61d10a64c4">CMNone</a>) {
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[0] = 1.0;
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][0] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][1] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][2] = 0.0; 
  } 

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a0e967fc9236e1bb9b51ddb4c16fd096e">CMSimple</a>) {
    par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[0] = 0.125*pow(M_PI*<a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>,-1.5);
    par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][0] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][1] = 0.0; par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[0][2] = 0.0; 
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a3ebfa1463485cc7babb95b427075772a">CMProd</a>) {
    <span class="keywordtype">int</span> <a class="code" href="donlp2_8h.html#a2833bf188e6bf292fa7d61e2dd54d622">nr</a>=par-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#aceeaab6ba25f876de7f218c9e797cf01">nr</a>; 
    <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a02d47a4f36ec0bcce348696534567e30">nx</a>=par-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#af7d2985994407467340336b7dd1b683e">ntheta</a>; <span class="keywordtype">int</span> nphi=par-&gt;<a class="code" href="structcmintegrationpara.html#a9a18828360415aa16bbe52f9f8e76d1c">prod</a>.<a class="code" href="structcmprodpara.html#a44027ab99975309599367c045379d55d">nphi</a>;
    
    <span class="keywordtype">double</span> pointr[nr], weightr[nr];
    <a class="code" href="gaussquad_8c.html#aee65fcd1581a362adaba774793e24c5e">GaussSqrHermitePoints</a>(nr, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, pointr, weightr);

    <span class="keywordtype">double</span> pointx[nx], weightx[nx];
    <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(nx, -1.0, 1.0, pointx, weightx);

    <span class="keywordtype">double</span> pointphi[nphi], weightphi[nphi];
    <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(nphi, 0, 2*M_PI, 0.00,
                                     pointphi, weightphi);

    <span class="keywordtype">int</span> i=0;
    <span class="keywordtype">int</span> ir, ix, iphi;
    <span class="keywordflow">for</span> (ir=0; ir&lt;nr; ir++)
      <span class="keywordflow">for</span> (ix=0; ix&lt;nx; ix++)
        <span class="keywordflow">for</span> (iphi=0; iphi&lt;nphi; iphi++) {
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][0] = pointr[ir]*sqrt(1-<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(pointx[ix]))*cos(pointphi[iphi]);
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][1] = pointr[ir]*sqrt(1-<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(pointx[ix]))*sin(pointphi[iphi]);
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][2] = pointr[ir]*pointx[ix];
          par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i] = 1/<a class="code" href="cmprojection_8c.html#a6468750a80f532995d7f387427b4176a">CUB</a>(2*M_PI)*
            weightr[ir]*weightx[ix]*weightphi[iphi];
          i++;
        }
  }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structcmintegrationpara.html#aa3272b967bedce6d4cc1fdd121a682a0">type</a> == <a class="code" href="Projection_8h.html#ae4d5251432e1a9e6803c0240cc492e18a9930f39726023d17ca4e18c2437ebaaf">CMPoly</a>) {
    <span class="keywordtype">int</span> nr=par-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#aadaf15fe4447fa26cf56004270dc7a83">nr</a>; 
    <span class="keywordtype">int</span> npoly=par-&gt;<a class="code" href="structcmintegrationpara.html#aec186a3437d89f60d74536ac5badf326">poly</a>.<a class="code" href="structcmpolypara.html#a0ecaf4c067190a16871c14bee617164e">npoly</a>;
    
    <span class="keywordtype">double</span> pointr[nr], weightr[nr];
    <a class="code" href="gaussquad_8c.html#aee65fcd1581a362adaba774793e24c5e">GaussSqrHermitePoints</a>(nr, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, pointr, weightr);

    <span class="keywordtype">int</span> i=0;    
    <span class="keywordtype">int</span> ir, ipoly, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>;   
    <span class="keywordflow">for</span> (ir=0; ir&lt;nr; ir++)
      <span class="keywordflow">for</span> (ipoly=0; ipoly&lt;npoly; ipoly++) {
        <span class="keywordflow">for</span> (j=0; j&lt;3; j++)
          par-&gt;<a class="code" href="structcmintegrationpara.html#aedc6f72a92ed296da2ebc0024d592668">x</a>[i][j] = pointr[ir]*<a class="code" href="cmprojection_8c.html#af5b681c73567b823d57c18d3cdabb2ab">polyhedron</a>[npoly][ipoly][j];
        par-&gt;<a class="code" href="structcmintegrationpara.html#af3836c5c86b8c7ca93e2031eb06c55cb">w</a>[i] = 1/<a class="code" href="cmprojection_8c.html#a6468750a80f532995d7f387427b4176a">CUB</a>(2*M_PI)*
          weightr[ir]*(4*M_PI/npoly);
        i++;
      }
  }  
}
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="afd1ded07497dd5d0aeed3229f1df2cfc"></a><!-- doxytag: member="cmprojection.c::cube" ref="afd1ded07497dd5d0aeed3229f1df2cfc" args="[8][3]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="cmprojection_8c.html#afd1ded07497dd5d0aeed3229f1df2cfc">cube</a>[8][3]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {{  0.57735,  0.57735,  0.57735},
                     {  0.57735,  0.57735, -0.57735},
                     {  0.57735, -0.57735,  0.57735},
                     {  0.57735, -0.57735, -0.57735},
                     { -0.57735,  0.57735,  0.57735},
                     { -0.57735,  0.57735, -0.57735},
                     { -0.57735, -0.57735,  0.57735},
                     { -0.57735, -0.57735, -0.57735}}
</pre></div>
<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00048">48</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

</div>
</div>
<a class="anchor" id="a257cc9882a74d9e9a560eb64ce94dbd1"></a><!-- doxytag: member="cmprojection.c::linear" ref="a257cc9882a74d9e9a560eb64ce94dbd1" args="[1][3]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="cmprojection_8c.html#a257cc9882a74d9e9a560eb64ce94dbd1">linear</a>[1][3] = {{ 0., 0., 1.}}</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00034">34</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

</div>
</div>
<a class="anchor" id="af3b97a4617428b51e5c2cc6ea1c840fe"></a><!-- doxytag: member="cmprojection.c::octahedron" ref="af3b97a4617428b51e5c2cc6ea1c840fe" args="[6][3]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="cmprojection_8c.html#af3b97a4617428b51e5c2cc6ea1c840fe">octahedron</a>[6][3]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {{0., 0., 1.},
                           {1., 0., 0.},
                           {0., 1., 0.},
                           {0., 0., -1.},
                           {-1., 0., 0.},
                           {0, -1., 0.}}
</pre></div>
<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00041">41</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

</div>
</div>
<a class="anchor" id="af5b681c73567b823d57c18d3cdabb2ab"></a><!-- doxytag: member="cmprojection.c::polyhedron" ref="af5b681c73567b823d57c18d3cdabb2ab" args=")[3]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double(*[] <a class="el" href="cmprojection_8c.html#af5b681c73567b823d57c18d3cdabb2ab">polyhedron</a>)[3]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> { NULL,
                              <a class="code" href="cmprojection_8c.html#a257cc9882a74d9e9a560eb64ce94dbd1">linear</a>,
                              NULL,
                              NULL,
                              <a class="code" href="cmprojection_8c.html#a71664e4e8efbff0b37db1c6148a19a53">tetrahedron</a>,
                              NULL,
                              <a class="code" href="cmprojection_8c.html#af3b97a4617428b51e5c2cc6ea1c840fe">octahedron</a>,
                              NULL,
                              <a class="code" href="cmprojection_8c.html#afd1ded07497dd5d0aeed3229f1df2cfc">cube</a> }
</pre></div>
<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00057">57</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

<p>Referenced by <a class="el" href="cmprojection_8c_source.html#l00147">_initcmintegration()</a>, and <a class="el" href="cmprojection_8c_source.html#l00234">reinitcmintegration()</a>.</p>

</div>
</div>
<a class="anchor" id="a71664e4e8efbff0b37db1c6148a19a53"></a><!-- doxytag: member="cmprojection.c::tetrahedron" ref="a71664e4e8efbff0b37db1c6148a19a53" args="[4][3]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="cmprojection_8c.html#a71664e4e8efbff0b37db1c6148a19a53">tetrahedron</a>[4][3]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {{0., 0., 1.}, 
                            {0., 0.942809, -0.333333}, 
                            {-0.816497, -0.471405, -0.333333}, 
                            {0.816497, -0.471405, -0.333333}}
</pre></div>
<p>Definition at line <a class="el" href="cmprojection_8c_source.html#l00036">36</a> of file <a class="el" href="cmprojection_8c_source.html">cmprojection.c</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:35 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
