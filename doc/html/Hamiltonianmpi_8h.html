<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmdmpi/Hamiltonianmpi.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>fmdmpi/Hamiltonianmpi.h File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;complex.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="SlaterDet_8h_source.html">fmd/SlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Interaction_8h_source.html">fmd/Interaction.h</a>&quot;</code><br/>

<p><a href="Hamiltonianmpi_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Hamiltonianmpi_8h.html#ae47a2c4af905ad7ad01a22824a1f2a26">calcHamiltonianmpi</a> (const <a class="el" href="structInteraction.html">Interaction</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, double *h)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Hamiltonianmpi_8h.html#a81b93599fe67b3772df6c3b373b593d6">calcHamiltonianodmpi</a> (const <a class="el" href="structInteraction.html">Interaction</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, complex double *h)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Hamiltonianmpi_8h.html#a933c50cf797797435a7b6abe03f28a83">calcPotentialmpi</a> (const <a class="el" href="structInteraction.html">Interaction</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, double v[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="Hamiltonianmpi_8h.html#ae42d6d2ad8fac19cc2b1b14ceda14f88">calcPotentialodmpi</a> (const <a class="el" href="structInteraction.html">Interaction</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, complex double v[])</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>calculate matrix element of <a class="el" href="structInteraction.html">Interaction</a></p>
<p>(c) 2003 Thomas Neff </p>

<p>Definition in file <a class="el" href="Hamiltonianmpi_8h_source.html">Hamiltonianmpi.h</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae47a2c4af905ad7ad01a22824a1f2a26"></a><!-- doxytag: member="Hamiltonianmpi.h::calcHamiltonianmpi" ref="ae47a2c4af905ad7ad01a22824a1f2a26" args="(const Interaction *P, const SlaterDet *Q, const SlaterDetAux *X, double *h)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcHamiltonianmpi </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structInteraction.html">Interaction</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>h</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Hamiltonianmpi_8c_source.html#l00028">28</a> of file <a class="el" href="Hamiltonianmpi_8c_source.html">Hamiltonianmpi.c</a>.</p>

<p>References <a class="el" href="Hamiltonianmpi_8c_source.html#l00063">calcPotentialmpi()</a>, <a class="el" href="KineticEnergy_8c_source.html#l00032">calcT()</a>, <a class="el" href="CenterofMass_8c_source.html#l00099">calcTCM()</a>, <a class="el" href="Interaction_8h_source.html#l00059">Interaction::cm</a>, and <a class="el" href="Interaction_8h_source.html#l00055">Interaction::n</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2_8c_source.html#l00131">ef()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> v[P-&gt;<a class="code" href="structInteraction.html#a83c4631335f917ed6115bfa21503845d">n</a>];
  <span class="keywordtype">double</span> t, tcm = 0.0;

  <a class="code" href="KineticEnergy_8c.html#adc499d9a8ff5fd6ddc8a6ccd38f5f7f5">calcT</a>(Q, X, &amp;t); 
  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structInteraction.html#af2e544149baa09761156dcaeed81a000">cm</a>) 
    <a class="code" href="CenterofMass_8c.html#a27efee5e8e47c37f68fe08105bf1a152">calcTCM</a>(Q, X, &amp;tcm);
  <a class="code" href="Hamiltonianmpi_8c.html#a933c50cf797797435a7b6abe03f28a83">calcPotentialmpi</a>(P, Q, X, v);

  *h = t - tcm + v[0];
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a81b93599fe67b3772df6c3b373b593d6"></a><!-- doxytag: member="Hamiltonianmpi.h::calcHamiltonianodmpi" ref="a81b93599fe67b3772df6c3b373b593d6" args="(const Interaction *P, const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, complex double *h)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcHamiltonianodmpi </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structInteraction.html">Interaction</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double *&nbsp;</td>
          <td class="paramname"> <em>h</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Hamiltonianmpi_8c_source.html#l00044">44</a> of file <a class="el" href="Hamiltonianmpi_8c_source.html">Hamiltonianmpi.c</a>.</p>

<p>References <a class="el" href="Hamiltonianmpi_8c_source.html#l00135">calcPotentialodmpi()</a>, <a class="el" href="CenterofMass_8c_source.html#l00113">calcTCMod()</a>, <a class="el" href="KineticEnergy_8c_source.html#l00040">calcTod()</a>, <a class="el" href="Interaction_8h_source.html#l00059">Interaction::cm</a>, and <a class="el" href="Interaction_8h_source.html#l00055">Interaction::n</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2p_8c_source.html#l00136">ef()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  complex <span class="keywordtype">double</span> v[P-&gt;<a class="code" href="structInteraction.html#a83c4631335f917ed6115bfa21503845d">n</a>];
  complex <span class="keywordtype">double</span> t, tcm = 0.0;

  <a class="code" href="KineticEnergy_8c.html#aa6a64db7fa2141bfc9a2fee49e50b659">calcTod</a>(Q, Qp, X, &amp;t); 
  <span class="keywordflow">if</span> (P-&gt;<a class="code" href="structInteraction.html#af2e544149baa09761156dcaeed81a000">cm</a>) 
    <a class="code" href="CenterofMass_8c.html#a1611a8882ccbc099a1d7807df80d6d2a">calcTCMod</a>(Q, Qp, X, &amp;tcm);
  <a class="code" href="Hamiltonianmpi_8c.html#ae42d6d2ad8fac19cc2b1b14ceda14f88">calcPotentialodmpi</a>(P, Q, Qp, X, v);

  *h = t - tcm + v[0];
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a933c50cf797797435a7b6abe03f28a83"></a><!-- doxytag: member="Hamiltonianmpi.h::calcPotentialmpi" ref="a933c50cf797797435a7b6abe03f28a83" args="(const Interaction *P, const SlaterDet *Q, const SlaterDetAux *X, double v[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcPotentialmpi </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structInteraction.html">Interaction</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>v</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Hamiltonianmpi_8c_source.html#l00063">63</a> of file <a class="el" href="Hamiltonianmpi_8c_source.html">Hamiltonianmpi.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Communication_8c_source.html#l00045">BroadcastSlaterDet()</a>, <a class="el" href="Communication_8c_source.html#l00038">BroadcastTask()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="Communication_8c_source.html#l00029">mpisize</a>, <a class="el" href="Interaction_8h_source.html#l00055">Interaction::n</a>, <a class="el" href="Communication_8h_source.html#l00041">TAGPOTENTIAL</a>, and <a class="el" href="Communication_8h_source.html#l00037">TAGROWCOL</a>.</p>

<p>Referenced by <a class="el" href="Hamiltonianmpi_8c_source.html#l00028">calcHamiltonianmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>;
  <span class="keywordtype">int</span> todo=(A*(A-1))/2;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>[2]={0,1}; 
  <span class="keywordtype">int</span> done=0; <span class="keywordtype">int</span> rank;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=P-&gt;<a class="code" href="structInteraction.html#a83c4631335f917ed6115bfa21503845d">n</a>;
  <span class="keywordtype">double</span> vrowcol[dim];
  MPI_Status status;

  <span class="keywordflow">for</span> (i=0; i&lt;dim; i++)
    v[i] = 0.0;

  <span class="keywordtype">int</span> task = TASKPOTENTIAL;
  <a class="code" href="Communication_8c.html#a74a3cac6e654a97021b6cdd00f51bebd">BroadcastTask</a>(&amp;task);

  <a class="code" href="Communication_8c.html#a20a157ba304a85328b36c9727c72a578">BroadcastSlaterDet</a>(Q);        
  <span class="comment">// BroadcastSlaterDetAux(Q, X);</span>

  <span class="comment">// supply slaves with work</span>
  <span class="keywordflow">for</span> (rank=1; rank&lt;<a class="code" href="Communication_8c.html#a76bbfaa16fe885d266a99a79acdaee7e">mpisize</a>; rank++) {
    MPI_Send(k, 2, MPI_INT, rank, <a class="code" href="Communication_8h.html#acea6cc2fd22a7c92c77c2ebeba3e6d04">TAGROWCOL</a>, MPI_COMM_WORLD);
    k[1]++;
    <span class="keywordflow">if</span> (k[1] == A) {
      k[0]++; k[1]=k[0]+1;
    }
  }

  <span class="keywordflow">while</span> (1) {
    MPI_Recv(vrowcol, dim, MPI_DOUBLE, MPI_ANY_SOURCE, <a class="code" href="Communication_8h.html#abb264ec97858d4056c217f597dfe09a0">TAGPOTENTIAL</a>,
             MPI_COMM_WORLD, &amp;status);
    rank = status.MPI_SOURCE;

    <span class="keywordflow">for</span> (i=0; i&lt;dim; i++)
      v[i] += vrowcol[i];

    done++;

    <span class="comment">// all work distributed ?</span>
    <span class="keywordflow">if</span> (k[0] == A-1)
      <span class="keywordflow">break</span>;

    MPI_Send(k, 2, MPI_INT, rank, <a class="code" href="Communication_8h.html#acea6cc2fd22a7c92c77c2ebeba3e6d04">TAGROWCOL</a>, MPI_COMM_WORLD);

    k[1]++;
    <span class="keywordflow">if</span> (k[1] == A) {
      k[0]++; k[1]=k[0]+1;
    }
  }

  <span class="comment">// collect remaining results</span>
  <span class="keywordflow">while</span> (done&lt;todo) {
    MPI_Recv(vrowcol, dim, MPI_DOUBLE, MPI_ANY_SOURCE, <a class="code" href="Communication_8h.html#abb264ec97858d4056c217f597dfe09a0">TAGPOTENTIAL</a>,
             MPI_COMM_WORLD, &amp;status);

    <span class="keywordflow">for</span> (i=0; i&lt;dim; i++)
      v[i] += vrowcol[i];
  
    done++;
  }

  <span class="comment">// tell slaves we have finished</span>
  k[0] = -1;
  <span class="keywordflow">for</span> (rank=1; rank&lt;mpisize; rank++) {
    MPI_Send(k, 2, MPI_INT, rank, <a class="code" href="Communication_8h.html#acea6cc2fd22a7c92c77c2ebeba3e6d04">TAGROWCOL</a>, MPI_COMM_WORLD);
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae42d6d2ad8fac19cc2b1b14ceda14f88"></a><!-- doxytag: member="Hamiltonianmpi.h::calcPotentialodmpi" ref="ae42d6d2ad8fac19cc2b1b14ceda14f88" args="(const Interaction *P, const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, complex double v[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcPotentialodmpi </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structInteraction.html">Interaction</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double&nbsp;</td>
          <td class="paramname"> <em>v</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Hamiltonianmpi_8c_source.html#l00135">135</a> of file <a class="el" href="Hamiltonianmpi_8c_source.html">Hamiltonianmpi.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="Communication_8c_source.html#l00045">BroadcastSlaterDet()</a>, <a class="el" href="Communication_8c_source.html#l00038">BroadcastTask()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="Communication_8c_source.html#l00029">mpisize</a>, <a class="el" href="Interaction_8h_source.html#l00055">Interaction::n</a>, <a class="el" href="Communication_8h_source.html#l00044">TAGPOTENTIALOD</a>, and <a class="el" href="Communication_8h_source.html#l00037">TAGROWCOL</a>.</p>

<p>Referenced by <a class="el" href="Hamiltonianmpi_8c_source.html#l00044">calcHamiltonianodmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> task = TASKPOTENTIALOD;
  <span class="keywordtype">int</span> i;
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>;
  <span class="keywordtype">int</span> todo=(A*(A-1))/2;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>[2]={0,1}; 
  <span class="keywordtype">int</span> done=0; <span class="keywordtype">int</span> rank;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=P-&gt;<a class="code" href="structInteraction.html#a83c4631335f917ed6115bfa21503845d">n</a>;
  complex <span class="keywordtype">double</span> vrowcol[dim];
  MPI_Status status;

  <span class="keywordflow">for</span> (i=0; i&lt;dim; i++)
    v[i] = 0.0;

  <a class="code" href="Communication_8c.html#a74a3cac6e654a97021b6cdd00f51bebd">BroadcastTask</a>(&amp;task);
  <a class="code" href="Communication_8c.html#a20a157ba304a85328b36c9727c72a578">BroadcastSlaterDet</a>(Q);
  <a class="code" href="Communication_8c.html#a20a157ba304a85328b36c9727c72a578">BroadcastSlaterDet</a>(Qp);
  <span class="comment">// BroadcastSlaterDetAux(Q, X);</span>

  <span class="comment">// supply slaves with work</span>
  <span class="keywordflow">for</span> (rank=1; rank&lt;<a class="code" href="Communication_8c.html#a76bbfaa16fe885d266a99a79acdaee7e">mpisize</a>; rank++) {

    MPI_Send(k, 2, MPI_INT, rank, <a class="code" href="Communication_8h.html#acea6cc2fd22a7c92c77c2ebeba3e6d04">TAGROWCOL</a>, MPI_COMM_WORLD);
    k[1]++;
    <span class="keywordflow">if</span> (k[1] == A) {
      k[0]++; k[1]=k[0]+1;
    }
  }

  <span class="keywordflow">while</span> (1) {
    MPI_Recv(vrowcol, dim, MPI_DOUBLE_COMPLEX, MPI_ANY_SOURCE, <a class="code" href="Communication_8h.html#a7d79b548bca6141b28b051d0f7b8776d">TAGPOTENTIALOD</a>,
             MPI_COMM_WORLD, &amp;status);
    rank = status.MPI_SOURCE;

    <span class="keywordflow">for</span> (i=0; i&lt;dim; i++)
      v[i] += vrowcol[i];

    done++;

    <span class="comment">// all work distributed ?</span>
    <span class="keywordflow">if</span> (k[0] == A-1)
      <span class="keywordflow">break</span>;

    MPI_Send(k, 2, MPI_INT, rank, <a class="code" href="Communication_8h.html#acea6cc2fd22a7c92c77c2ebeba3e6d04">TAGROWCOL</a>, MPI_COMM_WORLD);

    k[1]++;
    <span class="keywordflow">if</span> (k[1] == A) {
      k[0]++; k[1]=k[0]+1;
    }
  }

  <span class="comment">// collect remaining results</span>
  <span class="keywordflow">while</span> (done&lt;todo) {
    MPI_Recv(vrowcol, dim, MPI_DOUBLE_COMPLEX, MPI_ANY_SOURCE, <a class="code" href="Communication_8h.html#a7d79b548bca6141b28b051d0f7b8776d">TAGPOTENTIALOD</a>,
             MPI_COMM_WORLD, &amp;status);

    <span class="keywordflow">for</span> (i=0; i&lt;dim; i++)
      v[i] += vrowcol[i];
  
    done++;
  }

  <span class="comment">// tell slaves we have finished</span>
  k[0] = -1;
  <span class="keywordflow">for</span> (rank=1; rank&lt;mpisize; rank++) {
    MPI_Send(k, 2, MPI_INT, rank, <a class="code" href="Communication_8h.html#acea6cc2fd22a7c92c77c2ebeba3e6d04">TAGROWCOL</a>, MPI_COMM_WORLD);
  }
}
</pre></div></p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
