<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/gradSlaterDet.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>fmd/gradSlaterDet.c File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;assert.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;complex.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="Gaussian_8h_source.html">Gaussian.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gradGaussian_8h_source.html">gradGaussian.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gradSlaterDet_8h_source.html">gradSlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cmath_8h_source.html">numerics/cmath.h</a>&quot;</code><br/>

<p><a href="gradSlaterDet_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)&nbsp;&nbsp;&nbsp;(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)*(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a6f42706cdd7a14385895e0cf256658e1">allocategradSlaterDet</a> (<a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *G, int A)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a223bcce732d96e7d21568bd10bcd7a52">initgradSlaterDet</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *G)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">init Slater determinant gradient  <a href="#a223bcce732d96e7d21568bd10bcd7a52"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a16c678aaaea568cc5751ab5798cdf42f">freegradSlaterDet</a> (<a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *G)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a426aebc61cf81a23bf6c29e53a83fe9b">zerogradSlaterDet</a> (<a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *G)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a0cb0610f0506c19d9608cf6e94a21342">copygradSlaterDet</a> (const <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *G, <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *Gp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#ab33490f458a71fdcc6471fe33046b2f6">multgradSlaterDet</a> (<a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *G, complex double <a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a8219ca5621227dd64bd930a89aa3f076">addtogradSlaterDet</a> (<a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *G, const <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *dG)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a19af7ba71232be839592a3bad8cbdff3">addmulttogradSlaterDet</a> (<a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *G, const <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *dG, complex double <a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a1da0063e8ec0d9e56884479f45b7cf6a">rotategradSlaterDet</a> (<a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *G, double <a class="el" href="physics_8h.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>, double beta, double gamma)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">rotate gradient by Euler angles  <a href="#a1da0063e8ec0d9e56884479f45b7cf6a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a1cae30a7bcea51daf123370c200b8cfa">allocategradSlaterDetAux</a> (<a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>, int A)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">allocate space for <a class="el" href="structgradSlaterDetAux.html" title="Auxiliaries for gradients of SlaterDeterminants.">gradSlaterDetAux</a>  <a href="#a1cae30a7bcea51daf123370c200b8cfa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a7d27b21ff2b108fdbdb074656ee7093b">initgradSlaterDetAux</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">init <a class="el" href="structgradSlaterDetAux.html" title="Auxiliaries for gradients of SlaterDeterminants.">gradSlaterDetAux</a> dX  <a href="#a7d27b21ff2b108fdbdb074656ee7093b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a6cb2f9b08e553978ec6b050a36bd2773">freegradSlaterDetAux</a> (<a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">free memory used by <a class="el" href="structgradSlaterDetAux.html" title="Auxiliaries for gradients of SlaterDeterminants.">gradSlaterDetAux</a> dX  <a href="#a6cb2f9b08e553978ec6b050a36bd2773"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a6568288ac02af64c0beed47e54611beb">calcgradSlaterDetAux</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#ad66e523aac29b61105ef5438a1089863">calcgradSlaterDetAuxod</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculate <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> for SlaterDet's Q and Qp  <a href="#ad66e523aac29b61105ef5438a1089863"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#afc726972340fd4c4e672749be9bf2e0e">calcgradOvlapod</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>, <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *grad)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculate gradient of Ovlap &lt;Q|Qp&gt;  <a href="#afc726972340fd4c4e672749be9bf2e0e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a8e8291ea789a02513131a30f4a182b98">calcgradSlaterDetOBME</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>, const <a class="el" href="structgradOneBodyOperator.html">gradOneBodyOperator</a> *op, <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *grad)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a63d097367d0f4cd3b09f5543ab4aa3f6">calcgradSlaterDetOBMEod</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>, const <a class="el" href="structgradOneBodyOperator.html">gradOneBodyOperator</a> *op, <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *grad)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a64538da70b4c62205b594211bb0cd282">calcgradSlaterDetTBME</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>, const <a class="el" href="structgradTwoBodyOperator.html">gradTwoBodyOperator</a> *op, <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *grad)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a84bfe22b9200a4a32fef54bc03841dd8">calcgradSlaterDetTBMEod</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>, const <a class="el" href="structgradTwoBodyOperator.html">gradTwoBodyOperator</a> *op, <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *grad)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#aac08beb3a255d9f440bd0b90d42c1c5b">calcgradSlaterDetTBMErowcol</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>, const <a class="el" href="structgradTwoBodyOperator.html">gradTwoBodyOperator</a> *op, <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *grad, int <a class="el" href="MinimizerDONLP2proj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, int <a class="el" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gradSlaterDet_8c.html#a06a155afedd95e535d0f00d58a24d05e">calcgradSlaterDetTBMEodrowcol</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a9e4217d02e31a93b68c0612b1ee4c145">dX</a>, const <a class="el" href="structgradTwoBodyOperator.html">gradTwoBodyOperator</a> *op, <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *grad, int <a class="el" href="MinimizerDONLP2proj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>, int <a class="el" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>gradients for <a class="el" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a> matrixelements</p>
<p>(c) 2003 Thomas Neff </p>

<p>Definition in file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="aa7866fa5e4e0ee9b034e9dab6599a9cc"></a><!-- doxytag: member="gradSlaterDet.c::SQR" ref="aa7866fa5e4e0ee9b034e9dab6599a9cc" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SQR</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"><a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)*(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00023">23</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a19af7ba71232be839592a3bad8cbdff3"></a><!-- doxytag: member="gradSlaterDet.c::addmulttogradSlaterDet" ref="a19af7ba71232be839592a3bad8cbdff3" args="(gradSlaterDet *G, const gradSlaterDet *dG, complex double x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addmulttogradSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double&nbsp;</td>
          <td class="paramname"> <em>x</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00086">86</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00034">gradSlaterDet::ngauss</a>, and <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>.</p>

<p>Referenced by <a class="el" href="ConstraintSymmetries_8c_source.html#l00331">calcgradConstraintD3H()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00261">calcgradConstraintParCh()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00168">calcgradConstraintParN()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00120">calcgradConstraintParP()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00398">calcgradConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00467">calcgradConstraintSyz()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00958">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l01248">egradf()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00284">egradh()</a>, and <a class="el" href="minenergyp_8c_source.html#l00055">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  G-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> += <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>*dG-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a>;
  <span class="keywordflow">for</span> (i=0; i&lt;G-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a>; i++)
    addmulttogradGaussian(&amp;G-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>[i], &amp;dG-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>[i], <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8219ca5621227dd64bd930a89aa3f076"></a><!-- doxytag: member="gradSlaterDet.c::addtogradSlaterDet" ref="a8219ca5621227dd64bd930a89aa3f076" args="(gradSlaterDet *G, const gradSlaterDet *dG)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addtogradSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>dG</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00076">76</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00034">gradSlaterDet::ngauss</a>, and <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  G-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> += dG-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a>;
  <span class="keywordflow">for</span> (i=0; i&lt;G-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a>; i++)
    addtogradGaussian(&amp;G-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>[i], &amp;dG-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>[i]);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6f42706cdd7a14385895e0cf256658e1"></a><!-- doxytag: member="gradSlaterDet.c::allocategradSlaterDet" ref="a6f42706cdd7a14385895e0cf256658e1" args="(gradSlaterDet *G, int A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void allocategradSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>A</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00026">26</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, and <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>.</p>

<p>Referenced by <a class="el" href="gradHamiltonianmpi_8c_source.html#l00058">calcgradPotentialmpi()</a>, <a class="el" href="gradHamiltonianmpi_8c_source.html#l00142">calcgradPotentialodmpi()</a>, <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, <a class="el" href="MinimizerSlave_8c_source.html#l00026">MinimizerSlave()</a>, and <a class="el" href="MinimizerSlave_8c_source.html#l00097">MinimizerSlaveod()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  G-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a> = malloc(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*A*<span class="keyword">sizeof</span>(<a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1cae30a7bcea51daf123370c200b8cfa"></a><!-- doxytag: member="gradSlaterDet.c::allocategradSlaterDetAux" ref="a1cae30a7bcea51daf123370c200b8cfa" args="(gradSlaterDetAux *dX, int A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void allocategradSlaterDetAux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>A</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>allocate space for <a class="el" href="structgradSlaterDetAux.html" title="Auxiliaries for gradients of SlaterDeterminants.">gradSlaterDetAux</a> </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00113">113</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, <a class="el" href="MinimizerSlave_8c_source.html#l00026">MinimizerSlave()</a>, and <a class="el" href="MinimizerSlave_8c_source.html#l00097">MinimizerSlaveod()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*A)*<span class="keyword">sizeof</span>(<a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>));
  dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a> = malloc(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(A)*<span class="keyword">sizeof</span>(<a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc726972340fd4c4e672749be9bf2e0e"></a><!-- doxytag: member="gradSlaterDet.c::calcgradOvlapod" ref="afc726972340fd4c4e672749be9bf2e0e" args="(const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, const gradSlaterDetAux *dX, gradSlaterDet *grad)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcgradOvlapod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>grad</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculate gradient of Ovlap &lt;Q|Qp&gt; </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00208">208</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00034">gradSlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>, and <a class="el" href="gradSlaterDet_8c_source.html#l00044">zerogradSlaterDet()</a>.</p>

<p>Referenced by <a class="el" href="ConstraintSymmetries_8c_source.html#l00331">calcgradConstraintD3H()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00261">calcgradConstraintParCh()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00168">calcgradConstraintParN()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00120">calcgradConstraintParP()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00398">calcgradConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00467">calcgradConstraintSyz()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2proj_8c_source.html#l00410">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00169">egradf()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00284">egradh()</a>, <a class="el" href="minenergyp_8c_source.html#l00055">main()</a>, and <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  <span class="keywordtype">int</span>* idx = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dno = dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dval = grad-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>;
  complex <span class="keywordtype">double</span> ovl = X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,ki;

  grad-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a> = Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  <a class="code" href="gradSlaterDet_8c.html#a426aebc61cf81a23bf6c29e53a83fe9b">zerogradSlaterDet</a>(grad);

  <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
    <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
      addmulttogradGaussian(&amp;dval[idx[k]+ki], &amp;dno[(idx[k]+ki)+k*ngauss], 
                            ovl);

  grad-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> = ovl;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6568288ac02af64c0beed47e54611beb"></a><!-- doxytag: member="gradSlaterDet.c::calcgradSlaterDetAux" ref="a6568288ac02af64c0beed47e54611beb" args="(const SlaterDet *Q, const SlaterDetAux *X, gradSlaterDetAux *dX)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcgradSlaterDetAux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> for <a class="el" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a> Q. hermiticity not exploited yet </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00135">135</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradGaussian_8c_source.html#l00022">calcgradGaussianAux()</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00136">dn</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, and <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2vappc_8c_source.html#l00861">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00150">egradf()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00224">egradh()</a>, <a class="el" href="minenergy_8c_source.html#l00071">main()</a>, and <a class="el" href="MinimizerSlave_8c_source.html#l00026">MinimizerSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  <a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>* dGaux=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dno=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,<a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,mi;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a7efde279a983f2f2a4eadaf466d3700e">dn</a>;

  <span class="keywordflow">for</span> (l=0; l&lt;ngauss; l++)
    <span class="keywordflow">for</span> (k=0; k&lt;ngauss; k++)
      <a class="code" href="gradGaussian_8c.html#af0d6ba270df7f3f46fb1205aadf3836a" title="calculate auxiliary quantities for two Gaussians">calcgradGaussianAux</a>(&amp;G[k], &amp;G[l], &amp;Gaux[k+l*ngauss],
                          &amp;dGaux[k+l*ngauss]);

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (k=0; k&lt;ngauss; k++)
      zerogradGaussian(&amp;dno[k+l*ngauss]);

  <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
    <span class="keywordflow">for</span> (k=0; k&lt;ngauss; k++) {
      zerogradGaussian(&amp;dn);
      <span class="keywordflow">for</span> (mi=0; mi&lt;ng[m]; mi++)
        addtogradGaussian(&amp;dn, &amp;dGaux[k+(idx[m]+mi)*ngauss].dQ);
      <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
        addmulttogradGaussian(&amp;dno[k+l*ngauss], &amp;dn, o[m+l*A]);
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad66e523aac29b61105ef5438a1089863"></a><!-- doxytag: member="gradSlaterDet.c::calcgradSlaterDetAuxod" ref="ad66e523aac29b61105ef5438a1089863" args="(const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, gradSlaterDetAux *dX)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcgradSlaterDetAuxod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculate <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> for SlaterDet's Q and Qp </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00169">169</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradGaussian_8c_source.html#l00022">calcgradGaussianAux()</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00136">dn</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, and <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>.</p>

<p>Referenced by <a class="el" href="ConstraintSymmetries_8c_source.html#l00331">calcgradConstraintD3H()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00261">calcgradConstraintParCh()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00168">calcgradConstraintParN()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00120">calcgradConstraintParP()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00398">calcgradConstraintSxz()</a>, <a class="el" href="ConstraintSymmetries_8c_source.html#l00467">calcgradConstraintSyz()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2proj_8c_source.html#l00410">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00169">egradf()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00284">egradh()</a>, <a class="el" href="minenergyp_8c_source.html#l00055">main()</a>, <a class="el" href="MinimizerprojSlave_8c_source.html#l00031">MinimizerprojSlave()</a>, and <a class="el" href="MinimizerSlave_8c_source.html#l00097">MinimizerSlaveod()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx=Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* idxp=Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>;
  <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>; <span class="keywordtype">int</span>* ngp=Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>; <a class="code" href="structGaussian.html">Gaussian</a>* Gp=Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  <a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>* dGaux=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dno=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,ki,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,li,<a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,mi;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a7efde279a983f2f2a4eadaf466d3700e">dn</a>;

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (li=0; li&lt;ngp[l]; li++)
      <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
          <a class="code" href="gradGaussian_8c.html#af0d6ba270df7f3f46fb1205aadf3836a" title="calculate auxiliary quantities for two Gaussians">calcgradGaussianAux</a>(&amp;G[idx[k]+ki], &amp;Gp[idxp[l]+li], 
                              &amp;Gaux[(idx[k]+ki)+(idxp[l]+li)*ngauss],
                              &amp;dGaux[(idx[k]+ki)+(idxp[l]+li)*ngauss]);

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (k=0; k&lt;ngauss; k++)
      zerogradGaussian(&amp;dno[k+l*ngauss]);

  <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
    <span class="keywordflow">for</span> (k=0; k&lt;ngauss; k++) {
      zerogradGaussian(&amp;dn);
      <span class="keywordflow">for</span> (mi=0; mi&lt;ngp[m]; mi++)
        addtogradGaussian(&amp;dn, &amp;dGaux[k+(idxp[m]+mi)*ngauss].dQ);
      <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
        addmulttogradGaussian(&amp;dno[k+l*ngauss], &amp;dn, o[m+l*A]);
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e8291ea789a02513131a30f4a182b98"></a><!-- doxytag: member="gradSlaterDet.c::calcgradSlaterDetOBME" ref="a8e8291ea789a02513131a30f4a182b98" args="(const SlaterDet *Q, const SlaterDetAux *X, const gradSlaterDetAux *dX, const gradOneBodyOperator *op, gradSlaterDet *grad)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcgradSlaterDetOBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradOneBodyOperator.html">gradOneBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate gradient of matrix element with SaterDet Q for one-body operator op defined for Gaussians val and dval(ngauss) will be added up </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00232">232</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="gradGaussian_8h_source.html#l00073">gradOneBodyOperator::me</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="gradGaussian_8h_source.html#l00071">gradOneBodyOperator::opt</a>, <a class="el" href="gradGaussian_8h_source.html#l00072">gradOneBodyOperator::par</a>, <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>, and <a class="el" href="donlp2_8h_source.html#l00057">val</a>.</p>

<p>Referenced by <a class="el" href="ConstraintCM_8c_source.html#l00120">calcgradConstraintCM()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00747">calcgradConstraintDetQ()</a>, <a class="el" href="ConstraintDipole_8c_source.html#l00118">calcgradConstraintED2()</a>, <a class="el" href="ConstraintOctupole_8c_source.html#l00566">calcgradConstraintEO2()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00583">calcgradConstraintEQ2()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00419">calcgradConstraintER2()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00416">calcgradConstraintJ2()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00231">calcgradConstraintJ2()</a>, <a class="el" href="Constraintl2_8c_source.html#l00202">calcgradConstraintl2()</a>, <a class="el" href="Constraintls_8c_source.html#l00139">calcgradConstraintls()</a>, <a class="el" href="ConstraintLS_8c_source.html#l00299">calcgradConstraintLS()</a>, <a class="el" href="ConstraintOctupole_8c_source.html#l00600">calcgradConstraintNO2()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00638">calcgradConstraintNQ2()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00487">calcgradConstraintNR2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00332">calcgradConstraintNS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00335">calcgradConstraintNT2()</a>, <a class="el" href="ConstraintOctupole_8c_source.html#l00532">calcgradConstraintO2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00320">calcgradConstraintPS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00323">calcgradConstraintPT2()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00322">calcgradConstraintPX()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00331">calcgradConstraintPY()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00340">calcgradConstraintPZ()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00533">calcgradConstraintQ2()</a>, <a class="el" href="ConstraintQuadrupole_8c_source.html#l00806">calcgradConstraintQ2offdiagonal()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00354">calcgradConstraintR2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00308">calcgradConstraintS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00311">calcgradConstraintT2()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00295">calcgradConstraintX()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00304">calcgradConstraintY()</a>, <a class="el" href="ConstraintCMXP_8c_source.html#l00313">calcgradConstraintZ()</a>, <a class="el" href="gradOscillator_8c_source.html#l00071">calcgradOsci2()</a>, <a class="el" href="gradOscillator_8c_source.html#l00082">calcgradOsci4()</a>, <a class="el" href="gradKineticEnergy_8c_source.html#l00049">calcgradT()</a>, and <a class="el" href="gradCenterofMass_8c_source.html#l00077">calcgradTCM()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  <a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>* dGaux=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dno=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>;
  complex <span class="keywordtype">double</span>* <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a> = &amp;grad-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a>; <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dval = grad-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,s,ki,li,si;
  complex <span class="keywordtype">double</span> gval;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a> gdval;

  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradOneBodyOperator.html#a353815f77964419986d05d173b4034ca">opt</a> || Gaux[idx[k]+idx[l]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        gval = 0.0;
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++) {
          zerogradGaussian(&amp;gdval);
          <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++) {
            op-&gt;<a class="code" href="structgradOneBodyOperator.html#a5012db85cd71b779952dcdbc702cfdbb">me</a>(op-&gt;<a class="code" href="structgradOneBodyOperator.html#a40e354f2da539fe5ef54505f88246509">par</a>, 
                   &amp;G[idx[k]+ki], &amp;G[idx[l]+li], 
                   &amp;Gaux[(idx[k]+ki)+(idx[l]+li)*ngauss],
                   &amp;dGaux[(idx[k]+ki)+(idx[l]+li)*ngauss],
                   &amp;gval, &amp;gdval);
          }
          addmulttogradGaussian(&amp;dval[idx[k]+ki], &amp;gdval, o[l+k*A]); 
        }
        *val += gval*o[l+k*A];
        <span class="keywordflow">for</span> (s=0; s&lt;A; s++)
          <span class="keywordflow">for</span> (si=0; si&lt;ng[s]; si++)
            addmulttogradGaussian(&amp;dval[idx[s]+si], &amp;dno[(idx[s]+si)+k*ngauss],
                                  -gval*o[l+s*A]);
      }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a63d097367d0f4cd3b09f5543ab4aa3f6"></a><!-- doxytag: member="gradSlaterDet.c::calcgradSlaterDetOBMEod" ref="a63d097367d0f4cd3b09f5543ab4aa3f6" args="(const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, const gradSlaterDetAux *dX, const gradOneBodyOperator *op, gradSlaterDet *grad)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcgradSlaterDetOBMEod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradOneBodyOperator.html">gradOneBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>grad</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00274">274</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="gradGaussian_8h_source.html#l00073">gradOneBodyOperator::me</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="gradGaussian_8h_source.html#l00071">gradOneBodyOperator::opt</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, <a class="el" href="gradGaussian_8h_source.html#l00072">gradOneBodyOperator::par</a>, <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>, and <a class="el" href="donlp2_8h_source.html#l00057">val</a>.</p>

<p>Referenced by <a class="el" href="ConstraintR2_8c_source.html#l00448">calcgradConstraintER2od()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00463">calcgradConstraintJ2od()</a>, <a class="el" href="ConstraintLS_8c_source.html#l00344">calcgradConstraintLSod()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00516">calcgradConstraintNR2od()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00383">calcgradConstraintR2od()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00361">calcgradConstraintS2od()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00365">calcgradConstraintT2od()</a>, <a class="el" href="gradCenterofMass_8c_source.html#l00090">calcgradTCMod()</a>, and <a class="el" href="gradKineticEnergy_8c_source.html#l00059">calcgradTod()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* idxp = Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>;
  <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>; <span class="keywordtype">int</span>* ngp = Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>; <a class="code" href="structGaussian.html">Gaussian</a>* Gp=Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  <a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>* dGaux=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dno=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>;
  complex <span class="keywordtype">double</span> ovl = X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>;
  complex <span class="keywordtype">double</span> <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>; <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dval = grad-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,s,ki,li,si;
  complex <span class="keywordtype">double</span> gval;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a> gdval;

  val = 0.0;
  <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
    <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradOneBodyOperator.html#a353815f77964419986d05d173b4034ca">opt</a> || Gaux[idx[k]+idxp[l]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        gval = 0.0;
        <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++) {
          zerogradGaussian(&amp;gdval);
          <span class="keywordflow">for</span> (li=0; li&lt;ngp[l]; li++) {
            op-&gt;<a class="code" href="structgradOneBodyOperator.html#a5012db85cd71b779952dcdbc702cfdbb">me</a>(op-&gt;<a class="code" href="structgradOneBodyOperator.html#a40e354f2da539fe5ef54505f88246509">par</a>, 
                   &amp;G[idx[k]+ki], &amp;Gp[idxp[l]+li], 
                   &amp;Gaux[(idx[k]+ki)+(idxp[l]+li)*ngauss],
                   &amp;dGaux[(idx[k]+ki)+(idxp[l]+li)*ngauss],
                   &amp;gval, &amp;gdval);
          }
          addmulttogradGaussian(&amp;dval[idx[k]+ki], &amp;gdval, o[l+k*A]*ovl); 
        }
        val += gval*o[l+k*A]*ovl;
        <span class="keywordflow">for</span> (s=0; s&lt;A; s++)
          <span class="keywordflow">for</span> (si=0; si&lt;ng[s]; si++)
            addmulttogradGaussian(&amp;dval[idx[s]+si], &amp;dno[(idx[s]+si)+k*ngauss],
                                  -gval*o[l+s*A]*ovl);
      }

  grad-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> += val;

  <span class="comment">// this term is comming from the derivative of the overlap</span>
  <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
    <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
      addmulttogradGaussian(&amp;dval[idx[k]+ki], &amp;dno[(idx[k]+ki)+k*ngauss], val);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a64538da70b4c62205b594211bb0cd282"></a><!-- doxytag: member="gradSlaterDet.c::calcgradSlaterDetTBME" ref="a64538da70b4c62205b594211bb0cd282" args="(const SlaterDet *Q, const SlaterDetAux *X, const gradSlaterDetAux *dX, const gradTwoBodyOperator *op, gradSlaterDet *grad)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcgradSlaterDetTBME </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradTwoBodyOperator.html">gradTwoBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate gradient of matrix element with SaterDet Q for two-body operator op defined for Gaussians and dval(ngauss) will be added up </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00327">327</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="gradGaussian_8h_source.html#l00084">gradTwoBodyOperator::me</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="gradGaussian_8h_source.html#l00082">gradTwoBodyOperator::opt</a>, <a class="el" href="gradGaussian_8h_source.html#l00083">gradTwoBodyOperator::par</a>, <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>, and <a class="el" href="donlp2_8h_source.html#l00057">val</a>.</p>

<p>Referenced by <a class="el" href="ConstraintR2_8c_source.html#l00419">calcgradConstraintER2()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00416">calcgradConstraintJ2()</a>, <a class="el" href="ConstraintLS_8c_source.html#l00299">calcgradConstraintLS()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00487">calcgradConstraintNR2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00332">calcgradConstraintNS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00335">calcgradConstraintNT2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00320">calcgradConstraintPS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00323">calcgradConstraintPT2()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00354">calcgradConstraintR2()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00308">calcgradConstraintS2()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00311">calcgradConstraintT2()</a>, <a class="el" href="gradPotential_8c_source.html#l01278">calcgradPotential()</a>, and <a class="el" href="gradCenterofMass_8c_source.html#l00077">calcgradTCM()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  <a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>* dGaux=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dno=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>;
  complex <span class="keywordtype">double</span>* <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a> = &amp;grad-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a>; <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dval = grad-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,<a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>,s, ki,li,mi,ni,si;
  complex <span class="keywordtype">double</span> gval;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a> gdval;
  complex <span class="keywordtype">double</span> ooa;

  <span class="keywordflow">for</span> (n=0; n&lt;A; n++)
    <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a62e5ea54d88ca56e8c8293325bf64864">opt</a> || Gaux[idx[l]+idx[n]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
          <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
            <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a62e5ea54d88ca56e8c8293325bf64864">opt</a> || Gaux[idx[k]+idx[m]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

              ooa = o[m+k*A]*o[n+l*A]-o[n+k*A]*o[m+l*A];

              gval = 0.0;

              <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++) {
                zerogradGaussian(&amp;gdval);
                <span class="keywordflow">for</span> (ni=0; ni&lt;ng[n]; ni++)
                  <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
                    <span class="keywordflow">for</span> (mi=0; mi&lt;ng[m]; mi++)

                      op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a01e5511e7da0b31496365c7b41e2c4f4">me</a>(op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a806ec1e957d9ac7270fa0c79453eff35">par</a>, 
                             &amp;G[idx[k]+ki], &amp;G[idx[l]+li], 
                             &amp;G[idx[m]+mi], &amp;G[idx[n]+ni], 
                             &amp;Gaux[(idx[k]+ki)+(idx[m]+mi)*ngauss],
                             &amp;Gaux[(idx[l]+li)+(idx[n]+ni)*ngauss],
                             &amp;dGaux[(idx[k]+ki)+(idx[m]+mi)*ngauss],
                             &amp;gval, &amp;gdval);

                addmulttogradGaussian(&amp;dval[idx[k]+ki], &amp;gdval, ooa);
              }
              *val += 0.5*gval*ooa;

              <span class="keywordflow">for</span> (s=0; s&lt;A; s++) {
                ooa = o[m+s*A]*o[n+l*A]-o[n+s*A]*o[m+l*A];
                <span class="keywordflow">for</span> (si=0; si&lt;ng[s]; si++)
                  addmulttogradGaussian(&amp;dval[idx[s]+si], 
                                        &amp;dno[(idx[s]+si)+k*ngauss],
                                        -gval*ooa);
              }
            }
      }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a84bfe22b9200a4a32fef54bc03841dd8"></a><!-- doxytag: member="gradSlaterDet.c::calcgradSlaterDetTBMEod" ref="a84bfe22b9200a4a32fef54bc03841dd8" args="(const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, const gradSlaterDetAux *dX, const gradTwoBodyOperator *op, gradSlaterDet *grad)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcgradSlaterDetTBMEod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradTwoBodyOperator.html">gradTwoBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>grad</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00387">387</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00098">k</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="gradGaussian_8h_source.html#l00084">gradTwoBodyOperator::me</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="gradGaussian_8h_source.html#l00082">gradTwoBodyOperator::opt</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, <a class="el" href="gradGaussian_8h_source.html#l00083">gradTwoBodyOperator::par</a>, <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>, and <a class="el" href="donlp2_8h_source.html#l00057">val</a>.</p>

<p>Referenced by <a class="el" href="ConstraintR2_8c_source.html#l00448">calcgradConstraintER2od()</a>, <a class="el" href="ConstraintJ2_8c_source.html#l00463">calcgradConstraintJ2od()</a>, <a class="el" href="ConstraintLS_8c_source.html#l00344">calcgradConstraintLSod()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00516">calcgradConstraintNR2od()</a>, <a class="el" href="ConstraintR2_8c_source.html#l00383">calcgradConstraintR2od()</a>, <a class="el" href="ConstraintS2_8c_source.html#l00361">calcgradConstraintS2od()</a>, <a class="el" href="ConstraintT2_8c_source.html#l00365">calcgradConstraintT2od()</a>, <a class="el" href="gradPotential_8c_source.html#l01289">calcgradPotentialod()</a>, and <a class="el" href="gradCenterofMass_8c_source.html#l00090">calcgradTCMod()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* idxp = Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; 
  <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>; <span class="keywordtype">int</span>* ngp = Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>; <a class="code" href="structGaussian.html">Gaussian</a>* Gp=Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  <a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>* dGaux=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dno=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>;
  complex <span class="keywordtype">double</span> <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>; <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dval = grad-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>;
  complex <span class="keywordtype">double</span> ovl = X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>;

  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>,<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>,<a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>,s, ki,li,mi,ni,si;
  complex <span class="keywordtype">double</span> gval;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a> gdval;
  complex <span class="keywordtype">double</span> ooa;

  val = 0.0;
  <span class="keywordflow">for</span> (n=0; n&lt;A; n++)
    <span class="keywordflow">for</span> (l=0; l&lt;A; l++)
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a62e5ea54d88ca56e8c8293325bf64864">opt</a> || Gaux[idx[l]+idxp[n]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
          <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
            <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a62e5ea54d88ca56e8c8293325bf64864">opt</a> || Gaux[idx[k]+idxp[m]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

              ooa = o[m+k*A]*o[n+l*A]-o[n+k*A]*o[m+l*A];

              gval = 0.0;

              <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++) {
                zerogradGaussian(&amp;gdval);
                <span class="keywordflow">for</span> (ni=0; ni&lt;ngp[n]; ni++)
                  <span class="keywordflow">for</span> (li=0; li&lt;ng[l]; li++)
                    <span class="keywordflow">for</span> (mi=0; mi&lt;ngp[m]; mi++)

                      op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a01e5511e7da0b31496365c7b41e2c4f4">me</a>(op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a806ec1e957d9ac7270fa0c79453eff35">par</a>, 
                             &amp;G[idx[k]+ki], &amp;G[idx[l]+li], 
                             &amp;Gp[idxp[m]+mi], &amp;Gp[idxp[n]+ni], 
                             &amp;Gaux[(idx[k]+ki)+(idxp[m]+mi)*ngauss],
                             &amp;Gaux[(idx[l]+li)+(idxp[n]+ni)*ngauss],
                             &amp;dGaux[(idx[k]+ki)+(idxp[m]+mi)*ngauss],
                             &amp;gval, &amp;gdval);

                addmulttogradGaussian(&amp;dval[idx[k]+ki], &amp;gdval, ooa*ovl);
              }
              val += 0.5*gval*ooa*ovl;

              <span class="keywordflow">for</span> (s=0; s&lt;A; s++) {
                ooa = o[m+s*A]*o[n+l*A]-o[n+s*A]*o[m+l*A];
                <span class="keywordflow">for</span> (si=0; si&lt;ng[s]; si++)
                  addmulttogradGaussian(&amp;dval[idx[s]+si], 
                                        &amp;dno[(idx[s]+si)+k*ngauss],
                                        -gval*ooa*ovl);
              }
            }
      } 

  grad-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> += val;

  <span class="comment">// this term is comming from the derivative of the overlap</span>
  <span class="keywordflow">for</span> (k=0; k&lt;A; k++)
    <span class="keywordflow">for</span> (ki=0; ki&lt;ng[k]; ki++)
      addmulttogradGaussian(&amp;dval[idx[k]+ki], &amp;dno[(idx[k]+ki)+k*ngauss], val);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a06a155afedd95e535d0f00d58a24d05e"></a><!-- doxytag: member="gradSlaterDet.c::calcgradSlaterDetTBMEodrowcol" ref="a06a155afedd95e535d0f00d58a24d05e" args="(const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, const gradSlaterDetAux *dX, const gradTwoBodyOperator *op, gradSlaterDet *grad, int k, int l)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcgradSlaterDetTBMEodrowcol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradTwoBodyOperator.html">gradTwoBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>l</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00524">524</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="gradGaussian_8h_source.html#l00084">gradTwoBodyOperator::me</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="gradGaussian_8h_source.html#l00082">gradTwoBodyOperator::opt</a>, <a class="el" href="SlaterDet_8h_source.html#l00047">SlaterDetAux::ovlap</a>, <a class="el" href="gradGaussian_8h_source.html#l00083">gradTwoBodyOperator::par</a>, <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>, and <a class="el" href="donlp2_8h_source.html#l00057">val</a>.</p>

<p>Referenced by <a class="el" href="gradPotential_8c_source.html#l01313">calcgradPotentialodrowcol()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* idxp = Qp-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; 
  <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>; <span class="keywordtype">int</span>* ngp = Qp-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>; <a class="code" href="structGaussian.html">Gaussian</a>* Gp=Qp-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  <a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>* dGaux=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dno=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>;
  complex <span class="keywordtype">double</span> <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a>; <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dval = grad-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>;
  complex <span class="keywordtype">double</span> ovl = X-&gt;<a class="code" href="structSlaterDetAux.html#a19bee32579f8dd37e4834f06f07a231f" title="&amp;lt;Q|Q&amp;#39;&amp;gt;, only defined for non-diagonal">ovlap</a>;

  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>,s, ki,li,mi,ni,si;
  complex <span class="keywordtype">double</span> gval;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a> gdval;
  complex <span class="keywordtype">double</span> ooa;

  <span class="comment">// zero gradient</span>
  grad-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> = 0.0;
  <span class="keywordflow">for</span> (si=0; si&lt;ngauss; si++)
    zerogradGaussian(&amp;dval[si]);

  val = 0.0;
  <span class="keywordflow">for</span> (n=0; n&lt;A; n++)
    <span class="comment">// for (l=0; l&lt;A; l++)</span>
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a62e5ea54d88ca56e8c8293325bf64864">opt</a> || Gaux[idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+idxp[n]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
          <span class="comment">// for (k=0; k&lt;A; k++)</span>
            <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a62e5ea54d88ca56e8c8293325bf64864">opt</a> || Gaux[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+idxp[m]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

              ooa = o[m+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*A]*o[n+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A]-o[n+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*A]*o[m+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A];

              gval = 0.0;

              <span class="keywordflow">for</span> (ki=0; ki&lt;ng[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]; ki++) {
                zerogradGaussian(&amp;gdval);
                <span class="keywordflow">for</span> (ni=0; ni&lt;ngp[n]; ni++)
                  <span class="keywordflow">for</span> (li=0; li&lt;ng[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]; li++)
                    <span class="keywordflow">for</span> (mi=0; mi&lt;ngp[m]; mi++)
                      op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a01e5511e7da0b31496365c7b41e2c4f4">me</a>(op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a806ec1e957d9ac7270fa0c79453eff35">par</a>, 
                             &amp;G[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki], &amp;G[idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+li], 
                             &amp;Gp[idxp[m]+mi], &amp;Gp[idxp[n]+ni], 
                             &amp;Gaux[(idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki)+(idxp[m]+mi)*ngauss],
                             &amp;Gaux[(idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+li)+(idxp[n]+ni)*ngauss],
                             &amp;dGaux[(idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki)+(idxp[m]+mi)*ngauss],
                             &amp;gval, &amp;gdval);

                addmulttogradGaussian(&amp;dval[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki], &amp;gdval, ooa*ovl);
              }
              val += 0.5*gval*ooa*ovl;

              <span class="keywordflow">for</span> (s=0; s&lt;A; s++) {
                ooa = o[m+s*A]*o[n+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A]-o[n+s*A]*o[m+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A];
                <span class="keywordflow">for</span> (si=0; si&lt;ng[s]; si++)
                  addmulttogradGaussian(&amp;dval[idx[s]+si], 
                                        &amp;dno[(idx[s]+si)+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*ngauss],
                                        -gval*ooa*ovl);
              }
            }
      } 

  grad-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> += val;

  <span class="comment">// this term is comming from the derivative of the overlap</span>
  <span class="keywordflow">for</span> (s=0; s&lt;A; s++)
    <span class="keywordflow">for</span> (si=0; si&lt;ng[s]; si++)
      addmulttogradGaussian(&amp;dval[idx[s]+si], &amp;dno[(idx[s]+si)+s*ngauss], val);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aac08beb3a255d9f440bd0b90d42c1c5b"></a><!-- doxytag: member="gradSlaterDet.c::calcgradSlaterDetTBMErowcol" ref="aac08beb3a255d9f440bd0b90d42c1c5b" args="(const SlaterDet *Q, const SlaterDetAux *X, const gradSlaterDetAux *dX, const gradTwoBodyOperator *op, gradSlaterDet *grad, int k, int l)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcgradSlaterDetTBMErowcol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgradTwoBodyOperator.html">gradTwoBodyOperator</a> *&nbsp;</td>
          <td class="paramname"> <em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>l</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00458">458</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="SlaterDet_8h_source.html#l00036">SlaterDet::G</a>, <a class="el" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a class="el" href="SlaterDet_8h_source.html#l00044">SlaterDetAux::Gaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="SlaterDet_8h_source.html#l00034">SlaterDet::idx</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="gradGaussian_8h_source.html#l00084">gradTwoBodyOperator::me</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="SlaterDet_8h_source.html#l00035">SlaterDet::ng</a>, <a class="el" href="donlp2_8h_source.html#l00051">ng</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="SlaterDet_8h_source.html#l00046">SlaterDetAux::o</a>, <a class="el" href="gradGaussian_8h_source.html#l00082">gradTwoBodyOperator::opt</a>, <a class="el" href="gradGaussian_8h_source.html#l00083">gradTwoBodyOperator::par</a>, <a class="el" href="Gaussian_8h_source.html#l00039">GaussianAux::T</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>, and <a class="el" href="donlp2_8h_source.html#l00057">val</a>.</p>

<p>Referenced by <a class="el" href="gradPotential_8c_source.html#l01301">calcgradPotentialrowcol()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> A=Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>; <span class="keywordtype">int</span> ngauss=Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>; 
  <span class="keywordtype">int</span>* idx = Q-&gt;<a class="code" href="structSlaterDet.html#a1cb8dd92221385316b00c719a227c804" title="index of nucleons">idx</a>; <span class="keywordtype">int</span>* <a class="code" href="donlp2_8h.html#a05dddf13e5d94b9b27a10b39fdd60c2a">ng</a> = Q-&gt;<a class="code" href="structSlaterDet.html#a40059f4be29c6490a20b0f2987d91cae" title="number of gaussians per nucleon">ng</a>;
  <a class="code" href="structGaussian.html">Gaussian</a>* <a class="code" href="md5_8c.html#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>=Q-&gt;<a class="code" href="structSlaterDet.html#a4402796d6bc7406894d9f573e7866e6a" title="Gaussians.">G</a>;
  <a class="code" href="structGaussianAux.html">GaussianAux</a>* Gaux=X-&gt;<a class="code" href="structSlaterDetAux.html#af13f59ec13b3b0565098537c1a216c1b" title="Gaussian Auxiliaries Gaux(ngauss, ngauss).">Gaux</a>;
  complex <span class="keywordtype">double</span>* o=X-&gt;<a class="code" href="structSlaterDetAux.html#ac3ebc58940366da582c6698aab5fb6b8" title="inverse ovlap matrix o(A,A)">o</a>;
  <a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>* dGaux=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a>;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dno=dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>;
  complex <span class="keywordtype">double</span>* <a class="code" href="donlp2_8h.html#a4826db9a70669b4ad6637f200d0dd976">val</a> = &amp;grad-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a>; <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>* dval = grad-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>;

  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>,<a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>,s, ki,li,mi,ni,si;
  complex <span class="keywordtype">double</span> gval;
  <a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a> gdval;
  complex <span class="keywordtype">double</span> ooa;

  <span class="comment">// zero gradient, as each k,l component is calculated independendly</span>
  *val = 0.0;
  <span class="keywordflow">for</span> (ki=0; ki&lt;ngauss; ki++)
    zerogradGaussian(&amp;dval[ki]);

  <span class="keywordflow">for</span> (n=0; n&lt;A; n++)
    <span class="comment">// for (l=0; l&lt;A; l++)</span>
      <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a62e5ea54d88ca56e8c8293325bf64864">opt</a> || Gaux[idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+idx[n]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {
        <span class="keywordflow">for</span> (m=0; m&lt;A; m++)
          <span class="comment">// for (k=0; k&lt;A; k++)</span>
            <span class="keywordflow">if</span> (!op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a62e5ea54d88ca56e8c8293325bf64864">opt</a> || Gaux[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+idx[m]*ngauss].<a class="code" href="structGaussianAux.html#a743ce58e106e0f6c4ff7fde72a78b20f">T</a>) {

              ooa = o[m+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*A]*o[n+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A]-o[n+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*A]*o[m+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A];

              gval = 0.0;

              <span class="keywordflow">for</span> (ki=0; ki&lt;ng[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]; ki++) {
                zerogradGaussian(&amp;gdval);
                <span class="keywordflow">for</span> (ni=0; ni&lt;ng[n]; ni++)
                  <span class="keywordflow">for</span> (li=0; li&lt;ng[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]; li++)
                    <span class="keywordflow">for</span> (mi=0; mi&lt;ng[m]; mi++)

                      op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a01e5511e7da0b31496365c7b41e2c4f4">me</a>(op-&gt;<a class="code" href="structgradTwoBodyOperator.html#a806ec1e957d9ac7270fa0c79453eff35">par</a>, 
                             &amp;G[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki], &amp;G[idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+li], 
                             &amp;G[idx[m]+mi], &amp;G[idx[n]+ni], 
                             &amp;Gaux[(idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki)+(idx[m]+mi)*ngauss],
                             &amp;Gaux[(idx[<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>]+li)+(idx[n]+ni)*ngauss],
                             &amp;dGaux[(idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki)+(idx[m]+mi)*ngauss],
                             &amp;gval, &amp;gdval);

                addmulttogradGaussian(&amp;dval[idx[<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]+ki], &amp;gdval, ooa);
              }
              *val += 0.5*gval*ooa;

              <span class="keywordflow">for</span> (s=0; s&lt;A; s++) {
                ooa = o[m+s*A]*o[n+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A] - o[n+s*A]*o[m+<a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>*A];
                <span class="keywordflow">for</span> (si=0; si&lt;ng[s]; si++)
                  addmulttogradGaussian(&amp;dval[idx[s]+si], 
                                        &amp;dno[(idx[s]+si)+<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>*ngauss],
                                        -gval*ooa);
              }
            }
      }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0cb0610f0506c19d9608cf6e94a21342"></a><!-- doxytag: member="gradSlaterDet.c::copygradSlaterDet" ref="a0cb0610f0506c19d9608cf6e94a21342" args="(const gradSlaterDet *G, gradSlaterDet *Gp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copygradSlaterDet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Gp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00054">54</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00034">gradSlaterDet::ngauss</a>, and <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  assert(G-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a> == Gp-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a>);

  <span class="keywordtype">int</span> i;

  Gp-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> = G-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a>;
  <span class="keywordflow">for</span> (i=0; i&lt;G-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a>; i++)
    Gp-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>[i] = G-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>[i];
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a16c678aaaea568cc5751ab5798cdf42f"></a><!-- doxytag: member="gradSlaterDet.c::freegradSlaterDet" ref="a16c678aaaea568cc5751ab5798cdf42f" args="(gradSlaterDet *G)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freegradSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00038">38</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>.</p>

<p>Referenced by <a class="el" href="gradHamiltonianmpi_8c_source.html#l00058">calcgradPotentialmpi()</a>, and <a class="el" href="gradHamiltonianmpi_8c_source.html#l00142">calcgradPotentialodmpi()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  free(G-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6cb2f9b08e553978ec6b050a36bd2773"></a><!-- doxytag: member="gradSlaterDet.c::freegradSlaterDetAux" ref="a6cb2f9b08e553978ec6b050a36bd2773" args="(gradSlaterDetAux *dX)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freegradSlaterDetAux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>free memory used by <a class="el" href="structgradSlaterDetAux.html" title="Auxiliaries for gradients of SlaterDeterminants.">gradSlaterDetAux</a> dX </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00128">128</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, and <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  free(dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a>);
  free(dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a223bcce732d96e7d21568bd10bcd7a52"></a><!-- doxytag: member="gradSlaterDet.c::initgradSlaterDet" ref="a223bcce732d96e7d21568bd10bcd7a52" args="(const SlaterDet *Q, gradSlaterDet *G)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initgradSlaterDet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>init Slater determinant gradient </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00031">31</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00034">gradSlaterDet::ngauss</a>, and <a class="el" href="gradSlaterDet_8c_source.html#l00044">zerogradSlaterDet()</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00687">initWork()</a>, <a class="el" href="minenergy_8c_source.html#l00071">main()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00092">MinimizeDONLP2()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l01148">MinimizeDONLP2orthproj()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00090">MinimizeDONLP2p()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00090">MinimizeDONLP2par()</a>, <a class="el" href="MinimizerDONLP2proj_8c_source.html#l00672">MinimizeDONLP2proj()</a>, and <a class="el" href="MinimizerDONLP2vap_8c_source.html#l00903">MinimizeDONLP2vap()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  G-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a> = Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  G-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a> = (<a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>*) malloc(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>*<span class="keyword">sizeof</span>(<a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>));
  <a class="code" href="gradSlaterDet_8c.html#a426aebc61cf81a23bf6c29e53a83fe9b">zerogradSlaterDet</a>(G);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7d27b21ff2b108fdbdb074656ee7093b"></a><!-- doxytag: member="gradSlaterDet.c::initgradSlaterDetAux" ref="a7d27b21ff2b108fdbdb074656ee7093b" args="(const SlaterDet *Q, gradSlaterDetAux *dX)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initgradSlaterDetAux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgradSlaterDetAux.html">gradSlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>dX</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>init <a class="el" href="structgradSlaterDetAux.html" title="Auxiliaries for gradients of SlaterDeterminants.">gradSlaterDetAux</a> dX </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00120">120</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00027">gradSlaterDetAux::dGaux</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00028">gradSlaterDetAux::dno</a>, <a class="el" href="sldet2fmdpara_8c_source.html#l00025">MAXNG</a>, <a class="el" href="SlaterDet_8h_source.html#l00033">SlaterDet::ngauss</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00026">gradSlaterDetAux::ngauss</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00687">initWork()</a>, <a class="el" href="minenergy_8c_source.html#l00071">main()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00092">MinimizeDONLP2()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l01148">MinimizeDONLP2orthproj()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00090">MinimizeDONLP2p()</a>, <a class="el" href="MinimizerDONLP2par_8c_source.html#l00090">MinimizeDONLP2par()</a>, <a class="el" href="MinimizerDONLP2proj_8c_source.html#l00672">MinimizeDONLP2proj()</a>, and <a class="el" href="MinimizerDONLP2vap_8c_source.html#l00903">MinimizeDONLP2vap()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  dX-&gt;<a class="code" href="structgradSlaterDetAux.html#ad3203d3c030e48c5e56c8c171bcff82a">ngauss</a> = Q-&gt;<a class="code" href="structSlaterDet.html#aa49d03f0c2aafc2bc042c834c61fdd9c" title="total number of gaussians">ngauss</a>;
  dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a514ad5eda7ac6456d32ecea50b188bb1" title="Gaussian gradients dGaux(ngauss,ngauss).">dGaux</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>)*<span class="keyword">sizeof</span>(<a class="code" href="structgradGaussianAux.html" title="Derivatives of spin and spatial overlap of Gaussians.">gradGaussianAux</a>));
  dX-&gt;<a class="code" href="structgradSlaterDetAux.html#a4fff1f0e9a62f92c4c44e043a9ed8006" title="overlap gradients dno(ngauss,A)">dno</a> = malloc(<a class="code" href="sldet2fmdpara_8c.html#a8fe56bf98987252342a9cb3a3efb61f5">MAXNG</a>*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(Q-&gt;<a class="code" href="structSlaterDet.html#a608c038b00ef605b3871e920459ee4f3" title="number of nucleons">A</a>)*<span class="keyword">sizeof</span>(<a class="code" href="structgradGaussian.html" title="gradient with respect to spin and spatial parameters">gradGaussian</a>)); 
}  
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab33490f458a71fdcc6471fe33046b2f6"></a><!-- doxytag: member="gradSlaterDet.c::multgradSlaterDet" ref="ab33490f458a71fdcc6471fe33046b2f6" args="(gradSlaterDet *G, complex double x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multgradSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double&nbsp;</td>
          <td class="paramname"> <em>x</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00066">66</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00034">gradSlaterDet::ngauss</a>, and <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00958">calcgradprojectedHamiltonian()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  G-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> *= <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>;
  <span class="keywordflow">for</span> (i=0; i&lt;G-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a>; i++)
    multgradGaussian(&amp;G-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>[i], <a class="code" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1da0063e8ec0d9e56884479f45b7cf6a"></a><!-- doxytag: member="gradSlaterDet.c::rotategradSlaterDet" ref="a1da0063e8ec0d9e56884479f45b7cf6a" args="(gradSlaterDet *G, double alpha, double beta, double gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotategradSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>gamma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>rotate gradient by Euler angles </p>

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00097">97</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00034">gradSlaterDet::ngauss</a>, <a class="el" href="rotationmatrices_8c_source.html#l00050">rotatemat2()</a>, and <a class="el" href="rotationmatrices_8c_source.html#l00084">rotatemat3()</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00958">calcgradprojectedHamiltonian()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> euler[3] = { <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, gamma };

  complex <span class="keywordtype">double</span> R2[2][2];
  <a class="code" href="rotationmatrices_8c.html#a35bedbe2765f5d99ca0f5fa72e50f0e1" title="spinor rotation matrix">rotatemat2</a>(euler, R2);

  <span class="keywordtype">double</span> R3[3][3];
  <a class="code" href="rotationmatrices_8c.html#a927b76dce98d7889615bc1118ece7706" title="vector rotation matrix">rotatemat3</a>(euler, R3);
  
  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;G-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a>; i++)
    rotategradGaussian(&amp;G-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>[i], R3, R2);

}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a426aebc61cf81a23bf6c29e53a83fe9b"></a><!-- doxytag: member="gradSlaterDet.c::zerogradSlaterDet" ref="a426aebc61cf81a23bf6c29e53a83fe9b" args="(gradSlaterDet *G)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zerogradSlaterDet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgradSlaterDet.html">gradSlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>G</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="gradSlaterDet_8c_source.html#l00044">44</a> of file <a class="el" href="gradSlaterDet_8c_source.html">gradSlaterDet.c</a>.</p>

<p>References <a class="el" href="gradSlaterDet_8h_source.html#l00036">gradSlaterDet::gradval</a>, <a class="el" href="gradSlaterDet_8h_source.html#l00034">gradSlaterDet::ngauss</a>, and <a class="el" href="gradSlaterDet_8h_source.html#l00035">gradSlaterDet::val</a>.</p>

<p>Referenced by <a class="el" href="gradHamiltonian_8c_source.html#l00020">calcgradHamiltonian()</a>, <a class="el" href="gradHamiltonianmpi_8c_source.html#l00025">calcgradHamiltonianmpi()</a>, <a class="el" href="gradHamiltonian_8c_source.html#l00036">calcgradHamiltonianod()</a>, <a class="el" href="gradHamiltonianmpi_8c_source.html#l00040">calcgradHamiltonianodmpi()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="gradSlaterDet_8c_source.html#l00208">calcgradOvlapod()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00958">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00476">calcgradprojectedHamiltonianmatrix()</a>, <a class="el" href="MinimizerDONLP2p_8c_source.html#l00169">egradf()</a>, <a class="el" href="MinimizerDONLP2_8c_source.html#l00224">egradh()</a>, <a class="el" href="gradSlaterDet_8c_source.html#l00031">initgradSlaterDet()</a>, and <a class="el" href="minenergyp_8c_source.html#l00055">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i;

  G-&gt;<a class="code" href="structgradSlaterDet.html#aeb66b7b63a7c4e58067a99b9bbfaf573">val</a> = 0.0;
  <span class="keywordflow">for</span> (i=0; i&lt;G-&gt;<a class="code" href="structgradSlaterDet.html#a3a014a5c8ecb4942640babae781a886e">ngauss</a>; i++)
    zerogradGaussian(&amp;G-&gt;<a class="code" href="structgradSlaterDet.html#afb3b2d269a7cbd19d15617191bd740bd">gradval</a>[i]);
}
</pre></div></p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
