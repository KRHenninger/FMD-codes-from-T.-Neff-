<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/SpatialOrientation.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>fmd/SpatialOrientation.c File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;complex.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="Gaussian_8h_source.html">Gaussian.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="CenterofMass_8h_source.html">CenterofMass.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="AngularMomenta_8h_source.html">AngularMomenta.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="SpatialOrientation_8h_source.html">SpatialOrientation.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cmath_8h_source.html">numerics/cmath.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="lapack_8h_source.html">numerics/lapack.h</a>&quot;</code><br/>

<p><a href="SpatialOrientation_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SpatialOrientation_8c.html#ad33471b82b8b003bcdb578b82b82bb90">calcInertiaTensor</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, double T[9])</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculate mass inertia tensor  <a href="#ad33471b82b8b003bcdb578b82b82bb90"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SpatialOrientation_8c.html#a32d3ee4fee5633a62e4310aef4401017">calcOctupoleTensor</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, double O[27])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SpatialOrientation_8c.html#a35dc15bd8ec3baed1f008ef416af1fe4">calcSpatialOrientation</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, double *<a class="el" href="physics_8h.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>, double *beta, double *gamma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SpatialOrientation_8c.html#ac976e85596d5fab5140b3e9cd76ee1a4">calcOrientedOrientation</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, double *<a class="el" href="physics_8h.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>, double *beta, double *gamma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="SpatialOrientation_8c.html#a3e40deaeee0d028e1050280c476b201e">calcSpinOrientation</a> (const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, double *<a class="el" href="physics_8h.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>, double *beta, double *gamma)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">spin orientation with respect to z-axis  <a href="#a3e40deaeee0d028e1050280c476b201e"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>determine euler angles of spatial orientation by diagonalizing the inertia tensor</p>
<p>determine euler angles of intrinsic coordinate system by diagonalizing the &lt; Ji Jj &gt; tensor</p>
<p>(c) 2003 Thomas Neff </p>

<p>Definition in file <a class="el" href="SpatialOrientation_8c_source.html">SpatialOrientation.c</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ad33471b82b8b003bcdb578b82b82bb90"></a><!-- doxytag: member="SpatialOrientation.c::calcInertiaTensor" ref="ad33471b82b8b003bcdb578b82b82bb90" args="(const SlaterDet *Q, const SlaterDetAux *X, double T[9])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcInertiaTensor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>T</em>[9]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculate mass inertia tensor </p>

<p>Definition at line <a class="el" href="SpatialOrientation_8c_source.html#l00049">49</a> of file <a class="el" href="SpatialOrientation_8c_source.html">SpatialOrientation.c</a>.</p>

<p>References <a class="el" href="CenterofMass_8c_source.html#l00071">calcCMPosition()</a>, <a class="el" href="SlaterDet_8c_source.html#l00591">calcSlaterDetOBME()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00103">par</a>.</p>

<p>Referenced by <a class="el" href="SpatialOrientation_8c_source.html#l00198">calcOrientedOrientation()</a>, <a class="el" href="SpatialOrientation_8c_source.html#l00145">calcSpatialOrientation()</a>, and <a class="el" href="calcorientation_8c_source.html#l00027">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> Xcm[3];
  <a class="code" href="CenterofMass_8c.html#a1e6d03a8864c008d5eccd7a0ca7704f0">calcCMPosition</a>(Q, X, Xcm);

  <a class="code" href="structOneBodyOperator.html">OneBodyOperator</a> op_ob_inertia = { <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>: 9, opt: 1, <a class="code" href="MinimizerDONLP2multivapp_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>: Xcm, me: ob_inertia};
  <a class="code" href="SlaterDet_8c.html#a6635ee67b67d4b93287d558fb8d22504">calcSlaterDetOBME</a>(Q, X, &amp;op_ob_inertia, T);
}       
</pre></div></p>

</div>
</div>
<a class="anchor" id="a32d3ee4fee5633a62e4310aef4401017"></a><!-- doxytag: member="SpatialOrientation.c::calcOctupoleTensor" ref="a32d3ee4fee5633a62e4310aef4401017" args="(const SlaterDet *Q, const SlaterDetAux *X, double O[27])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcOctupoleTensor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>O</em>[27]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SpatialOrientation_8c_source.html#l00086">86</a> of file <a class="el" href="SpatialOrientation_8c_source.html">SpatialOrientation.c</a>.</p>

<p>References <a class="el" href="CenterofMass_8c_source.html#l00071">calcCMPosition()</a>, <a class="el" href="SlaterDet_8c_source.html#l00591">calcSlaterDetOBME()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00103">par</a>.</p>

<p>Referenced by <a class="el" href="SpatialOrientation_8c_source.html#l00198">calcOrientedOrientation()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> Xcm[3];
  <a class="code" href="CenterofMass_8c.html#a1e6d03a8864c008d5eccd7a0ca7704f0">calcCMPosition</a>(Q, X, Xcm);

  <a class="code" href="structOneBodyOperator.html">OneBodyOperator</a> op_ob_octupole = {<a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>: 27, opt: 1, <a class="code" href="MinimizerDONLP2multivapp_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>: Xcm, me: ob_octupole};

  <a class="code" href="SlaterDet_8c.html#a6635ee67b67d4b93287d558fb8d22504">calcSlaterDetOBME</a>(Q, X, &amp;op_ob_octupole, O);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac976e85596d5fab5140b3e9cd76ee1a4"></a><!-- doxytag: member="SpatialOrientation.c::calcOrientedOrientation" ref="ac976e85596d5fab5140b3e9cd76ee1a4" args="(const SlaterDet *Q, const SlaterDetAux *X, double *alpha, double *beta, double *gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcOrientedOrientation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>gamma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SpatialOrientation_8c_source.html#l00198">198</a> of file <a class="el" href="SpatialOrientation_8c_source.html">SpatialOrientation.c</a>.</p>

<p>References <a class="el" href="SpatialOrientation_8c_source.html#l00049">calcInertiaTensor()</a>, <a class="el" href="SpatialOrientation_8c_source.html#l00086">calcOctupoleTensor()</a>, <a class="el" href="lapack_8h.html#a56951e3b2cfff34c3c24fe137ad0f15a">dsyev()</a>, <a class="el" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>.</p>

<p>Referenced by <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00718">calcgradorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00958">calcgradprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2orthogonalproj_8c_source.html#l00390">calcorthprojectedHamiltonian()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00777">calcprojectedHamiltonian()</a>, <a class="el" href="transformsldet_8c_source.html#l00027">main()</a>, <a class="el" href="SlaterDet_8c_source.html#l00310">moveboostorientSlaterDet()</a>, and <a class="el" href="SlaterDet_8c_source.html#l00339">orientSlaterDet()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> T[3][3];
  <span class="keywordtype">double</span> O[3][3][3];
  <span class="keywordtype">int</span> i,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,<a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>;

  <a class="code" href="SpatialOrientation_8c.html#ad33471b82b8b003bcdb578b82b82bb90" title="calculate mass inertia tensor">calcInertiaTensor</a>(Q, X, T);
  <a class="code" href="SpatialOrientation_8c.html#a32d3ee4fee5633a62e4310aef4401017">calcOctupoleTensor</a>(Q, X, O);

  <span class="keywordtype">char</span> JOBZ=<span class="charliteral">&#39;V&#39;</span>;
  <span class="keywordtype">char</span> UPLO=<span class="charliteral">&#39;U&#39;</span>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a>=3;
  <span class="keywordtype">double</span> W[3];
  <span class="keywordtype">double</span> WORK[15];
  <span class="keywordtype">int</span> LWORK=15;
  <span class="keywordtype">int</span> INFO;

  <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#a56951e3b2cfff34c3c24fe137ad0f15a">dsyev</a>)(&amp;JOBZ, &amp;UPLO, &amp;N, (<span class="keywordtype">double</span>*)T, &amp;N, W, WORK, &amp;LWORK, &amp;INFO);

  <span class="comment">// axis with smallest eigenvalue to become z axis</span>

  <span class="keywordtype">int</span> imin=0;
  <span class="keywordtype">double</span> minw=fabs(W[0]);

  <span class="keywordflow">for</span> (i=1; i&lt;3; i++)
    <span class="keywordflow">if</span> (fabs(W[i]) &lt; minw) {
      imin = i;
      minw = fabs(W[i]);
    }

  <span class="comment">// align z-axis with symmetry axis</span>
  <span class="keywordtype">double</span> dummy;
  <span class="keywordflow">for</span> (i=0; i&lt;3; i++) {
    dummy = T[2][i];
    T[2][i] = T[imin][i];
    T[imin][i] = dummy;
  }

  <span class="comment">// we want a pure rotation</span>
  <span class="keywordflow">if</span> (det(T) &lt; 0.0)
    <span class="keywordflow">for</span> (i=0; i&lt;3; i++)
      T[0][i] *= -1;

  <span class="comment">// inertia tensor is invariant under Ry(180deg)</span>
  <span class="comment">// use sign of octupole moment to select orientation </span>
  <span class="keywordtype">double</span> Ozzz = 0.0;
  
  <span class="keywordflow">for</span> (i=0; i&lt;3; i++)
    <span class="keywordflow">for</span> (j=0; j&lt;3; j++)
      <span class="keywordflow">for</span> (k=0; k&lt;3; k++)
        Ozzz += T[2][i]*T[2][j]*T[2][k]*O[i][j][k];

  fprintf(stderr, <span class="stringliteral">&quot;... Ozzz: %8.5f\n&quot;</span>, Ozzz);

  <span class="comment">// Ry(180deg)</span>
  <span class="keywordflow">if</span> (Ozzz &lt; 0.0) {
    <span class="keywordflow">for</span> (i=0; i&lt;3; i++) {
      T[0][i] *= -1;
      T[2][i] *= -1;
    }
  }

  RotationMatrixToEulerAngles(T, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, gamma);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a35dc15bd8ec3baed1f008ef416af1fe4"></a><!-- doxytag: member="SpatialOrientation.c::calcSpatialOrientation" ref="a35dc15bd8ec3baed1f008ef416af1fe4" args="(const SlaterDet *Q, const SlaterDetAux *X, double *alpha, double *beta, double *gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSpatialOrientation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>gamma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate euler angles to describe orientation of mass distribution Slater determinant center of mass should be in origin </p>

<p>Definition at line <a class="el" href="SpatialOrientation_8c_source.html#l00145">145</a> of file <a class="el" href="SpatialOrientation_8c_source.html">SpatialOrientation.c</a>.</p>

<p>References <a class="el" href="SpatialOrientation_8c_source.html#l00049">calcInertiaTensor()</a>, <a class="el" href="lapack_8h.html#a56951e3b2cfff34c3c24fe137ad0f15a">dsyev()</a>, <a class="el" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>.</p>

<p>Referenced by <a class="el" href="calcdensities3d_8c_source.html#l00032">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> T[3][3];

  <a class="code" href="SpatialOrientation_8c.html#ad33471b82b8b003bcdb578b82b82bb90" title="calculate mass inertia tensor">calcInertiaTensor</a>(Q, X, T);

  <span class="keywordtype">char</span> JOBZ=<span class="charliteral">&#39;V&#39;</span>;
  <span class="keywordtype">char</span> UPLO=<span class="charliteral">&#39;U&#39;</span>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a>=3;
  <span class="keywordtype">double</span> W[3];
  <span class="keywordtype">double</span> WORK[15];
  <span class="keywordtype">int</span> LWORK=15;
  <span class="keywordtype">int</span> INFO;

  <a class="code" href="interpol_8h.html#a742b1a3b3d50237eaf54269ea927f452">FORTRAN</a>(<a class="code" href="lapack_8h.html#a56951e3b2cfff34c3c24fe137ad0f15a">dsyev</a>)(&amp;JOBZ, &amp;UPLO, &amp;N, (<span class="keywordtype">double</span>*)T, &amp;N, W, WORK, &amp;LWORK, &amp;INFO);

  <span class="comment">// align supposed symmetry axis with z axis</span>

  <span class="keywordtype">int</span> i;
  <span class="keywordtype">double</span> maxe=0.0;

  <span class="keywordflow">for</span> (i=0; i&lt;3; i++)
    maxe = fmax(maxe, fabs(W[i]));

  <span class="keywordtype">double</span> dif[3], mindif = 1.0;
  <span class="keywordtype">int</span> imin=-1;

  <span class="keywordflow">for</span> (i=0; i&lt;3; i++) {
    dif[i] = fabs(W[(i+1)%3]-W[(i+2)%3])/maxe;
    <span class="keywordflow">if</span> (dif[i] &lt; mindif) {
      mindif = dif[i];
      imin = i;
    }
  }

  <span class="comment">// align z-axis with symmetry axis</span>
  <span class="keywordtype">double</span> dummy;
  <span class="keywordflow">for</span> (i=0; i&lt;3; i++) {
    dummy = T[2][i];
    T[2][i] = T[imin][i];
    T[imin][i] = dummy;
  }

  <span class="keywordflow">if</span> (det(T) &lt; 0.0)
    <span class="keywordflow">for</span> (i=0; i&lt;3; i++)
      T[0][i] *= -1;


  RotationMatrixToEulerAngles(T, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, gamma);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3e40deaeee0d028e1050280c476b201e"></a><!-- doxytag: member="SpatialOrientation.c::calcSpinOrientation" ref="a3e40deaeee0d028e1050280c476b201e" args="(const SlaterDet *Q, const SlaterDetAux *X, double *alpha, double *beta, double *gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcSpinOrientation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>gamma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>spin orientation with respect to z-axis </p>

<p>Definition at line <a class="el" href="SpatialOrientation_8c_source.html#l00266">266</a> of file <a class="el" href="SpatialOrientation_8c_source.html">SpatialOrientation.c</a>.</p>

<p>References <a class="el" href="AngularMomenta_8c_source.html#l00248">calcJ()</a>, and <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00125">J2</a>.</p>

<p>Referenced by <a class="el" href="transformsldet_8c_source.html#l00027">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> J[3];

  <a class="code" href="AngularMomenta_8c.html#a15ef50bc6871388ecd6c8f707cbaaba1" title="calculate Jx, Jy, Jz">calcJ</a>(Q, X, J);

  <span class="keywordtype">double</span> Jxy=sqrt(J[0]*J[0]+J[1]*J[1]);
  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a81cec3098e89ee382a344824eef3d2e4">J2</a>=sqrt(J[0]*J[0]+J[1]*J[1]+J[2]*J[2]);

  *<a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a> = (J[1] &gt; 0.0 ? +1 : -1)* acos(J[0]/Jxy);
  *beta = acos(J[2]/J2);
  *gamma = 0.0;
}
</pre></div></p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
