<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/ProjectedDensityMatrixHO.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>fmd/ProjectedDensityMatrixHO.c File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;complex.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="Gaussian_8h_source.html">Gaussian.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Projection_8h_source.html">Projection.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="HOBasis_8h_source.html">HOBasis.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="DensityMatrixHO_8h_source.html">DensityMatrixHO.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ProjectedDensityMatrixHO_8h_source.html">ProjectedDensityMatrixHO.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cmath_8h_source.html">numerics/cmath.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="physics_8h_source.html">misc/physics.h</a>&quot;</code><br/>

<p><a href="ProjectedDensityMatrixHO_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)&nbsp;&nbsp;&nbsp;((<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>) &lt; 0 ? -(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>) : (<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>, y)&nbsp;&nbsp;&nbsp;((<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)&lt;(y) ? (<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>) : (y))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#ad7730f013ba69218e3f0d3ec7550f67a">NMAXOUTPUT</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#a9bc66e4069ea8ad1416b8678736434c9">initOpDiagonalDensityMatrixHO</a> (<a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#a13568471fb9fa5feec6e0f1ea5fb74c9">calcDiagonalDensityMatrixHOod</a> (<a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, complex double *rhodiag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#a9c28e08ac25b9cc8ebf9fb02b2925a4b">writeprojectedDiagonalDensityMatrixHO</a> (FILE *fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *dmpar, int <a class="el" href="MinimizerDONLP2vappiso_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, int pi, int a, void *dmatrix, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#a1338c41ef46cc63e0db079b45cd6c21b">writeprojectedDiagonalDensityMatricesHO</a> (FILE *fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *dmpar, void *dmatrix, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#a749520073e250d8dbbc5957ae7ec1f77">writeprojectedDiagonalTransitionDensityMatrixHO</a> (FILE *fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *dmpar, int <a class="el" href="MinimizerDONLP2vappiso_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, int pi, int af, int ai, void *dmatrix, const <a class="el" href="structEigenstates.html">Eigenstates</a> *E)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#ad3eb40e97bcce42b75641fe619d1ab4d">OpDiagonalDensityMatrixHO</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">complex double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProjectedDensityMatrixHO_8c.html#a103956ea26133e0b04f20e47636c5f03">rho</a> [4 *HODIMMAX *4 *HODIMMAX]</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>calculate the projected density matrix in harmonic oscillator basis</p>
<p>(c) 2006 Thomas Neff </p>

<p>Definition in file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a996f7be338ccb40d1a2a5abc1ad61759"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::ABS" ref="a996f7be338ccb40d1a2a5abc1ad61759" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ABS</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"><a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;((<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>) &lt; 0 ? -(<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>) : (<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00031">31</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>Referenced by <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00068">calcDiagonalDensityMatrixHOod()</a>, <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00102">writeprojectedDiagonalDensityMatrixHO()</a>, and <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00205">writeprojectedDiagonalTransitionDensityMatrixHO()</a>.</p>

</div>
</div>
<a class="anchor" id="a74e75242132eaabbc1c512488a135926"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::MIN" ref="a74e75242132eaabbc1c512488a135926" args="(x, y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"><a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">y</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>&nbsp;&nbsp;&nbsp;((<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>)&lt;(y) ? (<a class="el" href="donlp2_8h.html#a693a5a39c68cf597f5264260a0f2e380">x</a>) : (y))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00032">32</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>Referenced by <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00179">writeprojectedDiagonalDensityMatricesHO()</a>.</p>

</div>
</div>
<a class="anchor" id="ad7730f013ba69218e3f0d3ec7550f67a"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::NMAXOUTPUT" ref="ad7730f013ba69218e3f0d3ec7550f67a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NMAXOUTPUT&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00177">177</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>Referenced by <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00179">writeprojectedDiagonalDensityMatricesHO()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a13568471fb9fa5feec6e0f1ea5fb74c9"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::calcDiagonalDensityMatrixHOod" ref="a13568471fb9fa5feec6e0f1ea5fb74c9" args="(DensityMatrixHOPar *par, const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, complex double *rhodiag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcDiagonalDensityMatrixHOod </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double *&nbsp;</td>
          <td class="paramname"> <em>rhodiag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00068">68</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>References <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00031">ABS</a>, <a class="el" href="DensityMatrixHO_8c_source.html#l00094">calcDensityMatrixHOod()</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="HOBasis_8c_source.html#l00135">dimHOBasis()</a>, <a class="el" href="HOBasis_8c_source.html#l00153">HOxinljmidx()</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>, <a class="el" href="DensityMatrixHO_8h_source.html#l00023">DensityMatrixHOPar::nmax</a>, and <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00065">rho</a>.</p>

<p>Referenced by <a class="el" href="DiagonalDensityHOSlave_8c_source.html#l00026">DiagonalDensityHOSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a> = <a class="code" href="HOBasis_8c.html#a331ea1f326cb2b1c9f5c974db0296f2a">dimHOBasis</a>(par-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>);
  <span class="keywordtype">int</span> idx;

  <a class="code" href="DensityMatrixHO_8c.html#a0ed59bad81fa4af8d6be2fc0bd44fcd9">calcDensityMatrixHOod</a>(par, Q, Qp, X, <a class="code" href="ProjectedDensityMatrixHO_8c.html#a103956ea26133e0b04f20e47636c5f03">rho</a>);

  <span class="keywordtype">int</span> orbit, ixi, xi, <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a>, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, twoj, twom; 

  orbit = 0;
  <span class="keywordflow">for</span> (N=0; N&lt;=par-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>; N++) {

    <span class="keywordflow">for</span> (ixi=0; ixi&lt;=1; ixi++) {
      xi = ixi ? -1 : +1;

      <span class="keywordflow">for</span> (n=N/2; n&gt;=0; n--) {
        l=N-2*n;
        <span class="keywordflow">for</span> (twoj=<a class="code" href="ProjectedDensityMatrixHO_8c.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(2*l-1); twoj&lt;=2*l+1; twoj=twoj+2) {
          rhodiag[orbit] = 0.0;
          <span class="keywordflow">for</span> (twom=-twoj; twom&lt;=twoj; twom=twom+2) {
            idx = <a class="code" href="HOBasis_8c.html#a8f9242ba521192defbb05c248df2c84c">HOxinljmidx</a>(xi, n, l, twoj, twom);
            rhodiag[orbit] += <a class="code" href="ProjectedDensityMatrixHO_8c.html#a103956ea26133e0b04f20e47636c5f03">rho</a>[idx+idx*dim];
          }
          orbit++;
        }       
      }
    }
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9bc66e4069ea8ad1416b8678736434c9"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::initOpDiagonalDensityMatrixHO" ref="a9bc66e4069ea8ad1416b8678736434c9" args="(DensityMatrixHOPar *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initOpDiagonalDensityMatrixHO </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00050">50</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="physics_8c_source.html#l00031">hbc</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="DensityMatrixHO_8h_source.html#l00023">DensityMatrixHOPar::nmax</a>, <a class="el" href="DensityMatrixHO_8h_source.html#l00025">DensityMatrixHOPar::omega</a>, <a class="el" href="Projection_8h_source.html#l00117">ManyBodyOperator::par</a>, and <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>.</p>

<p>Referenced by <a class="el" href="calcoccupationnumbershoproj_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span>* opname = malloc(40*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
  sprintf(opname, <span class="stringliteral">&quot;DiagonalDensityMatrixHO-%d-%05.2f&quot;</span>, 
          par-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>, <a class="code" href="physics_8c.html#ac84f9a1ea91a60ec41b71eb31f90eb4c" title="hbarc [MeV fm]">hbc</a>*par-&gt;<a class="code" href="structDensityMatrixHOPar.html#a5e7e7f154825cca84af584c9248d72e4">omega</a>);
  
  <a class="code" href="ProjectedDensityMatrixHO_8c.html#ad3eb40e97bcce42b75641fe619d1ab4d">OpDiagonalDensityMatrixHO</a>.<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a> = opname;
  <a class="code" href="ProjectedDensityMatrixHO_8c.html#ad3eb40e97bcce42b75641fe619d1ab4d">OpDiagonalDensityMatrixHO</a>.<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a> = (par-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>+1)*(par-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>+2);
  <a class="code" href="ProjectedDensityMatrixHO_8c.html#ad3eb40e97bcce42b75641fe619d1ab4d">OpDiagonalDensityMatrixHO</a>.<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a> = <a class="code" href="ProjectedDensityMatrixHO_8c.html#ad3eb40e97bcce42b75641fe619d1ab4d">OpDiagonalDensityMatrixHO</a>.<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a>;
  <a class="code" href="ProjectedDensityMatrixHO_8c.html#ad3eb40e97bcce42b75641fe619d1ab4d">OpDiagonalDensityMatrixHO</a>.<a class="code" href="structManyBodyOperator.html#a05268b1b149040fd992263f2e22de7ec">par</a> = par;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1338c41ef46cc63e0db079b45cd6c21b"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::writeprojectedDiagonalDensityMatricesHO" ref="a1338c41ef46cc63e0db079b45cd6c21b" args="(FILE *fp, const Projection *P, const DensityMatrixHOPar *dmpar, void *dmatrix, const Eigenstates *E)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeprojectedDiagonalDensityMatricesHO </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *&nbsp;</td>
          <td class="paramname"> <em>dmpar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dmatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00179">179</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>References <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00032">MIN</a>, <a class="el" href="Projection_8h_source.html#l00146">Eigenstates::ngood</a>, <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00177">NMAXOUTPUT</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, and <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00102">writeprojectedDiagonalDensityMatrixHO()</a>.</p>

<p>Referenced by <a class="el" href="calcoccupationnumbershoproj_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> p,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>,i;
  <span class="keywordtype">int</span> ngood;

  <span class="keywordflow">for</span> (p=0; p&lt;=1; p++)
    <span class="keywordflow">for</span> (j=odd; j&lt;jmax; j=j+2) {

      ngood = E-&gt;<a class="code" href="structEigenstates.html#a44b4a004824004e5635d83048d875e21" title="number of eigenstates considered as &amp;quot;good&amp;quot;">ngood</a>[idxpij(jmax,p,j)];

      <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="ProjectedDensityMatrixHO_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(ngood, <a class="code" href="ProjectedDensityMatrixHO_8c.html#ad7730f013ba69218e3f0d3ec7550f67a">NMAXOUTPUT</a>); i++) {

        <a class="code" href="ProjectedDensityMatrixHO_8c.html#a9c28e08ac25b9cc8ebf9fb02b2925a4b">writeprojectedDiagonalDensityMatrixHO</a>(fp, P, dmpar, j, p, i, dmatrix, E);
      
      }
    }

}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c28e08ac25b9cc8ebf9fb02b2925a4b"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::writeprojectedDiagonalDensityMatrixHO" ref="a9c28e08ac25b9cc8ebf9fb02b2925a4b" args="(FILE *fp, const Projection *P, const DensityMatrixHOPar *dmpar, int j, int pi, int a, void *dmatrix, const Eigenstates *E)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeprojectedDiagonalDensityMatrixHO </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *&nbsp;</td>
          <td class="paramname"> <em>dmpar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dmatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00102">102</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>References <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00031">ABS</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a>, <a class="el" href="physics_8c_source.html#l00031">hbc</a>, <a class="el" href="HOBasis_8h_source.html#l00021">HONMAX</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00171">labelHOorbit()</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>, <a class="el" href="DensityMatrixHO_8h_source.html#l00023">DensityMatrixHOPar::nmax</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, and <a class="el" href="Projection_8h_source.html#l00143">Eigenstates::v</a>.</p>

<p>Referenced by <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00179">writeprojectedDiagonalDensityMatricesHO()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> nmax=dmpar-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=(dmpar-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>+1)*(dmpar-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>+2);
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> ipj = idxpij(jmax,pi,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>);
  <span class="keywordtype">int</span> idx = E-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipj][a];
  <span class="keywordtype">double</span> norm = E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][idx];
  <span class="keywordtype">double</span> <a class="code" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a> = E-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[ipj][idx];

  complex double (**dm)[dim] = dmatrix;
  complex <span class="keywordtype">double</span> *noccu = dm[ipj][idx];

  <span class="keywordtype">char</span> prefix[8];
  <span class="keywordflow">if</span>(odd) sprintf(prefix, <span class="stringliteral">&quot;[%d/2%c]&quot;</span>, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, pi ? <span class="charliteral">&#39;-&#39;</span> : <span class="charliteral">&#39;+&#39;</span>); 
  <span class="keywordflow">else</span>    sprintf(prefix, <span class="stringliteral">&quot;[%d%c]&quot;</span>, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>/2, pi ? <span class="charliteral">&#39;-&#39;</span> : <span class="charliteral">&#39;+&#39;</span>); 


  fprintf(fp, <span class="stringliteral">&quot;\n%s (%8.3f MeV) occupation numbers: \n&quot;</span>,
          prefix, <a class="code" href="physics_8c.html#ac84f9a1ea91a60ec41b71eb31f90eb4c" title="hbarc [MeV fm]">hbc</a>*H);

  <span class="keywordtype">int</span> i;
  <span class="keywordtype">int</span> orbit;
  <span class="keywordtype">double</span> nshell, norbit[<a class="code" href="HOBasis_8h.html#a694e963fcc125104dfaff0e3c7deb3ac">HONMAX</a>+1];
  <span class="keywordtype">int</span> ixi, xi, <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a>, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, twoj;

  i=0;
  <span class="keywordflow">for</span> (N=0; N&lt;=nmax; N++) {

    fprintf(fp, <span class="stringliteral">&quot;\n   N=%d\t\t&quot;</span>, N);
    <span class="keywordflow">for</span> (n=N/2; n&gt;=0; n--) {
      l=N-2*n;
      <span class="keywordflow">for</span> (twoj=<a class="code" href="ProjectedDensityMatrixHO_8c.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(2*l-1); twoj&lt;=2*l+1; twoj=twoj+2)
        fprintf(fp, <span class="stringliteral">&quot;%s\t&quot;</span>, <a class="code" href="HOBasis_8c.html#a26ec7640351d490f76d81537fcbb4632">labelHOorbit</a>(n, l, twoj));
    }
    fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);

    <span class="keywordflow">for</span> (ixi=0; ixi&lt;=1; ixi++) {
      xi = ixi ? -1 : +1;
      fprintf(fp, <span class="stringliteral">&quot;%c  &quot;</span>, ixi ? <span class="charliteral">&#39;n&#39;</span> : <span class="charliteral">&#39;p&#39;</span>);

      nshell = 0.0;
      orbit = 0;
      <span class="keywordflow">for</span> (n=N/2; n&gt;=0; n--) {
        l=N-2*n;
        <span class="keywordflow">for</span> (twoj=<a class="code" href="ProjectedDensityMatrixHO_8c.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(2*l-1); twoj&lt;=2*l+1; twoj=twoj+2) {
          norbit[orbit] = noccu[i]/norm;
          i++;
          nshell += norbit[orbit];
          orbit++;
        }
      }

      fprintf(fp, <span class="stringliteral">&quot;%6.3f\t&quot;</span>, nshell);
      <span class="keywordflow">for</span> (orbit=0; orbit&lt;=N; orbit++)
        fprintf(fp, <span class="stringliteral">&quot;%6.3f\t&quot;</span>, norbit[orbit]);
      fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
    }
  }
  
  <span class="keywordtype">double</span> ntot = 0.0;
  <span class="keywordflow">for</span> (i=0; i&lt;dim; i++)
    ntot += noccu[i]/norm;

  fprintf(fp, <span class="stringliteral">&quot;\nTotal Occupation: %6.3f\n&quot;</span>, ntot);

}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a749520073e250d8dbbc5957ae7ec1f77"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::writeprojectedDiagonalTransitionDensityMatrixHO" ref="a749520073e250d8dbbc5957ae7ec1f77" args="(FILE *fp, const Projection *P, const DensityMatrixHOPar *dmpar, int j, int pi, int af, int ai, void *dmatrix, const Eigenstates *E)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeprojectedDiagonalTransitionDensityMatrixHO </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structDensityMatrixHOPar.html">DensityMatrixHOPar</a> *&nbsp;</td>
          <td class="paramname"> <em>dmpar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>af</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dmatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>E</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00205">205</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>References <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00031">ABS</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00122">dim</a>, <a class="el" href="physics_8c_source.html#l00031">hbc</a>, <a class="el" href="HOBasis_8h_source.html#l00021">HONMAX</a>, <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="HOBasis_8c_source.html#l00050">l</a>, <a class="el" href="HOBasis_8c_source.html#l00171">labelHOorbit()</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00124">N</a>, <a class="el" href="DensityMatrixHO_8h_source.html#l00023">DensityMatrixHOPar::nmax</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="Projection_8h_source.html#l00094">Projection::odd</a>, <a class="el" href="donlp2_8h_source.html#l00117">phase</a>, and <a class="el" href="Projection_8h_source.html#l00143">Eigenstates::v</a>.</p>

<p>Referenced by <a class="el" href="calctransitionnumbershoproj_8c_source.html#l00031">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> nmax=dmpar-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a>=(dmpar-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>+1)*(dmpar-&gt;<a class="code" href="structDensityMatrixHOPar.html#a17edc3e75ba653c2e7f90827a48904ee">nmax</a>+2);
  <span class="keywordtype">int</span> odd=P-&gt;<a class="code" href="structProjection.html#acac5e7c756632311adca04f228e8886e" title="odd particle number - half integer spin">odd</a>;
  <span class="keywordtype">int</span> jmax=P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> ipj = idxpij(jmax,pi,<a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>);
  <span class="keywordtype">int</span> idxf = E-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipj][af];
  <span class="keywordtype">int</span> idxi = E-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipj][ai];
  <span class="keywordtype">double</span> normf = E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][idxf];
  <span class="keywordtype">double</span> normi = E-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipj][idxi];
  <span class="keywordtype">double</span> Hf = E-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[ipj][idxf];
  <span class="keywordtype">double</span> Hi = E-&gt;<a class="code" href="structEigenstates.html#ade09c5713d0d08f69ed61126f1c8d075" title="energy eigenvalues">v</a>[ipj][idxi];

  complex double (****dm)[dim] = dmatrix;
  complex <span class="keywordtype">double</span> *transm = dm[ipj][ipj][idxf][idxi];

  complex <span class="keywordtype">double</span> <a class="code" href="donlp2_8h.html#accf3aec63bc20b3c99ab4881cb07c05b">phase</a>;

  <span class="comment">// get rid of possible phase factors</span>
  phase = transm[0]/cabs(transm[0]);

  <span class="keywordtype">char</span> prefix[8];
  <span class="keywordflow">if</span>(odd) sprintf(prefix, <span class="stringliteral">&quot;[%d/2%c]&quot;</span>, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, pi ? <span class="charliteral">&#39;-&#39;</span> : <span class="charliteral">&#39;+&#39;</span>); 
  <span class="keywordflow">else</span>    sprintf(prefix, <span class="stringliteral">&quot;[%d%c]&quot;</span>, <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>/2, pi ? <span class="charliteral">&#39;-&#39;</span> : <span class="charliteral">&#39;+&#39;</span>); 


  fprintf(fp, <span class="stringliteral">&quot;\n%s (%8.3f MeV -&gt; %8.3f MeV) transition numbers: \n&quot;</span>,
          prefix, <a class="code" href="physics_8c.html#ac84f9a1ea91a60ec41b71eb31f90eb4c" title="hbarc [MeV fm]">hbc</a>*Hi, <a class="code" href="physics_8c.html#ac84f9a1ea91a60ec41b71eb31f90eb4c" title="hbarc [MeV fm]">hbc</a>*Hf);

  <span class="keywordtype">int</span> i;
  <span class="keywordtype">int</span> orbit;
  <span class="keywordtype">double</span> nshell, norbit[<a class="code" href="HOBasis_8h.html#a694e963fcc125104dfaff0e3c7deb3ac">HONMAX</a>+1];
  <span class="keywordtype">int</span> ixi, xi, <a class="code" href="MinimizerDONLP2multivapp_8c.html#afa106e3c58721409e0e2c7ae6980cf25">N</a>, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>, twoj;

  i=0;
  <span class="keywordflow">for</span> (N=0; N&lt;=nmax; N++) {

    fprintf(fp, <span class="stringliteral">&quot;\n   N=%d\t\t&quot;</span>, N);
    <span class="keywordflow">for</span> (n=N/2; n&gt;=0; n--) {
      l=N-2*n;
      <span class="keywordflow">for</span> (twoj=<a class="code" href="ProjectedDensityMatrixHO_8c.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(2*l-1); twoj&lt;=2*l+1; twoj=twoj+2)
        fprintf(fp, <span class="stringliteral">&quot;%s\t&quot;</span>, <a class="code" href="HOBasis_8c.html#a26ec7640351d490f76d81537fcbb4632">labelHOorbit</a>(n, l, twoj));
    }
    fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);

    <span class="keywordflow">for</span> (ixi=0; ixi&lt;=1; ixi++) {
      xi = ixi ? -1 : +1;
      fprintf(fp, <span class="stringliteral">&quot;%c  &quot;</span>, ixi ? <span class="charliteral">&#39;n&#39;</span> : <span class="charliteral">&#39;p&#39;</span>);

      nshell = 0.0;
      orbit = 0;
      <span class="keywordflow">for</span> (n=N/2; n&gt;=0; n--) {
        l=N-2*n;
        <span class="keywordflow">for</span> (twoj=<a class="code" href="ProjectedDensityMatrixHO_8c.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(2*l-1); twoj&lt;=2*l+1; twoj=twoj+2) {
          norbit[orbit] = creal(transm[i]/phase)/sqrt(normi*normf);
          i++;
          nshell += norbit[orbit];
          orbit++;
        }
      }

      fprintf(fp, <span class="stringliteral">&quot;%6.3f\t&quot;</span>, nshell);
      <span class="keywordflow">for</span> (orbit=0; orbit&lt;=N; orbit++)
        fprintf(fp, <span class="stringliteral">&quot;%6.3f\t&quot;</span>, norbit[orbit]);
      fprintf(fp, <span class="stringliteral">&quot;\n&quot;</span>);
    }
  }
  
  <span class="keywordtype">double</span> ntot = 0.0;
  <span class="keywordflow">for</span> (i=0; i&lt;dim; i++)
    ntot += creal(transm[i]/phase)/sqrt(normi*normf);

  fprintf(fp, <span class="stringliteral">&quot;\nTotal Strength: %6.3f\n&quot;</span>, ntot);

}
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ad3eb40e97bcce42b75641fe619d1ab4d"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::OpDiagonalDensityMatrixHO" ref="ad3eb40e97bcce42b75641fe619d1ab4d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> <a class="el" href="ProjectedDensityMatrixHO_8h.html#ad3eb40e97bcce42b75641fe619d1ab4d">OpDiagonalDensityMatrixHO</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
  name : NULL,
  rank : 0,
  pi : 0,
  <a class="code" href="MinimizerDONLP2multivapp_8c.html#ad5bd801f521717ed9f092360c3ba3b5e">dim</a> : 0,
  size : 0,
  <a class="code" href="MinimizerDONLP2multivapp_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a> : NULL,
  me : <a class="code" href="ProjectedDensityMatrixHO_8c.html#a13568471fb9fa5feec6e0f1ea5fb74c9">calcDiagonalDensityMatrixHOod</a>
}
</pre></div>
<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00039">39</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>Referenced by <a class="el" href="calcoccupationnumbershoproj_8c_source.html#l00030">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a103956ea26133e0b04f20e47636c5f03"></a><!-- doxytag: member="ProjectedDensityMatrixHO.c::rho" ref="a103956ea26133e0b04f20e47636c5f03" args="[4 *HODIMMAX *4 *HODIMMAX]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="donlp2_8h.html#a3ed57096651b587c2bf716fa78048153">rho</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00065">65</a> of file <a class="el" href="ProjectedDensityMatrixHO_8c_source.html">ProjectedDensityMatrixHO.c</a>.</p>

<p>Referenced by <a class="el" href="ProjectedDensityMatrixHO_8c_source.html#l00068">calcDiagonalDensityMatrixHOod()</a>, <a class="el" href="calcoccupationnumbersho_8c_source.html#l00030">main()</a>, <a class="el" href="Formfactors_8c_source.html#l00470">writeChargeDensities()</a>, <a class="el" href="Formfactors_8c_source.html#l00410">writeMatterDensities()</a>, <a class="el" href="Formfactors_8c_source.html#l00348">writePointDensities()</a>, <a class="el" href="Formfactors_8c_source.html#l00645">writeTransitionChargeDensities()</a>, and <a class="el" href="Formfactors_8c_source.html#l00569">writeTransitionPointDensities()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
