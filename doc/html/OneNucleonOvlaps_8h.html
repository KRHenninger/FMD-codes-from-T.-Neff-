<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FMD: fmd/OneNucleonOvlaps.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>fmd/OneNucleonOvlaps.h File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="SlaterDet_8h_source.html">SlaterDet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="Projection_8h_source.html">Projection.h</a>&quot;</code><br/>

<p><a href="OneNucleonOvlaps_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOneNucleonOvlapsPara.html">OneNucleonOvlapsPara</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="OneNucleonOvlaps_8h.html#ade1df1cb82ae4ef9a5c0cddb37d9a73b">NSPEC</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="OneNucleonOvlaps_8h.html#a56ecf80ddf9511eb72ae2fff376e6cb3">DIMSPEC</a>&nbsp;&nbsp;&nbsp;18</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="OneNucleonOvlaps_8h.html#a1d81975fc00ddd64d268364c0f48941d">initOpOneNucleonOvlaps</a> (<a class="el" href="structOneNucleonOvlapsPara.html">OneNucleonOvlapsPara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="OneNucleonOvlaps_8h.html#a6bf7448e9dcb9145c8e1c7621f301933">calcOneNucleonOvlapsod</a> (<a class="el" href="structOneNucleonOvlapsPara.html">OneNucleonOvlapsPara</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ab2c55582dfa6bab91946cc148b3578cd">par</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#ac4f7151b4c1c951d242ff9f8856381a0">Q</a>, const <a class="el" href="structSlaterDet.html">SlaterDet</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a302070733a377867b458d28f3146454f">Qp</a>, const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a40641ce31f478e07b357ff308ee3e47f">X</a>, complex double *specamplitude)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="OneNucleonOvlaps_8h.html#a2728acaa1a11ca7a88592aa838cf4a81">writeOneNucleonOvlaps</a> (FILE *fp, const <a class="el" href="structProjection.html">Projection</a> *<a class="el" href="MinimizerDONLP2vappiso_8c.html#a937218b25a684555a6d94a5058c7b358">P</a>, const <a class="el" href="structOneNucleonOvlapsPara.html">OneNucleonOvlapsPara</a> *p, int jfin, int pfin, int afin, int jini, int pini, int aini, void *specamplitudeme, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Efin, const <a class="el" href="structEigenstates.html">Eigenstates</a> *Eini)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="OneNucleonOvlaps_8h.html#a14a3f5a98f800054572b1b091f81c311">OpOneNucleonOvlap</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structManyBodyOperators.html">ManyBodyOperators</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="OneNucleonOvlaps_8h.html#a5e5ae9b011549095d5187d513702ec5d">OpOneNucleonOvlaps</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>calculate spectroscopic amplitudes in momentum space</p>
<p>(c) 2005-2007 Thomas Neff, Benjamin Hellwig </p>

<p>Definition in file <a class="el" href="OneNucleonOvlaps_8h_source.html">OneNucleonOvlaps.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a56ecf80ddf9511eb72ae2fff376e6cb3"></a><!-- doxytag: member="OneNucleonOvlaps.h::DIMSPEC" ref="a56ecf80ddf9511eb72ae2fff376e6cb3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIMSPEC&nbsp;&nbsp;&nbsp;18</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="OneNucleonOvlaps_8h_source.html#l00033">33</a> of file <a class="el" href="OneNucleonOvlaps_8h_source.html">OneNucleonOvlaps.h</a>.</p>

<p>Referenced by <a class="el" href="OneNucleonOvlapsSlave_8c_source.html#l00033">OneNucleonOvlapsSlave()</a>.</p>

</div>
</div>
<a class="anchor" id="ade1df1cb82ae4ef9a5c0cddb37d9a73b"></a><!-- doxytag: member="OneNucleonOvlaps.h::NSPEC" ref="ade1df1cb82ae4ef9a5c0cddb37d9a73b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NSPEC&nbsp;&nbsp;&nbsp;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="OneNucleonOvlaps_8h_source.html#l00032">32</a> of file <a class="el" href="OneNucleonOvlaps_8h_source.html">OneNucleonOvlaps.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6bf7448e9dcb9145c8e1c7621f301933"></a><!-- doxytag: member="OneNucleonOvlaps.h::calcOneNucleonOvlapsod" ref="a6bf7448e9dcb9145c8e1c7621f301933" args="(OneNucleonOvlapsPara *par, const SlaterDet *Q, const SlaterDet *Qp, const SlaterDetAux *X, complex double *specamplitude)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calcOneNucleonOvlapsod </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structOneNucleonOvlapsPara.html">OneNucleonOvlapsPara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDet.html">SlaterDet</a> *&nbsp;</td>
          <td class="paramname"> <em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSlaterDetAux.html">SlaterDetAux</a> *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex double *&nbsp;</td>
          <td class="paramname"> <em>specamplitude</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="OneNucleonOvlaps_8c_source.html#l00215">215</a> of file <a class="el" href="OneNucleonOvlaps_8c_source.html">OneNucleonOvlaps.c</a>.</p>

<p>References <a class="el" href="SlaterDet_8h_source.html#l00030">SlaterDet::A</a>, <a class="el" href="SlaterDet_8c_source.html#l00264">boostSlaterDet()</a>, <a class="el" href="clebsch_8c_source.html#l00304">clebsch()</a>, <a class="el" href="SlaterDet_8c_source.html#l00180">copySlaterDet()</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00042">dimo</a>, <a class="el" href="gaussquad_8c_source.html#l00045">GaussLegendrePoints()</a>, <a class="el" href="SlaterDet_8c_source.html#l00041">initSlaterDet()</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00041">io</a>, <a class="el" href="MinimizerDONLP2multivapp_8c_source.html#l00102">j</a>, <a class="el" href="HOBasis_8c_source.html#l00051">m</a>, <a class="el" href="physics_8c_source.html#l00033">mneutron</a>, <a class="el" href="physics_8c_source.html#l00032">mproton</a>, <a class="el" href="SlaterDet_8h_source.html#l00032">SlaterDet::N</a>, <a class="el" href="HOBasis_8c_source.html#l00049">n</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00026">OneNucleonOvlapsPara::nalpha</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00027">OneNucleonOvlapsPara::ncosb</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00025">OneNucleonOvlapsPara::npoints</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00024">OneNucleonOvlapsPara::qmax</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00028">OneNucleonOvlapsPara::recoil</a>, <a class="el" href="gaussquad_8c_source.html#l00255">ShiftedPeriodicTrapezoidalPoints()</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00039">specj</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00040">specl</a>, <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>, <a class="el" href="sphericalharmonics_8c_source.html#l00025">Y()</a>, and <a class="el" href="SlaterDet_8h_source.html#l00031">SlaterDet::Z</a>.</p>

<p>Referenced by <a class="el" href="OneNucleonOvlapsSlave_8c_source.html#l00033">OneNucleonOvlapsSlave()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> qmax = par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a4d8ef3bb676dc775742a4cc9748288e7">qmax</a>;
  <span class="keywordtype">int</span> ialpha, nalpha = par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a2d02d16c65727571705d14464bb6000f">nalpha</a>;
  <span class="keywordtype">int</span> icosb, ncosb = par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#aaaa4b55ab58bc37550b6d273b2687ac0">ncosb</a>;
  <span class="keywordtype">int</span> npoints = par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a82775128fc0a957ce02701e9e7ec471e">npoints</a>;
  <span class="keywordtype">int</span> <a class="code" href="HOBasis_8c.html#a742204794ea328ba293fe59cec79b990">m</a>, ml, ms, o, i;
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a37d972ae0b47b9099e30983131d31916">j</a>, <a class="code" href="HOBasis_8c.html#a89606eca6b563ec68d2da2e84657736f">l</a>;
  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2multivapp_8c.html#a20f4c4490bc8ecbdd1ffcb79acce6035" title="finestructure constant">alpha</a>, beta, weight;
  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2_8c.html#a116d67c73cdfa395275c96c0151ddcd4">q</a>, <a class="code" href="MinimizerDONLP2orthogonalproj_8c.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>[3];
  complex <span class="keywordtype">double</span> sa[2];
  <span class="keywordtype">int</span> gaussoverlapsdone = 0;

  <span class="comment">// initialize workspace if necessary</span>
  <span class="keywordflow">if</span> (!QAp) {
    QAp = malloc(<span class="keyword">sizeof</span>(<a class="code" href="structSlaterDet.html" title="Slater Determinant.">SlaterDet</a>));
    <a class="code" href="SlaterDet_8c.html#a16db6f53cfee239b7d506c86bc372686">initSlaterDet</a>(QA, QAp);
    
    <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(QB-&gt;A)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
    nlu = malloc(<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(QB-&gt;A)*<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>));
  }

  <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(QA, QAp);

  <span class="comment">// add single nucleon with momentum q</span>
  <span class="comment">// proton or neutron ?</span>
  <span class="keywordtype">int</span> <a class="code" href="MinimizerDONLP2vappiso_8c.html#a8d84be5ae01eee28a4a7932c6e568d27">iso</a> = (QA-&gt;Z == QB-&gt;Z) ? -1 : +1;
  <span class="keywordtype">double</span> massA = QA-&gt;Z*<a class="code" href="physics_8c.html#a8eb62e76681c15cad3ccab9c10160c14" title="proton mass [fm^-1]">mproton</a>+QA-&gt;N*<a class="code" href="physics_8c.html#a2da201ca1cde1f55795ebdf8f65c524d" title="neutron mass [fm^-1]">mneutron</a>;

  <span class="keywordflow">for</span> (o=0; o&lt;NSPEC; o++)
    <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="OneNucleonOvlaps_8c.html#a0d11ff77b25d124a8da3e15837b1e4b8">dimo</a>[o]*npoints; i++)
      specamplitude[i+<a class="code" href="OneNucleonOvlaps_8c.html#a13396ab49d1309c7c94166be31333904">io</a>[o]*npoints] = 0.0;

  <span class="keywordtype">double</span> alphal[nalpha], walphal[nalpha];
  <span class="keywordtype">double</span> cosbl[ncosb], wcosbl[ncosb];
  
  <a class="code" href="gaussquad_8c.html#a4c0554e8a66b1be46ead18ca02290a2d">ShiftedPeriodicTrapezoidalPoints</a>(nalpha, 0, 2*M_PI, 0.0, alphal, walphal);
  <a class="code" href="gaussquad_8c.html#aef4fbaefecb9e1201af41ba17d6f8845" title="weight function 1">GaussLegendrePoints</a>(ncosb, -1, 1, cosbl, wcosbl); 

  <span class="keywordflow">for</span> (i=0; i&lt;npoints; i++) {
    q = qmax* i/(npoints-1);
    <span class="keywordflow">for</span> (ialpha=0; ialpha&lt;nalpha; ialpha++)
      <span class="keywordflow">for</span> (icosb=0; icosb&lt;ncosb; icosb++) {
        alpha = alphal[ialpha];
        beta = acos(cosbl[icosb]);
        weight = walphal[ialpha]*wcosbl[icosb];
 
        k[0] = q*cos(alpha)*sin(beta); 
        k[1] = q*sin(alpha)*sin(beta);
        k[2] = q*cos(beta);

        <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a4bf08246692e2a321bb4dbb7679f24df">recoil</a>) {
          <span class="comment">// boost QA by -k</span>
          <span class="keywordtype">double</span> VcmA[3] = {-k[0]/massA, -k[1]/massA, -k[2]/massA};
          <a class="code" href="SlaterDet_8c.html#acd974ea424b0829a55ada79fc69abd90">copySlaterDet</a>(QA, QAp);
          <a class="code" href="SlaterDet_8c.html#ad154093b24c00e82ac9129d87cd2e049" title="boost Slater determinant with speed v">boostSlaterDet</a>(QAp, VcmA);
          gaussoverlapsdone = 0;
        }

        <span class="keywordflow">if</span> (!gaussoverlapsdone) {
          calcOvlapsAB(QAp, QB, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
          gaussoverlapsdone = 1;
        }

        calcSpecOvlaps(QAp, iso, k, QB, <a class="code" href="HOBasis_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, nlu, sa);

        <span class="keywordflow">for</span> (ms=-1; ms&lt;=1; ms=ms+2) {
          <span class="keywordflow">for</span> (o=0; o&lt;NSPEC; o++) {
            j = <a class="code" href="OneNucleonOvlaps_8c.html#a581366e9c4e1a7524e2c72cb9a307ca5">specj</a>[o]; l = <a class="code" href="OneNucleonOvlaps_8c.html#a90e7669d65b1e73e0fb181efe76074bd">specl</a>[o];
            <span class="keywordflow">for</span> (m=-j; m&lt;=j; m=m+2) {
              ml = m-ms;
              <span class="keywordflow">if</span> (-l&lt;=ml &amp;&amp; ml&lt;=l) {
                specamplitude[(-m+j)/2 + i*<a class="code" href="OneNucleonOvlaps_8c.html#a0d11ff77b25d124a8da3e15837b1e4b8">dimo</a>[o] + <a class="code" href="OneNucleonOvlaps_8c.html#a13396ab49d1309c7c94166be31333904">io</a>[o]*npoints] += weight* 
                  ((j-m)%4 ? -1 : +1)* 
                  <a class="code" href="clebsch_8c.html#a7b75250723cf843449ee508426c81537">clebsch</a>(l, 1, j, ml, ms, m)* sa[(ms+1)/2]* 
                  conj(<a class="code" href="sphericalharmonics_8c.html#a4517398bd7d1af1c7b318fab1d18dde0">Y</a>(l,ml,beta,alpha));
              }
            }
          }
        }
    }   
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1d81975fc00ddd64d268364c0f48941d"></a><!-- doxytag: member="OneNucleonOvlaps.h::initOpOneNucleonOvlaps" ref="a1d81975fc00ddd64d268364c0f48941d" args="(OneNucleonOvlapsPara *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initOpOneNucleonOvlaps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structOneNucleonOvlapsPara.html">OneNucleonOvlapsPara</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="OneNucleonOvlaps_8c_source.html#l00060">60</a> of file <a class="el" href="OneNucleonOvlaps_8c_source.html">OneNucleonOvlaps.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00115">ManyBodyOperator::dim</a>, <a class="el" href="Projection_8h_source.html#l00130">ManyBodyOperators::dim</a>, <a class="el" href="Projection_8h_source.html#l00118">ManyBodyOperator::me</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00026">OneNucleonOvlapsPara::nalpha</a>, <a class="el" href="Projection_8h_source.html#l00112">ManyBodyOperator::name</a>, <a class="el" href="Projection_8h_source.html#l00127">ManyBodyOperators::name</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00027">OneNucleonOvlapsPara::ncosb</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00025">OneNucleonOvlapsPara::npoints</a>, <a class="el" href="Projection_8h_source.html#l00117">ManyBodyOperator::par</a>, <a class="el" href="Projection_8h_source.html#l00129">ManyBodyOperators::par</a>, <a class="el" href="Projection_8h_source.html#l00114">ManyBodyOperator::pi</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00024">OneNucleonOvlapsPara::qmax</a>, <a class="el" href="Projection_8h_source.html#l00113">ManyBodyOperator::rank</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00028">OneNucleonOvlapsPara::recoil</a>, <a class="el" href="Projection_8h_source.html#l00116">ManyBodyOperator::size</a>, <a class="el" href="Projection_8h_source.html#l00131">ManyBodyOperators::size</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00039">specj</a>, <a class="el" href="OneNucleonOvlaps_8c_source.html#l00040">specl</a>, and <a class="el" href="OneNucleonOvlaps_8c_source.html#l00038">speclabel</a>.</p>

<p>Referenced by <a class="el" href="calconenucleonovlaps_8c_source.html#l00047">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">char</span>* name = malloc(60);
  sprintf(name, <span class="stringliteral">&quot;OneNucleonOvlaps-%05.2f-%d-%d-%d%s&quot;</span>,
          par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a4d8ef3bb676dc775742a4cc9748288e7">qmax</a>, par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a82775128fc0a957ce02701e9e7ec471e">npoints</a>, par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a2d02d16c65727571705d14464bb6000f">nalpha</a>, par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#aaaa4b55ab58bc37550b6d273b2687ac0">ncosb</a>, par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a4bf08246692e2a321bb4dbb7679f24df">recoil</a> ? <span class="stringliteral">&quot;-recoil&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);

  <a class="code" href="OneNucleonOvlaps_8c.html#a5e5ae9b011549095d5187d513702ec5d">OpOneNucleonOvlaps</a>.<a class="code" href="structManyBodyOperators.html#a331636b79824e209f31a9bfcac5bc026">name</a> = name;
  <a class="code" href="OneNucleonOvlaps_8c.html#a5e5ae9b011549095d5187d513702ec5d">OpOneNucleonOvlaps</a>.<a class="code" href="structManyBodyOperators.html#aa1b09f1ea3ecfedd76ca27f7954ce65b" title="has to be the same for all Operators">dim</a> = par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a82775128fc0a957ce02701e9e7ec471e">npoints</a>;
  <a class="code" href="OneNucleonOvlaps_8c.html#a5e5ae9b011549095d5187d513702ec5d">OpOneNucleonOvlaps</a>.<a class="code" href="structManyBodyOperators.html#a94494657638d56cc4a332f00aefcd1e4">size</a> = par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a82775128fc0a957ce02701e9e7ec471e">npoints</a>;
  <a class="code" href="OneNucleonOvlaps_8c.html#a5e5ae9b011549095d5187d513702ec5d">OpOneNucleonOvlaps</a>.<a class="code" href="structManyBodyOperators.html#a63b81b5a508a075fd10b76ebd219094f" title="the same for all operators">par</a> = par;

  <span class="keywordtype">int</span> i;
  <span class="keywordflow">for</span> (i=0; i&lt;NSPEC; i++) {
    <span class="keywordtype">char</span>* name = malloc(60);
    sprintf(name, <span class="stringliteral">&quot;OneNucleonOvlap%s-%05.2f-%d-%d-%d%s&quot;</span>,
            <a class="code" href="OneNucleonOvlaps_8c.html#a669098e4f7d42cdaef90238953d85733">speclabel</a>[i],
            par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a4d8ef3bb676dc775742a4cc9748288e7">qmax</a>, par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a82775128fc0a957ce02701e9e7ec471e">npoints</a>, par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a2d02d16c65727571705d14464bb6000f">nalpha</a>, par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#aaaa4b55ab58bc37550b6d273b2687ac0">ncosb</a>, par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a4bf08246692e2a321bb4dbb7679f24df">recoil</a> ? <span class="stringliteral">&quot;-recoil&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);
    <a class="code" href="OneNucleonOvlaps_8c.html#ac6405f3f461eb760c1d9754485f2796e">OpOneNucleonOvlap</a>[i].<a class="code" href="structManyBodyOperator.html#a4262723cd836949c28d7b922bc7178cd" title="uniquely identify operator including parameters">name</a> = name;
    <a class="code" href="OneNucleonOvlaps_8c.html#ac6405f3f461eb760c1d9754485f2796e">OpOneNucleonOvlap</a>[i].<a class="code" href="structManyBodyOperator.html#a2839a5170dccc5c19a75a414cccc710f" title="tensor rank of operator, 0 scalar, 2 vector, ...">rank</a> = <a class="code" href="OneNucleonOvlaps_8c.html#a581366e9c4e1a7524e2c72cb9a307ca5">specj</a>[i];
    <a class="code" href="OneNucleonOvlaps_8c.html#ac6405f3f461eb760c1d9754485f2796e">OpOneNucleonOvlap</a>[i].<a class="code" href="structManyBodyOperator.html#a78ec7c9f2238907255cf499427676907" title="parity of operator, 0 positve, 1 negative">pi</a> = <a class="code" href="OneNucleonOvlaps_8c.html#a90e7669d65b1e73e0fb181efe76074bd">specl</a>[i] % 4 ? 1 : 0;
    <a class="code" href="OneNucleonOvlaps_8c.html#ac6405f3f461eb760c1d9754485f2796e">OpOneNucleonOvlap</a>[i].<a class="code" href="structManyBodyOperator.html#a9d2fc8f9d519079b19667ee3c96615db" title="dimension of operator">dim</a> = par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a82775128fc0a957ce02701e9e7ec471e">npoints</a>;
    <a class="code" href="OneNucleonOvlaps_8c.html#ac6405f3f461eb760c1d9754485f2796e">OpOneNucleonOvlap</a>[i].<a class="code" href="structManyBodyOperator.html#a5597272550b373aa2136125a67e5d080" title="might be bigger than dimension">size</a> = par-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a82775128fc0a957ce02701e9e7ec471e">npoints</a>;
    <a class="code" href="OneNucleonOvlaps_8c.html#ac6405f3f461eb760c1d9754485f2796e">OpOneNucleonOvlap</a>[i].<a class="code" href="structManyBodyOperator.html#a05268b1b149040fd992263f2e22de7ec">par</a> = par;
    <a class="code" href="OneNucleonOvlaps_8c.html#ac6405f3f461eb760c1d9754485f2796e">OpOneNucleonOvlap</a>[i].<a class="code" href="structManyBodyOperator.html#aba2e7e550190ee2ec6e75c23c55fee2d">me</a> = NULL;
  }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2728acaa1a11ca7a88592aa838cf4a81"></a><!-- doxytag: member="OneNucleonOvlaps.h::writeOneNucleonOvlaps" ref="a2728acaa1a11ca7a88592aa838cf4a81" args="(FILE *fp, const Projection *P, const OneNucleonOvlapsPara *p, int jfin, int pfin, int afin, int jini, int pini, int aini, void *specamplitudeme, const Eigenstates *Efin, const Eigenstates *Eini)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeOneNucleonOvlaps </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structProjection.html">Projection</a> *&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structOneNucleonOvlapsPara.html">OneNucleonOvlapsPara</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>jfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pfin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>afin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>jini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>aini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>specamplitudeme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Efin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structEigenstates.html">Eigenstates</a> *&nbsp;</td>
          <td class="paramname"> <em>Eini</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="OneNucleonOvlaps_8c_source.html#l00307">307</a> of file <a class="el" href="OneNucleonOvlaps_8c_source.html">OneNucleonOvlaps.c</a>.</p>

<p>References <a class="el" href="Projection_8h_source.html#l00147">Eigenstates::index</a>, <a class="el" href="Projection_8h_source.html#l00093">Projection::jmax</a>, <a class="el" href="Projection_8h_source.html#l00148">Eigenstates::norm</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00025">OneNucleonOvlapsPara::npoints</a>, <a class="el" href="OneNucleonOvlaps_8h_source.html#l00024">OneNucleonOvlapsPara::qmax</a>, and <a class="el" href="calcbasisovlapmulti_8c_source.html#l00032">SQR</a>.</p>

<p>Referenced by <a class="el" href="calconenucleonovlaps_8c_source.html#l00047">main()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> jmax = P-&gt;<a class="code" href="structProjection.html#aaab8cf237ff5e23d0f7abb05117387fe" title="calculate up to (jmax-1)/2">jmax</a>;
  <span class="keywordtype">int</span> ipjfin = idxpij(jmax,pfin,jfin);
  <span class="keywordtype">int</span> ipjini = idxpij(jmax,pini,jini);
  <span class="keywordtype">int</span> npoints = p-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a82775128fc0a957ce02701e9e7ec471e">npoints</a>;
  <span class="keywordtype">double</span> qmax = p-&gt;<a class="code" href="structOneNucleonOvlapsPara.html#a4d8ef3bb676dc775742a4cc9748288e7">qmax</a>;
  <span class="keywordtype">int</span> idxfin = Efin-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipjfin][afin];
  <span class="keywordtype">int</span> idxini = Eini-&gt;<a class="code" href="structEigenstates.html#a0a44e079b2e594d09a15d3a1ddd4a35c" title="indexing eigenstates according to &amp;quot;goodness&amp;quot;">index</a>[ipjini][aini];
  <span class="keywordtype">double</span> normfin = Efin-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipjfin][idxfin];
  <span class="keywordtype">double</span> normini = Eini-&gt;<a class="code" href="structEigenstates.html#aafb83e8289ec1cb2c7e882311c35ea3a" title="many-body norm^2 of eigenstates">norm</a>[ipjini][idxini];
  complex double (****specampme)[npoints] = specamplitudeme;
  complex <span class="keywordtype">double</span> *sa = specampme[ipjfin][ipjini][idxfin][idxini];
  <span class="keywordtype">int</span> i;
  <span class="keywordtype">double</span> <a class="code" href="MinimizerDONLP2_8c.html#a116d67c73cdfa395275c96c0151ddcd4">q</a>;
  complex <span class="keywordtype">double</span> ml;
  
  <span class="comment">// calculate spectroscopic factor</span>
  <span class="keywordtype">double</span> dq = qmax/(npoints-1);
  <span class="keywordtype">double</span> S = 0.0;
  <span class="keywordflow">for</span> (i=0; i&lt;npoints; i++) {
    q = i*dq;
    S += dq*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(q)* (jfin+1.0)/(jini+1.0)*<a class="code" href="calcbasisovlapmulti_8c.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(cabs(sa[i]))/(normfin*normini);
  }
  fprintf(stderr, <span class="stringliteral">&quot;Spectroscopic factor: %6.3f\n&quot;</span>, S);

  <span class="comment">// write spectroscopic amplitudes</span>
  <span class="keywordflow">for</span> (i=0; i&lt;npoints; i++) {
    q = i*dq;
    
    <span class="comment">// we include factor 1/sqrt(2*Jini+1) into definiton</span>
    <span class="comment">// of spectroscopic amplitude</span>

    ml = sqrt((jfin+1.0)/(jini+1.0))* sa[i]/sqrt(normfin*normini);

    fprintf(fp, <span class="stringliteral">&quot;%6.3f\t%13.5g\t%13.5g\n&quot;</span>, q, creal(ml), cimag(ml));
  }
}
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a14a3f5a98f800054572b1b091f81c311"></a><!-- doxytag: member="OneNucleonOvlaps.h::OpOneNucleonOvlap" ref="a14a3f5a98f800054572b1b091f81c311" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structManyBodyOperator.html">ManyBodyOperator</a> <a class="el" href="OneNucleonOvlaps_8h.html#a14a3f5a98f800054572b1b091f81c311">OpOneNucleonOvlap</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="OneNucleonOvlaps_8c_source.html#l00049">49</a> of file <a class="el" href="OneNucleonOvlaps_8c_source.html">OneNucleonOvlaps.c</a>.</p>

<p>Referenced by <a class="el" href="calconenucleonovlaps_8c_source.html#l00047">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a5e5ae9b011549095d5187d513702ec5d"></a><!-- doxytag: member="OneNucleonOvlaps.h::OpOneNucleonOvlaps" ref="a5e5ae9b011549095d5187d513702ec5d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structManyBodyOperators.html">ManyBodyOperators</a> <a class="el" href="OneNucleonOvlaps_8h.html#a5e5ae9b011549095d5187d513702ec5d">OpOneNucleonOvlaps</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="OneNucleonOvlaps_8c_source.html#l00052">52</a> of file <a class="el" href="OneNucleonOvlaps_8c_source.html">OneNucleonOvlaps.c</a>.</p>

<p>Referenced by <a class="el" href="calconenucleonovlaps_8c_source.html#l00047">main()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 14:05:36 for FMD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
